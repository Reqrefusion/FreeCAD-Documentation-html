<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Create a FeaturePython object part II/ru</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="ru" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Create+a+FeaturePython+object+part+II&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--complete" title="Ein FeaturePython-Objekt erstellen Teil II (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Create_a_FeaturePython_object_part_II.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Create a FeaturePython object part II (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--complete" title="Cr&eacute;er un objet FeaturePython partie II (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--low" title="Creare un Box FeaturePython, Parte II (8% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Create_a_FeaturePython_object_part_II.html" class="mw-pt-progress mw-pt-progress--complete" title="Tworzenie obiekt&oacute;w FeaturePython - cz&#281;&#347;&#263; II (100% translated)" lang="pl" dir="ltr">polski</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</span></li></ul></div>
<div class="docnav">
    <div><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16" class="mw-file-element" data-file-width="64" data-file-height="64"></span></span> <a href="../ru/Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I/ru">Create a FeaturePython object part I</a></div>
    <div><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="16" height="16" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span></div>
    <div><a href="../ru/Online_Help_Toc.html" title="Online Help Toc/ru">&#1054;&#1075;&#1083;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><meta property="mw:PageProp/toc"></div>
<p><span id="Introduction"></span>
</p>
<h2><span id=".D0.92.D1.81.D1.82.D1.83.D0.BF.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="&#1042;&#1089;&#1090;&#1091;&#1087;&#1083;&#1077;&#1085;&#1080;&#1077;">&#1042;&#1089;&#1090;&#1091;&#1087;&#1083;&#1077;&#1085;&#1080;&#1077;</span></h2>
<p>On the <a href="../Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I">Create a FeaturePython object part I</a> page we've focused on the internal aspects of a Python class built around a FeaturePython object, specifically an <code>App::FeaturePython</code> object. We've created the object, defined some properties, and added a document-level event callback that allows our object to respond to a document recompute with the <code>execute()</code> method. But our object still lacks a presence in the <a href="../3D_view.html" class="mw-redirect" title="3D view">3D view</a>. Let's remedy that by adding a box.
</p>
<h2><span class="mw-headline" id="Adding_a_box">Adding a box</span></h2>
<p>First at the top of the <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> file, below the existing import, add:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
</pre></div>
<p>Then in <code>execute()</code> delete the <code>print()</code> statement and add the following line in its place:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">))</span>
</pre></div>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a href="../index.php?title=App_featurepython_box.png&amp;filetimestamp=20200604171503&amp;.html" class="mw-file-description"><img src="../File/App_featurepython_box.png" decoding="async" width="205" height="180" class="mw-file-element" data-file-width="205" data-file-height="180"></a><figcaption></figcaption></figure>
<p>These commands execute Python methods that come with FreeCAD by default:
</p>
<ul><li>The <code>Part.makeBox()</code> method generates a box shape.</li>
<li>The enclosing call to <code>Part.show()</code> adds the shape to the document and makes it visible.</li></ul>
<p>Delete any existing objects, reload the box module and create a new box object using <code>box.create()</code>. Notice how a box immediately appears on the screen. That is because we force the document to recompute at the end of <code>box.create()</code> which in turn triggers the <code>execute()</code> method of our <code>box</code> class.
</p><p>At first glance the result may look fine but there are some problems. The most obvious one is that the box is represented by an entirely different object than our FeaturePython object. <code>Part.show()</code> simply creates a separate box object and adds it to the document. Worse, if you change the dimensions of the FeaturePython object another box shape gets created, and the old one is left in place. And if you have the <a href="../Report_view.html" class="mw-redirect" title="Report view">Report view</a> open, you may have noticed an error stating "Recursive calling of recompute for document Unnamed". This has to do with using the <code>Part.show()</code> method inside a FeaturePython object.
</p>
<div style="clear:both"></div>
<p><a href="#top">&#1085;&#1072;&#1074;&#1077;&#1088;&#1093;</a>
</p>
<h2><span class="mw-headline" id="Fixing_the_code">Fixing the code</span></h2>
<p>To solve these problems we have to make a number of changes. Until now we've been using a <code>App::FeaturePython</code> object which is actually not intended to have a visual representation in the 3D view. We have to use a <code>Part::FeaturePython</code> object instead. In <code>create()</code> change the following line:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'App::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
</pre></div>
<p>to:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Part::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>
</pre></div>
<p>To get rid of the separate box object we need to assigns the result of the <code>makeBox()</code> method to the <code>Shape</code> property of our <code>Part::FeaturePython</code> object. Change this line in <code>execute()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">))</span>
</pre></div>
<p>to:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
</pre></div>
<figure class="mw-default-size mw-halign-right" typeof="mw:File"><a href="../index.php?title=Part_featurepython_no_vp.png&amp;filetimestamp=20190416103134&amp;.html" class="mw-file-description"><img src="../File/Part_featurepython_no_vp.png" decoding="async" width="201" height="156" class="mw-file-element" data-file-width="201" data-file-height="156"></a><figcaption></figcaption></figure>
<p>Save your changes, switch back to FreeCAD, delete any existing objects, reload the box module, and create a new box object. The new result is somewhat disappointing. There no longer is an extra object in the Tree view, and the icon in the Tree view has changed, but our box in the 3D view is also gone (which is why the icon is gray). What happened? Although we've properly created our box shape and assigned it to a <code>Part::FeaturePython</code> object, to make it actually show up in the 3D view we need to assign a <a href="../Viewprovider.html" title="Viewprovider">ViewProvider</a>.
</p>
<div style="clear:both"></div>
<p><a href="#top">&#1085;&#1072;&#1074;&#1077;&#1088;&#1093;</a>
</p>
<h2><span class="mw-headline" id="Writing_a_ViewProvider">Writing a ViewProvider</span></h2>
<p>A View Provider is the component of an object which allows it to have a visual representation in the 3D view. FreeCAD uses an application structure which is designed to separate the data (the "model") from it's visual representation (the "view"). If you've spent any time working with FreeCAD in Python, you are likely already aware of this through the use of the two core Python modules: <code>FreeCAD</code> and <code>FreeCADGui</code> (often aliased as <code>App</code> and <code>Gui</code> repectively).
</p><p>Our FeaturePython object also requires these elements. Thus far we've focused purely on the "model" portion of the code, now it's time to write the "view" portion. Fortunately most ViewProviders are simple and require little effort to write, at least to get started. Here's an example ViewProvider borrowed and slightly modified from <a rel="nofollow" class="external autonumber" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py">[1]</a>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Set this object to the proxy object of the actual view provider</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Setup the scene sub-graph of the view provider, this method is mandatory</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        If a property of the handled feature has changed we have the chance to handle this here</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return a list of display modes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return the name of the default display mode. It must be defined in getDisplayModes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Map the display mode defined in attach with those defined in getDisplayModes.</span>
<span class="sd">        Since they have the same names nothing needs to be done.</span>
<span class="sd">        This method is optional.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Print the name of the property that has changed</span>
<span class="sd">        """</span>

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return the icon in XMP format which will appear in the tree view. This method is optional and if not defined a default icon is shown.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "    c None",</span>
<span class="s2">            ".   c #141010",</span>
<span class="s2">            "+   c #615BD2",</span>
<span class="s2">            "@   c #C39D55",</span>
<span class="s2">            "#   c #000000",</span>
<span class="s2">            "$   c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Called during document saving.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Called during document restore.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>In the code above, we define an XMP icon for this object. Icon design is beyond the scope of this tutorial, but basic design can be managed using open source tools like <a rel="nofollow" class="external text" href="https://www.gimp.org">GIMP</a>, <a rel="nofollow" class="external text" href="https://krita.org/en/">Krita</a>, and <a rel="nofollow" class="external text" href="https://inkscape.org/">Inkscape</a>. The <code>getIcon()</code> method is optional, FreeCAD will use a default icon if this method is not provided.
</p><p>Add the ViewProvider code at the end of <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">box.py</span> and in the <code>create()</code> method insert the following line above the <code>recompute()</code> statement:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
</pre></div>
<p>This instances the custom ViewProvider class and passes the FeaturePython's built-in ViewObject to it. When the ViewProvider class initializes, it saves a reference to itself in the FeaturePython's <code>ViewObject.Proxy</code> attribute. This way, when FreeCAD needs to render our box visually, it can find the ViewProvider class to do that.
</p><p>Now, save the changes and return to FreeCAD. Import or reload the box module and call <code>box.create()</code>. You should now see two things:
</p>
<ul><li>The icon for the box object has changed.</li>
<li>And, more importantly, there is a box in the 3D view. If you do not see it press the <span class="ButtonTemplate" style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.3em; padding: 0px 8px 1px 8px; font-weight:normal;color: #202122;"><span typeof="mw:File"><a href="../index.php?title=Std_ViewFitAll.svg&amp;filetimestamp=20240704204734&amp;.html" class="mw-file-description"><img src="../File/Std_ViewFitAll.svg" decoding="async" width="16" height="16" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span> <a href="../Std_ViewFitAll.html" title="Std ViewFitAll">Std ViewFitAll</a></span> button. You can even alter the dimensions of the box by changing the values in the <a href="../Property_editor.html" class="mw-redirect" title="Property editor">Property editor</a>. Give it a try!</li></ul>
<p><a href="#top">&#1085;&#1072;&#1074;&#1077;&#1088;&#1093;</a>
</p>
<h2><span class="mw-headline" id="Trapping_events">Trapping events</span></h2>
<p>We have already discussed event trapping. Nearly every method of a FeaturePython class serves as a callback accessible to the FeaturePython object (which gets access to our class instance through the <code>Proxy</code> attribute).
</p><p>Below is a list of the callbacks that may be implemented in the basic FeaturePython object:
</p>
<table class="wikitable" cellpadding="5px" width="100%">
<caption>FeaturePython basic callbacks
</caption>
<tbody><tr>
<td style="width:25%"><code>execute(self, obj)</code>
</td>
<td style="width:25%">Called during document recomputes
</td>
<td style="width:50%">Do not call <code>recompute()</code> from this method (or any method called from <code>execute()</code>) as this causes a nested recompute.
</td></tr>
<tr>
<td><code>onBeforeChange(self, obj, prop)</code>
</td>
<td>Called before a property value is changed
</td>
<td><code>prop</code> is the name of the property to be changed, not the property object itself. Property changes cannot be cancelled.  Previous / next property values are not simultaneously available for comparison.
</td></tr>
<tr>
<td><code>onChanged(self, obj, prop)</code>
</td>
<td>Called after a property is changed
</td>
<td><code>prop</code> is the name of the property to be changed, not the property object itself.
</td></tr>
<tr>
<td><code>onDocumentRestored(self, obj)</code>
</td>
<td>Called after a document is restored or a FeaturePython object is copied.
</td>
<td>Occasionally, references to the FeaturePython object from the class, or the class from the FeaturePython object may be broken, as the class <code>__init__()</code> method is not called when the object is reconstructed. Adding <code>self.Object = obj</code> or <code>obj.Proxy = self</code> often solves these issues.
</td></tr></tbody></table>
<p>For a complete reference of FeaturePython methods available, see <a href="../FeaturePython_methods.html" title="FeaturePython methods">FeaturePython methods</a>.
</p><p>In addition, there are two callbacks in the ViewProvider class that may occasionally prove useful:
</p>
<table class="wikitable" cellpadding="5px" width="100%">
<caption>ViewProvider basic callbacks
</caption>
<tbody><tr>
<td style="width:25%"><code>updateData(self, obj, prop)</code>
</td>
<td style="width:25%">Called after a data (model) property is changed
</td>
<td style="width:50%"><code>obj</code> is a reference to the FeaturePython class instance, not the ViewProvider instance.  <code>prop</code> is the name of the property to be changed, not the property object itself.
</td></tr>
<tr>
<td><code>onChanged(self, vobj, prop)</code>
</td>
<td>Called after a view property is changed
</td>
<td><code>vobj</code> is a reference to the ViewProvider instance.  <code>prop</code> is the name of the view property which was changed.
</td></tr></tbody></table>
<p>It is not uncommon to encounter a situation where the Python callbacks are not being triggered as they should. Beginners in this area can rest assured that the FeaturePython callback system is not fragile or broken. Invariably when callbacks fail to run it is because a reference is lost or undefined in the underlying code. If, however, callbacks appear to be breaking with no explanation, providing object/proxy references in the <code>onDocumentRestored()</code> callback (as noted in the first table above) may alleviate these problems. Until you are comfortable with the callback system, it may be useful to add print statements in each callback to print messages to the console during development.
</p><p><a href="#top">&#1085;&#1072;&#1074;&#1077;&#1088;&#1093;</a>
</p><p><span id="Complete_code"></span>
</p>
<h2><span id=".D0.97.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.B8.D1.81.D1.85.D0.BE.D0.B4.D0.BD.D1.8B.D0.B9_.D0.BA.D0.BE.D0.B4"></span><span class="mw-headline" id="&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1099;&#1081;_&#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081;_&#1082;&#1086;&#1076;">&#1047;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1085;&#1099;&#1081; &#1080;&#1089;&#1093;&#1086;&#1076;&#1085;&#1099;&#1081; &#1082;&#1086;&#1076;</span></h2>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">Part</span>

<span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="n">obj_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Object creation method</span>
<span class="sd">    """</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Part::FeaturePython'</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">)</span>

    <span class="n">Box</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">App</span><span class="o">.</span><span class="n">GuiUp</span><span class="p">:</span>
        <span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>

    <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">obj</span>

<span class="k">class</span> <span class="nc">Box</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Default constructor</span>
<span class="sd">        """</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="s1">'box'</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyString'</span><span class="p">,</span> <span class="s1">'Description'</span><span class="p">,</span> <span class="s1">'Base'</span><span class="p">,</span> <span class="s1">'Box description'</span><span class="p">)</span><span class="o">.</span><span class="n">Description</span> <span class="o">=</span> <span class="s2">""</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box length'</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">10.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Width'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box width'</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="s1">'10 mm'</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s1">'App::PropertyLength'</span><span class="p">,</span> <span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Dimensions'</span><span class="p">,</span> <span class="s1">'Box height'</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="s1">'1 cm'</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Called on document recompute</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeBox</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Set this object to the proxy object of the actual view provider</span>
<span class="sd">        """</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Setup the scene sub-graph of the view provider, this method is mandatory</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        If a property of the handled feature has changed we have the chance to handle this here</span>
<span class="sd">        """</span>
        <span class="k">return</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return a list of display modes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return the name of the default display mode. It must be defined in getDisplayModes.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Map the display mode defined in attach with those defined in getDisplayModes.</span>
<span class="sd">        Since they have the same names nothing needs to be done.</span>
<span class="sd">        This method is optional.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Print the name of the property that has changed</span>
<span class="sd">        """</span>

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Return the icon in XMP format which will appear in the tree view. This method is optional and if not defined a default icon is shown.</span>
<span class="sd">        """</span>

        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "    c None",</span>
<span class="s2">            ".   c #141010",</span>
<span class="s2">            "+   c #615BD2",</span>
<span class="s2">            "@   c #C39D55",</span>
<span class="s2">            "#   c #000000",</span>
<span class="s2">            "$   c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Called during document saving.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Called during document restore.</span>
<span class="sd">        """</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p><a href="#top">&#1085;&#1072;&#1074;&#1077;&#1088;&#1093;</a>
</p>
<div class="docnav">
    <div><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16" class="mw-file-element" data-file-width="64" data-file-height="64"></span></span> <a href="../ru/Create_a_FeaturePython_object_part_I.html" title="Create a FeaturePython object part I/ru">Create a FeaturePython object part I</a></div>
    <div><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="16" height="16" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span></div>
    <div><a href="../ru/Online_Help_Toc.html" title="Online Help Toc/ru">&#1054;&#1075;&#1083;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1077;</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span></div>
</div>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
    <div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: var(--background-color-neutral-subtle, #fefefe);"><span typeof="mw:File"><a href="../index.php?title=Power_user_hub.png&amp;filetimestamp=20200511213015&amp;.html" class="mw-file-description"><img src="../File/Power_user_hub.png" decoding="async" width="24" height="24" class="mw-file-element" data-file-width="128" data-file-height="128"></a></span> <a href="../ru/Power_users_hub.html" title="Power users hub/ru">Power user documentation</a>
        <div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid var(--border-color-base, #aaaaaa); text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: var(--background-color-neutral-subtle, #fefefe);">
<ul><li><b>FreeCAD scripting:</b> <a href="../ru/Python.html" title="Python/ru">Python</a>, <a href="../ru/Introduction_to_Python.html" title="Introduction to Python/ru">Introduction to Python</a>, <a href="../ru/Python_scripting_tutorial.html" title="Python scripting tutorial/ru">Python scripting tutorial</a>, <a href="../ru/FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/ru">FreeCAD Scripting Basics</a></li></ul>
<hr>
<ul><li><b>Modules:</b> <a href="../ru/Builtin_modules.html" title="Builtin modules/ru">Builtin modules</a>, <a href="../ru/Units.html" title="Units/ru">Units</a>, <a href="../ru/Quantity.html" title="Quantity/ru">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../ru/Workbench_creation.html" title="Workbench creation/ru">Workbench creation</a>, <a href="../ru/Gui_Command.html" title="Gui Command/ru">Gui Commands</a>, <a href="../ru/Command.html" title="Command/ru">Commands</a>, <a href="../ru/Installing_more_workbenches.html" title="Installing more workbenches/ru">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../ru/Mesh_Scripting.html" title="Mesh Scripting/ru">Mesh Scripting</a>, <a href="../ru/Topological_data_scripting.html" title="Topological data scripting/ru">Topological data scripting</a>, <a href="../ru/Mesh_to_Part.html" title="Mesh to Part/ru">Mesh to Part</a>, <a href="../ru/PythonOCC.html" title="PythonOCC/ru">PythonOCC</a></li></ul>
<hr>
<ul><li><b>Parametric objects:</b> <a href="../ru/Scripted_objects.html" title="Scripted objects/ru">Scripted objects</a>, <a href="../ru/Viewprovider.html" title="Viewprovider/ru">Viewproviders</a> <small>(<a href="../ru/Custom_icon_in_tree_view.html" title="Custom icon in tree view/ru">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../ru/Scenegraph.html" title="Scenegraph/ru">Coin (Inventor) scenegraph</a>, <a href="../ru/Pivy.html" title="Pivy/ru">Pivy</a></li>
<li><b>Graphical interface:</b> <a href="../ru/Interface_creation.html" title="Interface creation/ru">Interface creation</a>, <a href="../ru/Dialog_creation.html" title="Dialog creation/ru">Interface creation completely in Python</a> <small>(<a href="../index.php?title=Dialog_creation_with_various_widgets/ru&amp;action=edit&amp;redlink=1.html" class="new" title="Dialog creation with various widgets/ru (page does not exist)">1</a>, <a href="../index.php?title=Dialog_creation_reading_and_writing_files/ru&amp;action=edit&amp;redlink=1.html" class="new" title="Dialog creation reading and writing files/ru (page does not exist)">2</a>, <a href="../index.php?title=Dialog_creation_setting_colors/ru&amp;action=edit&amp;redlink=1.html" class="new" title="Dialog creation setting colors/ru (page does not exist)">3</a>, <a href="../index.php?title=Dialog_creation_image_and_animated_GIF/ru&amp;action=edit&amp;redlink=1.html" class="new" title="Dialog creation image and animated GIF/ru (page does not exist)">4</a>, <a href="../index.php?title=PySide_usage_snippets/ru&amp;action=edit&amp;redlink=1.html" class="new" title="PySide usage snippets/ru (page does not exist)">5</a>)</small>, <a href="../ru/PySide.html" title="PySide/ru">PySide</a>, PySide examples <a href="../ru/PySide_Beginner_Examples.html" title="PySide Beginner Examples/ru">beginner</a>, <a href="../ru/PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/ru">intermediate</a>, <a href="../ru/PySide_Advanced_Examples.html" title="PySide Advanced Examples/ru">advanced</a></li>
<li><b>Macros:</b> <a href="../ru/Macros.html" title="Macros/ru">Macros</a>, <a href="../ru/How_to_install_macros.html" title="How to install macros/ru">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../ru/Embedding_FreeCAD.html" title="Embedding FreeCAD/ru">Embedding FreeCAD</a>, <a href="../ru/Embedding_FreeCADGui.html" title="Embedding FreeCADGui/ru">Embedding FreeCADGui</a></li></ul>
<hr>
<ul><li><b>Other:</b> <a href="../ru/Expressions.html" title="Expressions/ru">Expressions</a>, <a href="../ru/Code_snippets.html" title="Code snippets/ru">Code snippets</a>, <a href="../ru/Line_drawing_function.html" title="Line drawing function/ru">Line drawing function</a>, <a href="../ru/FreeCAD_vector_math_library.html" title="FreeCAD vector math library/ru">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr>
<ul><li><b>Hubs:</b> <a href="../ru/User_hub.html" title="User hub/ru">User hub</a>, <a href="../ru/Power_users_hub.html" title="Power users hub/ru">Power users hub</a>, <a href="../ru/Developer_hub.html" title="Developer hub/ru">Developer hub</a></li></ul></div>
    </div></div>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20260216160642
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.104 seconds
Real time usage: 0.136 seconds
Preprocessor visited node count: 585/1000000
Post&#8208;expand include size: 10300/2097152 bytes
Template argument size: 9519/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 9/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 25020/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   36.008      1 -total
 26.58%    9.570      1 Template:Powerdocnavi/ru
 15.05%    5.420      9 Template:Code
 10.52%    3.787     48 Template:Incode
 10.45%    3.763      2 Template:Docnav/ru
 10.44%    3.758      1 Template:Navigation_menu_2
  8.18%    2.945      3 Template:Clear
  6.53%    2.351      1 Template:TOCright
  5.21%    1.877      2 Template:FileName
  4.22%    1.521      1 Template:Button
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:196867-0!canonical and timestamp 20260216160642 and revision id 1755565. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>