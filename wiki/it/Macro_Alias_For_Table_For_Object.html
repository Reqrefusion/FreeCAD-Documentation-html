<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Alias For Table For Object/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Alias+For+Table+For+Object&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Macro_Alias_For_Table_For_Object.html" class="mw-pt-progress mw-pt-progress--complete" title="Makro Alias f&uuml;r Tabelle f&uuml;r Objekt (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_Alias_For_Table_For_Object.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Alias For Table For Object (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Alias_For_Table_For_Object.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Alias For Table For Object (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Macro_Alias_For_Table_For_Object.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Alias obiektu do tabeli (4% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Text-x-python.png&amp;filetimestamp=20121224162851&amp;.html" class="mw-file-description" title="Generic macro icon. Create your personal icon with the same name of the macro"><img alt="Generic macro icon. Create your personal icon with the same name of the macro" src="../File/Text-x-python.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></a></span><span> </span>
Macro Alias For Table For Object
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">This macro automatically creates aliases in a two-dimensional table using the names of the rows and columns.<br>
<p>A second function can create a link between a cell and a property value in an object.<br>
To be able to use this function, you just have to place the name of the relevant object in the column and the name of the property in the row.<br><br>Macro version: beta<br>Last modified: 2024-02-22<br>FreeCAD version: All<br>Author: 2cv001<br>
</p>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;2cv001&amp;action=edit&amp;redlink=1.html" class="new" title="User:2cv001 (page does not exist)">2cv001</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download">
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="../How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="../Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">beta
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2024-02-22
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
</div>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Descrizione">Descrizione</span></h2>
<p>Questa macro crea automaticamente alias in una tabella bidimensionale utilizzando i nomi di righe e colonne. Una seconda funzione pu&ograve; creare un collegamento tra una cella e il valore di una propriet&agrave; di un oggetto. Per poter utilizzare questa funzione, &egrave; sufficiente inserire il nome dell'oggetto in questione nella colonna e il nome della propriet&agrave; nella riga. 
</p><p>La sintassi per l'alias creato dalla macro &egrave;: <code>LabelObject_Property</code>.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=20240220.gif&amp;filetimestamp=20240220190651&amp;.html" class="mw-file-description"><img src="../File/20240220.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p>La macro pu&ograve; anche compilare automaticamente i valori delle propriet&agrave; degli oggetti (ad esempio corpo, schizzo, ecc.) in base a questi alias.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=20240220-01.gif&amp;filetimestamp=20240220190916&amp;.html" class="mw-file-description"><img src="../File/20240220-01.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilizzo">Utilizzo</span></h2>
<p><span id="Automatic_alias_creation"></span>
</p>
<h3><span class="mw-headline" id="Creazione_automatica_di_alias">Creazione automatica di alias</span></h3>
<p>Preparare un foglio di calcolo con una colonna contenente le etichette degli oggetti (Body, Sketch, Pad, ...) e una riga corrispondente alle propriet&agrave;. Nel codice si trover&agrave; la corrispondenza tra le propriet&agrave; e cosa inserire in questa riga. Vedere <code>dico=</code> di seguito.
</p><p>Ad esempio, utilizzare <code>posy</code> per la propriet&agrave; <code>Placement.Base.y</code>.
</p><p>Selezionare le celle nella tabella con la colonna delle etichette degli oggetti e la riga delle propriet&agrave;, quindi eseguire la macro e selezionare la prima opzione:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Capture_d%27%C3%A9cran_2024-02-22_02.png&amp;filetimestamp=20240221131153&amp;.html" class="mw-file-description"><img src="../File/Capture_d%27%C3%A9cran_2024-02-22_02.png" decoding="async" width="228" height="124" class="mw-file-element" data-file-width="228" data-file-height="124"></a></span>
</p><p>La macro creer&agrave; alias con questa sintassi: <code>LabelObject_Property</code>. Ad esempio: <code>BodyRect_posy</code>.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Capture_d%27%C3%A9cran_2024-02-21_133729.png&amp;filetimestamp=20240221130001&amp;.html" class="mw-file-description"><img src="../File/Capture_d%27%C3%A9cran_2024-02-21_133729.png" decoding="async" width="1113" height="622" class="mw-file-element" data-file-width="1113" data-file-height="622"></a></span>
</p><p>Parte del dico (controllare il codice della macro per il dico completo): 
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>dico={
        "posx"&nbsp;: "Placement.Base.x",
        "posy"&nbsp;: "Placement.Base.y",
        "posz"&nbsp;: "Placement.Base.z",
        "posX"&nbsp;: "Placement.Base.x",
        "posY"&nbsp;: "Placement.Base.y",
        "posZ"&nbsp;: "Placement.Base.z",
        "angle": "Placement.Rotation.Angle",
        "ang" &nbsp;: "Placement.Rotation.Angle",
        "axisx": "Placement.Rotation.Axis.x",
        "axisy": "Placement.Rotation.Axis.y",       
        "axisz": "Placement.Rotation.Axis.z", 
        "axeX"&nbsp;: "Placement.Rotation.Axis.x",
        "axeY"&nbsp;: "Placement.Rotation.Axis.y",       
        "axeZ"&nbsp;: "Placement.Rotation.Axis.z", 
        "attachementX"&nbsp;: "AttachmentOffset.Base.x",
        "attachementY"&nbsp;: "AttachmentOffset.Base.y",
        "attachementZ"&nbsp;: "AttachmentOffset.Base.z",
        "attachementAngle"&nbsp;: "AttachmentOffset.Rotation.Angle",
        "attachementAxisX"&nbsp;: "AttachmentOffset.Rotation.Axis.x",
        "attachementAxisY"&nbsp;: "AttachmentOffset.Rotation.Axis.y",        
        "attachementAxisZ"&nbsp;: "AttachmentOffset.Rotation.Axis.z",
        "Length"&nbsp;: "Length",
        "Length2": "Length2",
        "Radius"&nbsp;: "Radius",
        "Height"&nbsp;: "Height",
        "FirstAngle"&nbsp;: "FirstAngle",
        "SecondAngle": "SecondAngle",
        "Angle1"&nbsp;: "Angle1",
        "Angle2"&nbsp;: "Angle2",
        "Angle3"&nbsp;: "Angle3",
</pre></div>
<p><span id="Automatic_values_in_properties"></span>
</p>
<h3><span id="Valori_automatici_nelle_propriet.C3.A0"></span><span class="mw-headline" id="Valori_automatici_nelle_propriet&agrave;">Valori automatici nelle propriet&agrave;</span></h3>
<p>Selezionare alcune celle nella tabella con valori e alias creati in precedenza. Eseguire la macro e selezionare la seconda opzione (entrambe le opzioni possono essere selezionate contemporaneamente per concatenarle).
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Alias_For_Table_For_Object03.png&amp;filetimestamp=20240221132815&amp;.html" class="mw-file-description"><img src="../File/Alias_For_Table_For_Object03.png" decoding="async" width="224" height="120" class="mw-file-element" data-file-width="224" data-file-height="120"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The macro will assign values to the properties via an expression referencing the alias of the cells. From now on, if you change a value in the table, the property value will change and everything will be recalculated.
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Alias_For_Table_For_Object04.png&amp;filetimestamp=20240221133045&amp;.html" class="mw-file-description"><img src="../File/Alias_For_Table_For_Object04.png" decoding="async" width="1082" height="640" class="mw-file-element" data-file-width="1082" data-file-height="640"></a></span><br>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h3><span class="mw-headline" id="Examples">Examples</span></h3>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h4><span class="mw-headline" id="Pad">Pad</span></h4>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Alias_For_Table_For_Object_01.gif&amp;filetimestamp=20240221140039&amp;.html" class="mw-file-description"><img src="../File/Macro_Alias_For_Table_For_Object_01.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h4><span class="mw-headline" id="Sketch_constraints">Sketch constraints</span></h4>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Give a name to the constraint (here: Width) (Pay attention to the case.) Add a column with this constraint name in the properties row, and add a row with the label of the Sketch (here: Sketch). Run the macro.
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Alias_For_Table_For_Object_02.gif&amp;filetimestamp=20240221145555&amp;.html" class="mw-file-description"><img src="../File/Macro_Alias_For_Table_For_Object_02.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Credits">Credits</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This macro was developed based on an idea suggested by Esprit. Also, many thanks to him for the numerous ideas and tests he has carried out.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Version_information">Version information</span></h2>
</div> 
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>ver 25/02/2024 by 2cv001 <b>Alias_For_Table_For_Object.FCMacro</b>
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Code">Code</span></h2>
</div>
<div class="plainlinks" style="width:300px; text-align:center; margin:10px auto;">
<div style="border:1px outset #9eb4b5; background:#f0fdf8; margin:5px; padding:5px; white-space:nowrap; -webkit-border-radius: 5px; -moz-border-radius: 5px;">
<p><span typeof="mw:File"><a href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros-Beta1/main/Alias_For_Table_For_Object.FCMacro" rel="nofollow"><img src="../File/Nuvola_apps_download_manager.png" decoding="async" width="35" height="35" class="mw-file-element" data-file-width="128" data-file-height="128"></a></span>
</p><p><span class="CodeDownload" style="font-weight:bold"><a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros-Beta1/main/Alias_For_Table_For_Object.FCMacro">Download latest version of the macro</a></span>
</p>
</div>
</div>
<pre>#!/usr/bin/env python
# -*- coding: utf-8 -*-
# ========================================================================
# Macro Alias for table for object
# file name&nbsp;: Alias_For_Table_For_Object.FCMacro
# ========================================================================


__Name__   = "Alias for table for object"
__Comment__ ="Automatically creates aliases in a two-dimensional table using the names of the rows and columns"
__Author__ = "2cv001"
__Title__   = "Alias For Table For Object"
__Date__    = "2024/02/20"    #YYYY/MM/DD 14;21 B&eacute;ta
__Version__ = __Date__
__License__ = "Apache-2.0"
__Wiki__ = "https://wiki.freecad.org/Macro_Alias_For_Table_For_Object"
# https://forum.freecad.org/viewtopic.php?t=84878
#===========================================================================================
# The macro automatically creates alias in a two-dimensional table using the name of the row
# and the name of the column. To be able to use the "Table to object" function
# put the name of the concerned object in the column and the name of the property in the row.
# the alias creation function will create alias (except dico, see below)
# with this syntax  "LabelObject_property"
#
# The macro can also automatically fill the properties of objects (body, sketch, ...) based on
# aliases created by 'Create alias for table' and which indicate the object and the property
#
# The dico (see further in the code) is used to convert what you put in the top line to match
# what needs to be put in the expression. For example, if you have "posx" in the
# first line of your selection, in the expression, for the property part, there will be
# "Placement.Base.x"
#==========================================================================================



import FreeCAD, FreeCADGui
import re
from PySide import QtGui, QtCore, QtWidgets

addNumberIfOther=True

class CheckBoxDialog(QtWidgets.QDialog):
    def __init__(self, parent=None):
        super(CheckBoxDialog, self).__init__(parent)

        self.setWindowTitle("Macro FreeCAD")

        self.createAliasForTableCheckBox = QtWidgets.QCheckBox("Alias creation")
        self.createAliasForTableCheckBox.setToolTip("Creates an alias in each selected cell" +
                "\nbased on the first selected row and column" +
                "\nThe aliases will be in the format 'LabelObject_property'")
        self.tableToObjectCheckBox = QtWidgets.QCheckBox("Properties in objects based on aliases")
        self.tableToObjectCheckBox.setToolTip("Automatically fills the properties of objects (body, sketch, ...)" +
                "\nbased on aliases which must be in the format 'LabelObject_property'")
        buttonBox = QtWidgets.QDialogButtonBox(QtWidgets.QDialogButtonBox.Ok | QtWidgets.QDialogButtonBox.Cancel)
        buttonBox.accepted.connect(self.accept)
        buttonBox.rejected.connect(self.reject)

        layout = QtWidgets.QVBoxLayout()
        layout.addWidget(self.createAliasForTableCheckBox)
        layout.addWidget(self.tableToObjectCheckBox)
        layout.addWidget(buttonBox)
        self.setLayout(layout)

    def accept(self):
        super(CheckBoxDialog, self).accept()




def get_column(cell):
    column = ''.join([c for c in cell if not c.isdigit()])
    return column

def get_row(cell):
    row = ''.join([c for c in cell if c.isdigit()])
    if row==''&nbsp;:
        row='1'
    return int(row)




#################################################################################
# part code for alias
#################################################################################
# parameters for alias creation
separateur = " "      # typically put " " so blanks will be replaced by nouveauCaract
nouveauCaract = ''    #Put for example "_" to have the separators replaced by "_". Put "" to have no separator
majuscule = True      #set to True if you want  "Diametre du cercle" to be "DiametreDuCercle"
changeTexteCellule = False  # the text will only be changed if changeCellText is True.
                          # This does not change anything for the allias itself
premierCaractereEnMinuscule = False # Force the first character to be in lower case

# list of characters to be replaced by an equivalent. for example an @ will be replaced by 'a'
# if you add characters, please send me a private message. Il will eventually add it in my code.
caracEquivalents = [ ['&eacute;','e'],['&egrave;','e'],['&ecirc;','e'],['&agrave;','a'],['@','a'],['&amp;','e'],['&ccedil;','c'],
                  ['&sup2;','2'],["'",''],['?',''],['"',''],['(',''],[')',''],['#',''],['.',''],
                  [',',''],[';',''],['$',''],['+',''],['-',''],['*',''],['/',''],['\\',''] ,
                  ['[',''],[']',''],
                  ]



def traitementChaineSource(chaineSource, separateur, nouveauCaract, majuscule):
# If separator is ' ' and nouveauCaract is '_', and majuscule is True
# transforms "Diametre du cylindre" into "Diametre_Du_Cylindre

    def remplaceCararcDansMot(mot):

        def remplaceCartatParEquivalent(caractere):
        # replaces a character with its equivalent if it exists
            caracResult = caractere
            for couple in caracEquivalents:
                if (couple[0] == caractere):
                    caracResult = couple[1]
                    break
            return caracResult

    #replaces all characters of the word with its equivalent if it exists
        motResult = mot
        for caract in mot:
            a = remplaceCartatParEquivalent(caract)
            motResult = motResult.replace(caract, a)
        return motResult


    chaineResult = ''
    first = True
    carctDeSeparation = ''
    for mots in chaineSource.split(separateur):
        mots = remplaceCararcDansMot(mots)
        if (not (first)):
            carctDeSeparation = nouveauCaract
            if (majuscule):
                chaineResult = chaineResult + nouveauCaract + mots[:1].upper() + mots[1:]
                # We use "[:1]" instead of "[0]",
                # for no crash in case of an empty string (which happens if the cell is empty)
        else:
            chaineResult = chaineResult + nouveauCaract + mots
        first=False
    if premierCaractereEnMinuscule&nbsp;:
        chaineResult = chaineResult[:1].lower() + chaineResult[1:]
    return chaineResult


def create_alias_for_table_cells_Selected():
    mySpreadsheet = Gui.ActiveDocument.ActiveView.getSheet()
    aw = Gui.getMainWindow().centralWidget().activeSubWindow() # Store the active window
    # To get list of all selected cells
    sel_items = aw.widget().findChild(QtGui.QTableView).selectedIndexes()

    getCellName = lambda r,c:'{}{}{}'.format(chr(c//26 + 64) if c//26 &gt; 0 else '', chr(c%26 + 65), r + 1)



    for item in sel_items: # The selected cells are scanned

        if  (sel_items[0].column()!=item.column() and sel_items[0].row()!=item.row())&nbsp;:
            cellName=getCellName(item.row(), item.column())
            firstcellName=getCellName(sel_items[0].row(), sel_items[0].column())

            cellTextLine=get_column(firstcellName)+str(get_row(cellName))
            cellTextColumn=get_column(cellName)+ str(get_row(firstcellName))
            try&nbsp;:
                textLine = mySpreadsheet.get(cellTextLine)
                textColumn = mySpreadsheet.get(cellTextColumn)

            except&nbsp;:
                #print('Des cellules en premi&egrave;re colonne ou en premi&egrave;re ligne ne sont pas conformes')
                continue
            textAlias =  str(textLine) + '_'  + str(textColumn)
            textAlias=traitementChaineSource(textAlias, separateur, nouveauCaract, majuscule)
            if addNumberIfOther&nbsp;:
                startIndexForTextAlias=1
                for i in range(startIndexForTextAlias, 201):
                    try:
                        if i == 1:
                            mySpreadsheet.setAlias(cellName, textAlias)
                        else:
                            mySpreadsheet.setAlias(cellName, textAlias + '_' + str(i-1))
                            startIndexForTextAlias=i+1
                        break  # Arr&ecirc;te la boucle si aucune exception n'est lev&eacute;e
                    except:
                        continue  # Passe &agrave; l'it&eacute;ration suivante si une exception est lev&eacute;e





# The dictionary is used to convert what you put in the top line to match
# what needs to be put in the expression. For example, if you have &ldquo;posx&rdquo; in the
# first line of your selection, in the expression, for the property part, there will be
# "Placement.Base.x"
dico={
        "posx"&nbsp;: "Placement.Base.x",
        "posy"&nbsp;: "Placement.Base.y",
        "posz"&nbsp;: "Placement.Base.z",
        "posX"&nbsp;: "Placement.Base.x",
        "posY"&nbsp;: "Placement.Base.y",
        "posZ"&nbsp;: "Placement.Base.z",
        "angle": "Placement.Rotation.Angle",
        "ang": "Placement.Rotation.Angle",
        "axisx": "Placement.Rotation.Axis.x",
        "axisy": "Placement.Rotation.Axis.y",
        "axisz": "Placement.Rotation.Axis.z",
        "axeX": "Placement.Rotation.Axis.x",
        "axeY": "Placement.Rotation.Axis.y",
        "axeZ": "Placement.Rotation.Axis.z",
        "attachementX"&nbsp;: "AttachmentOffset.Base.x",
        "attachementY"&nbsp;: "AttachmentOffset.Base.y",
        "attachementZ"&nbsp;: "AttachmentOffset.Base.z",
        "attachementAngle"&nbsp;: "AttachmentOffset.Rotation.Angle",
        "attachementAxisX"&nbsp;: "AttachmentOffset.Rotation.Axis.x",
        "attachementAxisY"&nbsp;: "AttachmentOffset.Rotation.Axis.y",
        "attachementAxisZ"&nbsp;: "AttachmentOffset.Rotation.Axis.z",
        "Length"&nbsp;: "Length",
        "Length2"&nbsp;: "Length2",
        "Radius"&nbsp;: "Radius",
        "Height"&nbsp;: "Height",
        "FirstAngle"&nbsp;: "FirstAngle",
        "SecondAngle"&nbsp;: "SecondAngle",
        "Angle1"&nbsp;: "Angle1",
        "Angle2"&nbsp;: "Angle2",
        "Angle3"&nbsp;: "Angle3",
     }


def set_constraint_expression(sketchLabel, constraint_name, expression):
    # Get all Sketches with this label
    findConstraint = False
    sketches = App.ActiveDocument.getObjectsByLabel(sketchLabel)
    if len(sketches) &gt; 1&nbsp;:
        print("Warning, multiple sketches have the same label. "
              " All these sketches will be processed. "
              "This may cause problems if different sketches with the same label "
              "have constraints with the same name.")
    # Go through all Sketches

    for sketch in sketches:

        # Go through all constraints in the Sketch
        for i in range(sketch.ConstraintCount):
            # Get the constraint
            constraint = sketch.Constraints[i]

            # Check if the constraint name matches the one we're looking for
            if constraint.Name == constraint_name:
                # Modify the constraint value
                sketch.setExpression(f'Constraints[{i}]', expression)
                findConstraint=True
                break
    return findConstraint


def set_property_based_on_alias(sheet,cell):

    # alias of the cell
    alias = sheet.getAlias(cell)
    # Check if the alias is valid
    if sheet.getContents(cell)!=''&nbsp;:
        if alias is None:
            print(f"The selected cell {cell} does not have an alias.")
            return

    # Separate the alias into body name and property name
    # ex 'body_Name_posX' -&gt; body_Name for the object and posX for property name
    parts = alias.rsplit('_', 1)
    if len(parts)&nbsp;!= 2:
        print("The alias must be in the form 'BodyName_PropertyName'.")
        return

    objLabel, property_name = parts
    try&nbsp;:
        obj=App.ActiveDocument.getObjectsByLabel(objLabel)[0]
    except&nbsp;:
        print('no object with this label&nbsp;: ',objLabel)
        return
    try&nbsp;:
        property_name=dico[property_name]
    except&nbsp;:
        try&nbsp;:
            if  obj.TypeId&nbsp;!= 'Sketcher::SketchObject'&nbsp;:
                print (f'property {property_name} not found in the dictionary. See at the top of the source code')
        except&nbsp;:
            pass



    if obj is None:
        print(f"There is no object named '{objLabel}' in the document.")
        return

    # Create an expression that refers to the cell's alias
    expression = f"&lt;&lt;{sheet.Label}&gt;&gt;.{alias}"

    # Modify the object's property
    # if it's a constraint
    if  obj.TypeId == 'Sketcher::SketchObject'&nbsp;:
        findConstraint=set_constraint_expression(objLabel, property_name, expression)
        if findConstraint&nbsp;: # if not we continue to find a property
            return

    if hasattr(obj, property_name.split('.')[0]): # Placement.Base.x -&gt; Placement
        obj.setExpression(property_name, expression)
    else:
        print(f"The object '{objLabel}' does not have a property '{property_name}'.")


def tableToObject()&nbsp;:
    sheet = Gui.ActiveDocument.ActiveView.getSheet()
    # Check if the spreadsheet is active
    if sheet.TypeId&nbsp;!= 'Spreadsheet::Sheet':
        print("Please select cells in a spreadsheet.")
        return

    # active cell
    #cell = Gui.activeView().currentIndex()

    aw = Gui.getMainWindow().centralWidget().activeSubWindow() # Store the active window
    # To get list of all selected cells
    sel_items = aw.widget().findChild(QtGui.QTableView).selectedIndexes()
    getCellName = lambda r,c:'{}{}{}'.format(chr(c//26 + 64) if c//26 &gt; 0 else '', chr(c%26 + 65), r + 1)
    for cell in sel_items: # The selected cells are scanned
        cellName=getCellName(cell.row(), cell.column())

        if str(sheet.getContents(cellName))!= ''&nbsp;:
            set_property_based_on_alias(sheet, cellName)






def main():
    dialog = CheckBoxDialog()
    result = dialog.exec_()
    if result and dialog.createAliasForTableCheckBox.isChecked()&nbsp;:
        create_alias_for_table_cells_Selected()
    if result and dialog.tableToObjectCheckBox.isChecked()&nbsp;:
        tableToObject()
    return result



if __name__ == '__main__':
    main()
</pre>
<!-- 
NewPP limit report
Cached time: 20260206073149
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.056 seconds
Real time usage: 0.118 seconds
Preprocessor visited node count: 187/1000000
Post&#8208;expand include size: 3250/2097152 bytes
Template argument size: 2153/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 3/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 17228/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   14.587      1 -total
 46.10%    6.724      1 Template:Macro
 20.57%    3.001      1 Template:Code
 14.31%    2.087      6 Template:Incode
 11.69%    1.705      1 Template:CodeDownload
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:414039-0!canonical and timestamp 20260206073149 and revision id 1748089. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>