<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Python Assistant Window/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Python+Assistant+Window&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_Python_Assistant_Window.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Python Assistant Window (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Python Assistant Window (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Okno Asystent Python (4% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_Python_Assistant_Window.png&amp;filetimestamp=20150121133000&amp;.html" class="mw-file-description"><img src="../File/Macro_Python_Assistant_Window.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Python Assistant Window
</p>
</td></tr>
<tr>
<th class="ctOdd">Descrizione
</th></tr>
<tr>
<td class="ctEven left macro-description">Questa macro fornisce un ambiente di lavoro per tagliare/copiare/incollare del codice Python, segmentato in modo che possono essere selezionate differenti sezioni ed &egrave; persistente tra le sessioni di FreeCAD.<br><br>Versione macro: 1.0<br>Ultima modifica: 2015-01-21<br>Versione FreeCAD: All<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">ToolBar Icon</a><br>Autore: Piffpoof<br>
</td></tr>
<tr>
<th class="ctOdd">Autore
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Piffpoof.html" title="User:Piffpoof">Piffpoof</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Link
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../it/Macros_recipes.html" title="Macros recipes/it">Raccolta di macro</a><br><a href="../it/How_to_install_macros.html" title="How to install macros/it">Come installare le macro</a><br><a href="../it/Customize_Toolbars.html" title="Customize Toolbars/it">Personalizzare la  toolbar</a>
</td></tr>
<tr>
<th class="ctOdd">Versione macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Data ultima modifica
</th></tr>
<tr>
<td class="ctEven macro-date">2015-01-21
</td></tr>
<tr>
<th class="ctOdd">Versioni di FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Scorciatoia
</th></tr>
<tr>
<td class="ctEven"><i>Nessuna</i>
</td></tr>
<tr>
<th class="ctOdd">Vedere anche
</th></tr>
<tr>
<td class="ctEven"><i>Nessuno</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p>Uno dei potenti aspetti di Python &egrave; la sua Console che serve sia come dispositivo di output che da interprete dinamico del codice sorgente. La macro Python Assistant Window (in seguito denominata 'PAW') fornisce ulteriori funzionalit&agrave; alla console Python.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="http://pastebin.com/raw/2m0u94Z1">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "http://pastebin.com/raw/2m0u94Z1" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("http://pastebin.com/raw/2m0u94Z1")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="http://pastebin.com/raw/2m0u94Z1">http://pastebin.com/raw/2m0u94Z1</a>"&gt;raw code&lt;/a&gt;</div>
<p><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowScreenSnapshot.jpg&amp;filetimestamp=20150121165407&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowScreenSnapshot.jpg" decoding="async" width="500" height="488" class="mw-file-element" data-file-width="561" data-file-height="547"></a></span>
</p>
<h2><span class="mw-headline" id="Descrizione">Descrizione</span></h2>
<p>Essendo un ambiente di sviluppo moderno, Python presenta diversi vantaggi rispetto ai linguaggi pi&ugrave; vecchi e ai loro ambienti di sviluppo. Di grande utilit&agrave; &egrave; la console Python in cui si pu&ograve; inserire il codice e ricevere i risultati in modo interattivo (<a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>).. I risultati possono poi essere copiati e utilizzati per costruire il codice sorgente Python (in un editor di sorgente) o incollati nella console Python in forma alterata per ottenere ulteriori output. Questo &egrave; un metodo molto potente per sviluppare un codice.
</p><p>Nonostante la sua potenza, appare subito evidente che la console Python ha due inconvenienti:
</p>
<ul><li>la console ha delle dimensioni limitate e per vedere i risultati del lavoro fatto poco tempo prima pu&ograve; essere necessario scorrere di parecchio la schermata. I risultati non sono andati persi, ma sono scomodi da recuperare</li>
<li>la console si azzera ogni volta che si chiude una sessione di FreeCAD, e ad ogni avvio di FreeCAD la console &egrave; vuota (a parte il messaggio di avvio di Python)</li></ul>
<p>La PAW fornisce quanto segue:
</p>
<ul><li>&egrave; persistente tra le sessioni FreeCAD, da essa le cose non "scompaiono", a meno che l'utente le rimuova</li>
<li>ha un men&ugrave; contestuale che permette di:
<ul><li>eseguire le operazioni standard di editazione: Copia &amp; Incolla &amp; Seleziona tutto</li>
<li>copiare una selezione nella Console Python</li>
<li>copiare l'intero contenuto della PAW nella Console Python</li>
<li>aggiungere il contenuto della Console Python alla PAW</li>
<li>inserire dei marcatori testuali che facilitano la gestione del testo</li>
<li>selezionare tra qualsiasi due marcatori consecutivi</li>
<li>rimuovere il prefisso "&gt;&gt;&gt; " usato dalla Console Python per indicare l'output</li>
<li>ridurre pi&ugrave; righe vuote a una singola riga vuota</li>
<li>personalizzare l'ambiente di lavoro, per gestire la PAW tramite un pulsante GUI (nello stesso modo della finestra principale di FreeCAD)</li></ul></li></ul>
<h2><span class="mw-headline" id="Installazione">Installazione</span></h2>
<p>Tutto il codice di pythonAssistantWindow.FCMacro &egrave; contenuto in una macro, quindi per installarla basta copiare il suo codice nella appropriata directory delle Macro. Dopo, si pu&ograve; invocare pythonAssistantWindow dal menu Macro, dalla console Python o da un pulsante della barra degli strumenti (il metodo preferito).
</p>
<ul><li>per informazioni su come installare il codice delle macro vedere la pagina <a href="../it/How_to_install_macros.html" title="How to install macros/it">Come installare le macro</a></li>
<li>per informazioni su come installarla abbinata a un pulsante in una barra degli strumenti vedere la pagina <a href="../it/Customize_Toolbars.html" title="Customize Toolbars/it">Personalizzare la barra degli strumenti</a></li></ul>
<p><b>Nota</b>: Per coordinare la memoria persistente all'interno di FreeCAD viene utilizzata una variabile globale.
</p><p><b>Nota</b>: Nella directory "UserAppData" viene usato un file di testo per memorizzare il contenuto testuale della PAW tra le sessioni di FreeCAD.
</p>
<h2><span class="mw-headline" id="Uso">Uso</span></h2>
<p>La PAW si utilizza meglio se ha un pulsante su una barra degli strumenti. Pu&ograve; anche essere eseguita dal menu Macro o incollando il codice nella Console Python, ma queste ultime due opzioni riducono notevolmente la sua facilit&agrave; d'uso.
</p><p>Quando si avvia FreeCAD l'unica traccia della PAW &egrave; un pulsante sulla barra degli strumenti. Cliccando sul pulsante:
</p>
<ul><li>si apre la PAW nell'angolo in basso a destra
<ul><li>secondo le impostazioni predefinite occupa circa 1/3 della larghezza e dell'altezza dello schermo, il resto pu&ograve; essere utilizzato dalla finestra principale FreeCAD</li></ul></li>
<li>nella finestra appare l'ultimo contenuto visualizzato nella PAW - non ci dovrebbe essere alcuna differenza dall'ultima volta in cui &egrave; stato utilizzata
<ul><li>alla prima esecuzione la PAW &egrave; vuota</li></ul></li>
<li>quando la PAW &egrave; gi&agrave; aperta, ma &egrave; nascosta da altre finestre, viene portata in primo piano per renderla visibile</li>
<li>quando si chiude la PAW il suo contenuto viene scritto nel file e la finestra scompare - non vi &egrave; alcun dialogo di conferma</li>
<li>viceversa, se si esce da FreeCAD (Menu -&gt; Esci) appare una finestra di dialogo che chiede se si vuole salvare le modifiche non salvate nella PAW</li></ul>
<p>La maggior parte della funzionalit&agrave; della PAW sono fornite dal menu contestuale, le opzioni sono:
</p>
<ul><li>Copy<br>- fornisce la funzione standard di Copia</li>
<li>Copy selection to console<br>- copia la selezione corrente alla fine della Console Python</li>
<li>Copy contents to console<br>- copia tutto il contenuto della PAW alla fine della Console Python</li>
<li>Paste<br>- fornisce la funzione standard di Incolla</li>
<li>Append contents of Python Console to PAW<br>- copia il contenuto della Console Python alla fine della PAW - notare che i contenuti della Console Python possono essere una miscela di codice Python, output del codice Python, messaggi di errore, output di qualsiasi parte di FreeCAD</li>
<li>Select between Markers<br>- seleziona tra marcatori - i marcatori sono utilizzati per suddividere il testo della PAW in sezioni, e quando i contenuti sono sezionati, ogni sezione pu&ograve; essere selezionata individualmente e lavorata con (ad esempio copia, copia nella Console Python, Elimina). I marcatori consentono a sequenze separate e indipendenti di dichiarazioni Python di esistere nella PAW, e di essere poi gestite e lavorate singolarmente.</li>
<li>Select all<br>- fornisce la funzione standard di Seleziona tutto</li>
<li>Clear<br>- fornisce la funzione standard di Elimina che cancella tutti itest della PAW</li>
<li>Insert marker<br>- inserisce un marcatore testuale nella posizione corrente del cursore</li>
<li>Remove "&gt;&gt;&gt; "<br>- dopo aver copiato l'output della Console Python nella PAW, le linee che prodotte come output dei comandi Python eseguiti hanno il prefisso "&gt;&gt;&gt;", questa opzione rimuove tali prefissi in modo che l'output pu&ograve; essere utilizzato come contesto libero da dati</li>
<li>Reduce multiple blank lines to single blank lines<br>- compatta il testo, eliminando le righe vuote multiple</li>
<li>Alter GUI settings<br>- porta in primo piano una finestra modale con tre controlli:</li>
<li><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowGui2.jpg&amp;filetimestamp=20150121170002&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowGui2.jpg" decoding="async" width="500" height="134" class="mw-file-element" data-file-width="508" data-file-height="136"></a></span>
<ul><li>un cursore per impostare la percentuale della larghezza dello schermo dedicata alla PAW (ricordando che c'&egrave; una larghezza limite al di sotto della quale la finestra principale di FreeCAD non scende)</li>
<li>un cursore per impostare la percentuale dell'altezza dello schermo dedicata alla PAW</li>
<li>una coppia di pulsanti di opzione per indicare se la PAW deve essere posizionata nella parte superiore o inferiore del lato sinistro dello schermo</li></ul></li>
<li>Save as file<br>- il contenuto della finestra PAW viene scritto in un file selezionato dall'utente - il contenuto della PAW non viene alterato</li>
<li>Close window<br>- la finestra PAW viene chiusa e il contenuto scritto in un file a memoria persistente <br><b>Nota</b>: Non appare alcun dialogo, il salvataggio avviene automaticamente</li></ul>
<h2><span class="mw-headline" id="Interfaccia_utente">Interfaccia utente</span></h2>
<p>L'interfaccia utente &egrave; una semplice finestra di modifica di testo, c'&egrave; un pulsante per avviare la PAW e un menu contestuale delle opzioni eseguibili sul testo presente nella finestra. Le opzioni sono descritte nella sezione Utilizzo.
</p>
<h2><span class="mw-headline" id="Esempi">Esempi</span></h2>
<p><b>Primo esempio</b>
</p><p>Nel mese di gennaio un collega ha bisogno di aiuto con il codice Python per aggiornare un file. Lo scrivete e lo mettete a punto sul vostro computer e gli inviate il codice sorgente. Avete sviluppato il codice in 3 modi diversi e non sapete quale sia il migliore, quello da conservare. Copiate tutte le 3 versioni finite in PAW e le separate con i marcatori.
</p><p>All'inizio di maggio, state felicemente lavorando sul progetto di una bottiglia utilizzando FreeCAD. Avete qualche problema nel trovare l'esatto codice Python per generare quello che serve, e mentre la modellate graficamente, nella console Python viene generato il codice Python corrispondente. Utilizzando PAW copiate il contenuto della Console in PAW. Per formare la bottiglia vi spostate indietro e eseguite, poi copiate i risultati, li modificate in PAW e li ricopiate fino a quando siete soddisfatti.
</p><p>Per un lavoro diverso, in altra sede, dovete assentarvi per 2 settimane. Finito il lavoro, tornate nel vostro ufficio.
</p><p>Quando tornate dovete fare un p&ograve; di pulizia perch&egrave; ovviamente qualcuno ha utilizzato la vostra zona come zona da pranzo. Avviate FreeCAD e fate clic sul pulsante PAW nella barra degli strumenti, il vostro precedente lavoro &egrave; seduto l&igrave;, come se fosse stato fatto giorno prima. Capite che la soluzione al progetto della bottiglia si trova legando il codice del file che avete scritto a gennaio con quello interrotto due settimane prima. Potete selezionare e copiare rapidamente i segmenti di codice nella console di Python per eseguirli e ottimizzarli.
</p><p>Quando il codice &egrave; stabile, potete salvarlo in un file Python o in un file macro di FreeCAD.
</p><p><b>Altro esempio</b>
</p><p>Si sta cercando di capire cosa non va nei valori di rotazione di vari oggetti di un assieme. Su 27 oggetti non si riesce a individuare uno schema che indichi quali siano gli oggetti interessati. Quindi si mettono insieme alcune righe di Python per isolare gli oggetti non corretti e si incollano nel PAW. Poi si mettono insieme un paio di righe di Python per ottenere i valori di Label e Rotation e si incolla anche questo codice nel PAW. Copiate il codice per tutti gli oggetti che volete vedere elencati e ripetetelo per ogni oggetto, sempre nel PAW. La console di Python conterr&agrave; tutti i risultati (compresi gli errori di digitazione e i messaggi di errore), ma la porzione visibile della finestra sar&agrave; gi&agrave; stata fatta scorrere via da tempo. Ora si dispone di un insieme conciso di righe Python, lo si copia dal PAW, lo si incolla nella console Python e si ottiene l'elenco esatto degli oggetti che devono essere sottoposti a debug, insieme ai loro valori specifici. Se necessario, si possono incollare nuovamente i risultati dalla console Python nel PAW, anteponendo il carattere di commento Python ('#') se si desidera salvarli nel codice Python e mantenerli eseguibili. Infine, si pu&ograve; salvare questo conglomerato in un file dal PAW, in modo che sia al sicuro sul disco. Pronto per la prossima volta che dovrete rubare o adattare la logica del codice.
</p>
<h2><span class="mw-headline" id="Opzioni">Opzioni</span></h2>
<p>L'unica opzione per la PAW &egrave; la possibilit&agrave; di modificare la sua dimensione iniziale e la forma di visualizzazione secondo la dimensione e la forma della finestra principale di FreeCAD. Nel codice Python ci sono 3 valori costanti per le dimensioni e la posizione iniziale della PAW.
</p>
<h2><span class="mw-headline" id="Osservazioni">Osservazioni</span></h2>
<p>In questo codice c'&egrave; una semplice (proof of concept) abbozzo per un lavoro di memorizzazione persistente. Pu&ograve; essere usato da chi ha bisogno di tale capacit&agrave;.
</p>
<h2><span class="mw-headline" id="Link">Link</span></h2>
<p>nessuno (fino ad ora)
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<div id="itsfree" style="text-align:center;color:black;background:#FDE0A8;margin:1em 7em;padding:0.5em 2em;border:2px solid #FF5706;"><b>Se il listato dello script non finisce con le informazioni sulla versione FreeCAD e ultima riga non &egrave; "thus ends the macro..." significa che il Wiki ne ha mangiato una parte e quindi si deve scaricarlo o copiarlo da [<a rel="nofollow" class="external text" href="http://pastebin.com/raw.php?i=2m0u94Z1">unabbreviated script on pastebin.com</a>]</b></div>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Python_Assistant_Window.png&amp;filetimestamp=20150121133000&amp;.html" class="mw-file-description"><img src="../File/Macro_Python_Assistant_Window.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><b>Macro_Python_Assistant_Window.FCMacro</b>
</p>
<pre>#
#
#				Python Assistant Window
#				v 0.1 initial release
#
#
#***********************************************************************************
#
# provide a text editing window with functions to aid in coding Python within FreeCAD
#
############ To Do ############
# - contextual window doesn't fire if cursor is on last position in file
# - executing "from PySide import QtGui, QtCore" on console seems to close window
# - is it possible to copy code to console and then select and execute it?
##############################
#***********************************************************************************
# The next three variables define the width and height and vertical positioning
# of the Python Assistant Window
# 'pawWidthPercent' specifies the percentage of the screen width to be assigned to the Python Assistant Window
# 'pawHeightPercent' specifies the percentage of the screen height to be assigned to the Python Assistant Window
# 'pawAtBottomFlag' specifies if the Python Assistant Window is at the top or the bottom
# The Python Assistant Window is automatically placed at the left,
# so pawWidthPercent = 26, pawHeightPercent = 41, pawAtBottomFlag = False will cause the
# following:
# 1) the main FreeCAD window will be placed in the upper left corner of the screen,
#	 it's height will be 100% of the screen height,
#	 it's width will be 74% (=100%-26%) of the screen
# 2) the Python Assistant Window will be placed in the left side of the screen,
#	 it's height will be 41% of the screen height,
#	 it's width will be 26% of the screen
#	 it will be at the top (leaving empty space below it)
# The empty space (either above or below the Python Assistant Window),
# is left for the text editor (for editing the Macros) to be placed in.
#
pawWidthPercentInitial		= 37.5 # percent of the screen width
pawHeightPercentInitial		= 32.0 # percent of the screen height
pawAtBottomFlagInitial		= True
#***********************************************************************************
# import statements
import sys, operator, os
from os.path import expanduser
from PySide import QtGui, QtCore

# UI Class definitions

class PythonAssistantWindow(QtGui.QMainWindow):
	""""""
	def __init__(self, pythonTextToEdit):
		self.textIn = pythonTextToEdit
		super(PythonAssistantWindow, self).__init__()
		self.initUI(pythonTextToEdit)
	def initUI(self, pythonTextToEdit):
		"""Constructor"""
		# set default return value and pointer to subsequent child window
		self.result			= userCancelled
		self.childWindow	= None
		self.alertWindow	= None
		# set window dimensions for Python Advisor Window from the constants at the top of Macro file
		self.pawWinWidth	= pawWidthPercentInitial/100.0 * availableWidth
		self.pawWinHeight	= pawHeightPercentInitial/100.0 * availableHeight
		self.left			= screenWidth - self.pawWinWidth
		if pawAtBottomFlagInitial:
			self.top		= screenHeight - self.pawWinHeight
		else:
			self.top		= 0		
		self.editorHeight	= self.pawWinHeight
		# set dimensions for main FreeCAD window
		self.mainWinWidth	= availableWidth - (self.pawWinWidth+interWindowGap)
		self.mainWinHeight	= availableHeight
		# define main window
		FreeCADGui.getMainWindow().setGeometry(0, 0, self.mainWinWidth, self.mainWinHeight)
		# now set up this window
		self.setGeometry(self.left, self.top, self.pawWinWidth, self.pawWinHeight)
		self.setWindowTitle("Python Assistant Window")
		#
		centralWidget 		=  QtGui.QWidget(self)
		layout 				=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		# set up text editing widget
		self.text_editor = QtGui.QPlainTextEdit(self)
		self.text_editor.move(0,0)
		self.text_editor.resize(self.pawWinWidth,self.editorHeight)
		self.text_editor.appendPlainText(self.textIn)
		self.text_editor.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.text_editor.textChanged.connect(self.onTextChanged)
		# set up a monospace font for the text editor to match the Python console
		font = QtGui.QFont()
		font.setFamily("Courier")
		font.setStyleHint(QtGui.QFont.Monospace)
		font.setFixedPitch(True)
		font.setPointSize(12)
		self.text_editor.setFont(font)
		#self.text_editor.cursorPositionChanged.connect(self.onCursorPosition)
		self.cursor = self.text_editor.textCursor()
		# populate layout
		layout.addWidget(self.text_editor,0,0)
		self.setCentralWidget(centralWidget)
		# set contextual menu options for text editing widget
		# menu dividers
		mnuDivider1 = QtGui.QAction(self)
		mnuDivider1.setText(menuDividerText)
		mnuDivider1.triggered.connect(self.onMenuDivider)
		mnuDivider2 = QtGui.QAction(self)
		mnuDivider2.setText(menuDividerText)
		mnuDivider2.triggered.connect(self.onMenuDivider)
		mnuDivider3 = QtGui.QAction(self)
		mnuDivider3.setText(menuDividerText)
		mnuDivider3.triggered.connect(self.onMenuDivider)
		mnuDivider4 = QtGui.QAction(self)
		mnuDivider4.setText(menuDividerText)
		mnuDivider4.triggered.connect(self.onMenuDivider)
		# clear text
		mnuClear = QtGui.QAction(self)
		mnuClear.setText("Clear")
		mnuClear.triggered.connect(self.onClear)
		# paste copy/paste buffer
		mnuPaste = QtGui.QAction(self)
		mnuPaste.setText("Paste")
		mnuPaste.triggered.connect(self.onPaste)
		# paste contents of console
		mnuAppendFromConsole = QtGui.QAction(self)
		mnuAppendFromConsole.setText("Append contents of console")
		mnuAppendFromConsole.triggered.connect(self.onAppendFromConsole)
		# select between markers
		mnuSelectMarkers = QtGui.QAction(self)
		mnuSelectMarkers.setText("Select between markers")
		mnuSelectMarkers.triggered.connect(self.onSelectMarkers)
		# select all
		mnuSelectAll = QtGui.QAction(self)
		mnuSelectAll.setText("Select all")
		mnuSelectAll.triggered.connect(self.onSelectAll)
		# insert marker
		mnuInsertMarker = QtGui.QAction(self)
		mnuInsertMarker.setText("Insert marker")
		mnuInsertMarker.triggered.connect(self.onInsertMarker)
		# remove console generated "&gt;&gt;&gt; " character strings
		mnuStripPrefix = QtGui.QAction(self)
		mnuStripPrefix.setText("Remove '&gt;&gt;&gt; '")
		mnuStripPrefix.triggered.connect(self.onStripPrefix)
		# remove blank lines
		mnuReduceBlankLines = QtGui.QAction(self)
		mnuReduceBlankLines.setText("Delete multiple blank lines")
		mnuReduceBlankLines.triggered.connect(self.onReduceBlankLines)
		# copy selection
		mnuCopy = QtGui.QAction(self)
		mnuCopy.setText("Copy")
		mnuCopy.triggered.connect(self.onCopy)
		# copy selection to console
		mnuCopySelectionToConsole = QtGui.QAction(self)
		mnuCopySelectionToConsole.setText("Copy selection to console")
		mnuCopySelectionToConsole.triggered.connect(self.onCopySelectionToConsole)
		# copy to console
		mnuCopyToConsole = QtGui.QAction(self)
		mnuCopyToConsole.setText("Copy contents to console")
		mnuCopyToConsole.triggered.connect(self.onCopyToConsole)
		# save as file
		mnuSaveAsFile = QtGui.QAction(self)
		mnuSaveAsFile.setText("Save contents to file")
		mnuSaveAsFile.triggered.connect(self.onSaveAsFile)
		# close window
		mnuCloseWindow = QtGui.QAction(self)
		mnuCloseWindow.setText("Close window")
		mnuCloseWindow.triggered.connect(self.onCloseWindow)
		# alter GUI settings
		mnuSettings = QtGui.QAction(self)
		mnuSettings.setText("=Alter GUI settings=")
		mnuSettings.triggered.connect(self.onSettings)
		# define menu and add options
		self.text_editor.setContextMenuPolicy(QtCore.Qt.ActionsContextMenu)
		self.text_editor.addAction(mnuCopy)
		self.text_editor.addAction(mnuCopySelectionToConsole)
		self.text_editor.addAction(mnuCopyToConsole)
		self.text_editor.addAction(mnuDivider1)
		self.text_editor.addAction(mnuPaste)
		self.text_editor.addAction(mnuAppendFromConsole)
		self.text_editor.addAction(mnuSelectMarkers)
		self.text_editor.addAction(mnuSelectAll)
		self.text_editor.addAction(mnuClear)
		self.text_editor.addAction(mnuDivider2)
		self.text_editor.addAction(mnuInsertMarker)
		self.text_editor.addAction(mnuStripPrefix)
		self.text_editor.addAction(mnuReduceBlankLines)
		self.text_editor.addAction(mnuDivider3)
		self.text_editor.addAction(mnuSaveAsFile)
		self.text_editor.addAction(mnuSettings)
		self.text_editor.addAction(mnuCloseWindow)
		#
		self.show()
	#----------------------------------------------------------------------
	def onMenuDivider(self):
		# just a divider in the menu so we don't do anything
		pass
	def onClear(self):
		# clear editing field
		self.text_editor.clear()
	def onPaste(self):
		# paste contents of system copy/paste buffer into QPlainTextEdit field
		self.text_editor.paste()
	def onAppendFromConsole(self):
		# copy text from "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		consoleStr	= pcPTE.document().toPlainText()
		self.text_editor.appendPlainText(copyFromConsoleText)
		self.text_editor.appendPlainText("")
		self.text_editor.appendPlainText(consoleStr)
	def onCopy(self):
		# copy selected text to system copy/paste buffer
		self.text_editor.copy()
	def onCopySelectionToConsole(self):
		# copy selected text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		#
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		textToCopy = cursorText[cursor.selectionStart():cursor.selectionEnd()]
		if len(textToCopy)&gt;0:
			pcPTE.appendPlainText(textToCopy)
	def onCopyToConsole(self):
		# copy text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		pcPTE.appendPlainText(copyToConsoleText)
		pcPTE.appendPlainText()
	def onInsertMarker(self):
		# insert marker
		self.text_editor.insertPlainText(markerText)
	def onStripPrefix(self):
		# strip out "&gt;&gt;&gt; " from text edit window
		self.text_editor.selectAll()
		if len(self.text_editor.toPlainText())&gt;0:
			self.text_editor.selectAll()
			tmp = self.text_editor.toPlainText()
			self.text_editor.clear()
			self.text_editor.appendPlainText(tmp.replace("&gt;&gt;&gt; ",""))
	def onReduceBlankLines(self):
		# reduce multiple blank lines to single blank lines
		contents = self.text_editor.toPlainText()
		self.text_editor.clear()
		self.text_editor.appendPlainText(os.linesep.join([s for s in contents.splitlines() if s]))
	def onSelectMarkers(self):
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		bNum = cursor.blockNumber(); cNum = cursor.columnNumber()
		pos = cursor.position(); cursorTextLength = len(cursorText)
		occurrences = [i for i in range(len(cursorText)) if cursorText.startswith(markerText, i)]
		if len(occurrences)==0:
			self.alertWindow = QtGui.QMessageBox()
			self.alertWindow.setText("There are no markers...")
			self.alertWindow.show()
		elif len(occurrences)==1:
			hdrStart = occurrences[0]
			hdrEnd = hdrStart + markerTextLength
			if pos&lt;hdrStart:
				selectStart = 0; selectEnd = hdrStart
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
			if pos&gt;hdrEnd:
				selectStart = hdrEnd; selectEnd = cursorTextLength
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
		else:
			startOccurrences = list(); endOccurrences = list(occurrences)
			for i in range(len(occurrences)):
				startOccurrences.append(occurrences[i] + markerTextLength + 1)
			startOccurrences.insert( 0, 0)
			endOccurrences.insert( len(occurrences), cursorTextLength)
			for i in range(len(occurrences)+1):
				if startOccurrences[i]&lt;pos&lt;endOccurrences[i]:
					if i==0:
						selectStart = startOccurrences[i]
					else:
						selectStart = startOccurrences[i]-1
					selectEnd = endOccurrences[i]
					self.cursor.setPosition(selectStart)
					self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
					self.text_editor.setTextCursor(self.cursor)
					break
	def onSelectAll(self):
		self.text_editor.selectAll()
	def onCloseWindow(self):
		self.close()
	def onSettings(self):
		# get new width (as&nbsp;%), height (as&nbsp;%), vertical flag
		self.childWindow = GetGuiConfigParams(self)
		pass
	def onTextChanged(self):
		FreeCAD.PythonAssistantWindowStatus[1] = True
	def onCursorPosition(self):
		#print ("Line: {} | Column: {}".format(
		#	self.text_editor.textCursor().blockNumber(),
		#	self.text_editor.textCursor().columnNumber()))
		#print self.text_editor.textCursor().position()+self.text_editor.textCursor().columnNumber()
		pass
	def onSaveAsFile(self):
		filePath = QtGui.QFileDialog.getSaveFileName(parent=None,caption="Save contents as",dir=expanduser("~"),filter="*.txt")
		file = open(filePath[0],"w")
		file.write(self.text_editor.toPlainText())
		file.close()
	def closeEvent(self,event):
		# write out contents for next session
		file = open(persistenceFile,"w")
		file.write(self.text_editor.toPlainText())
		file.close()
		# clear global flag
		del FreeCAD.PythonAssistantWindowStatus
		self.close()

class GetGuiConfigParams(QtGui.QMainWindow):
	""""""
	def __init__(self, parentWindow):
		self.parentWindow = parentWindow
		super(GetGuiConfigParams, self).__init__()
		self.initUI(parentWindow)
	def initUI(self, parentWindow):
		"""Constructor"""
		self.result							= userCancelled
		# grab geometry from our parent so we can tell if user has changed values
		self.initialParentWindowX			= self.parentWindow.geometry().x()
		self.initialParentWindowY			= self.parentWindow.geometry().y()
		self.initialParentWindowH			= self.parentWindow.geometry().height()
		self.initialParentWindowW			= self.parentWindow.geometry().width()
		self.initialHeightSliderSetting		= self.initialParentWindowH/float(availableHeight)*100
		self.initialWidthSliderSetting		= self.initialParentWindowW/float(availableWidth-interWindowGap)*100
		# set some fixed GUI attributes
		width								= 450
		height								= 40
		buttonWidth							= 80
		sliderWidth							= 100
		self.setWindowTitle("GUI Configuration")
		self.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
		self.resize(width, height)
		self.widthSlider					= self.initialWidthSliderSetting
		self.heightSlider					= self.initialHeightSliderSetting
		#
		centralWidget 						=  QtGui.QWidget(self)
		layout 								=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		verticalLine 						=  QtGui.QFrame()
		# sliders
		widthSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		widthSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		widthSlider.valueChanged[int].connect(self.widthSliderChangeValue)
		widthSlider.setFixedWidth(sliderWidth)
		widthSlider.setValue(self.initialWidthSliderSetting)
		heightSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		heightSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		heightSlider.valueChanged[int].connect(self.heightSliderChangeValue)
		heightSlider.setFixedWidth(sliderWidth)
		heightSlider.setValue(self.initialHeightSliderSetting)
		# labels
		pawWidthLbl		= QtGui.QLabel("Python Assistant Window width", self)
		pawHeightLbl	= QtGui.QLabel("Python Assistant Window height", self)
		# radio buttons - window top or bottom
		self.rb1 = QtGui.QRadioButton("Window at Top",self)
		self.rb1.clicked.connect(self.onRb1)
		self.rb2 = QtGui.QRadioButton("Window at Bottom",self)
		self.rb2.toggle() # set default value
		self.rb2.clicked.connect(self.onRb2)
		if self.parentWindow.geometry().y()==0:
			self.rb1.toggle()
		# cancel button
		cancelButton = QtGui.QPushButton('Cancel', self)
		cancelButton.clicked.connect(self.onCancel)
		cancelButton.setFixedWidth(buttonWidth)
		# OK button
		okButton = QtGui.QPushButton('OK', self)
		okButton.clicked.connect(self.onOk)
		okButton.setFixedWidth(buttonWidth)
		#
		verticalLine.setFrameStyle(QtGui.QFrame.VLine)
		verticalLine.setSizePolicy(QtGui.QSizePolicy.Minimum,QtGui.QSizePolicy.Expanding)
		#
		pawWidthLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		pawHeightLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb1.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb2.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		# populate layout
		layout.addWidget(widthSlider,0,0)
		layout.addWidget(pawWidthLbl,0,1)
		layout.addWidget(heightSlider,2,0)
		layout.addWidget(pawHeightLbl,2,1)
		layout.addWidget(verticalLine,0,2,3,1)
		layout.addWidget(self.rb1,0,3)
		layout.addWidget(self.rb2,2,3)
		layout.addWidget(cancelButton,3,1,QtCore.Qt.AlignRight)
		layout.addWidget(okButton,3,3)
		#
		self.setCentralWidget(centralWidget)
		#
		self.show()
	def widthSliderChangeValue(self, value):
		self.widthSliderValue = value
	def heightSliderChangeValue(self, value):
		self.heightSliderValue = value
	def onRb1(self):
		pass
	def onRb2(self):
		pass
	def onCancel(self):
		self.result = userCancelled
		self.close()
	def onOk(self):
		self.result = "OK"
		# the two slider values are the width and height of the Python Assistant Window
		# resize main FreeCAD window
		freeCadMainWidth	= ((1-(self.widthSliderValue/100.0)) * availableWidth)-(3*interWindowGap)
		FreeCADGui.getMainWindow().setGeometry(0, 0, freeCadMainWidth, availableHeight)
		# resize the PAW window
		newPawWidth			= availableWidth-freeCadMainWidth
		newPawHeight		= (self.heightSliderValue/100.0) * availableHeight
		if self.rb1.isChecked():
			newPawTop		= 0
		else:
			newPawTop		= availableHeight - newPawHeight
		self.parentWindow.setGeometry(freeCadMainWidth+interWindowGap, newPawTop, newPawWidth-interWindowGap, newPawHeight)
		self.close()

#----------------------------------------------------------------------

# Class definitions
		
# Function definitions

def onFreeCADShutdown():
	# this will be invoked when FreeCAD is told to shut down
	#QtGui.QMessageBox.information(None,"","FreeCAD shutting down")
	if FreeCAD.PythonAssistantWindowStatus[1]:
		reply = QtGui.QMessageBox.question(None, "",
			"The Python Assistant Window has changes, do you want to save them?",
			QtGui.QMessageBox.Yes | QtGui.QMessageBox.No, QtGui.QMessageBox.No)
		if reply == QtGui.QMessageBox.Yes:
			# write out contents for next session
			file = open(persistenceFile,"w")
			file.write(FreeCAD.PythonAssistantWindowStatus[0].text_editor.toPlainText())
			file.close()
	del FreeCAD.PythonAssistantWindowStatus

# Constant definitions

userCancelled		= "Cancelled"
markerText			= "#=========== marker ===========\n"
markerTextLength	= len(markerText)
copyFromConsoleText	= "#=========== copy from console ==========="
copyToConsoleText	= "#============ copy to console ============"
menuDividerText		= "--------"
interWindowGap		= 3 # space between 2 windows for appearance sake
persistenceFile		= App.ConfigGet("UserAppData")+"PythonAssistantWindow.txt"
# code ***********************************************************************************
# put down user data saving routine for when FreeCAD exits
mw=Gui.getMainWindow()
mw.mainWindowClosed.connect(onFreeCADShutdown)
# get screen dimensions
screenWidth			= QtGui.QDesktopWidget().screenGeometry().width()
screenHeight		= QtGui.QDesktopWidget().screenGeometry().height()
# get dimensions for available space on screen
availableWidth		= QtGui.QDesktopWidget().availableGeometry().width()
availableHeight		= QtGui.QDesktopWidget().availableGeometry().height()

if not hasattr(FreeCAD,"PythonAssistantWindowStatus"):
	previousContents = ""
	if os.path.isfile(persistenceFile):
		# read contents of last session
		file = open(persistenceFile,"r")
		previousContents = file.read()
		file.close()
	# open window with contents from last session
	form = PythonAssistantWindow(previousContents)
	# save pointer to window so it can be located again and Raised when it becomes obscured
	FreeCAD.PythonAssistantWindowStatus = [None, False]
	FreeCAD.PythonAssistantWindowStatus[0] = form
else:
	# window is open so Raise it so it is visible
	FreeCAD.PythonAssistantWindowStatus[0].raise_()
	pass
#
#OS: Mac OS X
#Word size: 64-bit
#Version: 0.14.3703 (Git)
#Branch: releases/FreeCAD-0-14
#Hash: c6edd47334a3e6f209e493773093db2b9b4f0e40
#Python version: 2.7.5
#Qt version: 4.8.6
#Coin version: 3.1.3
#SoQt version: 1.5.0
#OCC version: 6.7.0
#
#thus ends the macro...
</pre>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20250725091613
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.054 seconds
Real time usage: 0.072 seconds
Preprocessor visited node count: 144/1000000
Post&#8208;expand include size: 3224/2097152 bytes
Template argument size: 1106/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 22287/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    8.278      1 -total
 42.35%    3.506      1 Template:Macro/it
 29.16%    2.414      1 Template:Codeextralink
 12.42%    1.028      1 Template:VeryImportantMessage
 10.93%    0.905      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:55731-0!canonical and timestamp 20250725091613 and revision id 1617408. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>