<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Code snippets/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Code+snippets&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../id/Code_snippets.html" class="mw-pt-progress mw-pt-progress--low" title="Code snippets (1% translated)" lang="id" dir="ltr">Bahasa Indonesia</a></li>
<li><a href="../de/Code_snippets.html" class="mw-pt-progress mw-pt-progress--high" title="Code Schnipsel (99% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Code_snippets.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Code snippets (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../tr/Code_snippets.html" class="mw-pt-progress mw-pt-progress--low" title="Code snippets (1% translated)" lang="tr" dir="ltr">T&uuml;rk&ccedil;e</a></li>
<li><a href="../es/Code_snippets.html" class="mw-pt-progress mw-pt-progress--med" title="Fragmentos C&oacute;digo (68% translated)" lang="es" dir="ltr">espa&ntilde;ol</a></li>
<li><a href="../fr/Code_snippets.html" class="mw-pt-progress mw-pt-progress--high" title="Extraits de codes (99% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--high" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Code_snippets.html" class="mw-pt-progress mw-pt-progress--high" title="Wycinki kod&oacute;w (99% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="../ro/Code_snippets.html" class="mw-pt-progress mw-pt-progress--med" title="Fragmente de cod (30% translated)" lang="ro" dir="ltr">rom&acirc;n&#259;</a></li>
<li><a href="../sv/Code_snippets.html" class="mw-pt-progress mw-pt-progress--low" title="Code snippets (12% translated)" lang="sv" dir="ltr">svenska</a></li>
<li><a href="../cs/Code_snippets.html" class="mw-pt-progress mw-pt-progress--low" title="Code snippets (1% translated)" lang="cs" dir="ltr">&#269;e&scaron;tina</a></li>
<li><a href="../ru/Code_snippets.html" class="mw-pt-progress mw-pt-progress--med" title="&#1060;&#1088;&#1072;&#1075;&#1084;&#1077;&#1085;&#1090;&#1099; &#1082;&#1086;&#1076;&#1072; (43% translated)" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a></li>
<li><a href="../ja/Code_snippets.html" class="mw-pt-progress mw-pt-progress--low" title="Code snippets (10% translated)" lang="ja" dir="ltr">&#26085;&#26412;&#35486;</a></li></ul></div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><meta property="mw:PageProp/toc"></div>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Introduzione">Introduzione</span></h2>
<p>Questa pagina contiene degli esempi, pezzi, di codice Python utilizzabili in FreeCAD, raccolti dalle esperienze degli utenti e dalle discussioni nei <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewforum.php?f=22">forum</a>. Dopo averli letti, &egrave; possibile usarli per iniziare a creare degli script personali ...
</p><p><span id="Snippets"></span>
</p>
<h2><span class="mw-headline" id="Frammenti">Frammenti</span></h2>
<p><span id="A_typical_InitGui.py_file"></span>
</p>
<h3><span class="mw-headline" id="Un_tipico_file_InitGui.py">Un tipico file InitGui.py</span></h3>
<p>Ogni modulo deve contenere, oltre al file del modulo principale, un file InitGui.py che ha il compito di inserire il modulo nella finestra grafica principale (GUI).
</p><p>Questo &egrave; un esempio semplice di un file InitGui.py: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ScriptWorkbench</span> <span class="p">(</span><span class="n">Workbench</span><span class="p">):</span> 
    <span class="n">MenuText</span> <span class="o">=</span> <span class="s2">"Scripts"</span>
    <span class="k">def</span> <span class="nf">Initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">Scripts</span> <span class="c1"># assuming Scripts.py is your module</span>
        <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Script_Cmd"</span><span class="p">]</span> <span class="c1"># That list must contain command names, that can be defined in Scripts.py</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">appendToolbar</span><span class="p">(</span><span class="s2">"My Scripts"</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> 
        
<span class="n">Gui</span><span class="o">.</span><span class="n">addWorkbench</span><span class="p">(</span><span class="n">ScriptWorkbench</span><span class="p">())</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="A_typical_module_file"></span>
</p>
<h3><span class="mw-headline" id="Un_tipico_file_del_modulo">Un tipico file del modulo</span></h3>
<p>Il seguente &egrave; un esempio di un file del modulo principale. Esso contiene tutto ci&ograve; che il modulo deve seguire. &Egrave; il file Scripts.py richiamato dall'esempio precedente. In esso &egrave; possibile inserire tutti i comandi personalizzati.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span> 
 
<span class="k">class</span> <span class="nc">ScriptCmd</span><span class="p">:</span> 
   <span class="k">def</span> <span class="nf">Activated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="c1"># Here your write what your ScriptCmd does...</span>
       <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s1">'Hello, World!'</span><span class="p">)</span>
   <span class="k">def</span> <span class="nf">GetResources</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
       <span class="k">return</span> <span class="p">{</span><span class="s1">'Pixmap'</span> <span class="p">:</span> <span class="s1">'path_to_an_icon/myicon.png'</span><span class="p">,</span> <span class="s1">'MenuText'</span><span class="p">:</span> <span class="s1">'Short text'</span><span class="p">,</span> <span class="s1">'ToolTip'</span><span class="p">:</span> <span class="s1">'More detailed text'</span><span class="p">}</span> 
       
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">addCommand</span><span class="p">(</span><span class="s1">'Script_Cmd'</span><span class="p">,</span> <span class="n">ScriptCmd</span><span class="p">())</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Import_a_new_filetype"></span>
</p>
<h3><span class="mw-headline" id="Importare_un_nuovo_tipo_di_file">Importare un nuovo tipo di file</span></h3>
<p>In FreeCAD, &egrave; facile creare un importatore per un nuovo tipo di file. FreeCAD non considera che si importano dati in un documento aperto, ma piuttosto che si pu&ograve; semplicemente aprire direttamente il nuovo tipo di file. Quindi, quello che si deve fare &egrave; aggiungere la nuova estensione di file alla lista delle estensioni conosciute di FreeCAD, scrivere il codice che legge il file e creare gli oggetti di FreeCAD che si desidera:
</p><p>Per aggiungere la nuova estensione di file all'elenco si deve aggiungere questa riga al file InitGui.py&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Assumes Import_Ext.py is the file that has the code for opening and reading .ext files</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">addImportType</span><span class="p">(</span><span class="s2">"Your new File Type (*.ext)"</span><span class="p">,</span><span class="s2">"Import_Ext"</span><span class="p">)</span>
</pre></div>
<p>Poi nel file Import_Ext.py:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span> 
   <span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
   <span class="c1"># here you do all what is needed with filename, read, classify data, create corresponding FreeCAD objects</span>
   <span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p>L'esportazione di un proprio documento in un nuovo tipo di file funziona allo stesso modo, ma si utilizza:
</p>
<pre>FreeCAD.addExportType("Your new File Type (*.ext)","Export_Ext")
</pre>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_a_line"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_una_linea">Aggiungere una linea</span></h3>
<p>Una linea ha semplicemente 2 punti.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span><span class="nn">PartGui</span> 
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="c1"># add a line element to the document and set its points </span>
<span class="n">l</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">LineSegment</span><span class="p">()</span>
<span class="n">l</span><span class="o">.</span><span class="n">StartPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">l</span><span class="o">.</span><span class="n">EndPoint</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span><span class="o">.</span><span class="n">Shape</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_a_polygon"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_un_poligono">Aggiungere un poligono</span></h3>
<p>Un poligono &egrave; semplicemente un insieme di segmenti di linea collegati tra di loro (una polilinea in AutoCAD). Non &egrave; necessario che sia chiuso.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">PartGui</span> 
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span> 

<span class="c1"># create a 3D vector, set its coordinates and add it to the list </span>
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="n">v</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> 
<span class="n">n</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> 
<span class="c1">#... repeat for all nodes </span>

<span class="c1"># Create a polygon object and set its nodes </span>
<span class="n">p</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Polygon"</span><span class="p">,</span><span class="s2">"Polygon"</span><span class="p">)</span> 
<span class="n">p</span><span class="o">.</span><span class="n">Nodes</span> <span class="o">=</span> <span class="n">n</span> 
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_and_remove_an_object_to/from_a_group"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_e_rimuovere_un_oggetto_in_un_gruppo">Aggiungere e rimuovere un oggetto in un gruppo</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> 
<span class="n">grp</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::DocumentObjectGroup"</span><span class="p">,</span> <span class="s2">"Group"</span><span class="p">)</span> 
<span class="n">lin</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Line"</span><span class="p">)</span>
<span class="n">grp</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># adds the lin object to the group grp</span>
<span class="n">grp</span><span class="o">.</span><span class="n">removeObject</span><span class="p">(</span><span class="n">lin</span><span class="p">)</span> <span class="c1"># removes the lin object from the group grp</span>
</pre></div>
<p>Nota: &Egrave; anche possibile annidare dei gruppi in altri gruppi e creare dei sottogruppi...
</p>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_a_Mesh"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_un_Mesh">Aggiungere un Mesh</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Mesh</span>
<span class="n">doc</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="c1"># create a new empty mesh</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Mesh</span><span class="o">.</span><span class="n">Mesh</span><span class="p">()</span>
<span class="c1"># build up box out of 12 facets</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">m</span><span class="o">.</span><span class="n">addFacet</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="c1"># scale to a edge langth of 100</span>
<span class="n">m</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span>
<span class="c1"># add the mesh to the active document</span>
<span class="n">me</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Mesh::Feature"</span><span class="p">,</span><span class="s2">"Cube"</span><span class="p">)</span>
<span class="n">me</span><span class="o">.</span><span class="n">Mesh</span><span class="o">=</span><span class="n">m</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_an_arc_or_a_circle"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_un_arco_o_un_cerchio">Aggiungere un arco o un cerchio</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Circle</span><span class="p">()</span> 
<span class="n">c</span><span class="o">.</span><span class="n">Radius</span><span class="o">=</span><span class="mf">10.0</span>  
<span class="n">f</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::Feature"</span><span class="p">,</span> <span class="s2">"Circle"</span><span class="p">)</span> <span class="c1"># create a document with a circle feature </span>
<span class="n">f</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">toShape</span><span class="p">()</span> <span class="c1"># Assign the circle shape to the shape property </span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Access_and_change_the_representation_of_an_object"></span>
</p>
<h3><span class="mw-headline" id="Accedere_alla_rappresentazione_di_un_oggetto_e_modificarla">Accedere alla rappresentazione di un oggetto e modificarla</span></h3>
<p>A ogni oggetto di un documento di FreeCAD &egrave; associato un oggetto di rappresentazione della sua vista in cui sono memorizzati tutti i parametri che definiscono il modo in cui l'oggetto deve apparire, come il colore, la larghezza di linea, ecc... Vedere anche lo snippet sottostante <a class="mw-selflink-fragment" href="#Elencare_i_componenti_di_un_oggetto">Elencare i componenti di un oggetto</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">gad</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span> <span class="c1"># access the active document containing all </span>
                           <span class="c1"># view representations of the features in the</span>
                           <span class="c1"># corresponding App document </span>

<span class="n">v</span> <span class="o">=</span> <span class="n">gad</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s2">"Cube"</span><span class="p">)</span>  <span class="c1"># access the view representation to the Mesh feature 'Cube' </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span>               <span class="c1"># prints the color to the console </span>
<span class="n">v</span><span class="o">.</span><span class="n">ShapeColor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># sets the shape color to white</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Replace_the_form_of_mouse_with_one_image"></span>
</p>
<h3><span id="Sostituire_la_forma_del_mouse_con_un.27immagine"></span><span class="mw-headline" id="Sostituire_la_forma_del_mouse_con_un'immagine">Sostituire la forma del mouse con un'immagine</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="s2">"Complete_Path_to_image.bmp"</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Replace_the_form_of_mouse_with_one_image_(cross)_include"></span>
</p>
<h3><span id="Sostituire_la_forma_del_mouse_con_un.27immagine_.28croce.29_inclusa"></span><span class="mw-headline" id="Sostituire_la_forma_del_mouse_con_un'immagine_(croce)_inclusa">Sostituire la forma del mouse con un'immagine (croce) inclusa</span></h3>
<p>L'immagine viene creata da Gimp esportata in un file .XPM. Copiare ed utilizzare il codice tra parentesi <b>"{"</b> code to copy <b>"}"</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QImage</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QCursor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<span class="n">cross32x32Icon</span> <span class="o">=</span> <span class="p">[</span>
<span class="s2">"32 32 2 1"</span><span class="p">,</span>
<span class="s2">" 	c None"</span><span class="p">,</span>
<span class="s2">".	c #FF0000"</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"............... . .............."</span><span class="p">,</span>
<span class="s2">"                                "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span><span class="p">,</span>
<span class="s2">"                .               "</span>
<span class="p">]</span>

<span class="n">myImage</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QPixmap</span><span class="p">(</span><span class="n">cross32x32Icon</span><span class="p">)</span>
<span class="n">cursor</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">myImage</span><span class="p">)</span>
<span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QCursor</span><span class="p">(</span><span class="n">cursor</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Observe_camera_change_in_the_3D_viewer_via_Python"></span>
</p>
<h3><span class="mw-headline" id="Osservare_il_cambiamento_della_telecamera_nel_visualizzatore_3D_tramite_Python">Osservare il cambiamento della telecamera nel visualizzatore 3D tramite Python</span></h3>
<p>Questo pu&ograve; essere fatto aggiungendo un <a rel="nofollow" class="external text" href="https://www.coin3d.org/Coin/html/classSoNodeSensor.html">Sensore Node</a> alla fotocamera: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">cam</span><span class="p">,</span> <span class="n">sensor</span> <span class="o">=</span> <span class="n">args</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam position&nbsp;: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Cam rotation&nbsp;: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()))</span>

<span class="n">camera_node</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">node_sensor</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoNodeSensor</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">camera_node</span><span class="p">)</span>
<span class="n">node_sensor</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">camera_node</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Observe_mouse_events_in_the_3D_viewer_via_Python"></span>
</p>
<h3><span class="mw-headline" id="Controllare_gli_eventi_del_mouse_nel_visualizzatore_3D_tramite_Python">Controllare gli eventi del mouse nel visualizzatore 3D tramite Python</span></h3>
<p>La struttura di Inventor permette di aggiungere uno o pi&ugrave; nodi di richiamo (callback) al grafo di scena (Scenegraph) della vista. In FreeCAD &egrave; installato di default un nodo callback per la vista che permette di aggiungere funzioni C++ globali o statiche. In appropriate associazioni Python vengono forniti alcuni metodi per utilizzare questa tecnica all'interno del codice Python.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><br>
Ora, cliccate in qualche parte nella zona nella vista 3D e osservate i messaggi nella finestra di output. Per terminare l'osservazione basta chiamare:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">v</span><span class="o">.</span><span class="n">removeEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</pre></div>
<p>Sono supportati i seguenti tipi di eventi:
</p>
<ul><li>SoEvent -- Tutti i tipi di eventi</li>
<li>SoButtonEvent -- Tutti gli eventi del mouse e della tastiera</li>
<li>SoLocation2Event -- Eventi di movimento 2D (normalmente i movimenti del mouse)</li>
<li>SoMotion3Event -- Eventi di movimento 3D (normalmente di spaceball)</li>
<li>SoKeyboardEvent -- Eventi dei tasti alto e basso</li>
<li>SoMouseButtonEvent -- Eventi dei pulsanti del mouse verso il basso e verso l'alto</li>
<li>SoSpaceballButtonEvent -- Eventi di SpaceBall in basso e in alto</li></ul>
<p>La funzione di Python che pu&ograve; essere registrata con addEventCallback() si aspetta una difinizione. Secondo l'evento controllato la definizione pu&ograve; contenere chiavi differenti.
</p><p>Per tutti gli eventi esistono le seguenti chiavi:
</p>
<ul><li>Type -- Il nome del tipo di evento, ad esempio SoMouseEvent, SoLocation2Event, ...</li>
<li>Time -- L'ora corrente come stringa</li>
<li>Position -- Una tupla di due interi, dipendenti dalla posizione del mouse</li>
<li>ShiftDown -- un valore booleano, vero (true) se Shift &egrave; stato premuto altrimenti false</li>
<li>CtrlDown -- un valore booleano, true se &egrave; stato premuto Ctrl altrimenti false</li>
<li>AltDown -- un valore booleano, true se &egrave; stato premuto Alt altrimenti false</li></ul>
<p>Per tutti gli eventi dei pulsanti, ad esempio eventi di tastiera, mouse o spaceball:
</p>
<ul><li>State -- Una stringa 'UP' se il pulsante &egrave; verso l'alto, 'DOWN' se &egrave; verso il basso o 'UNKNOWN' per tutti gli altri casi</li></ul>
<p>Per gli eventi da tastiera: 
</p>
<ul><li>Key -- Un carattere del tasto premuto</li></ul>
<p>Per gli eventi del pulsante del mouse 
</p>
<ul><li>Button -- Il pulsante premuto, potrebbe essere BUTTON1, ..., BUTTON5 o ANY</li></ul>
<p>Per gli eventi di Spaceball: 
</p>
<ul><li>Button -- Il pulsante premuto, potrebbe essere BUTTON1, ..., BUTTON7 o ANY</li></ul>
<p>E infine eventi di movimento: 
</p>
<ul><li>Translation -- Una tupla di tre numeri in virgola mobile</li>
<li>Rotation -- Un quaternione per la rotazione, cio&egrave; una tupla di quattro numeri in virgola mobile</li></ul>
<p><a href="#top">Inizio</a></p>
<p><span id="Display_keys_pressed_and_Events_command"></span>
</p>
<h3><span class="mw-headline" id="Visualizzare_i_tasti_premuti_e_gli_eventi_dei_comandi">Visualizzare i tasti premuti e gli eventi dei comandi</span></h3>
<p>Questa macro visualizza nel report i tasti premuti e tutti gli eventi dei comandi 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="k">try</span><span class="p">:</span>
           <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"Key"</span><span class="p">])</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">down</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># here the character pressed</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># list all events command</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"_______________________________________"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
       <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
           <span class="kc">None</span>
 
<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>

<span class="c1">#v.removeEventCallback("SoEvent",c) # remove ViewObserver</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Manipulate_the_scenegraph_in_Python"></span>
</p>
<h3><span class="mw-headline" id="Manipolare_il_grafo_della_scena_in_Python">Manipolare il grafo della scena in Python</span></h3>
<p>&Egrave; anche possibile ottenere il Scenegraph (grafo della scena) in Python e modificarlo, con il modulo 'Pivy' - una associazione di Python per Coin.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy.coin</span> <span class="kn">import</span> <span class="o">*</span>                <span class="c1"># load the pivy module</span>
<span class="n">view</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>   <span class="c1"># get the active viewer</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>            <span class="c1"># the root is an SoSeparator node</span>
<span class="n">root</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">SoCube</span><span class="p">())</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>
</pre></div>
<p>L'API in Python di Pivy viene creato utilizzando lo strumento SWIG. In FreeCAD si usano alcuni nodi auto-scritti che non &egrave; possibile creare direttamente in Python. Tuttavia, &egrave; possibile creare un nodo dal suo nome interno.
Si pu&ograve; creare una istanza di tipo 'SoFCSelection' con:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">type</span> <span class="o">=</span> <span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s2">"SoFCSelection"</span><span class="p">)</span>
<span class="n">node</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_and_remove_objects_to/from_the_scenegraph"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_e_rimuovere_oggetti_nel_grafo_della_scena">Aggiungere e rimuovere oggetti nel grafo della scena</span></h3>
<p>Questo &egrave; un modo per aggiungere dei nuovi nodi al Scenegraph. Accertarsi di aggiungere sempre un SoSeparator per contenere la  geometria, le coordinate e le informazioni sui materiale di uno stesso oggetto. 
L'esempio seguente aggiunge una linea rossa da (0,0,0) a (10,0,0):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">sg</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getSceneGraph</span><span class="p">()</span>
<span class="n">co</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">co</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">),</span><span class="n">pts</span><span class="p">)</span>
<span class="n">ma</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>
<span class="n">ma</span><span class="o">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">li</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLineSet</span><span class="p">()</span>
<span class="n">li</span><span class="o">.</span><span class="n">numVertices</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">no</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">co</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">ma</span><span class="p">)</span>
<span class="n">no</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>
<span class="n">sg</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p>Per rimuoverla, &egrave; sufficiente scrivere:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">sg</span><span class="o">.</span><span class="n">removeChild</span><span class="p">(</span><span class="n">no</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Save_the_sceneGraph_in_3_series_of_36_files"></span>
</p>
<h3><span class="mw-headline" id="Salvare_il_grafo_della_scena_in_3_serie_di_36_file">Salvare il grafo della scena in 3 serie di 36 file</span></h3>
<p>Visualizza il frammento di codice espandendo questa sezione
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="s2">"C:/Temp/animation/"</span>
<span class="n">steps</span><span class="o">=</span><span class="mi">36</span>
<span class="n">angle</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">steps</span>

<span class="n">matX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matX</span><span class="o">.</span><span class="n">rotateX</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsX</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matX</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matY</span><span class="o">.</span><span class="n">rotateY</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsY</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matY</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">matZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Matrix</span><span class="p">()</span>
<span class="n">matZ</span><span class="o">.</span><span class="n">rotateZ</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
<span class="n">stepsZ</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Placement</span><span class="p">(</span><span class="n">matZ</span><span class="p">)</span><span class="o">.</span><span class="n">Rotation</span>

<span class="n">view</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">cam</span><span class="o">=</span><span class="n">view</span><span class="o">.</span><span class="n">getCameraNode</span><span class="p">()</span>
<span class="n">rotCamera</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>

<span class="c1"># this sets the lookat point to the center of circumsphere of the global bounding box</span>
<span class="n">view</span><span class="o">.</span><span class="n">fitAll</span><span class="p">()</span>

<span class="c1"># the camera's position, i.e. the user's eye point</span>
<span class="n">position</span><span class="o">=</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="o">*</span><span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
<span class="n">distance</span><span class="o">=</span><span class="n">cam</span><span class="o">.</span><span class="n">focalDistance</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>

<span class="c1"># view direction</span>
<span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># this is the point on the screen the camera looks at</span>
<span class="c1"># when rotating the camera we should make this point fix</span>
<span class="n">lookat</span><span class="o">=</span><span class="n">position</span><span class="o">+</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>

<span class="c1"># around x axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsX</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"x-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around y axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsY</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"y-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># around z axis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">rotCamera</span><span class="o">=</span><span class="n">stepsZ</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">rotCamera</span><span class="p">)</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="o">*</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">vec</span><span class="o">=</span><span class="n">rotCamera</span><span class="o">.</span><span class="n">multVec</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">pos</span><span class="o">=</span><span class="n">lookat</span><span class="o">-</span><span class="n">vec</span><span class="o">*</span><span class="n">distance</span>
    <span class="n">cam</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">view</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">dirname</span><span class="o">+</span><span class="s2">"z-</span><span class="si">%d</span><span class="s2">.png"</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Inizio</a></p>
<p><span id="Add_custom_widgets_to_the_interface"></span>
</p>
<h3><span id="Aggiungere_dei_widget_personalizzati_all.27interfaccia"></span><span class="mw-headline" id="Aggiungere_dei_widget_personalizzati_all'interfaccia">Aggiungere dei widget personalizzati all'interfaccia</span></h3>
<p>&Egrave; possibile creare widget personalizzati con Qt designer, trasformarli in uno script Python e poi caricarli nell'interfaccia di FreeCAD con PySide.
</p><p>Il codice Python prodotto dal compilatore Ui di Python (lo strumento che converte i file .ui di Qt-designer nel codice Python) appare in genere come questo (&egrave; semplice, si pu&ograve; anche codificare direttamente in Python):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">myWidget_Ui</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">myWidget</span><span class="p">):</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"my Nice New Widget"</span><span class="p">)</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">())</span><span class="o">.</span><span class="n">expandedTo</span><span class="p">(</span><span class="n">myWidget</span><span class="o">.</span><span class="n">minimumSizeHint</span><span class="p">()))</span> <span class="c1"># sets size of the widget</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QLabel</span><span class="p">(</span><span class="n">myWidget</span><span class="p">)</span> <span class="c1"># creates a label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">24</span><span class="p">))</span> <span class="c1"># sets its size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"label"</span><span class="p">)</span> <span class="c1"># sets its name, so it can be found by name</span>

    <span class="k">def</span> <span class="nf">retranslateUi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">draftToolbar</span><span class="p">):</span> <span class="c1"># built-in QT function that manages translations of widgets</span>
        <span class="n">myWidget</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"My Widget"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="s2">"myWidget"</span><span class="p">,</span> <span class="s2">"Welcome to my new widget!"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">UnicodeUTF8</span><span class="p">))</span>
</pre></div>
<p>Dopo, basta creare un riferimento alla finestra Qt di FreeCAD, inserire un widget personalizzato in essa, e "trasformare" questo widget nel proprio con il codice Ui che abbiamo appena creato:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">FCmw</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span> <span class="c1"># the active qt window, = the freecad window since we are inside it</span>
<span class="c1"># FCmw = FreeCADGui.getMainWindow() # use this line if the 'addDockWidget' error is declared</span>
<span class="n">myNewFreeCADWidget</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">()</span> <span class="c1"># create a new dckwidget</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">myWidget_Ui</span><span class="p">()</span> <span class="c1"># load the Ui script</span>
<span class="n">myNewFreeCADWidget</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># setup the ui</span>
<span class="n">FCmw</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">,</span><span class="n">myNewFreeCADWidget</span><span class="p">)</span> <span class="c1"># add the widget to the main window</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_a_Tab_to_the_Combo_View"></span>
</p>
<h3><span class="mw-headline" id="Aggiungere_una_scheda_alla_Combo_View">Aggiungere una scheda alla Combo View</span></h3>
<p>Il seguente codice consente di aggiungere una nuova scheda nel pannello <a href="../it/Combo_view.html" class="mw-redirect" title="Combo view/it">Vista combinata</a> di FreeCAD, oltre le schede standard "Modello" e "Azioni" . Questo codice utilizza anche il modulo <code>uic</code> per caricare un file UI direttamente nella nuova scheda.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create new Tab in ComboView</span>
<span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtCore</span>
<span class="c1">#from PySide import uic</span>

<span class="k">def</span> <span class="nf">getMainWindow</span><span class="p">():</span>
   <span class="s2">"returns the main window"</span>
   <span class="c1"># using QtGui.qApp.activeWindow() isn't very reliable because if another</span>
   <span class="c1"># widget than the mainwindow is active (e.g. a dialog) the wrong widget is</span>
   <span class="c1"># returned</span>
   <span class="n">toplevel</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span><span class="o">.</span><span class="n">topLevelWidgets</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">toplevel</span><span class="p">:</span>
       <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">metaObject</span><span class="p">()</span><span class="o">.</span><span class="n">className</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Gui::MainWindow"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span>
   <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">"No main window found"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getComboView</span><span class="p">(</span><span class="n">mw</span><span class="p">):</span>
   <span class="n">dw</span><span class="o">=</span><span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dw</span><span class="p">:</span>
       <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Combo View"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
       <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">())</span> <span class="o">==</span> <span class="s2">"Python Console"</span><span class="p">:</span>
           <span class="k">return</span> <span class="n">i</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QTabWidget</span><span class="p">)</span>
   <span class="k">raise</span> <span class="ne">Exception</span> <span class="p">(</span><span class="s2">"No tab widget found"</span><span class="p">)</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">tab</span> <span class="o">=</span> <span class="n">getComboView</span><span class="p">(</span><span class="n">getMainWindow</span><span class="p">())</span>
<span class="n">tab2</span><span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDialog</span><span class="p">()</span>
<span class="n">tab</span><span class="o">.</span><span class="n">addTab</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span><span class="s2">"A Special Tab"</span><span class="p">)</span>

<span class="c1">#uic.loadUi("/myTaskPanelforTabs.ui",tab2)</span>
<span class="n">tab2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#tab.removeTab(2)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Enable_or_disable_a_window"></span>
</p>
<h3><span class="mw-headline" id="Abilitare_o_disabilitare_una_finestra">Abilitare o disabilitare una finestra</span></h3>
<div class="mw-translate-fuzzy">
<p>Questo script d&agrave; la possibilit&agrave; di manipolare l'interfaccia utente dalla <a href="../it/Python_console.html" class="mw-redirect" title="Python console/it">Python console/it</a> per mostrare/nascondere diversi componenti nella <a href="../it/Interface.html" title="Interface/it">interface/it</a> di FreeCAD come:
</p>
<ul><li><a href="../Report_view.html" class="mw-redirect" title="Report view">Report view</a></li>
<li><a href="../Tree_view.html" class="mw-redirect" title="Tree view">Tree view</a></li>
<li><a href="../Property_editor.html" class="mw-redirect" title="Property editor">Property view</a></li>
<li><a href="../Selection_view.html" class="mw-redirect" title="Selection view">Selection view</a></li>
<li><a href="../Combo_view.html" class="mw-redirect" title="Combo view">Combo view</a></li>
<li><a href="../Python_console.html" class="mw-redirect" title="Python console">Python console</a></li>
<li>draftToolbar</li></ul>
</div>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">dws</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QDockWidget</span><span class="p">)</span>

<span class="c1"># objectName may be&nbsp;:</span>
<span class="c1"># "Report view"</span>
<span class="c1"># "Tree view"</span>
<span class="c1"># "Property view"</span>
<span class="c1"># "Selection view"</span>
<span class="c1"># "Combo View"</span>
<span class="c1"># "Python console"</span>
<span class="c1"># "draftToolbar"</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dws</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"Report view"</span><span class="p">:</span>
    <span class="n">dw</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">break</span>

<span class="n">va</span> <span class="o">=</span> <span class="n">dw</span><span class="o">.</span><span class="n">toggleViewAction</span><span class="p">()</span>
<span class="n">va</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
<span class="n">dw</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>        <span class="c1"># True or False</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Open_a_custom_webpage"></span>
</p>
<h3><span class="mw-headline" id="Aprire_una_pagina_web_personalizzata">Aprire una pagina web personalizzata</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">WebGui</span>
<span class="n">WebGui</span><span class="o">.</span><span class="n">openBrowser</span><span class="p">(</span><span class="s2">"http://www.example.com"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_HTML_contents_of_an_opened_webpage"></span>
</p>
<h3><span class="mw-headline" id="Ottenere_il_contenuto_HTML_di_una_pagina_web_aperta">Ottenere il contenuto HTML di una pagina web aperta</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span><span class="n">QtWebKit</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">qApp</span>
<span class="n">mw</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">activeWindow</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWebKit</span><span class="o">.</span><span class="n">QWebFrame</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">unicode</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">toHtml</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">html</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Retrieve_the_coordinates_of_3_selected_points_or_objects"></span>
</p>
<h3><span class="mw-headline" id="Reperire_le_coordinate_di_3_punti_o_oggetti_selezionati">Reperire le coordinate di 3 punti o oggetti selezionati</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># the line above to put the accentuated in the remarks</span>
<span class="c1"># If this line is missing, an error will be returned</span>
<span class="c1"># extract and use the coordinates of 3 objects selected</span>
<span class="kn">import</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">math</span><span class="o">,</span> <span class="nn">PartGui</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span><span class="p">,</span> <span class="n">Console</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span> <span class="c1"># " sel " contains the items selected</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span><span class="o">!=</span><span class="mi">3</span> <span class="p">:</span>
  <span class="c1"># If there are no 3 objects selected, an error is displayed in the report view</span>
  <span class="c1"># The \r and \n at the end of line mean return and the newline CR + LF.</span>
  <span class="n">Console</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">"Select 3 points exactly</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">else</span> <span class="p">:</span>
  <span class="n">points</span><span class="o">=</span><span class="p">[]</span>
  <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
    <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
    <span class="c1"># display of the coordinates in the report view</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>

  <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="List_all_objects"></span>
</p>
<h3><span class="mw-headline" id="Lista_di_oggetti">Lista di oggetti</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span><span class="nn">Draft</span>
<span class="c1"># List all objects of the document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span>
<span class="c1">#App.Console.PrintMessage(str(objs) + "\n")</span>
<span class="c1">#App.Console.PrintMessage(str(len(FreeCAD.ActiveDocument.Objects)) + " Objects"  + "\n")</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>                                             <span class="c1"># list the Name  of the object  (not modifiable)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Label</span>                                            <span class="c1"># list the Label of the object  (modifiable)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">LabelText</span>                                    <span class="c1"># list the LabeText of the text (modifiable)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name the Label and the text</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span><span class="s2">" "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># Displays the Name and the Label of the object</span>

<span class="c1">#doc.removeObject("Box") # Clears the designated object</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="List_the_dimensions_of_an_object,_given_its_name"></span>
</p>
<h3><span id="Ottenere_la_dimensione_di_un_oggetto.2C_dato_il_suo_nome"></span><span class="mw-headline" id="Ottenere_la_dimensione_di_un_oggetto,_dato_il_suo_nome">Ottenere la dimensione di un oggetto, dato il suo nome</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">MyObjectName</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">:</span> <span class="c1"># replace "MyObjectName" for list</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">edge</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Function_resident_with_the_mouse_click_action"></span>
</p>
<h3><span class="mw-headline" id="Funzione_residente_per_una_azione_con_un_clic_del_mouse">Funzione residente per una azione con un clic del mouse</span></h3>
<p>Qui con <b>SelObserver</b> sopra uno obietto selezionato
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># causes an action to the mouse click on an object</span>
<span class="c1"># This function remains resident (in memory) with the function "addObserver(s)"</span>
<span class="c1"># "removeObserver(s) # Uninstalls the resident function</span>
<span class="k">class</span> <span class="nc">SelObserver</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">setPreselection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Preselection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>

    <span class="k">def</span> <span class="nf">addSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">,</span><span class="n">pnt</span><span class="p">):</span>               <span class="c1"># Selection object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"addSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the document</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Name of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># The part of the object name</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># Coordinates of the object</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"______"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">removeSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">sub</span><span class="p">):</span>                <span class="c1"># Remove the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"removeSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                           <span class="c1"># Set selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"setSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clearSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>                         <span class="c1"># If click on the screen, clear the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"clearSelection"</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>  <span class="c1"># If click on another object, clear the previous object</span>
<span class="n">s</span> <span class="o">=</span><span class="n">SelObserver</span><span class="p">()</span>
<span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addObserver</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>                       <span class="c1"># install the function mode resident</span>
<span class="c1">#FreeCADGui.Selection.removeObserver(s)                   # Uninstall the resident function</span>
</pre></div>
<p>Altro esempio con <b>ViewObserver</b> sopra uno obbietto selezionato
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">v</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span>
 
<span class="c1">#This class logs any mouse button events. As the registered callback function fires twice for 'down' and</span>
<span class="c1">#'up' events we need a boolean flag to handle this.</span>
<span class="k">class</span> <span class="nc">ViewObserver</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
   
   <span class="k">def</span> <span class="nf">logPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">):</span>
       <span class="n">down</span> <span class="o">=</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s2">"State"</span><span class="p">]</span> <span class="o">==</span> <span class="s2">"DOWN"</span><span class="p">)</span>
       <span class="n">pos</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">"Position"</span><span class="p">]</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">down</span><span class="p">):</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Clicked on position: ("</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">", "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">")</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">pnt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getPoint</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"World coordinates: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pnt</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
           <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getObjectInfo</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
           <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Object info: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">info</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">o</span> <span class="o">=</span> <span class="n">ViewObserver</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">addEventCallback</span><span class="p">(</span><span class="s2">"SoMouseButtonEvent"</span><span class="p">,</span><span class="n">o</span><span class="o">.</span><span class="n">logPosition</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Display_the_active_document"></span>
</p>
<h3><span class="mw-headline" id="Visualizzare_il_documento_attivo">Visualizzare il documento attivo</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">DocObserver</span><span class="p">:</span>                      <span class="c1"># document Observer</span>
    <span class="k">def</span> <span class="nf">slotActivateDocument</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">doc</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>

<span class="n">obs</span><span class="o">=</span><span class="n">DocObserver</span><span class="p">()</span>
<span class="n">App</span><span class="o">.</span><span class="n">addDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
<span class="c1">#App.removeDocumentObserver(obs)                 # desinstalle la fonction residente</span>
</pre></div>
<p>Per rimuovere la chiamata dell'osservatore:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">App</span><span class="o">.</span><span class="n">removeDocumentObserver</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>                 <span class="c1"># desinstalle la fonction residente</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Find/select_all_elements_below_the_cursor"></span>
</p>
<h3><span class="mw-headline" id="Trovare_o_selezionare_tutti_gli_elementi_sotto_il_cursore">Trovare o selezionare tutti gli elementi sotto il cursore</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>

<span class="k">def</span> <span class="nf">mouse_over_cb</span><span class="p">(</span> <span class="n">event_callback</span><span class="p">):</span>
    <span class="n">event</span> <span class="o">=</span> <span class="n">event_callback</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">getPosition</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
    <span class="n">listObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getObjectsInfo</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">listObjects</span><span class="p">:</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2"> *** Objects under mouse pointer ***"</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">listObjects</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">[</span><span class="s2">"Object"</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>


<span class="n">view</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>

<span class="n">mouse_over</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoLocation2Event</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">mouse_over_cb</span> <span class="p">)</span>

<span class="c1"># to remove Callback&nbsp;:</span>
<span class="c1">#view.removeEventCallbackPivy( coin.SoLocation2Event.getClassTypeId(), mouse_over)</span>

<span class="c1">####</span>
<span class="c1">#The easy way is probably to use FreeCAD's selection.</span>
<span class="c1">#FreeCADGui.ActiveDocument.ActiveView.getObjectsInfo(mouse_coords)</span>

<span class="c1">####</span>
<span class="c1">#you get that kind of result&nbsp;:</span>
<span class="c1">#'Document': 'Unnamed', 'Object': 'Box', 'Component': 'Face2', 'y': 8.604081153869629, 'x': 21.0, 'z': 8.553047180175781</span>

<span class="c1">####</span>
<span class="c1">#You can use this data to add your element to FreeCAD's selection&nbsp;:</span>
<span class="c1">#FreeCADGui.Selection.addSelection(FreeCAD.ActiveDocument.Box,'Face2',21.0,8.604081153869629,8.553047180175781)</span>
</pre></div>
<p><a href="#top">Inizio</a></p><div class="mw-collapsible mw-collapsed toccolours">
<p><span id="List_the_components_of_an_object"></span>
</p>
<h3><span class="mw-headline" id="Elencare_i_componenti_di_un_oggetto">Elencare i componenti di un oggetto</span></h3>
<p>Questa funzione elenca i componenti ed estrae le coordinate XYZ di un oggetto, i bordi (edge) e le loro lunghezze, le sue facce e la loro superficie.
</p><p>Questa funzione elenca i componenti di un oggetto ed estrae:
</p>
<ul><li>questo oggetto e le sue coordinate XYZ,</li>
<li>i suoi bordi e le loro lunghezze, centro di massa e coordinate</li>
<li>le sue facce e il loro centro di massa</li>
<li>le sue facce e le loro superfici e coordinate</li></ul>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># This function list the components of an object</span>
<span class="c1"># and extract this object its XYZ coordinates,</span>
<span class="c1"># its edges and their lengths center of mass and coordinates</span>
<span class="c1"># its faces and their center of mass</span>
<span class="c1"># its faces and their surfaces and coordinates</span>
<span class="c1"># 8/05/2014</span>

<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span><span class="nn">Part</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">():</span>
    <span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>   <span class="c1"># Select an object</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>                           <span class="c1"># If there is a selection then</span>
        <span class="n">Vertx</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Edges</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">Faces</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">compt_V</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_E</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">compt_F</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">pas</span>    <span class="o">=</span><span class="mi">0</span>
        <span class="n">perimetre</span> <span class="o">=</span> <span class="mf">0.0</span>   
        <span class="n">EdgesLong</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Displays the "Name" and the "Label" of the selection</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Selection &gt; "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"  "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span><span class="p">)</span> <span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                     <span class="c1"># Search the "Edges" and their lengths</span>
            <span class="n">compt_E</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Edges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Edge</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">EdgesLong</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">))</span>
            <span class="n">perimetre</span> <span class="o">+=</span> <span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span>                     <span class="c1"># calculates the perimeter</span>

            <span class="c1"># Displays the "Edge" and its length</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Length &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays the "Edge" and its center mass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edge"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_E</span><span class="p">)</span><span class="o">+</span><span class="s2">" Center &gt; "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
            <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="c1"># Displays the coordinates 1</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z1: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">compt_E</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
                <span class="n">Vertx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)</span>
            <span class="c1"># Displays the coordinates 2</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">" Y2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">" Z2: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">num</span><span class="o">.</span><span class="n">Point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Perimeter of the form &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perimetre</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> 

        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">FacesSurf</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                      <span class="c1"># Search the "Faces" and their surface</span>
            <span class="n">compt_F</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">Faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">FacesSurf</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its surface</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Surface "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its CenterOfMass</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Center  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">FacesCoor</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">fco</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">f0</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>                        <span class="c1"># Search the Vertexes of the face</span>
                <span class="n">fco</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"X"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Y"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
                <span class="n">FacesCoor</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Z"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">fco</span><span class="p">)</span><span class="o">+</span><span class="s2">": "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">f0</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>

            <span class="c1"># Displays 'Face' and its Coordinates</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Coordinate"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FacesCoor</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

            <span class="c1"># Displays 'Face' and its Volume</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">compt_F</span><span class="p">)</span><span class="o">+</span><span class="s2">" &gt;  Volume  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">compt_F</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
            <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total surface of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Surface of the form   &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Displays the total Volume of the form</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Volume  of the form   &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">detail</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Inizio</a></p>
<h3><span class="mw-headline" id="List_the_PropertiesList">List the PropertiesList</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Console</span>
<span class="n">o</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveObject</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">PropertiesList</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">op</span><span class="p">:</span>
    <span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Property: "</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span> <span class="s2">" Value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="n">p</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\r\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Add_a_single_Property_Comment"></span>
</p>
<h3><span id="Aggiungere_una_singola_Propriet.C3.A0_Comment"></span><span class="mw-headline" id="Aggiungere_una_singola_Propriet&agrave;_Comment">Aggiungere una singola Propriet&agrave; Comment</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span><span class="s2">"GComment"</span><span class="p">,</span><span class="s2">"Draft"</span><span class="p">,</span><span class="s2">"Font name"</span><span class="p">)</span><span class="o">.</span><span class="n">GComment</span> <span class="o">=</span> <span class="s2">"Comment here"</span>
<span class="n">App</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<div class="mw-collapsible mw-collapsed toccolours">
<p><span id="Search_and_data_extraction"></span>
</p>
<h3><span class="mw-headline" id="Ricerca_e_estrazione_di_dati">Ricerca e estrazione di dati</span></h3>
<p>Esempi di ricerca e decodifica di informazioni su un oggetto.
</p><p>Ogni sezione separata da "############" &egrave; indipendente e pu&ograve; essere copiata direttamente nella console Python, o in una macro o usata come macro a s&egrave; stante. La descrizione della macro si trova nel commento.
</p><p>Le informazioni ricercate in questo modo sono visualizzate nella finestra dei rapporti attivabile con Visualizza -&gt; Viste -&gt; Report
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
 
<span class="c1"># Exemples de recherche et de decodage d'informations sur un objet</span>
<span class="c1"># Chaque section peut etre copiee directement dans la console Python ou dans une macro ou utilisez la macro tel quel</span>
<span class="c1"># Certaines commandes se repetent seul l'approche est differente</span>
<span class="c1"># L'affichage se fait dans la Vue rapport&nbsp;: Menu Affichage &gt; Vues &gt; Vue rapport</span>
<span class="c1">#</span>
<span class="c1"># Examples of research and decoding information on an object</span>
<span class="c1"># Each section can be copied directly into the Python console, or in a macro or uses this macro</span>
<span class="c1"># Certain commands as repeat alone approach is different</span>
<span class="c1"># Displayed in Report view: View &gt; Views &gt; report view</span>
<span class="c1">#</span>
<span class="c1"># rev:30/08/2014:29/09/2014:17/09/2015 22/11/2019 30/12/2022</span>
 
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">import</span> <span class="nn">DraftVecUtils</span><span class="o">,</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1">##################################################################################</span>
<span class="c1"># info in the object</span>

<span class="n">box</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="s1">'Box'</span><span class="p">)</span>                                 <span class="c1"># object </span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">box</span><span class="p">))</span>                                                           <span class="c1"># all options disponible in the object</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>                                                           <span class="c1"># object name</span>
<span class="c1">####</span>
<span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">Content</span><span class="p">)</span>                                                        <span class="c1"># content of the object in XML format</span>
<span class="c1">##################################################################################</span>
<span class="c1">#</span>
<span class="c1"># example of using the information listed</span>
<span class="c1">#</span>
<span class="c1"># search the name of the active document </span>
<span class="n">mydoc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>                                     <span class="c1"># Name of active Document</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Active docu   &nbsp;: "</span><span class="o">+</span><span class="p">(</span><span class="n">mydoc</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the document name and the name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_FullName</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">FullName</span>                                         <span class="c1"># file Name and Name of the object selected</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_FullName: "</span><span class="o">+</span><span class="p">(</span><span class="n">object_FullName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the label of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Label</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Label</span>                                               <span class="c1"># Label of the object (modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Label  &nbsp;: "</span><span class="o">+</span><span class="p">(</span><span class="n">object_Label</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1">#TypeID object FreeCAD selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"sel           &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>          <span class="c1"># sel[0] first object selected</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Name of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">object_Name</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Name</span>                                                <span class="c1"># Name of the object (not modifiable)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"object_Name   &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">object_Name</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># search the Sub Element Name of the sub object selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                    <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">element_</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                           <span class="c1"># name of 1 element selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"elementSelec  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">element_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the length of the subObject selected</span>
<span class="n">SubElementLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="c1"># sub element or element name with getSelectionEx()</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"SubElement length: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">SubElementLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span><span class="c1"># length</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the edges and the coordinates of the object[0] selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">):</span>                                   <span class="c1"># list all Edges</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Edges n&nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X1            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1"># coordinate XYZ first point</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y1            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z1            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>     <span class="c1">#</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"X2            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># coordinate XYZ second point</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Y2            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Z2            &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1">#</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>    
<span class="c1">##################################################################################</span>

<span class="c1"># give the sub element name, length, coordinates, BoundBox, BoundBox.Center, Area of the SubObjects selected</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">SubElement</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>                                        <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">subElementName</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                     <span class="c1"># sub element name with getSelectionEx()</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subElementName&nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subElementName</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectLength</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span>                  <span class="c1"># sub element Length</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectLength: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectLength</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectX1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>         <span class="c1"># sub element coordinate X1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X1  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectY1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>         <span class="c1"># sub element coordinate Y1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y1  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">subObjectZ1</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>         <span class="c1"># sub element coordinate Z1</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z1  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ1</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">subObjectX2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">x</span>     <span class="c1"># sub element coordinate X2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_X2  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectX2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectY2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">y</span>     <span class="c1"># sub element coordinate Y2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Y2  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectY2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="n">subObjectZ2</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Point</span><span class="o">.</span><span class="n">z</span>     <span class="c1"># sub element coordinate Z2</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObject_Z2  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectZ2</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            

    <span class="n">subObjectBoundBox</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span>              <span class="c1"># sub element BoundBox coordinates</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBox &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBox</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">subObjectBoundBoxCenter</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">BoundBox</span><span class="o">.</span><span class="n">Center</span> <span class="c1"># sub element BoundBoxCenter</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"subObjectBBoxCe: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">subObjectBoundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    
    <span class="n">surfaceFace</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Area</span>                        <span class="c1"># Area of the face selected</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceFace   &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surfaceFace</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Oups"</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>            
<span class="c1">##################################################################################</span>

<span class="c1"># give the area of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">surface</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Area</span>                                               <span class="c1"># Area object complete</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"surfaceObjet  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">surface</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the Center Of Mass and coordinates of the object</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">CenterOfMass</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">CenterOfMass</span>                                  <span class="c1"># Center of Mass of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMass  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassX &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># coordinates [0]=X [1]=Y [2]=Z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassY &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>   <span class="c1"># or CenterOfMass.x, CenterOfMass.y, CenterOfMass.z</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"CenterOfMassZ &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">CenterOfMass</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># list the all faces of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">):</span>                                   <span class="c1"># List alles faces of the object</span>
    <span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Face          &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">"Face</span><span class="si">%d</span><span class="s2">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the volume of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">volume_</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Volume</span>                                             <span class="c1"># Volume of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"volume_       &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">volume_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the BoundBox of the oject selected all type</span>
<span class="n">objs</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>                                                         <span class="c1"># serch the object type</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Shape"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Mesh"</span><span class="p">):</span>      <span class="c1"># upgrade with wmayer thanks #https://forum.freecad.org/viewtopic.php?f=13&amp;t=22331</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Mesh</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"Points"</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Points</span>

<span class="n">boundBox_</span><span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">BoundBox</span>                                                     <span class="c1"># BoundBox of the object</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox_     &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBox_</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>         <span class="c1"># </span>
 
<span class="n">boundBoxLX</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XLength</span>                                          <span class="c1"># Length x boundBox rectangle</span>
<span class="n">boundBoxLY</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YLength</span>                                          <span class="c1"># Length y boundBox rectangle</span>
<span class="n">boundBoxLZ</span>   <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZLength</span>                                          <span class="c1"># Length z boundBox rectangle</span>

<span class="n">boundBoxXMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMin</span>                                             <span class="c1"># coordonate XMin</span>
<span class="n">boundBoxYMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMin</span>                                             <span class="c1"># coordonate YMin</span>
<span class="n">boundBoxZMin</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMin</span>                                             <span class="c1"># coordonate ZMin</span>
<span class="n">boundBoxXMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">XMax</span>                                             <span class="c1"># coordonate XMax</span>
<span class="n">boundBoxYMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">YMax</span>                                             <span class="c1"># coordonate YMax</span>
<span class="n">boundBoxZMax</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">ZMax</span>                                             <span class="c1"># coordonate ZMax</span>

<span class="n">boundBoxDiag</span><span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">DiagonalLength</span>                                    <span class="c1"># Diagonal Length boundBox rectangle</span>
<span class="n">boundBoxCenter</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">Center</span>                                         <span class="c1"># BoundBox Center</span>
<span class="n">boundBoxCenterOfGravity</span> <span class="o">=</span> <span class="n">boundBox_</span><span class="o">.</span><span class="n">CenterOfGravity</span>                       <span class="c1"># BoundBox CenterOfGravity</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLX    &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLX</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLY    &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLY</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxLZ    &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxLZ</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMin  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMin  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMin  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMin</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxXMax  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxXMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxYMax  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxYMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxZMax  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxZMax</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxDiag  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxDiag</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBoxCenter&nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenter</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"boundBox Center of Gravity&nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">boundBoxCenterOfGravity</span> <span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># give the complete placement of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span>                                               <span class="c1"># Placement Vector XYZ and Yaw-Pitch-Roll</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement     &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span>                                          <span class="c1"># Placement Vector XYZ</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"PlacementBase &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
 
<span class="c1"># give the placement Base (xyz) of the object selected</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">oripl_X</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                        <span class="c1"># decode Placement X</span>
<span class="n">oripl_Y</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                        <span class="c1"># decode Placement Y</span>
<span class="n">oripl_Z</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                        <span class="c1"># decode Placement Z</span>

<span class="c1"># same </span>
<span class="c1">#oripl_X = sel[0].Placement.Base.x                                        # decode Placement X</span>
<span class="c1">#oripl_Y = sel[0].Placement.Base.y                                        # decode Placement Y</span>
<span class="c1">#oripl_Z = sel[0].Placement.Base.z                                        # decode Placement Z</span>
 
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_X       &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_X</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Y       &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"oripl_Z       &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">oripl_Z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">rotation</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"rotation             &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rotation</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the placement rotation of the object selected (x, y, z, angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span>                                      <span class="c1"># decode Placement Rotation other method</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot        &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected (angle rotation)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                                <span class="c1"># decode Placement Rotation Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Placement Rot Angle  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pl</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation.Q of the object selected (angle rotation in Radian) for convert: math.degrees(angleInRadian)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                                 <span class="c1"># select object with getSelection()</span>
<span class="n">Rot</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span>                                       <span class="c1"># Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot          &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_0</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation Q</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_0        &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_0</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_0</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_1</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 1</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_1        &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_1</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_1</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>
 
<span class="n">Rot_2</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 2</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_2        &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_2</span><span class="p">)</span><span class="o">+</span> <span class="s2">" rad ,  "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="mi">180</span> <span class="o">*</span> <span class="n">Rot_2</span> <span class="o">/</span> <span class="mf">3.1416</span><span class="p">)</span><span class="o">+</span><span class="s2">" deg "</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span> <span class="c1"># or math.degrees(angle)</span>

<span class="n">Rot_3</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>                                    <span class="c1"># decode Placement Rotation 3</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_3        &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_3</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">Rot_Axis</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Axis</span>                                 <span class="c1"># Placement Rotation .Axis</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Axis     &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Axis</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
 
<span class="n">Rot_Angle</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span>                               <span class="c1"># Placement Rotation .Angle</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Rot_Angle    &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Rot_Angle</span><span class="p">)</span><span class="o">+</span> <span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>

<span class="c1"># give the rotation of the object selected toEuler (angle rotation in degrees)</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>                             <span class="c1"># select object with getSelection()</span>
<span class="n">angle</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()</span>                   <span class="c1"># angle Euler</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Angle         &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Yaw</span>   <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Yaw (Z) lacet (alpha)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Yaw           &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Yaw</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Pitch</span> <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Pitch (Y) tangage (beta)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Pitch         &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Pitch</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">Roll</span>  <span class="o">=</span> <span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">toEuler</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>                  <span class="c1"># decode angle Euler Roll (X) roulis (gamma)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Roll          &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Roll</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>

<span class="n">rot</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">()</span>
<span class="n">rot</span><span class="o">.</span><span class="n">setYawPitchRoll</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Angle: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Axis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Axis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"RawAxis: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">RawAxis</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"YawPitchRoll: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">getYawPitchRoll</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation: "</span><span class="p">,</span> <span class="n">rot</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Quaternion: "</span><span class="p">,</span> <span class="n">rot</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

<span class="c1">##################################################################################</span>

<span class="c1"># find Midpoint of the selected line</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">DraftGeomUtils</span>
<span class="n">sel</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
<span class="n">vecteur</span> <span class="o">=</span> <span class="n">DraftGeomUtils</span><span class="o">.</span><span class="n">findMidpoint</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>              <span class="c1"># find Midpoint</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makePoint</span><span class="p">(</span><span class="n">vecteur</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Inizio</a></p>
<p><span id="Manual_search_of_an_element_with_label"></span>
</p>
<h3><span id="Ricerca_manuale_di_un_elemento_dall.27etichetta"></span><span class="mw-headline" id="Ricerca_manuale_di_un_elemento_dall'etichetta">Ricerca manuale di un elemento dall'etichetta</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># Extract the coordinate X,Y,Z and Angle giving the label (here "Cylindre")</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.x      &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.y      &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.z      &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Base.Angle  &nbsp;: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObjectsByLabel</span><span class="p">(</span><span class="s2">"Cylindre"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Angle</span><span class="p">)</span><span class="o">+</span><span class="s2">"</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
<span class="c1">##################################################################################</span>
</pre></div>
<p><b>Nota:</b> Solitamente gli angoli sono espressi in radianti. Per convertirli:
</p>
<ol><li>da gradi a radianti&nbsp;:
<ul><li>angolo in radianti = <b>pi * (angolo in gradi) / 180</b></li>
<li>angolo in radianti = math.radians(angolo in gradi)</li></ul></li>
<li>da radianti a gradi&nbsp;:
<ul><li>angolo in gradi = <b>180 * (angolo in radianti) / pi</b></li>
<li>angolo in gradi = math.degrees(angolo in radianti)</li></ul></li></ol>
<p><a href="#top">Inizio</a></p>
<p><span id="Cartesian_coordinates"></span>
</p>
<h3><span class="mw-headline" id="Coordinate_cartesiane">Coordinate cartesiane</span></h3>
<p>Questo codice visualizza le coordinate cartesiane dell'elemento selezionato.
</p><p>Modificare il valore di "numberOfPoints" se si desidera un diverso numero di punti (modificare la precisione)
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numberOfPoints</span> <span class="o">=</span> <span class="mi">100</span>                                                         <span class="c1"># Decomposition number (or precision you can change)</span>
<span class="n">selectedEdge</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># select one element</span>
<span class="n">points</span>  <span class="o">=</span> <span class="n">selectedEdge</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="n">numberOfPoints</span><span class="p">)</span>                            <span class="c1"># discretize the element</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>                                                             <span class="c1"># list and display the coordinates</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="s2">" X"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z"</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
</pre></div>
<p>Altro metodo per visualizzare "Int" e "Float" (interi e valori in virgola mobile)
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">c</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>        <span class="c1"># create the circle</span>
<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>                     <span class="c1"># display the shape</span>

<span class="c1"># slice accepts two arguments:</span>
<span class="c1">#+ the normal of the cross section plane</span>
<span class="c1">#+ the distance from the origin to the cross section plane. Here you have to find a value so that the plane intersects your object</span>
<span class="n">s</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># </span>

<span class="c1"># here the result is a single wire</span>
<span class="c1"># depending on the source object this can be several wires</span>
<span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># if you only need the vertexes of the shape you can use</span>
<span class="n">v</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>
    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">Point</span><span class="p">)</span>

<span class="c1"># but you can also sub-sample the section to have a certain number of points (int) ...</span>
<span class="n">p1</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p1</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode</span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># to see the difference accuracy (20)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>


<span class="c1"># ... or define a sampling distance (float)</span>
<span class="n">p2</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ii</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p2</span><span class="p">:</span>
    <span class="n">ii</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>                                             <span class="c1"># Vector()</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">ii</span><span class="p">,</span> <span class="s2">": X:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="s2">" Y:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="s2">" Z:"</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">z</span> <span class="p">)</span>       <span class="c1"># Vector decode </span>
<span class="n">Draft</span><span class="o">.</span><span class="n">makeWire</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># to see the difference accuracy (0.5)</span>

<span class="c1">## uncomment to use</span>
<span class="c1">#import Draft</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # first transform the DWire in Wire         "downgrade"</span>
<span class="c1">#Draft.downgrade(App.ActiveDocument.ActiveObject,delete=True)  # second split the Wire in single objects   "downgrade"</span>
<span class="c1">#</span>
<span class="c1">##Draft.upgrade(FreeCADGui.Selection.getSelection(),delete=True) # to attach lines contiguous SELECTED use "upgrade"</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Select_all_objects_in_the_document"></span>
</p>
<h3><span class="mw-headline" id="Selezionare_tutti_gli_oggetti_nel_documento">Selezionare tutti gli oggetti nel documento</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span> <span class="p">)</span>                               <span class="c1"># display the object Name</span>
    <span class="n">objName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">Name</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">objName</span><span class="p">)</span>
    <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>                 <span class="c1"># select the object</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Select_a_face_of_an_object_by_Name_object_and_Face_number"></span>
</p>
<h3><span class="mw-headline" id="Selezionare_una_faccia_di_un_oggetto_in_base_a_Nome_oggetto_e_Numero_faccia">Selezionare una faccia di un oggetto in base a Nome oggetto e Numero faccia</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># select one face of the object</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Draft</span>
<span class="n">App</span><span class="o">=</span><span class="n">FreeCAD</span>
<span class="n">nameObject</span> <span class="o">=</span> <span class="s2">"Box"</span>                             <span class="c1"># objet</span>
<span class="n">faceSelect</span> <span class="o">=</span> <span class="s2">"Face3"</span>                           <span class="c1"># face to selection</span>
<span class="n">loch</span><span class="o">=</span><span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nameObject</span><span class="p">)</span>  <span class="c1"># objet</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>                 <span class="c1"># clear all selection</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">loch</span><span class="p">,</span><span class="n">faceSelect</span><span class="p">)</span>    <span class="c1"># select the face specified</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()</span>
<span class="c1">#Draft.makeFacebinder(s)                       #</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_Face_(r.Q)"></span>
</p>
<h3><span id="Ottienere_il_vettore_normale_di_una_faccia_di_un_oggetto_con_Nome_oggetto_e_Numero_faccia_.28r.Q.29"></span><span class="mw-headline" id="Ottienere_il_vettore_normale_di_una_faccia_di_un_oggetto_con_Nome_oggetto_e_Numero_faccia_(r.Q)">Ottienere il vettore normale di una faccia di un oggetto con Nome oggetto e Numero faccia (r.Q)</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face and the name of the object (rotation Q with yL, uV) = (App.Vector (x, y, z), angle))</span>
<span class="c1">## normal d'une face en donnant le numero de la face et le nom de l'objet (rotation Q avec yL, uV) = (App.Vector(x, y, z),angle))</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Vector</span>

<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>      <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>  <span class="c1"># object name</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">CenterOfMass</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>

<span class="n">nv</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">direction</span> <span class="o">=</span> <span class="n">yL</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">nv</span> <span class="o">+</span> <span class="n">yL</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Direction &nbsp;: "</span><span class="p">,</span><span class="n">direction</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">direction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation  &nbsp;: "</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rotation Q&nbsp;: "</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_of_a_face_of_an_object_by_Name_object_and_number_of_Face"></span>
</p>
<h3><span class="mw-headline" id="Ottienere_il_vettore_normale_di_una_faccia_di_un_oggetto_tramite_Nome_oggetto_e_numero_di_Faccia">Ottienere il vettore normale di una faccia di un oggetto tramite Nome oggetto e numero di Faccia</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">2</span>       <span class="c1"># number of the face searched (begin 0, 1, 2, 3 .....)</span>
<span class="n">nomObjet</span>    <span class="o">=</span> <span class="s2">"Box"</span>   <span class="c1"># object name</span>
<span class="n">normal</span>      <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">nomObjet</span><span class="p">)</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">),</span> <span class="s2">"&nbsp;: "</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_of_an_object_selected_and_number_of_Face"></span>
</p>
<h3><span class="mw-headline" id="Ottienere_il_vettore_normale_di_un_oggetto_selezionato_e_il_numero_di_Faccia">Ottienere il vettore normale di un oggetto selezionato e il numero di Faccia</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1">## normal of a face by giving the number of the face of the selected object</span>
<span class="n">selectionObjects</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>     
<span class="n">numero_Face</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># numero de la face recherchee</span>
<span class="n">normal</span> <span class="o">=</span> <span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">numero_Face</span><span class="p">]</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
<span class="c1"># selectionne la face numerotee</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">()</span>
<span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">addSelection</span><span class="p">(</span><span class="n">selectionObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">"Face"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">numero_Face</span><span class="p">))</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_on_the_surface"></span>
</p>
<h3><span class="mw-headline" id="Ottenere_il_vettore_normale_alla_superficie">Ottenere il vettore normale alla superficie</span></h3>
<p>Questo esempio mostra come trovare vettore normale alla superficie trovando prima i parametri u, v di un punto sulla superficie e utilizzando poi i parametri u, v per trovare il vettore normale
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">normal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">ss</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="c1">#SubObjects[0] is the edge list</span>
   <span class="n">points</span>  <span class="o">=</span> <span class="n">ss</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span><span class="c1">#points on the surface edge, </span>
             <span class="c1">#this example just use points on the edge for example. </span>
             <span class="c1">#However point is not necessary on the edge, it can be anywhere on the surface. </span>
   <span class="n">face</span><span class="o">=</span><span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
   <span class="k">for</span> <span class="n">pp</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
      <span class="n">pt</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">)</span><span class="c1">#a point on the surface edge</span>
      <span class="n">uv</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="c1"># find the surface u,v parameter of a point on the surface edge</span>
      <span class="n">u</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">v</span><span class="o">=</span><span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">normal</span><span class="o">=</span><span class="n">face</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span><span class="c1">#use u,v to find normal vector</span>
      <span class="nb">print</span><span class="p">(</span> <span class="n">normal</span><span class="p">)</span>
      <span class="n">line</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">((</span><span class="n">pp</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">pp</span><span class="o">.</span><span class="n">z</span><span class="p">),</span> <span class="p">(</span><span class="n">normal</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">normal</span><span class="o">.</span><span class="n">z</span><span class="p">))</span>
      <span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_of_the_face_and_create_a_line_at_the_point_mouse_clicked"></span>
</p>
<h3><span class="mw-headline" id="Ottenere_il_vettore_normale_della_faccia_e_creare_una_linea_nel_punto_cliccato_con_il_mouse">Ottenere il vettore normale della faccia e creare una linea nel punto cliccato con il mouse</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span>
<span class="kn">import</span> <span class="nn">Draft</span><span class="o">,</span> <span class="nn">Part</span><span class="o">,</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span> <span class="k">as</span> <span class="nn">Gui</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">openTransaction</span><span class="p">(</span><span class="s2">"Tyty"</span><span class="p">)</span>    <span class="c1"># memorise les actions (avec annuler restore)</span>
<span class="n">selectedFace</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">SubObjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pointClick</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">PickedPoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">########## section direction</span>
<span class="n">plr</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">yL</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="n">uv</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">Surface</span><span class="o">.</span><span class="n">parameter</span><span class="p">(</span><span class="n">yL</span><span class="p">)</span>
<span class="n">nv</span> <span class="o">=</span> <span class="n">direction</span> <span class="o">=</span> <span class="n">selectedFace</span><span class="o">.</span><span class="n">normalAt</span><span class="p">(</span><span class="n">uv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">uv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">Rotation</span><span class="p">(</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">nv</span><span class="p">)</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">Q</span>
<span class="n">plr</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">pointClick</span>
<span class="c1">########## section direction</span>

<span class="n">line</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">make_wire</span><span class="p">([</span><span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">),</span> <span class="n">App</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">20.0</span><span class="p">)]</span> <span class="p">)</span>    <span class="c1"># create line</span>
<span class="n">line</span><span class="o">.</span><span class="n">Placement</span><span class="o">=</span><span class="n">plr</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span> <span class="s2">"Direction (radian)&nbsp;: "</span><span class="p">,</span><span class="n">direction</span> <span class="p">)</span>    <span class="c1"># direction in radian</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Get_the_normal_vector_of_a_surface_from_a_STL_file"></span>
</p>
<h3><span class="mw-headline" id="Ottieni_il_vettore_normale_di_una_superficie_da_un_file_STL">Ottieni il vettore normale di una superficie da un file STL</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">getNormal</span><span class="p">(</span><span class="n">cb</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cb</span><span class="o">.</span><span class="n">getEvent</span><span class="p">()</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span> <span class="o">==</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoButtonEvent</span><span class="o">.</span><span class="n">UP</span><span class="p">:</span>
        <span class="n">pp</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="n">getPickedPoint</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pp</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getNormal</span><span class="p">()</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">getDetail</span><span class="p">(),</span> <span class="s2">"SoFaceDetail"</span><span class="p">)</span><span class="o">.</span><span class="n">getFaceIndex</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">"Normal: </span><span class="si">{}</span><span class="s2">, Face index: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">vec</span><span class="p">),</span> <span class="n">index</span><span class="p">))</span>

<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="n">meth</span><span class="o">=</span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">addEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">getNormal</span><span class="p">)</span>
</pre></div>
<p>hai finito quindi fai questo per uscire: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">removeEventCallbackPivy</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoMouseButtonEvent</span><span class="o">.</span><span class="n">getClassTypeId</span><span class="p">(),</span> <span class="n">meth</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Create_one_object_to_the_position_of_the_Camera"></span>
</p>
<h3><span class="mw-headline" id="Creare_un_oggetto_della_posizione_della_fotocamera">Creare un oggetto della posizione della fotocamera</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># create one object of the position to camera with "getCameraOrientation()"</span>
<span class="c1"># the object is still facing the screen</span>
<span class="kn">import</span> <span class="nn">Draft</span>

<span class="n">plan</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">plan</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="c1">###### extract data</span>
<span class="n">a</span>    <span class="o">=</span> <span class="s2">""</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">plan</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"0123456789e.- "</span><span class="p">):</span>
        <span class="n">a</span><span class="o">+=</span><span class="n">i</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)</span>
<span class="c1">####### extract data</span>

<span class="c1">#print( a)</span>
<span class="c1">#print( a[0])</span>
<span class="c1">#print( a[1])</span>
<span class="c1">#print( a[2])</span>
<span class="c1">#print( a[3])</span>

<span class="n">xP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">yP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">zP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">qP</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="n">xP</span><span class="p">,</span><span class="n">yP</span><span class="p">,</span><span class="n">zP</span><span class="p">,</span><span class="n">qP</span><span class="p">)</span>         <span class="c1"># rotation of object</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># here coordinates XYZ of Object</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># create rectangle</span>
<span class="c1">#rec = Draft.makeCircle(radius=5,placement=pl,face=False,support=None)                   # create circle</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">rec</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
</pre></div>
<p>stesso codice semplificato
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">pl</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getCameraOrientation</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">rec</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeRectangle</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Read_And_write_one_Expression"></span>
</p>
<h3><span class="mw-headline" id="Leggere_e_scrivere_una_Expression">Leggere e scrivere una Expression</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Draft</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span>

<span class="n">pl</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Placement</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Rotation</span><span class="o">.</span><span class="n">Q</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">Base</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">obj</span> <span class="o">=</span> <span class="n">Draft</span><span class="o">.</span><span class="n">makeCircle</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">placement</span><span class="o">=</span><span class="n">pl</span><span class="p">,</span><span class="n">face</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">support</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>    <span class="c1"># create circle</span>

<span class="nb">print</span><span class="p">(</span> <span class="n">obj</span><span class="o">.</span><span class="n">PropertiesList</span> <span class="p">)</span>                                                  <span class="c1"># properties disponible in the obj</span>

<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Radius'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'2mm'</span><span class="p">)</span>                    <span class="c1"># modify the radius</span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'Placement.Base.x'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'10mm'</span><span class="p">)</span>         <span class="c1"># modify the placement </span>
<span class="n">doc</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span><span class="o">.</span><span class="n">setExpression</span><span class="p">(</span><span class="s1">'FirstAngle'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'90'</span><span class="p">)</span>                 <span class="c1"># modify the first angle</span>
<span class="n">doc</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>

<span class="n">expressions</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ExpressionEngine</span>                                         <span class="c1"># read the expression list</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">expressions</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expressions</span><span class="p">:</span>                                                      <span class="c1"># list and separate the data expression</span>
    <span class="nb">print</span><span class="p">(</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s2">" = "</span><span class="p">,</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Create_a_Sketch_on_a_Surface_in_PartDesign"></span>
</p>
<h3><span class="mw-headline" id="Creare_uno_schizzo_su_una_superficie_in_PartDesign">Creare uno schizzo su una superficie in PartDesign</span></h3>
<p>Questo frammento pu&ograve; essere utile se si desidera creare uno schizzo su una superficie in PartDesign dall'interno di una macro.
Tenere presente che il corpo potrebbe essere None, se non &egrave; selezionato alcun corpo attivo e che la Selezione potrebbe essere vuota.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">body</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getActiveObject</span><span class="p">(</span><span class="s1">'pdbody'</span><span class="p">)</span>
<span class="n">first_selection</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">Selection</span><span class="o">.</span><span class="n">getSelectionEx</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">feature</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">Object</span>
<span class="n">face_name</span> <span class="o">=</span> <span class="n">first_selection</span><span class="o">.</span><span class="n">SubElementNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">sketch</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s1">'Sketcher::SketchObject'</span><span class="p">,</span><span class="s1">'MySketch'</span><span class="p">)</span>
<span class="n">body</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">sketch</span><span class="p">)</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">MapMode</span> <span class="o">=</span> <span class="s1">'FlatFace'</span>
<span class="n">sketch</span><span class="o">.</span><span class="n">Support</span> <span class="o">=</span> <span class="p">(</span><span class="n">feature</span><span class="p">,</span> <span class="n">face_name</span><span class="p">)</span>

<span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="How_to_Simulate_a_Mouse_Click_at_a_given_Coordinate"></span>
</p>
<h3><span class="mw-headline" id="Come_simulare_un_Clic_del_Mouse_su_una_data_coordinata">Come simulare un Clic del Mouse su una data coordinata</span></h3>
<p>La posizione &egrave; relativa al widget GL. Vedere <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=44008">discussione sul forum</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>

<span class="n">mw</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">mw</span><span class="o">.</span><span class="n">findChild</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QOpenGLWidget</span><span class="p">)</span>
<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span><span class="mi">300</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">app</span><span class="o">.</span><span class="n">sendEvent</span><span class="p">(</span><span class="n">gl</span><span class="p">,</span> <span class="n">me</span><span class="p">)</span>
</pre></div>
<p>Se si ha un punto 3D e si vuole ottenere il punto 2D sul widget OpenGL, usare questo: 
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">FreeCAD</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Gui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span>
<span class="n">point3d</span> <span class="o">=</span> <span class="n">Base</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">point2d</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getPointOnScreen</span><span class="p">(</span><span class="n">point3d</span><span class="p">)</span>
<span class="n">size</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">getSize</span><span class="p">()</span>
<span class="n">coordX</span> <span class="o">=</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">coordY</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">point2d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">me</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMouseEvent</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QEvent</span><span class="o">.</span><span class="n">MouseButtonRelease</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">(</span><span class="n">coordX</span><span class="p">,</span><span class="n">coordY</span><span class="p">),</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftButton</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoModifier</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="How_to_create_a_face_with_holes_using_Python_API"></span>
</p>
<h3><span id="Come_creare_una_faccia_con_fori_utilizzando_l.27API_Python"></span><span class="mw-headline" id="Come_creare_una_faccia_con_fori_utilizzando_l'API_Python">Come creare una faccia con fori utilizzando l'API Python</span></h3>
<p>Questo frammento dimostra come creare una faccia con fori interni tramite l'API Python. Vedi <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=56308">discussione sul forum</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">Part</span>

<span class="c1"># Create poles that will define the Face</span>
<span class="n">pts</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
       <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="n">bs</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">BSplineCurve</span><span class="p">()</span>
<span class="n">bs</span><span class="o">.</span><span class="n">buildFromPoles</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  <span class="c1"># True makes this periodic/closed</span>

<span class="c1"># Make the Face from the curve</span>
<span class="n">myFace</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeFilledFace</span><span class="p">([</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">()])</span>

<span class="c1"># Create geometry for holes that will be cut in the surface</span>
<span class="n">hole0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">hole1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Geom2d</span><span class="o">.</span><span class="n">Circle2d</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Base</span><span class="o">.</span><span class="n">Vector2d</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.5</span><span class="p">),</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">edge0</span> <span class="o">=</span> <span class="n">hole0</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">edge1</span> <span class="o">=</span> <span class="n">hole1</span><span class="o">.</span><span class="n">toShape</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
<span class="n">wireb</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">bs</span><span class="o">.</span><span class="n">toShape</span><span class="p">())</span>
<span class="n">wire0</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge0</span><span class="p">)</span>
<span class="n">wire1</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Wire</span><span class="p">(</span><span class="n">edge1</span><span class="p">)</span>

<span class="c1"># Cut holes in the face</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire0</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>  <span class="c1"># This is required</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">cutHoles</span><span class="p">([</span><span class="n">wire1</span><span class="p">])</span>
<span class="n">myFace</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

<span class="n">Part</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">myFace</span><span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<p><span id="Close_and_restart_FreeCAD"></span>
</p>
<h3><span class="mw-headline" id="Chiudere_e_riavviare_FreeCAD">Chiudere e riavviare FreeCAD</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">PySide2</span> 
<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="k">def</span> <span class="nf">restart_freecad</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Shuts down and restarts FreeCAD"""</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">arguments</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">if</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">():</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QProcess</span><span class="o">.</span><span class="n">startDetached</span><span class="p">(</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QApplication</span><span class="o">.</span><span class="n">applicationFilePath</span><span class="p">(),</span> <span class="n">args</span>
        <span class="p">)</span>
</pre></div>
<p><a href="#top">Inizio</a></p>
<h2><span class="mw-headline" id="Coin3D">Coin3D</span></h2>
<p>Vedere <a href="../index.php?title=Coin3d_snippets/it&amp;action=edit&amp;redlink=1.html" class="new" title="Coin3d snippets/it (page does not exist)">Frammenti Coin3d</a>
</p>
<p><a href="#top">Inizio</a></p>
<p><span id="Related"></span>
</p>
<h2><span class="mw-headline" id="Correlazioni">Correlazioni</span></h2>
<ul><li><a href="../it/Scripted_objects.html" title="Scripted objects/it">Oggetti da script</a></li>
<li><a href="../it/Macros.html" title="Macros/it">Macro</a></li>
<li><a href="../index.php?title=Topological_data_scripting/Script_di_dati_topologici&amp;action=edit&amp;redlink=1.html" class="new" title="Topological data scripting/Script di dati topologici (page does not exist)">Topological_data_scripting/Script di dati topologici</a></li></ul>
<p><a href="#top">Inizio</a></p>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
    <div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: var(--background-color-neutral-subtle, #fefefe);"><span typeof="mw:File"><a href="../index.php?title=Power_user_hub.png&amp;filetimestamp=20200511213015&amp;.html" class="mw-file-description"><img src="../File/Power_user_hub.png" decoding="async" width="24" height="24" class="mw-file-element" data-file-width="128" data-file-height="128"></a></span> <a href="../it/Power_users_hub.html" title="Power users hub/it">Power user documentation</a>
        <div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid var(--border-color-base, #aaaaaa); text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: var(--background-color-neutral-subtle, #fefefe);">
<ul><li><b>FreeCAD scripting:</b> <a href="../it/Python.html" title="Python/it">Python</a>, <a href="../it/Introduction_to_Python.html" title="Introduction to Python/it">Introduction to Python</a>, <a href="../it/Python_scripting_tutorial.html" title="Python scripting tutorial/it">Python scripting tutorial</a>, <a href="../it/FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/it">FreeCAD Scripting Basics</a></li></ul>
<hr>
<ul><li><b>Modules:</b> <a href="../it/Builtin_modules.html" title="Builtin modules/it">Builtin modules</a>, <a href="../it/Units.html" title="Units/it">Units</a>, <a href="../it/Quantity.html" title="Quantity/it">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../it/Workbench_creation.html" title="Workbench creation/it">Workbench creation</a>, <a href="../it/Gui_Command.html" title="Gui Command/it">Gui Commands</a>, <a href="../it/Command.html" title="Command/it">Commands</a>, <a href="../it/Installing_more_workbenches.html" title="Installing more workbenches/it">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../it/Mesh_Scripting.html" title="Mesh Scripting/it">Mesh Scripting</a>, <a href="../it/Topological_data_scripting.html" title="Topological data scripting/it">Topological data scripting</a>, <a href="../it/Mesh_to_Part.html" title="Mesh to Part/it">Mesh to Part</a>, <a href="../it/PythonOCC.html" title="PythonOCC/it">PythonOCC</a></li></ul>
<hr>
<ul><li><b>Parametric objects:</b> <a href="../it/Scripted_objects.html" title="Scripted objects/it">Scripted objects</a>, <a href="../it/Viewprovider.html" title="Viewprovider/it">Viewproviders</a> <small>(<a href="../it/Custom_icon_in_tree_view.html" title="Custom icon in tree view/it">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../it/Scenegraph.html" title="Scenegraph/it">Coin (Inventor) scenegraph</a>, <a href="../it/Pivy.html" title="Pivy/it">Pivy</a></li>
<li><b>Graphical interface:</b> <a href="../it/Interface_creation.html" title="Interface creation/it">Interface creation</a>, <a href="../it/Dialog_creation.html" title="Dialog creation/it">Interface creation completely in Python</a> <small>(<a href="../it/Dialog_creation_with_various_widgets.html" title="Dialog creation with various widgets/it">1</a>, <a href="../it/Dialog_creation_reading_and_writing_files.html" title="Dialog creation reading and writing files/it">2</a>, <a href="../it/Dialog_creation_setting_colors.html" title="Dialog creation setting colors/it">3</a>, <a href="../it/Dialog_creation_image_and_animated_GIF.html" title="Dialog creation image and animated GIF/it">4</a>, <a href="../it/PySide_usage_snippets.html" title="PySide usage snippets/it">5</a>)</small>, <a href="../it/PySide.html" title="PySide/it">PySide</a>, PySide examples <a href="../it/PySide_Beginner_Examples.html" title="PySide Beginner Examples/it">beginner</a>, <a href="../it/PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/it">intermediate</a>, <a href="../it/PySide_Advanced_Examples.html" title="PySide Advanced Examples/it">advanced</a></li>
<li><b>Macros:</b> <a href="../it/Macros.html" title="Macros/it">Macros</a>, <a href="../it/How_to_install_macros.html" title="How to install macros/it">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../it/Embedding_FreeCAD.html" title="Embedding FreeCAD/it">Embedding FreeCAD</a>, <a href="../it/Embedding_FreeCADGui.html" title="Embedding FreeCADGui/it">Embedding FreeCADGui</a></li></ul>
<hr>
<ul><li><b>Other:</b> <a href="../it/Expressions.html" title="Expressions/it">Expressions</a>, <a class="mw-selflink selflink">Code snippets</a>, <a href="../it/Line_drawing_function.html" title="Line drawing function/it">Line drawing function</a>, <a href="../it/FreeCAD_vector_math_library.html" title="FreeCAD vector math library/it">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr>
<ul><li><b>Hubs:</b> <a href="../it/User_hub.html" title="User hub/it">User hub</a>, <a href="../it/Power_users_hub.html" title="Power users hub/it">Power users hub</a>, <a href="../it/Developer_hub.html" title="Developer hub/it">Developer hub</a></li></ul></div>
    </div></div>
<!-- 
NewPP limit report
Cached time: 20251021085705
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.366 seconds
Real time usage: 0.456 seconds
Preprocessor visited node count: 1240/1000000
Post&#8208;expand include size: 12459/2097152 bytes
Template argument size: 56574/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 59/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 268604/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   62.978      1 -total
 46.97%   29.579     59 Template:Code
 23.67%   14.905      1 Template:Powerdocnavi/it
  7.34%    4.622     50 Template:Top
  6.38%    4.021      1 Template:Navigation_menu_2
  6.29%    3.961      1 Template:Incode
  4.92%    3.098      1 Template:TOCright
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:2381-0!canonical and timestamp 20251021085705 and revision id 1669182. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>