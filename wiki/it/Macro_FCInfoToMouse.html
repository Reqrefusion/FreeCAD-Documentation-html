<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro FCInfoToMouse/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+FCInfoToMouse&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Macro_FCInfoToMouse.html" class="mw-pt-progress mw-pt-progress--med" title="Macro FCInfoToMouse/de (15% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_FCInfoToMouse.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro FCInfoToMouse (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_FCInfoToMouse.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro FCInfoToMouse (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Macro_FCInfoToMouse.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: FCInfo w kursorze myszki (3% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<div class="mw-translate-fuzzy">
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=FCInfoToMouse.png&amp;filetimestamp=20160101205625&amp;.html" class="mw-file-description"><img src="../File/FCInfoToMouse.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Info dal mouse
</p>
</td></tr>
<tr>
<th class="ctOdd">Descrizione
</th></tr>
<tr>
<td class="ctEven left macro-description">Fornisce in tempo reale informazioni sulle coordinate, lunghezza e angoli del mouse.<br><br>Versione macro: 00.05<br>Ultima modifica: 2021-04-14<br>Autore: Mario52<br>
</td></tr>
<tr>
<th class="ctOdd">Autore
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Mario52.html" title="User:Mario52">Mario52</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Link
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../it/Macros_recipes.html" title="Macros recipes/it">Raccolta di macro</a><br><a href="../it/How_to_install_macros.html" title="How to install macros/it">Come installare le macro</a><br><a href="../it/Customize_Toolbars.html" title="Customize Toolbars/it">Personalizzare la  toolbar</a>
</td></tr>
<tr>
<th class="ctOdd">Versione macro
</th></tr>
<tr>
<td class="ctEven macro-version">00.05
</td></tr>
<tr>
<th class="ctOdd">Data ultima modifica
</th></tr>
<tr>
<td class="ctEven macro-date">2021-04-14
</td></tr>
<tr>
<th class="ctOdd">Versioni di FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Scorciatoia
</th></tr>
<tr>
<td class="ctEven"><i>Nessuna</i>
</td></tr>
<tr>
<th class="ctOdd">Vedere anche
</th></tr>
<tr>
<td class="ctEven"><i>Nessuno</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Description">Description</span></h2>
</div>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Descrizione">Descrizione</span></h2>
<p>Fornisce in tempo reale informazioni sulle coordinate, lunghezza e angoli del mouse in una bolla di annotazione visualizzata nella schermata 3D
</p>
</div>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="https://gist.githubusercontent.com/mario52a/974214c4b83beaa41495/raw/7789c1995dba2af74a14d549638267f7740c036c/Macro_FCInfoToMouse.FCMacro">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "https://gist.githubusercontent.com/mario52a/974214c4b83beaa41495/raw/7789c1995dba2af74a14d549638267f7740c036c/Macro_FCInfoToMouse.FCMacro" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("https://gist.githubusercontent.com/mario52a/974214c4b83beaa41495/raw/7789c1995dba2af74a14d549638267f7740c036c/Macro_FCInfoToMouse.FCMacro")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="https://gist.githubusercontent.com/mario52a/974214c4b83beaa41495/raw/7789c1995dba2af74a14d549638267f7740c036c/Macro_FCInfoToMouse.FCMacro">https://gist.githubusercontent.com/mario52a/974214c4b83beaa41495/raw/7789c1995dba2af74a14d549638267f7740c036c/Macro_FCInfoToMouse.FCMacro</a>"&gt;raw code&lt;/a&gt;</div>
<p><br>
<span typeof="mw:File"><a href="../index.php?title=Macro_FCInfoToMouse_00.png&amp;filetimestamp=20160101212913&amp;.html" class="mw-file-description"><img src="../File/Macro_FCInfoToMouse_00.png" decoding="async" width="480" height="360" class="mw-file-element" data-file-width="640" data-file-height="480"></a></span>
</p>
<div class="mw-translate-fuzzy">
<p style="text-align:left; font-style:italic; max-width:800px; box-sizing:border-box; margin-block:1em; margin-inline:clamp(1em, 6vw, 2em); padding-inline:clamp(0.75em, 4vw, 2em); word-break:normal; overflow-wrap:break-word;">FCInfoToMouse</p>
</div>
<p><span id="Usage"></span>
</p>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Utilizzo">Utilizzo</span></h2>
<p>Dopo aver installato la macro nella cartella delle macro, eseguirla. Viene creata l'annotazione che visualizza in tempo reale le informazioni sulla posizione del mouse.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ol><li>Install the FCInfoToMouse macro in your macros directory via the <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a></li>
<li>Run the <a href="../Macros.html" title="Macros">Macro</a></li></ol>
<dl><dd>Result: an annotation appears and the mouse coordinate information is displayed in real-time.</dd></dl>
</div>
<div class="mw-translate-fuzzy">
<figure class="mw-halign-left" typeof="mw:File"><a href="../index.php?title=Macro_FCInfoToMouse_01.png&amp;filetimestamp=20160101213313&amp;.html" class="mw-file-description" title="FCInfoToMouse"><img alt="FCInfoToMouse" src="../File/Macro_FCInfoToMouse_01.png" decoding="async" width="240" height="42" class="mw-file-element" data-file-width="144" data-file-height="25"></a><figcaption>FCInfoToMouse </figcaption></figure>
</div>
<div class="mw-translate-fuzzy">
<ul><li><b>X, Y, Z</b>&nbsp;: le coordinate del mouse visualizzate nella bolla (Nella modalit&agrave; "Single" viene visualizzato solo questo)<br></li></ul>
</div>
<div class="mw-translate-fuzzy">
<p>Dopo il primo click, sono visualizzate la altre informazioni (Nella modalit&agrave; "Forced" vengono visualizzati questi dati)
</p>
</div>
<div class="mw-translate-fuzzy">
<figure class="mw-halign-left" typeof="mw:File"><a href="../index.php?title=Macro_FCInfoToMouse_02.png&amp;filetimestamp=20160101213349&amp;.html" class="mw-file-description" title="FCInfoToMouse"><img alt="FCInfoToMouse" src="../File/Macro_FCInfoToMouse_02.png" decoding="async" width="240" height="82" class="mw-file-element" data-file-width="181" data-file-height="62"></a><figcaption>FCInfoToMouse </figcaption></figure>
</div>
<div class="mw-translate-fuzzy">
<ul><li><b>X1, Y1, Z1</b>&nbsp;: coordinate al primo clic del mouse</li>
<li><b>X2, Y2, Z2</b>&nbsp;: coordinate al secondo clic del mouse</li>
<li><b>L</b>&nbsp;: lunghezza tra il primo clic e il movimento del mouse corrente</li>
<li><b>XY, YZ, XZ</b>&nbsp;: angoli tra il primo punto e lo spostamento del mouse nei piani XY, YZ, XZ</li></ul>
</div>
<div style="clear:both"></div>
<div class="mw-translate-fuzzy">
<figure class="mw-halign-left" typeof="mw:File"><a href="../index.php?title=Macro_FCInfoToMouse_03.png&amp;filetimestamp=20160102114041&amp;.html" class="mw-file-description" title="FCInfoToMouse"><img alt="FCInfoToMouse" src="../File/Macro_FCInfoToMouse_03.png" decoding="async" width="240" height="148" class="mw-file-element" data-file-width="301" data-file-height="185"></a><figcaption>FCInfoToMouse </figcaption></figure>
</div>
<div class="mw-translate-fuzzy">
<p>se il mouse si trova sopra un oggetto, il nome dell'oggetto appare nella parte superiore dell'annotazione
</p>
</div>
<div style="clear:both"></div>
<p><span id="Keyboard_Shortcuts"></span>
</p>
<div class="mw-translate-fuzzy">
<p>Utilizzare i tasti:
</p>
</div>
<div class="mw-translate-fuzzy">
<p><b><span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">SHIFT</span> + <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">Q</span></b>&nbsp;: per uscire da FCInfoToMouse, se si esce dalla macro l'annotazione rimane nella posizione corrente del mouse. Se si desidera eliminare l'annotazione si deve farlo manualmente. Selezionare l'annotazione nella vista ad albero e eliminarla o nasconderla.
</p>
</div>
<div class="mw-translate-fuzzy">
<p><b><span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">SHIFT</span> + <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">M</span></b>&nbsp;: per forzare la visualizzazione completa nei modi "<b>single</b>", o "<b>normal</b>".
</p>
<ul><li>Il modo <b>single</b> visualizza solo le coordinate del mouse</li></ul>
</div>
<p><b><span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">SHIFT</span> + <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">C</span></b>&nbsp;: per mostrare o nascondere l'annotazione.
</p>
<div class="mw-translate-fuzzy">
<p><b><span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">SHIFT</span> + <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">D</span></b>&nbsp;: for "<b>open / close</b>" un foglio di lavoro nel documento in cui le coordinate sono state salvate:
</p>
</div>
<div class="mw-translate-fuzzy">
<p><span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">cell <b>A</b></span>&nbsp;: x, y, z <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">cell <b>B</b></span>&nbsp;: x <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">cell <b>C</b></span>&nbsp;: y <span class="key" style="background: #f9f9f9; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 1px solid #888888; border-radius: 0.3em; padding: 0px 5px 1px 5px; color:#202122;">cell <b>D</b></span>&nbsp;: z
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h3><span class="mw-headline" id="Notes">Notes</span></h3>
</div>
<p>In qualsiasi momento, &egrave; possibile modificare le propriet&agrave; della annotazione impostando i parametri nella scheda Vista che si apre facendo clic sull'oggetto FCInfoToMouse nella Vista Combinata.
</p><p>Se si desidera cambiare il numero di decimali,modificare la riga 43 del codice (default 4 decimali)
</p><p>Esempio per 6 cifre decimali:
</p><p>valore originale
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">global</span> <span class="n">arrondi</span>    <span class="p">;</span> <span class="n">arrondi</span>    <span class="o">=</span> <span class="mi">4</span>
</pre></div>
<p>sostituire con
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">global</span> <span class="n">arrondi</span>    <span class="p">;</span> <span class="n">arrondi</span>    <span class="o">=</span> <span class="mi">6</span>
</pre></div>
<p>Per rendere la configurazione dell'annotazione permanente &egrave; possibile modificare i valori di configurazione nelle linee della sezione <b>da 104 a 122</b>
</p><p><br>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Script">Script</span></h2>
</div>
<h2><span class="mw-headline" id="Script_2">Script</span></h2>
<p>L'icona <b>FCInfoToMouse.png</b> <span typeof="mw:File"><a href="../index.php?title=FCInfoToMouse.png&amp;filetimestamp=20160101205625&amp;.html" class="mw-file-description" title="FCInfoToMouse"><img alt="FCInfoToMouse" src="../File/FCInfoToMouse.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span> per <a rel="nofollow" class="external text" href="http://www.freecad.org/wiki/index.php?title=Customize_ToolsBar/it">personalizzare la barra degli strumenti</a>
</p><p><b>Macro_FCInfoToMouse.FCMacro</b> 
</p>
<pre># -*- coding: utf-8 -*-
"""
***************************************************************************
*   Copyright (c) 2016 &lt;mario52&gt;                                          *
*                                                                         *
*   This file is a supplement to the FreeCAD CAx development system.      *
*                                                                         *
*   This program is free software; you can redistribute it and/or modify  *
*   it under the terms of the GNU Lesser General Public License (LGPL)    *
*   as published by the Free Software Foundation; either version 2 of     *
*   the License, or (at your option) any later version.                   *
*   for detail see the LICENCE text file.                                 *
*                                                                         *
*   This software is distributed in the hope that it will be useful,      *
*   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
*   GNU Library General Public License for more details.                  *
*                                                                         *
*   You should have received a copy of the GNU Library General Public     *
*   License along with this macro; if not, write to the Free Software     *
*   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  *
*   USA                                                                   *
***************************************************************************
*           WARNING! All changes in this file will be lost and            *  
*                  may cause malfunction of the program                   *
***************************************************************************
"""
# https://forum.freecad.org/viewtopic.php?f=22&amp;t=9215
# FCInfoToMouse

__title__   = "FCInfoToMouse"
__author__  = "Mario52"
__url__     = "https://wiki.freecad.org/Macro_FCInfoToMouse"
__version__ = "00.04"
__date__    = "27/03/2018"
#
import Draft, Part
import math,FreeCAD
from FreeCAD import Base
import time
App = FreeCAD

global arrondi   &nbsp;; arrondi    = 4

global objectAnn &nbsp;; objectAnn  = "" 
global positionX1&nbsp;; positionX1 = 0.0
global positionY1&nbsp;; positionY1 = 0.0
global positionZ1&nbsp;; positionZ1 = 0.0
global force     &nbsp;; force      = 0
global hidden    &nbsp;; hidden     = 0
global coorBegin &nbsp;; coorBegin  = ""
global pas       &nbsp;; pas        = 0

global spreadSheet; spreadSheet= 0
global compteur  &nbsp;; compteur   = 0 
global spread    &nbsp;; spread     = ""

from math import sqrt, pi, sin, cos, asin, acos, atan, atan2, degrees

def angle2(vecteur_x1,vecteur_y1,vecteur_x2,vecteur_y2,mode):   #tester getAngle ( Vector )
# calcul de l'inclinaison d'une ligne a partir de deux Vecteurs
# si "mode" = 1 alors affichage en degres sinon en radian
    try:
        deltaX = vecteur_x2 - vecteur_x1
        deltaY = vecteur_y2 - vecteur_y1
        if mode ==1:
            angle = degrees(atan2(float(deltaY),float(deltaX))) # degres  (mode = 1)
        else:
            angle = atan2(float(deltaY),float(deltaX))          # radian  (mode = 0)
        return round(angle,arrondi)
    except Exception:
        None

def sub(first, other): 
	"sub(Vector,Vector) - subtracts second vector from first one"
	if isinstance(first,FreeCAD.Vector) and isinstance(other,FreeCAD.Vector):
		return FreeCAD.Vector(first.x-other.x, first.y-other.y, first.z-other.z)

def length(first):
	"lengh(Vector) - gives vector length"
	if isinstance(first,FreeCAD.Vector):
		return math.sqrt(first.x*first.x + first.y*first.y + first.z*first.z)

def dist(first, other):
	"dist(Vector,Vector) - returns the distance between both points/vectors"
	if isinstance(first,FreeCAD.Vector) and isinstance(other,FreeCAD.Vector):
		return length(sub(first,other))

def codeColor(color):
    try:
        rgb = float((float(color)/255.0))
    except Exception:
        rgb = 0.0
    return rgb


doc = FreeCAD.ActiveDocument    
if doc == None:
    doc = FreeCAD.newDocument()

# for modify the configuration&nbsp;: line 104 to 122
# PS: if DisplayMode = "Line" and Frame = False the annotation is transparent
#
##### Configuration  Modify here # Begin #######################################
                                                                               #
#BackgroundColor&nbsp;:                                                             #
red_B           = 0.0                # 0.0 to 255.0                            #
green_B         = 84.0               # 0.0 to 255.0                            #
blue_B          = 255.0              # 0.0 to 255.0                            #
                                                                               #
displayMode     = "Line"             # "Line" or "Object"                      #
fontName        = "MS Shell Dlg 2"   # "MS Shell Dlg 2" for Windows            #
fontSize        = 8.0                # Font size                               #
frame           = False              # "False" or "True"                       #
justification   = "Left"             # "Left", "Right", "Center"               #
                                                                               #
#TextColor      &nbsp;:                                                             #
red_T           = 255.0              # 0.0 to 255.0                            #
green_T         = 255.0              # 0.0 to 255.0                            #
blue_T          = 255.0              # 0.0 to 255.0                            #
                                                                               #
##### Configuration  End End ###################################################

v=Gui.activeDocument().activeView()
objectAnn = App.ActiveDocument.addObject("App::AnnotationLabel","FCInfoToMouse")# create work annotation
objectAnn.LabelText=["Hello FreeCAD World"]

FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).BackgroundColor = (codeColor(red_B),codeColor(green_B),codeColor(blue_B))   #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).DisplayMode     = displayMode                                               #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).FontName        = fontName                                                  #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).FontSize        = fontSize                                                  #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).Frame           = frame                                                     #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).Justification   = justification                                             #
FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).TextColor       = (codeColor(red_T),codeColor(green_T),codeColor(blue_T))   #

import os, sys, platform
global PolicePath;    PolicePath = ""

#if platform.system() == "Windows"&nbsp;:
#    PolicePath = "C:/Windows/Fonts/ARIAL.TTF"
#elif platform.system() == "Linux"&nbsp;:
#    PolicePath = "/usr/share/fonts/truetype/ubuntu-font-family/Ubuntu-M.ttf"
#elif platform.system() == "Darwin":
#    PolicePath = "/Library/Fonts/Arial.ttf"
#else:
#    PolicePath = "C:/Windows/Fonts/ARIAL.TTF"

p=FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Mod/Draft")
PolicePath = p.GetString("FontFile")

class ViewObserver:
    def __init__(self, view):
       self.view = view

    def logPosition(self, info):
        global objectAnn
        global positionX1, positionY1, positionZ1
        global pas, arrondi
        global coorBegin
        global force
        global hidden
        global PolicePath
        global spreadSheet
        global compteur
        global spread

######## for testing key ############
#        try:                       #
#            print info["Key"]      #
#            print info["State"]    #
##            print ord(info["Key"]) #
#        except Exception:          #
#            None                   #
#####################################

        Button1 = 0

        try:
            if (info["Key"] == "Q") and (info["State"] == "DOWN"):                        # SHIFT + Q for quit
                v.removeEventCallback("SoEvent",c)                                        # close event observation
                FreeCAD.Console.PrintMessage( "End FCInfoToMouse" + "\n")
        except Exception:
            None

        try:
            if (info["Key"] == "M") and (info["State"] == "DOWN"):                        # SHIFT + M for force display
                if force == 0:
                    force = 1
                    FreeCAD.Console.PrintMessage( "Forced " + "\n")
                elif force == 1:
                    force = 2
                    FreeCAD.Console.PrintMessage( "Single " + "\n")
                elif force == 2:
                    force = 0
                    FreeCAD.Console.PrintMessage( "Normal " + "\n")
        except Exception:
            None

        try:
            if (info["Key"] == "C") and (info["State"] == "DOWN"):                        # SHIFT + C for hidden / visible annotation OK
                if hidden == 0:
                    hidden = 1
                    FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).Visibility = False
                    FreeCAD.Console.PrintMessage( "concealed " + "\n")
                else:
                    hidden = 0
                    FreeCADGui.getDocument(doc.Name).getObject(objectAnn.Label).Visibility = True
                    FreeCAD.Console.PrintMessage( "visible " + "\n")
        except Exception:
            None

        try:
            if (info["Key"] == "D") and (info["State"] == "DOWN"):                        # SHIFT + S for Open spreadSheet
                if spreadSheet == 0:
                    #spread = FreeCAD.ActiveDocument.getObjectsByLabel(spread.Name)[0]    # for append in existant SpreadSheet
                    spread = App.activeDocument().addObject('Spreadsheet::Sheet','MySpreedSheett')
                    spreadSheet = 1
                    FreeCAD.Console.PrintMessage("SpreadSheet open&nbsp;: " + spread.Name + "\n")
                else:
                    spreadSheet = 0
                    FreeCAD.Console.PrintMessage("SpreadSheet closed" + "\n")
                compteur    = 0
        except Exception:
            None

        try:
            object2 = ""
            object = v.getObjectInfo(v.getCursorPos())                                    # here for object preselected
            object2 = object["Object"] + "." + object["Component"]                        # object + component
            pnt = FreeCAD.Vector(float(object["x"]),float(object["y"]),float(object["z"]))# vector on position mouse to object
#            print "pnt ",pnt
        except Exception:
            pos = info["Position"]                                                        # if mouse in 3D view
            pnt = self.view.getPoint(pos)                                                 # vector detect on mouse position 3D view
#            print "pnt ",pnt

        try:
            if (info["Button"] == "BUTTON1") and (info["State"] == "DOWN"):               # coordinates clic to mouse
                positionX1 = round(pnt[0],arrondi)
                positionY1 = round(pnt[1],arrondi)
                positionZ1 = round(pnt[2],arrondi)
                
                coorBegin = ""
                coorBegin = "X1: "+str(positionX1)+"  Y1: "+str(positionY1)+"  Z1: "+str(positionZ1)
                if pas == 0:
                    pas = 1
                else:
                    pas = 0

                try:                                                   # spreadSheet
                    if spreadSheet == 1:
                        compteur += 1
                        spread.set("A"+str(compteur) ,  str(positionX1) + ", " + str(positionY1) + ", " + str(positionZ1))
                        spread.set("B"+str(compteur) ,  str(positionX1))
                        spread.set("C"+str(compteur) ,  str(positionY1))
                        spread.set("D"+str(compteur) ,  str(positionZ1))
                        App.ActiveDocument.recompute()
                        FreeCAD.Console.PrintMessage(str(compteur) + "&nbsp;: " +  str(positionX1) + ", " + str(positionY1) + ", " + str(positionZ1) + "\n")
                except Exception:
                    None
                
        except Exception:
            None

        try:
            objectAnn.BasePosition = (pnt[0], pnt[1], pnt[2])
            if force == 2:
                objectAnn.LabelText = ["X: " + str(round(pnt[0],arrondi)) + " Y: " + str(round(pnt[1],arrondi)) + " Z: " + str(round(pnt[2],arrondi))]
            else:
                if ((pas == 1) or (force == 1)):
                    coorEnd = longueur = angles = ""
                    coorEnd = "X2: " + str(round(pnt[0],arrondi)) + "  Y2: " + str(round(pnt[1],arrondi)) + "  Z2: " + str(round(pnt[2],arrondi))
                    longueur = "L: " + str(round(dist(FreeCAD.Vector(positionX1,positionY1,positionZ1), FreeCAD.Vector(pnt[0], pnt[1], pnt[2])),12)) # around to 12 decimales
                    alphaXY = alphaXY = alphaXZ = 0.0
                    alphaXY = str(round(angle2(positionX1,positionY1,pnt[0],pnt[1],1),arrondi))
                    alphaYZ = str(round(angle2(positionY1,positionZ1,pnt[1],pnt[2],1),arrondi))
                    alphaXZ = str(round(angle2(positionX1,positionZ1,pnt[0],pnt[2],1),arrondi))
        
                    angles = "XY: " + alphaXY + unichr(176) + "  YZ: " + alphaYZ + unichr(176) + "  XZ: " + alphaXZ + unichr(176)    # unichr(176) = degrees character
        
                    if object2 == "":
                        objectAnn.LabelText = [coorBegin, coorEnd, longueur, angles,]
                    else:
                        objectAnn.LabelText = [object2, coorBegin, coorEnd, longueur, angles,]
                else:
                    if object2 == "":
                        objectAnn.LabelText = ["X: " + str(round(pnt[0],arrondi)) + " Y: " + str(round(pnt[1],arrondi)) + " Z: " + str(round(pnt[2],arrondi)),]
                    else:
                        objectAnn.LabelText = [object2, "X: " + str(round(pnt[0],arrondi)) + " Y: " + str(round(pnt[1],arrondi)) + " Z: " + str(round(pnt[2],arrondi))]

        except Exception:
            FreeCAD.Console.PrintError("End FCInfoToMouse by an error" + "\n")
            v.removeEventCallback("SoEvent",c)                                            # close event observation

##### Begin ######
FreeCAD.Console.PrintMessage("__Welcome to FCInfoToMouse__" + "\n")
FreeCAD.Console.PrintMessage("SHIFT + Q&nbsp;: for quit" + "\n")
FreeCAD.Console.PrintMessage("SHIFT + M&nbsp;: for force display, mode single, mode normal" + "\n")
FreeCAD.Console.PrintMessage("SHIFT + C&nbsp;: for concealed / visible" + "\n")
FreeCAD.Console.PrintMessage("SHIFT + D&nbsp;: for create spreadSheet / close spreadSheet" + "\n")
FreeCAD.Console.PrintMessage("____________________________" + "\n")

pas = 0
o = ViewObserver(v)
try:
    c = v.addEventCallback("SoEvent",o.logPosition)
except Exception:
    App.ActiveDocument.removeObject(objectAnn.Label)
    FreeCAD.Console.PrintMessage( "Not GUI End FCInfoToMouse" + "\n")</pre>
<p>or to Gists <a rel="nofollow" class="external text" href="https://gist.github.com/mario52a/974214c4b83beaa41495">Macro_FCInfoToMouse.FCMacro</a> or the zip <a rel="nofollow" class="external text" href="https://gist.github.com/mario52a/974214c4b83beaa41495/archive/d62630049d4663369fc80519a7655ee4c32c8711.zip">Macro_FCInfoToMouse.FCMacro.zip</a>
</p><p><span id="Limitation"></span>
</p>
<h2><span class="mw-headline" id="Limitazioni">Limitazioni</span></h2>
<p>&Egrave; possibile che la macro non riconosca alcuni tasti
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Links">Links</span></h2>
</div>
<h2><span class="mw-headline" id="Link">Link</span></h2>
<p>La discussione nel forum <a rel="nofollow" class="external text" href="http://forum.freecad.org/viewtopic.php?f=3&amp;t=13592">From autocad to freecad</a>
</p><p>Le mie macro in <a rel="nofollow" class="external text" href="https://gist.github.com/mario52a">mario52a </a> gists
</p><p><span id="Version"></span>
</p>
<h2><span class="mw-headline" id="Versione">Versione</span></h2>
<p>27/03/2018 ver 00.04&nbsp;: aggiungi funzione "Salva la coordinata in un tasto spreadSheet" D "flip/flop on, off
</p><p>24/01/2016 ver 00.03&nbsp;: add section configuration and replace key "C" to "M"
</p><p>23/01/2016 ver 00.02&nbsp;: add function "single", replace key "H" to "C" and correct bug
</p><p>02/01/2016&nbsp;: ver 0.1
</p>
<!-- 
NewPP limit report
Cached time: 20251009172102
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.095 seconds
Real time usage: 0.114 seconds
Preprocessor visited node count: 277/1000000
Post&#8208;expand include size: 6910/2097152 bytes
Template argument size: 16274/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 18172/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   15.427      1 -total
 21.66%    3.341      2 Template:Code
 16.49%    2.544      1 Template:Codeextralink
 13.48%    2.079      1 Template:Macro/it
 12.05%    1.860     12 Template:KEY
 11.04%    1.703      1 Template:MacroCode
  9.02%    1.391      1 Template:Caption
  6.78%    1.046      2 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:63220-0!canonical and timestamp 20251009172102 and revision id 1659827. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>