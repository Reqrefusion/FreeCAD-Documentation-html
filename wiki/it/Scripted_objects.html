<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Scripted objects/it</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../id/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (1% translated)" lang="id" dir="ltr">Bahasa Indonesia</a></li>
<li><a href="../de/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--complete" title="Skriptgenerierte Objekte (80% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Scripted_objects.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Scripted objects (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../tr/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (1% translated)" lang="tr" dir="ltr">T&uuml;rk&ccedil;e</a></li>
<li><a href="../es/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (5% translated)" lang="es" dir="ltr">espa&ntilde;ol</a></li>
<li><a href="../fr/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--complete" title="Objets cr&eacute;&eacute;s par script (97% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--complete" title="Obiekty tworzone skryptami (97% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="../pt/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (1% translated)" lang="pt" dir="ltr">portugu&ecirc;s</a></li>
<li><a href="../pt-br/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Objetos com Script (3% translated)" lang="pt-BR" dir="ltr">portugu&ecirc;s do Brasil</a></li>
<li><a href="../ro/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Obiecte create prin script-programare (8% translated)" lang="ro" dir="ltr">rom&acirc;n&#259;</a></li>
<li><a href="../fi/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (1% translated)" lang="fi" dir="ltr">suomi</a></li>
<li><a href="../sv/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Scripted objects (5% translated)" lang="sv" dir="ltr">svenska</a></li>
<li><a href="../cs/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="Skriptovan&eacute; objekty (5% translated)" lang="cs" dir="ltr">&#269;e&scaron;tina</a></li>
<li><a href="../ru/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--med" title="&#1055;&#1088;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1080;&#1088;&#1091;&#1077;&#1084;&#1099;&#1077; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1099; (41% translated)" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a></li>
<li><a href="../zh-cn/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="&#33050;&#26412;&#21270;&#29289;&#20307; (4% translated)" lang="zh-Hans-CN" dir="ltr">&#20013;&#25991;&#65288;&#20013;&#22269;&#22823;&#38470;&#65289;</a></li>
<li><a href="../ja/Scripted_objects.html" class="mw-pt-progress mw-pt-progress--stub" title="&#12473;&#12463;&#12522;&#12503;&#12488;&#12395;&#12424;&#12427;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#29983;&#25104; (1% translated)" lang="ja" dir="ltr">&#26085;&#26412;&#35486;</a></li></ul></div>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
    <div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16"></span></span> <a href="../it/Topological_data_scripting.html" title="Topological data scripting/it">Script di dati topologici</a></div>
    <div style="margin: 4px 0; float: right;"><a href="../it/Scenegraph.html" title="Scenegraph/it">Scena grafica</a>
 <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-right.svg" decoding="async" width="16" height="16"></span></span></div>
    <div style="text-align:center"><a href="../it/Online_Help_Toc.html" title="Online Help Toc/it">Indice</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24"></span></span></div>
</div>
<div style="clear:right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none;"><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduzione"><span class="tocnumber">1</span> <span class="toctext">Introduzione</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Esempio_di_base"><span class="tocnumber">2</span> <span class="toctext">Esempio di base</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Cose_da_notare"><span class="tocnumber">2.1</span> <span class="toctext">Cose da notare</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Un_altro_esempio_pi%C3%B9_complesso"><span class="tocnumber">3</span> <span class="toctext">Un altro esempio pi&ugrave; complesso</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Rendere_gli_oggetti_selezionabili"><span class="tocnumber">4</span> <span class="toctext">Rendere gli oggetti selezionabili</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Lavorare_con_forme_semplici"><span class="tocnumber">5</span> <span class="toctext">Lavorare con forme semplici</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Struttura_di_Scenegraph"><span class="tocnumber">6</span> <span class="toctext">Struttura di Scenegraph</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Oggetti_con_script_di_Part_Design"><span class="tocnumber">7</span> <span class="toctext">Oggetti con script di Part Design</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Tipi_di_oggetti_disponibili"><span class="tocnumber">8</span> <span class="toctext">Tipi di oggetti disponibili</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Metodi_disponibili"><span class="tocnumber">9</span> <span class="toctext">Metodi disponibili</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Propriet%C3%A0_disponibili"><span class="tocnumber">10</span> <span class="toctext">Propriet&agrave; disponibili</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Attributi_della_propriet%C3%A0"><span class="tocnumber">10.1</span> <span class="toctext">Attributi della propriet&agrave;</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Estensioni_disponibili"><span class="tocnumber">11</span> <span class="toctext">Estensioni disponibili</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Ulteriori_informazioni"><span class="tocnumber">12</span> <span class="toctext">Ulteriori informazioni</span></a></li>
</ul>
</div>
</div>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Introduzione">Introduzione</span></h2>
<p>Oltre ai tipi di oggetti standard, come le Annotazioni, gli oggetti Mesh e gli oggetti Parte, FreeCAD offre anche la straordinaria possibilit&agrave; di costruire al 100% oggetti parametrici in script di Python, chiamati <a href="../it/App_FeaturePython.html" title="App FeaturePython/it">Python Features</a> (<i>Caratteristiche</i> Python). Questi oggetti si comportano esattamente come un qualsiasi altro oggetto di FreeCAD, e sono salvati e ripristinati automaticamente con salva/apri il file.
</p><p>Una particolarit&agrave; deve essere compresa: per motivi di sicurezza, i file di FreeCAD non contengono mai alcun codice incorporato. Il codice Python che scrivi per creare oggetti parametrici non viene mai salvato all'interno di un file. Ci&ograve; significa che se apri un file contenente tale oggetto su un'altra macchina, e quel codice Python non &egrave; disponibile su quella macchina, l'oggetto non verr&agrave; completamente ricreato. Se distribuisci tali oggetti ad altri, dovrai distribuire anche il tuo script Python, ad esempio come <a href="../it/Macros.html" title="Macros/it">Macro</a>.
</p><p><b>Nota</b>: &egrave; possibile impacchettare il codice Python all'interno di un file FreeCAD utilizzando la serializzazione json con un App::PropertyPythonObject, ma quel codice non pu&ograve; mai essere eseguito direttamente, e quindi ha poca utilit&agrave; per il nostro scopo qui.
</p><p>Le <a href="../it/App_FeaturePython.html" title="App FeaturePython/it">Python Features</a> seguono le stesse regole di tutte le altre funzionalit&agrave; di FreeCAD: sono divise in una parte App e una parte GUI. La parte App, cio&egrave; il Document Object (oggetto del documento), definisce la geometria dell'oggetto, mentre la sua parte grafica, cio&egrave; il View Provider Object (fornitore della vista dell'oggetto), definisce come l'oggetto viene disegnato sullo schermo. Il View Provider Object, come qualsiasi altro elemento di FreeCAD, &egrave; disponibile solo quando si esegue FreeCAD nella sua GUI (interfaccia grafica). Per costruire il proprio oggetto, sono disponibili diversi metodi e propriet&agrave;. La Propriet&agrave; deve essere una  qualsiasi dei tipi di propriet&agrave; predefinite che FreeCAD mette a disposizione. Le propriet&agrave; disponibili sono quelle che appaiono nella finestra di visualizzazione delle propriet&agrave; per consentire all'utente di modificarle. Con questa procedura, gli oggetti FeaturePython sono realmente e totalmente parametrici. E' possibile definire separatamente le propriet&agrave; per l'oggetto e per la sua ViewObject (rappresentazione).
</p><p><span id="Basic_example"></span>
</p>
<h2><span class="mw-headline" id="Esempio_di_base">Esempio di base</span></h2>
<p>L'esempio seguente si trova nel file <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py">src/Mod/TemplatePyMod/FeaturePython.py</a>, con molti altri esempi:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="sd">'''Examples for a feature class and its view provider.'''</span>

<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Box</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Add some custom properties to our box feature'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Width"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Width of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Height"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Height of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Do something when a property has changed'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''Do something when doing a recomputation, this method is mandatory'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Recompute Python Box feature</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderBox</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Set this object to the proxy object of the actual view provider'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyColor"</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Color of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Color</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Setup the scene sub-graph of the view provider, this method is mandatory'''</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoScale</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>

        <span class="n">data</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoCube</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="p">,</span> <span class="s2">"Shaded"</span><span class="p">);</span>
        <span class="n">style</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
        <span class="n">style</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="p">,</span> <span class="s2">"Wireframe"</span><span class="p">);</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onChanged</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''If a property of the handled feature has changed we have the chance to handle this here'''</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Length"</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Width"</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Height"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="o">.</span><span class="n">scaleFactor</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">h</span><span class="p">))</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Return a list of display modes.'''</span>
        <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modes</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the name of the default display mode. It must be defined in getDisplayModes.'''</span>
        <span class="k">return</span> <span class="s2">"Shaded"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">'''Map the display mode defined in attach with those defined in getDisplayModes.\</span>
<span class="sd">                Since they have the same names nothing needs to be done. This method is optional'''</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Here we can do something when a single property got changed'''</span>
        <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Color"</span><span class="p">:</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">vp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Color"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the icon in XPM format which will appear in the tree view. This method is\</span>
<span class="sd">                optional and if not defined a default icon is shown.'''</span>
        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "   c None",</span>
<span class="s2">            ".  c #141010",</span>
<span class="s2">            "+  c #615BD2",</span>
<span class="s2">            "@  c #C39D55",</span>
<span class="s2">            "#  c #000000",</span>
<span class="s2">            "$  c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''When saving the document this object gets stored using Python's json module.\</span>
<span class="sd">                Since we have some un-serializable parts here -- the Coin stuff -- we must define this method\</span>
<span class="sd">                to return a tuple of all serializable objects or None.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">'''When restoring the serialized object from document we have the chance to set some internals here.\</span>
<span class="sd">                Since no data were serialized nothing needs to be done here.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeBox</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">)</span>
    <span class="n">Box</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ViewProviderBox</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>

<span class="n">makeBox</span><span class="p">()</span>
</pre></div>
<p><span id="Things_to_note"></span>
</p>
<h3><span class="mw-headline" id="Cose_da_notare">Cose da notare</span></h3>
<p>Se il tuo oggetto si basa sul ricalcolo non appena viene creato, devi farlo manualmente nella funzione <code>__init__</code> poich&eacute; non viene chiamato automaticamente. Questo esempio non lo richiede, perch&eacute; il metodo <code>onChanged</code> della classe <code>Box</code> ha lo stesso effetto della funzione <code>execute</code>, ma gli esempi seguenti si basano sull'essere ricalcolati prima che qualsiasi cosa venga visualizzata nella vista 3D. Negli esempi, questo viene fatto manualmente con <code>ActiveDocument.recompute()</code>, ma in scenari pi&ugrave; complessi devi decidere dove ricalcolare l'intero documento o l'oggetto FeaturePython.
</p><p>Questo esempio produce una serie di analisi dello stack di eccezioni nella finestra di visualizzazione del report. Questo perch&eacute; il metodo <code>onChanged</code> della classe <code>Box</code> viene chiamato ogni volta che viene aggiunta una propriet&agrave; in <code>__init__</code>. Quando viene aggiunta la prima, le propriet&agrave; Width e Height non esistono ancora e quindi il tentativo di accedervi fallisce.
</p><p>Una spiegazione di <code>__getstate__</code> e <code>__setstate__</code> che sono stati sostituiti da <code>dumps</code> e <code>loads</code> &egrave; nel thread del forum <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=18&amp;t=44009&amp;start=10#p377892">obj.Proxy.Type &egrave; un dizionario, non una stringa</a>.
</p><p><code>obj.addProperty(...)</code> restituisce <code>obj</code>, in modo che il valore della propriet&agrave; possa essere impostato sulla stessa riga:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
<p>Che equivale a:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span> <span class="s2">"Length"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">,</span> <span class="s2">"Length of the box"</span><span class="p">)</span>
<span class="n">obj</span><span class="o">.</span><span class="n">Length</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
<p><span id="Other_more_complex_example"></span>
</p>
<h2><span id="Un_altro_esempio_pi.C3.B9_complesso"></span><span class="mw-headline" id="Un_altro_esempio_pi&ugrave;_complesso">Un altro esempio pi&ugrave; complesso</span></h2>
<div class="mw-translate-fuzzy">
<p>In questo esempio si utilizza il Modulo <a href="../it/Part_Workbench.html" title="Part Workbench/it">Part</a> per creare un ottaedro, quindi si crea la sua rappresentazione Coin con Pivy.
</p>
</div>
<p>Prima si crea l'oggetto del documento:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="kn">import</span> <span class="nn">pivy</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Octahedron</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Add some custom properties to our box feature"</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Length"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Length of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Length</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Width"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Width of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Width</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Height"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span> <span class="s2">"Height of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span><span class="o">=</span><span class="mf">1.0</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"Part::PropertyPartShape"</span><span class="p">,</span><span class="s2">"Shape"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span> <span class="s2">"Shape of the octahedron"</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
     <span class="c1"># Define six vetices for the shape</span>
     <span class="n">v1</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v2</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v3</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v4</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
     <span class="n">v5</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">v6</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">Width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

     <span class="c1"># Make the wires/faces</span>
     <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v4</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v5</span><span class="p">)</span>
     <span class="n">f5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v4</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v3</span><span class="p">,</span><span class="n">v4</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">f8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_face</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v6</span><span class="p">)</span>
     <span class="n">shell</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeShell</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">,</span><span class="n">f4</span><span class="p">,</span><span class="n">f5</span><span class="p">,</span><span class="n">f6</span><span class="p">,</span><span class="n">f7</span><span class="p">,</span><span class="n">f8</span><span class="p">])</span>
     <span class="n">solid</span><span class="o">=</span><span class="n">Part</span><span class="o">.</span><span class="n">makeSolid</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
     <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">solid</span>

  <span class="c1"># helper mehod to create the faces</span>
  <span class="k">def</span> <span class="nf">make_face</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">):</span>
     <span class="n">wire</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makePolygon</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">,</span><span class="n">v1</span><span class="p">])</span>
     <span class="n">face</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">Face</span><span class="p">(</span><span class="n">wire</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">face</span>
</pre></div>
<p>In seguito si crea il fornitore della vista dell'oggetto (view provider object), responsabile di mostrare l'oggetto nella scena 3D:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ViewProviderOctahedron</span><span class="p">:</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Set this object to the proxy object of the actual view provider"</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyColor"</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">,</span><span class="s2">"Color of the octahedron"</span><span class="p">)</span><span class="o">.</span><span class="n">Color</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Setup the scene sub-graph of the view provider, this method is mandatory"</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoScale</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoBaseColor</span><span class="p">()</span>

     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoIndexedFaceSet</span><span class="p">()</span>

     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shaded</span><span class="p">,</span><span class="s2">"Shaded"</span><span class="p">);</span>
     <span class="n">style</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
     <span class="n">style</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="p">)</span>
     <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span><span class="p">,</span><span class="s2">"Wireframe"</span><span class="p">);</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">onChanged</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="s2">"Color"</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
     <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
     <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
     <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Shape"</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Shape"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setNum</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">Vertexes</span><span class="p">:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">Z</span><span class="p">)</span>
           <span class="n">cnt</span><span class="o">=</span><span class="n">cnt</span><span class="o">+</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">face</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
     <span class="s2">"Return a list of display modes."</span>
     <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
     <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
     <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">modes</span>

  <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="s2">"Return the name of the default display mode. It must be defined in getDisplayModes."</span>
     <span class="k">return</span> <span class="s2">"Shaded"</span>

  <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
     <span class="k">return</span> <span class="n">mode</span>

  <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
     <span class="s2">"Here we can do something when a single property got changed"</span>
     <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintMessage</span><span class="p">(</span><span class="s2">"Change property: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
     <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"Color"</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">vp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"Color"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">        /* XPM */</span>
<span class="s2">        static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">        "16 16 6 1",</span>
<span class="s2">        "    c None",</span>
<span class="s2">        ".   c #141010",</span>
<span class="s2">        "+   c #615BD2",</span>
<span class="s2">        "@   c #C39D55",</span>
<span class="s2">        "#   c #000000",</span>
<span class="s2">        "$   c #57C355",</span>
<span class="s2">        "        ........",</span>
<span class="s2">        "   ......++..+..",</span>
<span class="s2">        "   .@@@@.++..++.",</span>
<span class="s2">        "   .@@@@.++..++.",</span>
<span class="s2">        "   .@@  .++++++.",</span>
<span class="s2">        "  ..@@  .++..++.",</span>
<span class="s2">        "###@@@@ .++..++.",</span>
<span class="s2">        "##$.@@$#.++++++.",</span>
<span class="s2">        "#$#$.$$$........",</span>
<span class="s2">        "#$$#######      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        "#$$#$$$$$#      ",</span>
<span class="s2">        " #$#$$$$$#      ",</span>
<span class="s2">        "  ##$$$$$#      ",</span>
<span class="s2">        "   #######      "};</span>
<span class="s2">        """</span>

  <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">return</span> <span class="kc">None</span>

  <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
     <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>Infine, dopo che l'oggetto e il suo visualizzatore sono definiti, basta solo chiamarli (La classe Octahedron e il codice della classe viewprovider possono essere copiati direttamente nella console Python di FreeCAD)::
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span><span class="s2">"Octahedron"</span><span class="p">)</span>
<span class="n">Octahedron</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ViewProviderOctahedron</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
</pre></div>
<p><span id="Making_objects_selectable"></span>
</p>
<h2><span class="mw-headline" id="Rendere_gli_oggetti_selezionabili">Rendere gli oggetti selezionabili</span></h2>
<p>Se volete rendere il vostro oggetto selezionabile, o almeno una parte di esso, facendo clic su di esso nella finestra, &egrave; necessario includere la sua geometria Coin all'interno di un nodo SoFCSelection. Se l'oggetto ha una rappresentazione complessa, con widget, annotazioni, etc, si potrebbe voler includere solo una parte di esso in un SoFCSelection. Tutto quello che compone un SoFCSelection viene costantemente analizzato da FreeCAD per rilevare selezioni/preselezioni, quindi non ha senso sovraccaricarlo con delle scansioni non necessarie.
</p>
<div class="mw-translate-fuzzy">
<p>Una volta che le parti dello scenegraph, che devono essere selezionabili, si trovano all'interno dei nodi SoFCSelection, &egrave; necessario fornire due metodi per gestire il percorso di selezione. Il percorso di selezione pu&ograve; assumere la forma di una stringa che fornisce i nomi di ciascun elemento nel percorso o di un array di oggetti scenegraph. I due metodi che fornisci sono <code>getDetailPath</code>, che converte da un percorso stringa in un array di oggetti scenegraph, e <code>getElementPicked</code>, che prende un elemento su cui &egrave; stato fatto clic nello scenegraph e restituisce il suo nome di stringa (nota, non il suo percorso di stringa).
</p>
</div>
<p>Ecco l'esempio della molecola sopra, adattato per rendere selezionabili gli elementi della molecola:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">Molecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Add two point properties '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span> <span class="ow">or</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="sd">''' Print the name of the property that has changed '''</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">''' Print a short message when doing a recomputation, this method is mandatory '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderMolecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="n">sep1</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
        <span class="n">sel1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="c1"># sel1.policy.setValue(coin.SoSelection.SHIFT)</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span>
        <span class="n">sep1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sel1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoTranslation</span><span class="p">()</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="p">)</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSphere</span><span class="p">())</span>
        <span class="n">sep2</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSeparator</span><span class="p">()</span>
        <span class="n">sel2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">ref</span><span class="p">()</span>
        <span class="n">sep2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sel2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="o">=</span><span class="n">coin</span><span class="o">.</span><span class="n">SoTranslation</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="p">)</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">coin</span><span class="o">.</span><span class="n">SoSphere</span><span class="p">())</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">RootNode</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sep1</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">RootNode</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">sep2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateData</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="s1">'p2'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel1</span> <span class="o">=</span> <span class="n">sel1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel2</span> <span class="o">=</span> <span class="n">sel2</span>

    <span class="k">def</span> <span class="nf">getDetailPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span>
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">RootNode</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="p">)</span>

            <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">whichChild</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">splitSubname</span><span class="p">(</span><span class="n">subname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom1'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom2'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">getElementPicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom1'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom2'</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p1"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trl1</span><span class="o">.</span><span class="n">translation</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p2"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trl2</span><span class="o">.</span><span class="n">translation</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeMolecule</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Molecule"</span><span class="p">)</span>
    <span class="n">Molecule</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">ViewProviderMolecule</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><span id="Working_with_simple_shapes"></span>
</p>
<h2><span class="mw-headline" id="Lavorare_con_forme_semplici">Lavorare con forme semplici</span></h2>
<p>Se l'oggetto parametrico produce semplicemente una forma, non &egrave; necessario utilizzare un fornitore di vista dell'oggetto (view provider object). La forma viene visualizzata utilizzando la rappresentazione della forma standard di FreeCAD:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="kn">import</span> <span class="nn">Part</span>
<span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''"App two point properties" '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''"Print a short message when doing a recomputation, this method is mandatory" '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span>
<span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="o">.</span><span class="n">Proxy</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># just set it to something different from None (this assignment is needed to run an internal notification)</span>
<span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p>Lo stesso codice con l'uso di <b>ViewProviderLine</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">FreeCAD</span> <span class="k">as</span> <span class="nn">App</span>
<span class="kn">import</span> <span class="nn">FreeCADGui</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span>
<span class="kn">import</span> <span class="nn">Part</span>

<span class="k">class</span> <span class="nc">Line</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
         <span class="sd">'''"App two point properties" '''</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
         <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">'''"Print a short message when doing a recomputation, this method is mandatory" '''</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeLine</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">p1</span><span class="p">,</span><span class="n">fp</span><span class="o">.</span><span class="n">p2</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ViewProviderLine</span><span class="p">:</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
      <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
      <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

   <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">''' Return the name of the default display mode. It must be defined in getDisplayModes. '''</span>
      <span class="k">return</span> <span class="s2">"Flat Lines"</span>

<span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"Part::FeaturePython"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">)</span>
<span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">ViewProviderLine</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
<span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
</pre></div>
<p><span id="Scenegraph_Structure"></span>
</p>
<h2><span class="mw-headline" id="Struttura_di_Scenegraph">Struttura di Scenegraph</span></h2>
<p>Potresti aver notato che gli esempi sopra costruiscono i loro scenegraphs in modi leggermente diversi. Alcuni usano <code>obj.addDisplayMode(node, "modename")</code> mentre altri usano <code>obj.SwitchNode.getChild(x).addChild(y)</code>.
</p><p>Ogni caratteristica in un documento di FreeCAD si basa sulla seguente struttura di scenegraph:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">RootNode</span>
 \<span class="o">-</span> <span class="n">SwitchNode</span>
     \<span class="o">-</span> <span class="n">Shaded</span>
      <span class="o">-</span> <span class="n">Wireframe</span>
      <span class="o">-</span> <span class="n">etc</span>
</pre></div>
<p><code>SwitchNode</code> mostra solo uno dei suoi figli, a seconda della modalit&agrave; di visualizzazione selezionata in FreeCAD.
</p><p>Gli esempi che utilizzano <code>addDisplayMode</code> stanno costruendo i loro scenegraph esclusivamente dagli elementi dello scenegraph di coin3d. Dietro le quinte, <code>addDisplayMode</code> aggiunge un nuovo figlio a <code>SwitchNode</code>; il nome di quel nodo corrisponder&agrave; alla modalit&agrave; di visualizzazione, che &egrave; stata passata.
</p><p>Gli esempi che utilizzano <code>SwitchNode.getChild(x).addChild</code> costruiscono anche parte della loro geometria utilizzando le funzioni dell'ambiente Part, come <code>fp.Shape = Part.makeLine(fp.p1 ,fp.p2)</code>. Questo costruisce i diversi scenegraph della modalit&agrave; di visualizzazione sotto <code>SwitchNode</code>; quando in seguito arriveremo ad aggiungere elementi coin3d allo scenegraph, dobbiamo aggiungerli agli scenegraph della modalit&agrave; di visualizzazione esistenti usando <code>addChild</code> piuttosto che creare un nuovo figlio di <code>SwitchNode</code>.
</p><p>Quando si utilizza <code>addDisplayMode()</code> per aggiungere geometria allo scenegraph, ogni modalit&agrave; di visualizzazione dovrebbe avere il proprio nodo che viene passato a <code>addDisplayMode()</code>; non riutilizzare lo stesso nodo per questo. Ci&ograve; confonder&agrave; il meccanismo di selezione. Va bene se il nodo di ciascuna modalit&agrave; di visualizzazione ha gli stessi nodi geometrici aggiunti sotto di esso, solo la radice di ciascuna modalit&agrave; di visualizzazione deve essere distinta.
</p><p>Ecco l'esempio della molecola sopra, adattato per essere disegnato solo con oggetti scenegraph Coin3D invece di utilizzare oggetti dall'ambiente Part:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">Part</span>
<span class="kn">from</span> <span class="nn">pivy</span> <span class="kn">import</span> <span class="n">coin</span>

<span class="k">class</span> <span class="nc">Molecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Add two point properties '''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p1"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"Start point"</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyVector"</span><span class="p">,</span><span class="s2">"p2"</span><span class="p">,</span><span class="s2">"Line"</span><span class="p">,</span><span class="s2">"End point"</span><span class="p">)</span><span class="o">.</span><span class="n">p2</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="sd">''' Print a short message when doing a recomputation, this method is mandatory '''</span>
        <span class="k">pass</span>

<span class="k">class</span> <span class="nc">ViewProviderMolecule</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">''' Set this object to the proxy object of the actual view provider '''</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">material</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoMaterial</span><span class="p">()</span>
        <span class="n">material</span><span class="o">.</span><span class="n">diffuseColor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">material</span><span class="o">.</span><span class="n">emissiveColor</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">drawStyle</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="p">()</span>
        <span class="n">drawStyle</span><span class="o">.</span><span class="n">pointSize</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">drawStyle</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoDrawStyle</span><span class="o">.</span><span class="n">LINES</span>
        <span class="n">wireframe</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">shaded</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wireframe</span> <span class="o">=</span> <span class="n">wireframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shaded</span> <span class="o">=</span> <span class="n">shaded</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoCoordinate3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">drawStyle</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">material</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">drawStyle</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">material</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel1</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedPointSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p1</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">sel1</span> <span class="o">+=</span> <span class="n">p1</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel1</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel2</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedPointSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p2</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sel2</span> <span class="o">+=</span> <span class="n">p2</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel2</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">g</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoGroup</span><span class="p">()</span>
        <span class="n">sel3</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoFCSelection'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">sel3</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">'EMISSIVE_DIFFUSE'</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="n">coin</span><span class="o">.</span><span class="n">SoType</span><span class="o">.</span><span class="n">fromName</span><span class="p">(</span><span class="s1">'SoIndexedLineSet'</span><span class="p">)</span><span class="o">.</span><span class="n">createInstance</span><span class="p">()</span>
        <span class="n">p3</span><span class="o">.</span><span class="n">coordIndex</span><span class="o">.</span><span class="n">setValues</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">sel3</span> <span class="o">+=</span> <span class="n">p3</span>
        <span class="n">g</span> <span class="o">+=</span> <span class="n">sel3</span>
        <span class="n">wireframe</span> <span class="o">+=</span> <span class="n">g</span>
        <span class="n">shaded</span> <span class="o">+=</span> <span class="n">g</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="n">wireframe</span><span class="p">,</span> <span class="s1">'Wireframe'</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addDisplayMode</span><span class="p">(</span><span class="n">shaded</span><span class="p">,</span> <span class="s1">'Shaded'</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sel1</span> <span class="o">=</span> <span class="n">sel1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel2</span> <span class="o">=</span> <span class="n">sel2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sel3</span> <span class="o">=</span> <span class="n">sel3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateData</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span> <span class="s1">'p2'</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getDetailPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">append</span><span class="p">):</span>
        <span class="n">vobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ViewObject</span>
        <span class="k">if</span> <span class="n">append</span><span class="p">:</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">RootNode</span><span class="p">)</span>
            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="p">)</span>

            <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">whichChild</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
            <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">"getDetailPath: mode </span><span class="si">{}</span><span class="s2"> is active</span><span class="se">\n</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mode</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">vobj</span><span class="o">.</span><span class="n">SwitchNode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">splitSubname</span><span class="p">(</span><span class="n">subname</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom1'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Atom2'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sub</span> <span class="o">==</span> <span class="s1">'Line'</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mode</span><span class="o">.</span><span class="n">getChild</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">getElementPicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="p">):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom1'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Atom2'</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">findNode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sel3</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">'Line'</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="s2">"If a property of the handled feature has changed we have the chance to handle this here"</span>
        <span class="c1"># fp is the handled feature, prop is the name of the property that has changed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructed</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p1"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p1"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop</span> <span class="o">==</span> <span class="s2">"p2"</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">getPropertyByName</span><span class="p">(</span><span class="s2">"p2"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">set1Value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">'Wireframe'</span><span class="p">,</span> <span class="s1">'Shaded'</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">'Shaded'</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">makeMolecule</span><span class="p">():</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">newDocument</span><span class="p">()</span>
    <span class="n">a</span><span class="o">=</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span><span class="s2">"Molecule"</span><span class="p">)</span>
    <span class="n">Molecule</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">b</span><span class="o">=</span><span class="n">ViewProviderMolecule</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
    <span class="n">a</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">recompute</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>

<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">makeMolecule</span><span class="p">()</span>
</pre></div>
<p><span id="Part_Design_scripted_objects"></span>
</p>
<h2><span class="mw-headline" id="Oggetti_con_script_di_Part_Design">Oggetti con script di Part Design</span></h2>
<p>Quando si creano oggetti con script in Part Design, il processo &egrave; simile agli oggetti con script discussi sopra, ma con alcune considerazioni aggiuntive. Dobbiamo gestire 2 propriet&agrave; della forma, una per la forma, che vediamo nella vista 3D e un'altra per la forma utilizzata dagli strumenti del modello, come le caratteristiche del modello polare. Le forme dell'oggetto devono anche essere fuse con qualsiasi materiale esistente gi&agrave; nel Corpo (o tagliate da esso nel caso di funzioni sottrattive). E dobbiamo tenere conto della collocazione e dell'attaccamento dei nostri oggetti in modo un po' diverso.
</p><p>Le feature di oggetti solidi con script di Part Design devono essere basate su PartDesign::FeaturePython, PartDesign::FeatureAdditivePython o PartDesign::FeatureSubtractivePython piuttosto che su Part::FeaturePython. Solo le varianti Additive e Subtractive possono essere utilizzate nelle feature di ripetizione e, se basate su Part::FeaturePython, quando l'utente rilascia l'oggetto in un Body di Part Design, diventa una BaseFeature invece di essere trattato dal Body come un oggetto di Part Design nativo. Nota: tutti questi dovrebbero essere solidi, quindi se stai creando una caratteristica non solida dovrebbe essere basata su Part::FeaturePython altrimenti la caratteristica successiva nell'albero tenter&agrave; di fondersi come un solido e fallir&agrave; .
</p><p>Di seguito &egrave; riportato un semplice esempio di creazione di una primitiva Tube, simile alla primitiva Tube nell'ambiente Part, tranne per il fatto che questa sar&agrave; un oggetto feature solido di Part Design. Per questo useremo 2 file separati: pdtube.FCMacro e pdtube.py. Il file .FCMacro verr&agrave; eseguito dall'utente per creare l'oggetto. Il file .py conterr&agrave; le definizioni delle classi, importate da .FCMacro. Il motivo per farlo in questo modo &egrave; mantenere la natura parametrica dell'oggetto dopo aver riavviato FreeCAD e aperto un documento contenente uno dei nostri tubi.
</p><p>Innanzitutto, il file di definizione della classe:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#classes should go in pdtube.py</span>
<span class="kn">import</span> <span class="nn">FreeCAD</span><span class="o">,</span> <span class="nn">FreeCADGui</span><span class="o">,</span> <span class="nn">Part</span>
<span class="k">class</span> <span class="nc">PDTube</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Radius1"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Radius1"</span><span class="p">)</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Radius2"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Radius2"</span><span class="p">)</span><span class="o">.</span><span class="n">Radius2</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyLength"</span><span class="p">,</span><span class="s2">"Height"</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">,</span><span class="s2">"Height of tube"</span><span class="p">)</span><span class="o">.</span><span class="n">Height</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">makeAttachable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">makeAttachable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">FreeCAD</span><span class="o">.</span><span class="n">Version</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="mi">19</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="s1">'Part::AttachExtensionPython'</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">addExtension</span><span class="p">(</span><span class="s1">'Part::AttachExtensionPython'</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">setEditorMode</span><span class="p">(</span><span class="s1">'Placement'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#non-readonly non-hidden</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fp</span><span class="p">):</span>
        <span class="n">outer_cylinder</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
        <span class="n">inner_cylinder</span> <span class="o">=</span> <span class="n">Part</span><span class="o">.</span><span class="n">makeCylinder</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span><span class="p">,</span> <span class="n">fp</span><span class="o">.</span><span class="n">Height</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">==</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">:</span> <span class="c1">#just make cylinder</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">outer_cylinder</span>
        <span class="k">elif</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius1</span> <span class="o">&lt;</span> <span class="n">fp</span><span class="o">.</span><span class="n">Radius2</span><span class="p">:</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">outer_cylinder</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">inner_cylinder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1">#invert rather than error out</span>
            <span class="n">tube_shape</span> <span class="o">=</span> <span class="n">inner_cylinder</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">outer_cylinder</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">"positionBySupport"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">makeAttachable</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="n">fp</span><span class="o">.</span><span class="n">positionBySupport</span><span class="p">()</span>
        <span class="n">tube_shape</span><span class="o">.</span><span class="n">Placement</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">Placement</span>

        <span class="c1">#BaseFeature (shape property of type Part::PropertyPartShape) is provided for us</span>
        <span class="c1">#with the PartDesign::FeaturePython and related classes, but it might be empty</span>
        <span class="c1">#if our object is the first object in the tree.  it's a good idea to check</span>
        <span class="c1">#for its existence in case we want to make type Part::FeaturePython, which won't have it</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">"BaseFeature"</span><span class="p">)</span> <span class="ow">and</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">"Subtractive"</span> <span class="ow">in</span> <span class="n">fp</span><span class="o">.</span><span class="n">TypeId</span><span class="p">:</span>
                <span class="n">full_shape</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">tube_shape</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">full_shape</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">BaseFeature</span><span class="o">.</span><span class="n">Shape</span><span class="o">.</span><span class="n">fuse</span><span class="p">(</span><span class="n">tube_shape</span><span class="p">)</span>
            <span class="n">full_shape</span><span class="o">.</span><span class="n">transformShape</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span> <span class="c1">#borrowed from gears workbench</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">full_shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">Shape</span> <span class="o">=</span> <span class="n">tube_shape</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="s2">"AddSubShape"</span><span class="p">):</span> <span class="c1">#PartDesign::FeatureAdditivePython and</span>
                                      <span class="c1">#PartDesign::FeatureSubtractivePython have this</span>
                                      <span class="c1">#property but PartDesign::FeaturePython does not</span>
                                      <span class="c1">#It is the shape used for copying in pattern features</span>
                                      <span class="c1">#for example in making a polar pattern</span>
            <span class="n">tube_shape</span><span class="o">.</span><span class="n">transformShape</span><span class="p">(</span><span class="n">fp</span><span class="o">.</span><span class="n">Placement</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">.</span><span class="n">toMatrix</span><span class="p">(),</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">fp</span><span class="o">.</span><span class="n">AddSubShape</span> <span class="o">=</span> <span class="n">tube_shape</span>

<span class="k">class</span> <span class="nc">PDTubeVP</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Set this object to the proxy object of the actual view provider'''</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">Proxy</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vobj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vobj</span> <span class="o">=</span> <span class="n">vobj</span>

    <span class="k">def</span> <span class="nf">updateData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''If a property of the handled feature has changed we have the chance to handle this here'''</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getDisplayModes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
        <span class="sd">'''Return a list of display modes.'''</span>
        <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Flat Lines"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Shaded"</span><span class="p">)</span>
        <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">"Wireframe"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modes</span>

    <span class="k">def</span> <span class="nf">getDefaultDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the name of the default display mode. It must be defined in getDisplayModes.'''</span>
        <span class="k">return</span> <span class="s2">"Flat Lines"</span>

    <span class="k">def</span> <span class="nf">setDisplayMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode</span><span class="p">):</span>
        <span class="sd">'''Map the display mode defined in attach with those defined in getDisplayModes.\</span>
<span class="sd">                Since they have the same names nothing needs to be done. This method is optional'''</span>
        <span class="k">return</span> <span class="n">mode</span>

    <span class="k">def</span> <span class="nf">onChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">prop</span><span class="p">):</span>
        <span class="sd">'''Here we can do something when a single property got changed'''</span>
        <span class="c1">#FreeCAD.Console.PrintMessage("Change property: " + str(prop) + "\n")</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">getIcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''Return the icon in XPM format which will appear in the tree view. This method is\</span>
<span class="sd">                optional and if not defined a default icon is shown.'''</span>
        <span class="k">return</span> <span class="s2">"""</span>
<span class="s2">            /* XPM */</span>
<span class="s2">            static const char * ViewProviderBox_xpm[] = {</span>
<span class="s2">            "16 16 6 1",</span>
<span class="s2">            "   c None",</span>
<span class="s2">            ".  c #141010",</span>
<span class="s2">            "+  c #615BD2",</span>
<span class="s2">            "@  c #C39D55",</span>
<span class="s2">            "#  c #000000",</span>
<span class="s2">            "$  c #57C355",</span>
<span class="s2">            "        ........",</span>
<span class="s2">            "   ......++..+..",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@@@.++..++.",</span>
<span class="s2">            "   .@@  .++++++.",</span>
<span class="s2">            "  ..@@  .++..++.",</span>
<span class="s2">            "###@@@@ .++..++.",</span>
<span class="s2">            "##$.@@$#.++++++.",</span>
<span class="s2">            "#$#$.$$$........",</span>
<span class="s2">            "#$$#######      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            "#$$#$$$$$#      ",</span>
<span class="s2">            " #$#$$$$$#      ",</span>
<span class="s2">            "  ##$$$$$#      ",</span>
<span class="s2">            "   #######      "};</span>
<span class="s2">            """</span>

    <span class="k">def</span> <span class="nf">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''When saving the document this object gets stored using Python's json module.\</span>
<span class="sd">                Since we have some un-serializable parts here -- the Coin stuff -- we must define this method\</span>
<span class="sd">                to return a tuple of all serializable objects or None.'''</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">state</span><span class="p">):</span>
        <span class="sd">'''When restoring the serialized object from document we have the chance to set some internals here.\</span>
<span class="sd">                Since no data were serialized nothing needs to be done here.'''</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
<p>E ora il file macro per creare l'oggetto:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#pdtube.FCMacro</span>
<span class="kn">import</span> <span class="nn">pdtube</span>
<span class="c1">#above line needed if the class definitions above are place in another file: PDTube.py</span>
<span class="c1">#this is needed if the tube object is to remain parametric after restarting FreeCAD and loading</span>
<span class="c1">#a document containing the object</span>

<span class="n">body</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">ActiveView</span><span class="o">.</span><span class="n">getActiveObject</span><span class="p">(</span><span class="s2">"pdbody"</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">body</span><span class="p">:</span>
    <span class="n">FreeCAD</span><span class="o">.</span><span class="n">Console</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">"No active body.</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PySide</span> <span class="kn">import</span> <span class="n">QtGui</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">getMainWindow</span><span class="p">()</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Additive"</span><span class="p">,</span><span class="s2">"Subtractive"</span><span class="p">,</span><span class="s2">"Neither additive nor subtractive"</span><span class="p">]</span>
    <span class="n">item</span><span class="p">,</span><span class="n">ok</span> <span class="o">=</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="s2">"Select tube type"</span><span class="p">,</span><span class="s2">"Select whether you want additive, subtractive, or neither:"</span><span class="p">,</span><span class="n">items</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeatureAdditivePython"</span>
        <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeatureSubtractivePython"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">className</span> <span class="o">=</span> <span class="s2">"PartDesign::FeaturePython"</span> <span class="c1">#not usable in pattern features, such as polar pattern</span>

        <span class="n">tube</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">className</span><span class="p">,</span><span class="s2">"Tube"</span><span class="p">)</span>
        <span class="n">pdtube</span><span class="o">.</span><span class="n">PDTube</span><span class="p">(</span><span class="n">tube</span><span class="p">)</span>
        <span class="n">pdtube</span><span class="o">.</span><span class="n">PDTubeVP</span><span class="p">(</span><span class="n">tube</span><span class="o">.</span><span class="n">ViewObject</span><span class="p">)</span>
        <span class="n">body</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="n">tube</span><span class="p">)</span> <span class="c1">#optionally we can also use body.insertObject() for placing at particular place in tree</span>
</pre></div>
<p><span id="Available_object_types"></span>
</p>
<h2><span class="mw-headline" id="Tipi_di_oggetti_disponibili">Tipi di oggetti disponibili</span></h2>
<p>I tipi di oggetto che si possono creare con <code>FreeCAD.ActiveDocument.addObject()</code> dipendono dai moduli caricati. Dopo aver caricato tutti gli ambienti di lavoro interni &egrave; possibile ottenere un elenco completo con <code>FreeCAD.ActiveDocument.supportedTypes()</code>. Solo i tipi di oggetto con un nome che termina con <code>Python</code> possono essere utilizzati per oggetti con script. Questi sono elencati qui (per FreeCAD v1.0):
</p>
<ul><li><code>App::DocumentObjectGroupPython</code></li>
<li><code>App::FeaturePython</code></li>
<li><code>App::GeometryPython</code></li>
<li><code>App::LinkElementPython</code></li>
<li><code>App::LinkGroupPython</code></li>
<li><code>App::LinkPython</code></li>
<li><code>App::MaterialObjectPython</code></li>
<li><code>App::PlacementPython</code></li>
<li><code>Fem::ConstraintPython</code></li>
<li><code>Fem::FeaturePython</code></li>
<li><code>Fem::FemAnalysisPython</code></li>
<li><code>Fem::FemMeshObjectPython</code></li>
<li><code>Fem::FemResultObjectPython</code></li>
<li><code>Fem::FemSolverObjectPython</code></li>
<li><code>Measure::MeasurePython</code></li>
<li><code>Mesh::FeaturePython</code></li>
<li><code>Part::CustomFeaturePython</code></li>
<li><code>Part::FeaturePython</code></li>
<li><code>Part::Part2DObjectPython</code></li>
<li><code>PartDesign::FeatureAdditivePython</code></li>
<li><code>PartDesign::FeatureAddSubPython</code></li>
<li><code>PartDesign::FeaturePython</code></li>
<li><code>PartDesign::FeatureSubtractivePython</code></li>
<li><code>PartDesign::SubShapeBinderPython</code></li>
<li><code>Path::FeatureAreaPython</code></li>
<li><code>Path::FeatureAreaViewPython</code></li>
<li><code>Path::FeatureCompoundPython</code></li>
<li><code>Path::FeaturePython</code></li>
<li><code>Path::FeatureShapePython</code></li>
<li><code>Points::FeaturePython</code></li>
<li><code>Sketcher::SketchObjectPython</code></li>
<li><code>Spreadsheet::SheetPython</code></li>
<li><code>TechDraw::DrawBrokenViewPython</code></li>
<li><code>TechDraw::DrawComplexSectionPython</code></li>
<li><code>TechDraw::DrawLeaderLinePython</code></li>
<li><code>TechDraw::DrawPagePython</code></li>
<li><code>TechDraw::DrawRichAnnoPython</code></li>
<li><code>TechDraw::DrawTemplatePython</code></li>
<li><code>TechDraw::DrawTilePython</code></li>
<li><code>TechDraw::DrawTileWeldPython</code></li>
<li><code>TechDraw::DrawViewPartPython</code></li>
<li><code>TechDraw::DrawViewPython</code></li>
<li><code>TechDraw::DrawViewSectionPython</code></li>
<li><code>TechDraw::DrawViewSymbolPython</code></li>
<li><code>TechDraw::DrawWeldSymbolPython</code></li></ul>
<p><span id="Available_methods"></span>
</p>
<h2><span class="mw-headline" id="Metodi_disponibili">Metodi disponibili</span></h2>
<p>Vedi <a href="../it/FeaturePython_methods.html" title="FeaturePython methods/it">Metodi FeaturePython</a> per i riferimenti completi.
</p><p><span id="Available_properties"></span>
</p>
<h2><span id="Propriet.C3.A0_disponibili"></span><span class="mw-headline" id="Propriet&agrave;_disponibili">Propriet&agrave; disponibili</span></h2>
<p>Le propriet&agrave; sono i veri elementi costitutivi degli oggetti FeaturePython. Attraverso di essi si potr&agrave; interagire e modificare il proprio oggetto. Dopo aver creato un nuovo oggetto FeaturePython nel proprio documento, &egrave; possibile ottenere un elenco delle propriet&agrave; disponibili:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ActiveDocument</span><span class="o">.</span><span class="n">addObject</span><span class="p">(</span><span class="s2">"App::FeaturePython"</span><span class="p">,</span> <span class="s2">"Box"</span><span class="p">)</span>
<span class="n">obj</span><span class="o">.</span><span class="n">supportedProperties</span><span class="p">()</span>
</pre></div>
<p>Vedere <a href="../it/FeaturePython_Custom_Properties.html" title="FeaturePython Custom Properties/it">Propriet&agrave; personalizzate FeaturePython</a> per una panoramica.
</p><p>Quando si aggiungono propriet&agrave; ai propri oggetti personalizzati, fare attenzione a quanto segue:
</p>
<ul><li>Non utilizzare i caratteri <code>&lt;</code> o <code>&gt;</code> nelle descrizioni delle propriet&agrave; (questo potrebbe danneggiare le porzioni xml nel file .FCStd).</li>
<li>Le propriet&agrave; vengono memorizzate in ordine alfabetico in un file .FCStd. Se nelle proprie propriet&agrave; &egrave; presente una forma (shape), qualsiasi propriet&agrave; il cui nome viene dopo "Shape" in ordine alfabetico verr&agrave; caricata DOPO la forma, il che pu&ograve; causare comportamenti strani.</li></ul>
<p>Le propriet&agrave; sono definite nel <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/App/PropertyStandard.h">file di intestazione PropertyStandard C++</a>.
</p><p><span id="Property_attributes"></span>
</p>
<h3><span id="Attributi_della_propriet.C3.A0"></span><span class="mw-headline" id="Attributi_della_propriet&agrave;">Attributi della propriet&agrave;</span></h3>
<p>Per impostazione predefinita le propriet&agrave; possono essere modificate dall'utente, ma &egrave; possibile renderle di sola lettura, ad esempio se si vuole mostrare il risultato di un metodo. &Egrave; anche possibile nascondere una propriet&agrave;. Questi attributi possono essere impostati utilizzando:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">setEditorMode</span><span class="p">(</span><span class="s2">"MyPropertyName"</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
</pre></div>
<p>Dove mode pu&ograve; avere questi valori:
</p>
<pre> 0 -- default mode, lettura e scrittura
 1 -- solo lettura
 2 -- nascosto
 3 -- di sola lettura e nascosto
</pre>
<p>Gli attributi possono essere impostati anche utilizzando un elenco di stringhe, ad es. <code>obj.setEditorMode("Placement", ["ReadOnly", "Hidden"])</code>.
</p><p>Gli attributi impostati utilizzando <code>setEditorMode</code> possono essere rimossi dall'utente. Vedere <a href="../it/Property_editor.html#Context_menu" title="Property editor/it">Editor delle propriet&agrave;</a>. Tenere presente che le propriet&agrave; di sola lettura possono ancora essere modificate da Python.
</p><p>E' possibile anche impostare questi e altri attributi direttamente con la funzione <code>addProperty</code>. Gli attributi impostati con tale funzione non possono essere modificati dall'utente. Una possibilit&agrave; interessante &egrave; contrassegnare una propriet&agrave; come propriet&agrave; di output. In questo modo FreeCAD non contrassegner&agrave; l'oggetto come touched quando lo si modifica (quindi non &egrave; necessario ricalcolarlo).
</p><p>Esempio di propriet&agrave; di output (vedi anche <a rel="nofollow" class="external free" href="https://forum.freecad.org/viewtopic.php?t=24928">https://forum.freecad.org/viewtopic.php?t=24928</a>):
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
<p>Gli attributi che possono essere impostati con <code>addProperty</code> sono elencati di seguito. &Egrave; possibile impostare pi&ugrave; attributi aggiungendo valori.
</p>
<pre>   0 -- Prop_None, nessun attributo di propriet&agrave; speciale
   1 -- Prop_ReadOnly, la propriet&agrave; &egrave; di sola lettura nell'editor
   2 -- Prop_Transient, la propriet&agrave; non verr&agrave; salvata nel file
   4 -- Prop_Hidden, la propriet&agrave; non apparir&agrave; nell'editor
   8 -- Prop_Output, la propriet&agrave; modificata non tocca il suo contenitore principale
  16 -- Prop_NoRecompute, la propriet&agrave; modificata non tocca il suo contenitore per il ricalcolo
  32 -- Prop_NoPersist, la propriet&agrave; non verr&agrave; affatto salvata nel file
</pre>
<p>Gli attributi della propriet&agrave; sono definiti nel <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/App/PropertyContainer.h">file di intestazione PropertyContainer C++</a>.
</p><p>Per <code>Prop_ReadOnly</code> e <code>Prop_Hidden</code> anche la funzione <code>addProperty</code> ha argomenti booleani:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
<p>Che equivale a:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="s2">"App::PropertyString"</span><span class="p">,</span> <span class="s2">"MyCustomProperty"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
<p><span style="font-size:small;"><a href="../it/Release_notes_1.0.html" title="Release notes 1.0/it">disponibile dalla versione 1.0</a></span>: La firma completa della funzione &egrave;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">addProperty</span><span class="p">(</span><span class="nb">type</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hidden</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enum_vals</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
<ul><li><code>type</code>: Tipo di propriet&agrave;.</li>
<li><code>name</code>: Nome della propriet&agrave;.</li>
<li><code>group</code>: Sottosezione della propriet&agrave; (utilizzata nell'<a href="../it/Property_editor.html" title="Property editor/it">Editor della propriet&agrave;</a>).</li>
<li><code>doc</code>: Tooltip (idem).</li>
<li><code>attr</code>: Attributo, vedere sopra.</li>
<li><code>read_only</code>: Vedi sopra.</li>
<li><code>hidden</code>: Vedi sopra.</li>
<li><code>enum_vals</code>: Valori di enumerazione (elenco di stringhe), rilevante solo se il tipo &egrave; <code>"App::PropertyEnumeration"</code>.</li></ul>
<p><span id="Available_extensions"></span>
</p>
<h2><span class="mw-headline" id="Estensioni_disponibili">Estensioni disponibili</span></h2>
<p>L'elenco delle estensioni disponibili pu&ograve; essere ottenuto con <code>grep -RI EXTENSION_PROPERTY_SOURCE_TEMPLATE</code> nel repository del codice sorgente ed &egrave; fornito qui (per FreeCAD v0.21).
</p><p>Per gli oggetti:
</p>
<ul><li><code>App::GeoFeatureGroupExtensionPython</code></li>
<li><code>App::GroupExtensionPython</code></li>
<li><code>App::LinkBaseExtensionPython</code></li>
<li><code>App::LinkExtensionPython</code></li>
<li><code>App::OriginGroupExtensionPython</code></li>
<li><code>Part::AttachExtensionPython</code></li>
<li><code>TechDraw::CosmeticExtensionPython</code></li></ul>
<p>Per la vista oggetti:
</p>
<ul><li><code>Gui::ViewProviderExtensionPython</code></li>
<li><code>Gui::ViewProviderGeoFeatureGroupExtensionPython</code></li>
<li><code>Gui::ViewProviderGroupExtensionPython</code></li>
<li><code>Gui::ViewProviderOriginGroupExtensionPython</code></li>
<li><code>PartGui::ViewProviderAttachExtensionPython</code></li>
<li><code>PartGui::ViewProviderSplineExtensionPython</code></li></ul>
<p>Esistono altre estensioni ma non funzionano cos&igrave; come sono:
</p>
<ul><li><code>App::ExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderCosmeticExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderDrawingViewExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderPageExtensionPython</code></li>
<li><code>TechDrawGui::ViewProviderTemplateExtensionPython</code></li></ul>
<p><span id="Further_information"></span>
</p>
<h2><span class="mw-headline" id="Ulteriori_informazioni">Ulteriori informazioni</span></h2>
<p>Pagine aggiuntive:
</p>
<ul><li><a href="../it/Scripted_objects_saving_attributes.html" title="Scripted objects saving attributes/it">Oggetti creati con script che salvano gli attributi</a></li>
<li><a href="../it/Scripted_objects_migration.html" title="Scripted objects migration/it">Migrazione di oggetti creati con script</a></li>
<li><a href="../it/Scripted_objects_with_attachment.html" title="Scripted objects with attachment/it">Oggetti creati da script con parti associate</a></li>
<li><a href="../it/Viewprovider.html" title="Viewprovider/it">Viewprovider</a></li></ul>
<p>Interessanti thread del forum sugli oggetti con script:
</p>
<ul><li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=13740">Python object attributes lost at load</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?t=12139">New FeaturePython is grey</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=18&amp;t=44009">Explanation on dumps and loads</a>, <a rel="nofollow" class="external text" href="https://docs.python.org/3/library/pickle.html#object.__getstate__">official documentation</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=18&amp;t=13460&amp;start=20#p109709">Eigenmode frequency always 0?</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=21330">how to implement python feature's setEdit properly?</a></li></ul>
<p>Oltre agli esempi presentati qui dare un'occhiata al codice sorgente di FreeCAD  <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD/blob/master/src/Mod/TemplatePyMod/FeaturePython.py">src/Mod/TemplatePyMod/FeaturePython.py</a> per ulteriori esempi.
</p><p><br>
</p>
<div class="docnav" style="background-color: #ececef; border: 1px solid #a2a9b1; padding: 2px 10px; margin: 10px 0; line-height: 1; clear: both; overflow: hidden;">
    <div style="margin: 4px 0; float: left;"><span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-left.svg" decoding="async" width="16" height="16"></span></span> <a href="../it/Topological_data_scripting.html" title="Topological data scripting/it">Script di dati topologici</a></div>
    <div style="margin: 4px 0; float: right;"><a href="../it/Scenegraph.html" title="Scenegraph/it">Scena grafica</a>
 <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Arrow-right.svg" decoding="async" width="16" height="16"></span></span></div>
    <div style="text-align:center"><a href="../it/Online_Help_Toc.html" title="Online Help Toc/it">Indice</a> <span class="mw-default-size" typeof="mw:File"><span><img src="../File/Online_Help_Toc.svg" decoding="async" width="24" height="24"></span></span></div>
</div>
<div class="NavFrame" style="margin: 0px; text-align: center; border-collapse: collapse; font-size: 100%; border-top-style: double; border-top-style: 1px; clear:both;">
    <div class="NavHead mw-collapsible mw-collapsed" style="margin: 1px; font-weight: normal; background-color: #fefefe;"><span typeof="mw:File"><a href="../File/Power_user_hub.png" class="mw-file-description"><img src="../File/Power_user_hub.png" decoding="async" width="24" height="24"></a></span> <a href="../it/Power_users_hub.html" title="Power users hub/it">Power user documentation</a>
        <div class="NavContent mw-collapsible-content" style="margin: 10px; border: 1px solid #aaaaaa; text-align: left; border-collapse: collapse; font-weight: normal; font-size: 100%; clear:both; margin-top: 1px; background-color: #fefefe;">
<ul><li><b>FreeCAD scripting:</b> <a href="../it/Python.html" title="Python/it">Python</a>, <a href="../it/Introduction_to_Python.html" title="Introduction to Python/it">Introduction to Python</a>, <a href="../it/Python_scripting_tutorial.html" title="Python scripting tutorial/it">Python scripting tutorial</a>, <a href="../it/FreeCAD_Scripting_Basics.html" title="FreeCAD Scripting Basics/it">FreeCAD Scripting Basics</a></li></ul>
<hr>
<ul><li><b>Modules:</b> <a href="../it/Builtin_modules.html" title="Builtin modules/it">Builtin modules</a>, <a href="../it/Units.html" title="Units/it">Units</a>, <a href="../it/Quantity.html" title="Quantity/it">Quantity</a></li>
<li><b>Workbenches:</b> <a href="../it/Workbench_creation.html" title="Workbench creation/it">Workbench creation</a>, <a href="../it/Gui_Command.html" title="Gui Command/it">Gui Commands</a>, <a href="../it/Command.html" title="Command/it">Commands</a>, <a href="../it/Installing_more_workbenches.html" title="Installing more workbenches/it">Installing more workbenches</a></li>
<li><b>Meshes and Parts:</b> <a href="../it/Mesh_Scripting.html" title="Mesh Scripting/it">Mesh Scripting</a>, <a href="../it/Topological_data_scripting.html" title="Topological data scripting/it">Topological data scripting</a>, <a href="../it/Mesh_to_Part.html" title="Mesh to Part/it">Mesh to Part</a>, <a href="../it/PythonOCC.html" title="PythonOCC/it">PythonOCC</a></li></ul>
<hr>
<ul><li><b>Parametric objects:</b> <a class="mw-selflink selflink">Scripted objects</a>, <a href="../it/Viewprovider.html" title="Viewprovider/it">Viewproviders</a> <small>(<a href="../it/Custom_icon_in_tree_view.html" title="Custom icon in tree view/it">Custom icon in tree view</a>)</small></li>
<li><b>Scenegraph:</b> <a href="../it/Scenegraph.html" title="Scenegraph/it">Coin (Inventor) scenegraph</a>, <a href="../it/Pivy.html" title="Pivy/it">Pivy</a></li>
<li><b>Graphical interface:</b> <a href="../it/Interface_creation.html" title="Interface creation/it">Interface creation</a>, <a href="../it/Dialog_creation.html" title="Dialog creation/it">Interface creation completely in Python</a> <small>(<a href="../it/Dialog_creation_with_various_widgets.html" title="Dialog creation with various widgets/it">1</a>, <a href="../it/Dialog_creation_reading_and_writing_files.html" title="Dialog creation reading and writing files/it">2</a>, <a href="../it/Dialog_creation_setting_colors.html" title="Dialog creation setting colors/it">3</a>, <a href="../it/Dialog_creation_image_and_animated_GIF.html" title="Dialog creation image and animated GIF/it">4</a>, <a href="../it/PySide_usage_snippets.html" title="PySide usage snippets/it">5</a>)</small>, <a href="../it/PySide.html" title="PySide/it">PySide</a>, PySide examples <a href="../it/PySide_Beginner_Examples.html" title="PySide Beginner Examples/it">beginner</a>, <a href="../it/PySide_Intermediate_Examples.html" title="PySide Intermediate Examples/it">intermediate</a>, <a href="../it/PySide_Advanced_Examples.html" title="PySide Advanced Examples/it">advanced</a></li>
<li><b>Macros:</b> <a href="../it/Macros.html" title="Macros/it">Macros</a>, <a href="../it/How_to_install_macros.html" title="How to install macros/it">How to install macros</a></li>
<li><b>Embedding:</b> <a href="../it/Embedding_FreeCAD.html" title="Embedding FreeCAD/it">Embedding FreeCAD</a>, <a href="../it/Embedding_FreeCADGui.html" title="Embedding FreeCADGui/it">Embedding FreeCADGui</a></li></ul>
<hr>
<ul><li><b>Other:</b> <a href="../it/Expressions.html" title="Expressions/it">Expressions</a>, <a href="../it/Code_snippets.html" title="Code snippets/it">Code snippets</a>, <a href="../it/Line_drawing_function.html" title="Line drawing function/it">Line drawing function</a>, <a href="../it/FreeCAD_vector_math_library.html" title="FreeCAD vector math library/it">FreeCAD vector math library</a> <small>(deprecated)</small></li></ul>
<hr>
<ul><li><b>Hubs:</b> <a href="../it/User_hub.html" title="User hub/it">User hub</a>, <a href="../it/Power_users_hub.html" title="Power users hub/it">Power users hub</a>, <a href="../it/Developer_hub.html" title="Developer hub/it">Developer hub</a></li></ul></div>
    </div></div>
<!-- 
NewPP limit report
Cached time: 20250523100053
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.214 seconds
Real time usage: 0.225 seconds
Preprocessor visited node count: 1127/1000000
Post&#8208;expand include size: 13676/2097152 bytes
Template argument size: 33489/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 19/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 136496/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   23.133      1 -total
 26.08%    6.034     19 Template:Code
 23.12%    5.349      1 Template:Powerdocnavi/it
 13.52%    3.127    114 Template:Incode
  6.42%    1.486      2 Template:Docnav/it
  6.32%    1.462      1 Template:Navigation_menu_2
  4.18%    0.968      1 Template:Version/it
  2.59%    0.599      1 Template:TOCright
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:2372-0!canonical and timestamp 20250523100052 and revision id 1586615. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>