<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Cut Object For Magnets/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Cut+Object+For+Magnets&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Macro_Cut_Object_For_Magnets.html" class="mw-pt-progress mw-pt-progress--complete" title="Makro Objekt f&uuml;r Magnete ausschneiden (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_Cut_Object_For_Magnets.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Cut Object For Magnets (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Cut_Object_For_Magnets.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Cut Object For Magnets (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--low" lang="it" dir="ltr">italiano</span></li></ul></div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_Cut_Object_For_Magnets.png&amp;filetimestamp=20260106011212&amp;.html" class="mw-file-description"><img src="../File/Macro_Cut_Object_For_Magnets.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Macro Cut Object for Magnets
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Cut an object along a plane and add aligned magnet holes with surface collision detection. Creates two parts with perfectly aligned holes for embedding magnets that allow the parts to snap together.<br><br>Macro version: 0.6.2<br>Last modified: 2026-01-18<br>FreeCAD version: 0.21+<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/thumb/e/e3/Macro_Cut_Object_For_Magnets.png/48px-Macro_Cut_Object_For_Magnets.png">ToolBar Icon</a><br>Author: Spkane<br>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Spkane.html" title="User:Spkane">Spkane</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/thumb/e/e3/Macro_Cut_Object_For_Magnets.png/48px-Macro_Cut_Object_For_Magnets.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="../How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="../Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">0.6.2
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2026-01-18
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.21+
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><a href="../Part_Slice.html" title="Part Slice">Part Slice</a>, <a href="../PartDesign_Hole.html" title="PartDesign Hole">PartDesign Hole</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Description">Description</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This macro cuts a 3D object along a specified plane and automatically adds aligned magnet holes to both resulting pieces. The holes are positioned with intelligent collision detection to ensure they don't break through the outer walls of the object.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This is particularly useful for:
</p>
<ul><li>Creating multi-part prints that snap together with embedded magnets.</li>
<li>Splitting large objects for smaller 3D printer beds while maintaining alignment.</li>
<li>Adding magnetic closure mechanisms to enclosures and cases.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p><b>Key Features:</b>
</p>
<ul><li>Cut along preset planes (XY, XZ, YZ) or model datum planes.</li>
<li>Automatic hole placement with even distribution along the cut edge.</li>
<li>Surface collision detection prevents holes from breaking through walls.</li>
<li>Configurable hole diameter, depth, and count.</li>
<li>Preferred and minimum edge clearance settings.</li>
<li>Smart repositioning of holes when initial placement fails safety checks.</li>
<li>Creates PartDesign::Body objects with parametric Hole features.</li>
<li>Supports re-cutting already-cut objects (preserves existing holes).</li>
<li>Automatically separates the two parts for easy viewing.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ol><li>Open a document with the object you want to cut.</li>
<li>Optionally select the object and/or a datum plane before running the macro.</li>
<li>Run the macro from <b>Macro &rarr; Macros &rarr; CutObjectForMagnets &rarr; Execute</b>.</li>
<li>In the dialog:
<ul><li>Select the body to cut from the dropdown.</li>
<li>Choose the cut plane type (Preset or Model Plane).</li>
<li>For preset planes, set the offset from origin.</li>
<li>Configure magnet hole parameters:
<ul><li><b>Diameter</b>: Hole diameter (should match your magnet size).</li>
<li><b>Depth</b>: Hole depth from cut surface.</li>
<li><b>Number of Holes</b>: Total holes to create.</li>
<li><b>Edge Clearance (Preferred)</b>: Ideal distance from hole edge to object surface.</li>
<li><b>Edge Clearance (Minimum)</b>: Minimum acceptable clearance.</li></ul></li></ul></li>
<li>Click "Execute Cut".</li></ol>
</div>
<figure class="mw-halign-center" typeof="mw:File"><a href="../index.php?title=MacroCutObjectForMagnetsDialog.png&amp;filetimestamp=20260119180444&amp;.html" class="mw-file-description"><img src="../File/MacroCutObjectForMagnetsDialog.png" decoding="async" width="400" height="427" class="mw-file-element" data-file-width="1022" data-file-height="1092"></a><figcaption></figcaption></figure>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Example">Example</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This image shows a vase object in its original form, and after being cut multiple times with the macro. Magnets can then be inserted into the object, and the object can be re-assembled. This example was to create a "breakable" vase for a theatrical stage performance, but there are many other potential uses as well.
</p>
</div>
<figure class="mw-halign-center" typeof="mw:File"><a href="../index.php?title=CutObjectForMagnetsExample.png&amp;filetimestamp=20260106020408&amp;.html" class="mw-file-description"><img src="../File/CutObjectForMagnetsExample.png" decoding="async" width="400" height="400" class="mw-file-element" data-file-width="1658" data-file-height="1656"></a><figcaption></figcaption></figure>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="How_It_Works">How It Works</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p><b>Cutting Process:</b>
</p>
<ol><li>Creates a large half-space box aligned with the cutting plane.</li>
<li>Uses boolean operations to split the object into two parts.</li>
<li>Creates PartDesign::Body containers for each half.</li></ol>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p><b>Hole Placement Algorithm:</b>
</p>
<ol><li>Calculates hole positions evenly distributed along the cut face perimeter.</li>
<li>For each position, validates against BOTH parts (not just one).</li>
<li>Uses preferred clearance first, falls back to minimum if needed.</li>
<li>Checks for hole-to-hole spacing (minimum 2x diameter).</li>
<li>Repositions holes that fail safety checks using multiple strategies:
<ul><li>Reduced clearance at same position.</li>
<li>Increased inset from edge.</li>
<li>Alternative positions along the perimeter.</li></ul></li></ol>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p><b>Safety Features:</b>
</p>
<ul><li>Creates test cylinders to check if holes would break through walls.</li>
<li>Validates each hole against both the top and bottom parts.</li>
<li>Skips holes that cannot be safely placed.</li>
<li>Reports repositioned and skipped holes in the console.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Parameters">Parameters</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<table class="wikitable">
<tbody><tr>
<th>Parameter</th>
<th>Description</th>
<th>Default
</th></tr>
<tr>
<td>Plane Type</td>
<td>"Preset Plane" (XY/XZ/YZ) or "Model Plane" (datum plane)</td>
<td>Preset Plane
</td></tr>
<tr>
<td>Offset</td>
<td>Distance from origin for preset planes</td>
<td>0 mm
</td></tr>
<tr>
<td>Diameter</td>
<td>Magnet hole diameter</td>
<td>3 mm
</td></tr>
<tr>
<td>Depth</td>
<td>Hole depth from cut surface</td>
<td>3 mm
</td></tr>
<tr>
<td>Number of Holes</td>
<td>Total holes to create</td>
<td>6
</td></tr>
<tr>
<td>Edge Clearance (Preferred)</td>
<td>Ideal distance from hole edge to object surface</td>
<td>2 mm
</td></tr>
<tr>
<td>Edge Clearance (Minimum)</td>
<td>Minimum acceptable clearance (used during repositioning)</td>
<td>0.5 mm
</td></tr></tbody></table>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Requirements">Requirements</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ul><li>FreeCAD 0.19 or later.</li>
<li>An object with a solid shape (Part or PartDesign body).</li>
<li>For model plane mode: a datum plane or object with planar faces.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ul><li>Install via the <b>FreeCAD Addon manager</b> or manually from the <a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-macro-cut-for-magnets/">freecad-macro-cut-for-magnets repo on GitHub</a>.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Tips">Tips</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ul><li><b>Magnet sizing</b>: Measure your magnets carefully. Common sizes are 3mm, 5mm, and 6mm diameter.</li>
<li><b>Add tolerance</b>: Consider adding 0.1-0.2mm to the diameter for easier magnet insertion.</li>
<li><b>Depth planning</b>: Set hole depth slightly deeper than magnet height to ensure flush or recessed fit.</li>
<li><b>Edge clearance</b>: For thin-walled objects, reduce the preferred clearance but keep minimum clearance high enough to prevent wall breakthrough.</li>
<li><b>Re-cutting</b>: The macro detects existing magnet holes and preserves them when cutting already-cut parts.</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Source_Code">Source Code</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The full source code is hosted on GitHub:
</p>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-macro-cut-for-magnets/">freecad-macro-cut-for-magnets on GitHub</a></li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Links">Links</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ul><li><a rel="nofollow" class="external text" href="https://spkane.github.io/freecad-macro-cut-for-magnets/">Full Documentation</a> - Complete guides and tutorials.</li>
<li><a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-macro-cut-for-magnets">GitHub Repository</a> - Source code and issue tracker.</li>
<li><a href="../Part_Slice.html" title="Part Slice">Part Slice</a> - FreeCAD's built-in slice tool.</li>
<li><a href="../PartDesign_Hole.html" title="PartDesign Hole">PartDesign Hole</a> - Parametric hole feature documentation.</li>
<li><a href="../PartDesign_Body.html" title="PartDesign Body">PartDesign Body</a> - Body container documentation.</li></ul>
</div>
<!-- 
NewPP limit report
Cached time: 20260216123506
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.049 seconds
Real time usage: 0.085 seconds
Preprocessor visited node count: 129/1000000
Post&#8208;expand include size: 2275/2097152 bytes
Template argument size: 820/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 1096/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.483      1 Template:Macro
100.00%    6.483      1 -total
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:416327-0!canonical and timestamp 20260216123506 and revision id 1755414. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>