<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Half turn stairs/it</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="it" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Half+turn+stairs&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_Half_turn_stairs.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Half turn stairs (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Half_turn_stairs.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Half turn stairs (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="it" dir="ltr">italiano</span></li>
<li><a href="../pl/Macro_Half_turn_stairs.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Half turn stairs (9% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_Half_turn_stairs.png&amp;filetimestamp=20161017154624&amp;.html" class="mw-file-description"><img src="../File/Macro_Half_turn_stairs.png" decoding="async" width="32" height="28" class="mw-file-element" data-file-width="420" data-file-height="372"></a></span><span> </span>
Scala a mezzo giro
</p>
</td></tr>
<tr>
<th class="ctOdd">Descrizione
</th></tr>
<tr>
<td class="ctEven left macro-description">Crea una scala con svolta a sinistra o a destra di data altezza. Il dati della scala sono definiti nel file stairs.dat (Dovete copiare i dati nella pagina del wiki). L'alzata viene calcolata secondo l'altezza della scala.<br><br>Versione macro: 1.0<br>Ultima modifica: 2016-10-17<br>Versione FreeCAD: Tutte<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/b/b8/Half_turn_stairs.png">ToolBar Icon</a><br>Autore: Berner<br>
</td></tr>
<tr>
<th class="ctOdd">Autore
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;Berner&amp;action=edit&amp;redlink=1.html" class="new" title="User:Berner (page does not exist)">Berner</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/b/b8/Half_turn_stairs.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Link
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../it/Macros_recipes.html" title="Macros recipes/it">Raccolta di macro</a><br><a href="../it/How_to_install_macros.html" title="How to install macros/it">Come installare le macro</a><br><a href="../it/Customize_Toolbars.html" title="Customize Toolbars/it">Personalizzare la  toolbar</a>
</td></tr>
<tr>
<th class="ctOdd">Versione macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Data ultima modifica
</th></tr>
<tr>
<td class="ctEven macro-date">2016-10-17
</td></tr>
<tr>
<th class="ctOdd">Versioni di FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Tutte
</td></tr>
<tr>
<th class="ctOdd">Scorciatoia
</th></tr>
<tr>
<td class="ctEven"><i>Nessuna</i>
</td></tr>
<tr>
<th class="ctOdd">Vedere anche
</th></tr>
<tr>
<td class="ctEven"><i>Nessuno</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Descrizione">Descrizione</span></h2>
<p>Questa macro crea una scala mezzo giro con i dati del file stairs.dat e con svolta a sinistra o a destra.
</p><p><span typeof="mw:File"><a href="../index.php?title=Half_turn_stairs.png&amp;filetimestamp=20161017163817&amp;.html" class="mw-file-description" title="stairs"><img alt="stairs" src="../File/Half_turn_stairs.png" decoding="async" width="480" height="425" class="mw-file-element" data-file-width="480" data-file-height="425"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Stairs</p>
<p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilizzo">Utilizzo</span></h2>
<ul><li>Copiare e salvare i dati come file stairs.dat nella prpria directory delle macro, vedere sotto il codice Data (stairs.dat).</li></ul>
<ul><li>Avviare la macro e modificare l'altezza della scala. La svolta pu&ograve; essere a sinistra o a destra.</li></ul>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span typeof="mw:File"><a href="../index.php?title=Half_turn_stairs.png&amp;filetimestamp=20161017163817&amp;.html" class="mw-file-description"><img src="../File/Half_turn_stairs.png" decoding="async" width="64" height="57" class="mw-file-element" data-file-width="480" data-file-height="425"></a></span>
</p><p><b>Half_turn_stairs.FCMacro</b>
</p>
<pre># -*- coding: utf-8 -*-
#
# Half_turn_stairs Macro runs with Freecad 0.17
#
# Author: Berner and Forum
#
# This macro creates a half turn stair from tupels of x,y,z 
# the tupels used to create a dwire for every stair.
# The dwire is extruded, so it give with 18 stairs the total rise 
#
# A sample file with parameters is in stairs.dat
#
# created a wire with coordinate x y z separated (in the file)
#Sample: (delete # on lines without comments)
# Stair 0
#0.0 -240.0 0.0 0.0 0.0 0.0 1000.0 0.0 0.0 1000.0 -240.0 0.0
# Stair 1
#0.0 0.0 0.0 0.0 240.0 0.0 1000.0 240.0 0.0 1000.0 0.0 0.0
#. . . .

from __future__ import unicode_literals
from FreeCAD import Base
import Draft, Part

App.Console.PrintMessage("Half_turn_stairs-Macro\n")
# Get location of user macros
p=FreeCAD.ParamGet("User parameter:BaseApp/Preferences/Macro")
path = p.GetString("MacroPath")
dataset = path + "/stairs.dat"                          # path and name of file.txt
docname = App.ActiveDocument.Name                       # Name of active document
 
debug='n' # Debug Values on Console
rise = 3100.0 # Geschosshoehe Total Rise

left_right="l"  # turn stairs left or left_right
# GUI

from PySide import QtGui
(rise, ok) = QtGui.QInputDialog.getDouble(
		QtGui.QWidget(), 'Total Rise / Geschosshoehe', 'Total Rise /  Geschosshoehe', 2000, 0, 3100, 4)
if ok:
 left_right = QtGui.QInputDialog.getText(None, "left_right", "Turn Left or Right l/r")[0]
if debug == 'y': FreeCAD.Console.PrintMessage("rise="+str(rise) + " " + str(ok) + "\n" )
if debug == 'y': FreeCAD.Console.PrintMessage("left_right="+str(left_right) + " " + str(ok) + "\n" )
# End Gui
step=float(rise/18)  # Treppensteigung / Step_high

# functions
def objnames():  # List object names
 doc = FreeCAD.ActiveDocument
 objs = FreeCAD.ActiveDocument.Objects
 names=''  #list of objectnames
 labels='' # list of objectlabels 
 for obj in objs:
    a = obj.Name                                             # list the Name  of the object  (not modifiable)
    b = obj.Label                                            # list the Label of the object  (modifiable)
    try:
        c = obj.LabelText                                    # list the LabeText of the text (modifiable)
        names=names+str(a)+" "
        labels=labels+str(b)+" "
    except:
        names=names+str(a)+" "
        labels=labels+str(b)+" "
 return names
 if debug == 'y': App.Console.PrintMessage("Names="+str(names) +"\n"+"Labels="+ str(labels) + "\n")
# end functions

file = open(dataset, "r") # open the file read
i = 0 #line counter
line = file.readline()
while(line&nbsp;!= ''):    # read number of lines
   if line[0:1]&nbsp;!= "#" and len(line) &gt;0:
    i = i + 1
    if debug == "y": App.Console.PrintMessage("Parameter-Line" + str(i) + " " + line + "\n")
   line = file.readline() 
file.close()
numlines=i  # number of parameter-lines
if debug == "y": App.Console.PrintMessage("Number of Parameter-Lines =" + str(numlines) + "\n")
file = open(dataset, "r")                                  # open the file read
wire = []
X=Y=Z = 0.0
if left_right == "r": 
 i = 0 #line counter
else:
 i = numlines 
line = file.readline()
while(line&nbsp;!= ''):
    num_words = len(line.split())
    num_tupel = num_words // 3
    if debug == "y": App.Console.PrintMessage(str(num_words) + "\n")
    if debug == "y": App.Console.PrintMessage(str(num_tupel) + "\n")
    if line[0:1] == "#" or num_words&nbsp;!= (num_tupel * 3):
     if num_words&nbsp;!= (num_tupel * 3):
      App.Console.PrintMessage("Error on Inputfile line " + str(i) + "\n")
      App.Console.PrintMessage("Only " + str(num_words) + " of multiple of 3 Words\n")
    else:
     if line[0:1] == "#": 
      num_words = 0   #  ignore comment
     if debug == "y": App.Console.PrintMessage(line + "\n")
     coordinates = line.split()
     if debug == "y": App.Console.PrintMessage(str(coordinates) + " " + str(num_words) + " " + str(num_tupel)+ str(type(num_words)) + "\n")
     if num_words &gt; 0:
      data=""  # generate statement
      printline="App.Console.PrintMessage(" # generate variable for PrintMessage (debug)
      for x in range(1, num_tupel + 1):
       data=data + "X" + str(x) + ",Y" + str(x) + ",Z" + str(x)
       printline=printline + "str(X" + str(x) + ") + ' ' + " + "str(Y" + str(x) + ") + ' ' + " + "str(Z" + str(x) + ") + ' '"
       if x &lt; num_tupel: 
        data=data + ","
        printline=printline + " + "
      data=data + " = coordinates" 
      printline=printline + ")\n"
      if debug == "y": App.Console.PrintMessage(data + "\n")
      if debug == "y": App.Console.PrintMessage(printline + "\n")
      # X1,Y1,Z1,X2,Y2,Z2,X3,Y3,Z3,X4,Y4,Z4 = coordinates
      exec(data) # coordinates to variables
      if debug == "y": exec(printline) # output input file
      #App.Console.PrintMessage(str(X1) + " " + str(Y1) + " " +str(Z1) + "\n")
      px=""
      pn="" # names of generated variables
      for x in range(1, num_tupel +1):
       if x &lt; num_tupel:
        pn=pn + "p" + str(x) + ","
       else:
        pn=pn + "p" + str(x)
       data = "Z" + str(x) + " = " + str(i * step)  # Korrektur z= 0.0 auf aktuelle step
       if debug == "y": App.Console.PrintMessage(data + "\n")
       exec(data)
       px="p" + str(x) + "= FreeCAD.Vector(float(X" + str(x) + "),float(Y" + str(x) + "),float(Z" + str(x) + "))" 
       if debug == "y": App.Console.PrintMessage(px + "\n")
       exec(px)
      if debug == "y": App.Console.PrintMessage(pn + "\n")
      #p1 = FreeCAD.Vector(float(X1),float(Y1),float(Z1))
      #p2 = FreeCAD.Vector(float(X2),float(Y2),float(Z2))
      #p3 = FreeCAD.Vector(float(X3),float(Y3),float(Z3))
      #p4 = FreeCAD.Vector(float(X4),float(Y4),float(Z4))
      data="Draft.makeWire([" + pn + "],closed=True)"
      if debug == "y": App.Console.PrintMessage(data + "\n")
      exec(data)
      #Draft.makeWire([p1,p2,p3,p4,p5],closed=True)
      if left_right == "r": 
       i = i + 1
      else:
       i = i -1
    line = file.readline() 
file.close()
#
# List all objects of the document
names = objnames()    # list objectnames
App.Console.PrintMessage("names="+str(names) +"\n")
#extrude
extr="" # suffix for continues Extrude in commands
extrnames="Box Cut" #names of source object, because not consitend nameings in freecad
j=len(names.split())
n=0 #counter
if left_right == "r": 
 l1 = 0
 l2 = j
 step = 1
else:
 l1 = j
 l2 = -1
 step = -1
for x in range(l1, l2, step):
 w=str(names.split(" ")[x])
 if w[0:4] == "Wire":
  if debug == 'y':  App.Console.PrintMessage("w="+str(w) +"\n")
  data = 'f = FreeCAD.getDocument(docname).addObject("Part::Extrusion","Extrude' + str(extr)+ '")'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f = App.getDocument(docname).getObject("Extrude' + str(extr) + '")'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.Base = App.getDocument(docname).getObject("' + str(w) + '")'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.DirMode = str("Custom")'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.Dir = App.Vector(0.000000000000000, 0.000000000000000, 1.000000000000000)'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.DirLink = None'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.LengthFwd = 180.000000000000000'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.LengthRev = 0.000000000000000'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.Solid = True'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.Reversed = False'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.Symmetric = False'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.TaperAngle = 0.000000000000000'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
  data = 'f.TaperAngleRev = 0.000000000000000'
  if debug == "y": App.Console.PrintMessage(data + "\n")
  exec(data)
 # data = 'App.getDocument(docname).Extrude' + str(extr) + '.Placement=App.Placement(App.Vector(0,0,360), #App.Rotation(App.Vector(0,0,1),0), App.Vector(0,0,0))'
  #if debug == "y": App.Console.PrintMessage(data + "\n")
  #exec(data)
  n = n + 1
  extr = str("%03d"&nbsp;% n)  # count extrude suffix
  extrnames=extrnames + " Extrude" + str("%03d"&nbsp;% x)
#
FreeCAD.ActiveDocument.recompute()
</pre>
<p><br>
</p>
<h2><span id="Dati_.28stairs.dat.29"></span><span class="mw-headline" id="Dati_(stairs.dat)">Dati (stairs.dat)</span></h2>
<p>Salva questi dati come file <b>stairs.dat</b> nella propria directory delle macro
</p>
<pre>#
# Save this Data as file stairs.dat in your macro directory
# 
# Stufe 0
0.0 -240.0 0.0 0.0 0.0 0.0 1000.0 0.0 0.0 1000.0 -240.0 0.0
# Stufe 1
0.0 0.0 0.0 0.0 240.0 0.0 1000.0 240.0 0.0 1000.0 0.0 0.0
# Stufe 2
0.0 240.0 0.0 0.0 520.0 0.0 1000.0 520.0 0.0 1000.0 240.0 0.0
# Stufe 3
0.0 520.0 0.0 0.0 840.0 0.0 1000.0 720.0 0.0 1000.0 520.0 0.0
# Stufe 4
0.0 840.0 0.0 0.0 1220.0 0.0 1000.0 860.0 0.0 1000.0 720.0 0.0
# Stufe 5
0.0 1220.0 0.0 0.0 1620.0 0.0 1000.0 1000.0 0.0 1000.0 860.0 0.0
# Stufe 6
0.0 1620.0 0.0 0.0 2170.0 0.0  140.0 2170.0 0.0 1000.0 1120.0 0.0 1000.0 1000.0 0.0
# Stufe 7
140.0 2170.0 0.0 680.0 2170.0 0.0 1020.0 1170.0 0.0 1000.0 1170.0 0.0 1000.0 1120.0 0.0 140.0 2170.0 0.0
# Stufe 8
680.0 2170.0 0.0 1115.0 2170.0 0.0 1115.0 1170.0 0.0 1020.0 1170.0 0.0 
# Stufe 9
1115.0 2170.0 0.0 1550.0 2170.0 0.0 1210.0 1170.0 0.0 1115.0  1170.0 0.0 1115.0 2170.0 0.0
# Stufe 10
1550.0 2170.0 0.0 2090.0 2170.0 0.0 1230.0 1120.0 0.0 1230.0 1170.0 0.0 1210.0 1170.0 0.0 1550.0 2170.0 0.0
# Stufe 11
2090.0 2170.0 0.0 2230.0 2170.0 0.0 2230.0 1620.0 0.0 1230.0 1000.0 0.0 1230.0 1120.0 0.0 2090.0 2170.0 0.0
# Stufe 12
1230.0 1000.0 0.0 2230.0 1620.0 0.0 2230.0 1230.0 0.0 1230.0 860.0 0.0 1230.0 1000.0 0.0
# Stufe 13
1230.0 720.0 0.0 1230.0 860.0 0.0 2230.0 1220.0 0.0 2230.0 840.0 0.0 1230.0 720.0 0.0
# Stufe 14
1230.0 520.0 0.0 1230.0 720.0 0.0 2230.0 840.0 0.0 2230.0 520.0 0.0 1230.0 520.0 0.0
# Stufe 15
1230.0 240.0 0.0 1230.0 520.0 0.0 2230 520.0 0.0 2230.0 240.0 0.0 1230.0 240.0 0.0
# Stufe 16
1230.0 0.0 0.0 1230.0 240.0 0.0 2230.0 240.0 0.0 2230.0 0.0 0.0 1230.0 0.0 0.0
# Stufe 17
1230.0 -240.0 0.0 1230.0 0.0 0.0 2230.0 0.0 0.0 2230.0 -240.0 0.0 1230.0 -240.0 0.0
</pre>
<h2><span class="mw-headline" id="Link">Link</span></h2>
<ul><li><a href="../it/Macro_PartsLibrary.html" title="Macro PartsLibrary/it">Macro_PartsLibrary</a> FreeCAD Library</li></ul>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20250724155944
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.025 seconds
Real time usage: 0.033 seconds
Preprocessor visited node count: 117/1000000
Post&#8208;expand include size: 2357/2097152 bytes
Template argument size: 643/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 11286/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.647      1 -total
 37.85%    2.516      1 Template:Macro/it
 22.69%    1.508      1 Template:Caption
 20.07%    1.334      1 Template:MacroCode
 15.41%    1.024      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:74987-0!canonical and timestamp 20250724155944 and revision id 1616854. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>