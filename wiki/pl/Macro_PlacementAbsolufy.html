<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro PlacementAbsolufy/pl</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="pl" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+PlacementAbsolufy&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Macro_PlacementAbsolufy.html" class="mw-pt-progress mw-pt-progress--low" title="Macro PlacementAbsolufy/de (12% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_PlacementAbsolufy.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro PlacementAbsolufy (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_PlacementAbsolufy.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro PlacementAbsolufy (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Macro_PlacementAbsolufy.html" class="mw-pt-progress mw-pt-progress--high" title="Macro PlacementAbsolufy (82% translated)" lang="it" dir="ltr">italiano</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--low" lang="pl" dir="ltr">polski</span></li></ul></div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_PlacementAbsolufy.png&amp;filetimestamp=20190713150005&amp;.html" class="mw-file-description"><img src="../File/Macro_PlacementAbsolufy.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
PlacementAbsolufy
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">This macro resets position of all part containers to document origin while keeping the absolute object positions.<br>
<p>This macro has been written mainly to circumvent unfinished Part container implementation that can lead to absolute position shift, mainly when exporting parts. This is due to fact that Part containers creates a local coordinate system that can be shifted from global one. This local referential is then used by subsequent objects but isn't correctly handled by several functions (eg. export).<br><br>Macro version: 0.2<br>Last modified: 2019-06-10<br>FreeCAD version: 0.17+<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/9/92/Macro_PlacementAbsolufy.png">ToolBar Icon</a><br>Author: OpenBrain<br>
</p>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;OpenBrain&amp;action=edit&amp;redlink=1.html" class="new" title="User:OpenBrain (page does not exist)">OpenBrain</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/9/92/Macro_PlacementAbsolufy.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="../How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="../Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">0.2
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2019-06-10
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.17+
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><a href="../Macro_StraightenObject.html" title="Macro StraightenObject">Macro StraightenObject</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Description">Description</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h3><span class="mw-headline" id="Context">Context</span></h3>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This macro has been written mainly to circumvent unfinished Part container implementation that can lead to absolute position shift, mainly when exporting parts. This is due to fact that Part containers creates a local coordinate system that can be shifted from global one. This local referential is then used by subsequent objects but isn't correctly handled by several functions (eg. export).
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Functionally, the macro will reset the Part containers placement to global origin while preserving the objects absolute position. Notice that PlacementAbsolufy macro applies to the whole active document.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>To use the macro, just run it when the document on which it shall be applied is open.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The macro is available through <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. Code is provided on this page for convenience in case user system doesn't have git-python. Though it should be up-to-date, latest release is always available at <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD-macros/blob/master/Utility/PlacementAbsolufy.FCMacro">FreeCAD-macro repository</a>
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>For more detailed explanations, see the <a href="../How_to_install_macros.html" title="How to install macros">How to install macros</a> page.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Script">Script</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_PlacementAbsolufy.png&amp;filetimestamp=20190713150005&amp;.html" class="mw-file-description"><img src="../File/Macro_PlacementAbsolufy.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p>
</div>
<p><b>Macro_PlacementAbsolufy.FCMacro</b>
</p>
<pre>#!/usr/bin/python
#####################################
# Copyright (c) openBrain 2019
# Licensed under LGPL v2
#
# This macro will reset position of all part containers to document origin while keeping the absolute object positions
#
# Version history&nbsp;:
# *0.2&nbsp;: some typo improvement + commenting for official PR
# *0.1&nbsp;: alpha release, almost no test performed
#
#####################################

__Name__ = 'PlacementAbsolufy'
__Comment__ = 'Reset part containers to global origin while keeping object positions'
__Author__ = 'openBrain'
__Version__ = '0.2'
__Date__ = '2019-06-10'
__License__ = 'LGPL v2'
__Web__ = 'https://wiki.freecad.org/Macro_PlacementAbsolufy'
__Wiki__ = 'https://wiki.freecad.org/Macro_PlacementAbsolufy'
__Icon__ = ''
__Help__ = 'Run the macro with model active in the GUI'
__Status__ = 'Alpha'
__Requires__ = 'FreeCAD &gt;= 0.17'
__Communication__ = 'https://forum.freecad.org/viewtopic.php?f=3&amp;t=36869'
__Files__ = ''

currState = {} #initialize a dictionary to store current object placements

for obj in App.ActiveDocument.Objects: #going through active document objects
    if "Placement" in obj.PropertiesList: #if object has a Placement property
        currState[obj] = obj.getGlobalPlacement() #store the object pointer with its global placement

App.ActiveDocument.openTransaction("Absolufy") #open a transaction for undo management

for obj, plac in currState.items(): #going through all moveable objects
    if obj.isDerivedFrom("App::Part"): #if object is a part container
        obj.Placement = App.Placement(App.Vector(0,0,0),App.Rotation(0,0,0)) #reset its placement to global document origin
    elif obj.TypeId[:5] == "App::": #if object is another App type (typically an origin axis or plane)
        None #do nothing
    else: #for all other objects
        obj.Placement = plac #replace them at their global (absolute) placement

App.ActiveDocument.commitTransaction() #commit transaction</pre>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Limitations">Limitations</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<ul><li>Process the whole open document</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Forum_discussion">Forum discussion</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>For any feedback (bug, feature request, comments, ...), please use this forum thread: <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=3&amp;t=36869">Preserving global position of Parts during export</a>
</p>
</div>
<!-- 
NewPP limit report
Cached time: 20251001095933
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.032 seconds
Real time usage: 0.048 seconds
Preprocessor visited node count: 120/1000000
Post&#8208;expand include size: 2457/2097152 bytes
Template argument size: 2900/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 3174/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.791      1 -total
 58.93%    2.234      1 Template:Macro
 38.22%    1.449      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:290401-0!canonical and timestamp 20251001095932 and revision id 1653037. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>