<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro EasyAlias/pl</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="pl" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+EasyAlias&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_EasyAlias.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro EasyAlias (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_EasyAlias.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro EasyAlias (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="pl" dir="ltr">polski</span></li>
<li><a href="../ko/Macro_EasyAlias.html" class="mw-pt-progress mw-pt-progress--high" title="EasyAlias &#47588;&#53356;&#47196; (89% translated)" lang="ko" dir="ltr">&#54620;&#44397;&#50612;</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Easy-alias-icon.png&amp;filetimestamp=20200207183746&amp;.html" class="mw-file-description"><img src="../File/Easy-alias-icon.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Macro EasyAlias
</p>
</td></tr>
<tr>
<th class="ctOdd">Opis
</th></tr>
<tr>
<td class="ctEven left macro-description">U&#380;yj tego makra, aby szybko i &#322;atwo tworzy&#263; aliasy dla kom&oacute;rek w swoich arkuszach kalkulacyjnych. Makro pobiera etykiety tekstowe, kt&oacute;re wcze&#347;niej utworzy&#322;e&#347; w jednej kolumnie, i wykorzystuje je jako aliasy dla kom&oacute;rek w kolejnej kolumnie.<br><br>Macro version: 2025.06.19<br>Last modified: 2025-06-19<br>FreeCAD version: 0.21<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/5/5e/Easy-alias-icon.png">Ikona paska narz&#281;dzi</a><br>Autor: TheMarkster<br>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;TheMarkster&amp;action=edit&amp;redlink=1.html" class="new" title="User:TheMarkster (page does not exist)">TheMarkster</a>
</td></tr>
<tr>
<th class="ctOdd">Do pobrania
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/5/5e/Easy-alias-icon.png">Ikona paska narz&#281;dzi</a>
</td></tr>
<tr>
<th class="ctOdd">Odno&#347;niki
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../pl/Macros_recipes.html" title="Macros recipes/pl">Przepisy na makropolecenia</a><br><a href="../pl/How_to_install_macros.html" title="How to install macros/pl">Jak zainstalowa&#263; makrodefinicje</a><br><a href="../pl/Customize_Toolbars.html" title="Customize Toolbars/pl">Dostosowanie pask&oacute;w narz&#281;dzi</a>
</td></tr>
<tr>
<th class="ctOdd">Wersja Makrodefinicji
</th></tr>
<tr>
<td class="ctEven macro-version">2025.06.19
</td></tr>
<tr>
<th class="ctOdd">Data zmian
</th></tr>
<tr>
<td class="ctEven macro-date">2025-06-19
</td></tr>
<tr>
<th class="ctOdd">Wersja FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.21
</td></tr>
<tr>
<th class="ctOdd">Domy&#347;lny skr&oacute;t
</th></tr>
<tr>
<td class="ctEven"><i>Brak</i>
</td></tr>
<tr>
<th class="ctOdd">Zobacz r&oacute;wnie&#380;
</th></tr>
<tr>
<td class="ctEven"><i>-</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Opis">Opis</span></h2>
<p>U&#380;yj tego makra, aby szybko i &#322;atwo tworzy&#263; aliasy dla kom&oacute;rek w swoich arkuszach kalkulacyjnych. Makro pobiera etykiety tekstowe, kt&oacute;re wcze&#347;niej utworzy&#322;e&#347; w jednej kolumnie, i wykorzystuje je jako aliasy dla kom&oacute;rek w kolejnej kolumnie. Na przyk&#322;ad etykiety tekstowe w kolumnie A mog&#261; pos&#322;u&#380;y&#263; do utworzenia alias&oacute;w dla odpowiadaj&#261;cych im kom&oacute;rek w kolumnie B. Od wersji 2022.03.21, je&#347;li etykieta zawiera tekst w nawiasach, tylko ten tekst zostanie u&#380;yty jako alias. Przyk&#322;adowo etykieta "Height of top end (topHeight)" (bez cudzys&#322;ow&oacute;w) spowoduje utworzenie aliasu topHeight w s&#261;siedniej kom&oacute;rce.
</p><p><span id="Usage"></span>
</p>
<h2><span id="U.C5.BCycie"></span><span class="mw-headline" id="U&#380;ycie">U&#380;ycie</span></h2>
<p>Zaznacz kom&oacute;rki zawieraj&#261;ce etykiety tekstowe i uruchom makro. S&#261;siednie kom&oacute;rki w nast&#281;pnej kolumnie otrzymaj&#261; aliasy utworzone na podstawie warto&#347;ci tekstowych z zaznaczonych kom&oacute;rek.
</p><p><span typeof="mw:File"><a href="../index.php?title=EasyAlias-scr1.png&amp;filetimestamp=20200207190307&amp;.html" class="mw-file-description"><img src="../File/EasyAlias-scr1.png" decoding="async" width="600" height="293" class="mw-file-element" data-file-width="828" data-file-height="405"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Zrzut ekranu EasyAlias1, etykiety tekstowe z kolumny A s&#261; u&#380;ywane do tworzenia alias&oacute;w w kolumnie B.</p>
<p><span id="Script"></span>
</p>
<h2><span class="mw-headline" id="Skrypt">Skrypt</span></h2>
<p>Ikona paska narz&#281;dzi <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Easy-alias-icon.png&amp;filetimestamp=20200207183746&amp;.html" class="mw-file-description"><img src="../File/Easy-alias-icon.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><b>Macro_EasyAlias.FCMacro</b>
</p>
<pre># -*- coding: utf-8 -*-
import FreeCAD
import re
from PySide import QtGui

"""
EasyAlias.FCMacro.py

This macro can be used to easily create aliases based on the contents of selected spreadsheet
cells in the previous column. As an example, suppose you wish to have the following:

A1: content = 'radius', B1: content = '5', alias = 'radius'
A2: content = 'height', B1: content = '15', alias = 'height'

The traditional way to set this up would be:
Select A1
Enter radius
Select B1
Enter 5
Right-click B1
Select properties
Select Alias
Enter radius
click OK
Select A2
Enter height
Select B2
Enter 15
Right-click B2
Select Properties
Select Alias
Enter height
Click OK

Using this macro, the work flow becomes:
Select A1
Enter radius
Select B1
Enter 5
Select A2
Enter height
Select B2
Enter 15
Select A1 through A2
Run the EasyAlias macro
Done

"""

__title__ = "EasyAlias"
__author__ = "TheMarkster and rosta"
__url__ = "https://wiki.freecad.org/Macro_EasyAlias"
__Wiki__ = "https://wiki.freecad.org/Macro_EasyAlias"
__date__ = "2025.06.19" #year.month.date
__version__ = __date__
__icon__ = "https://wiki.freecad.org/images/5/5e/Easy-alias-icon.png"

CELL_ADDR_RE = re.compile(r"([A-Za-z]+)([1-9]\d*)")
CUSTOM_ALIAS_RE = re.compile(r".*\((.*)\)")
MAGIC_NUMBER = 64
REPLACEMENTS = {
    " ": "_",
    ".": "_",
    "&auml;": "ae",
    "&ouml;": "oe",
    "&uuml;": "ue",
    "&Auml;": "Ae",
    "&Ouml;": "Oe",
    "&Uuml;": "Ue",
    "&szlig;": "ss",
    "'": ""
}

def getSpreadsheets():
    """
    Returns a set of selected spreadsheets in the active document or None if none is selected.
    :returns: a set of selected spreadsheets in the active document or None if none is selected
    :rtype: set
    """

    spreadsheets = set()
    for selectedObject in Gui.Selection.getSelection():
        if selectedObject.TypeId == 'Spreadsheet::Sheet':
            spreadsheets.add(selectedObject)
        elif selectedObject.TypeId == "App::Link":
            linkedObject = selectedObject.LinkedObject
            if linkedObject.TypeId == 'Spreadsheet::Sheet':
                spreadsheets.add(linkedObject)
    if spreadsheets:
        return spreadsheets
    else:
        # check if there is only one spreadsheet and use that one if none are selected
        doc = FreeCAD.ActiveDocument
        if not doc:
            return spreadsheets
        all_spreadsheets = [obj for obj in doc.Objects if obj.isDerivedFrom("Spreadsheet::Sheet")]
        if len(all_spreadsheets) == 1:
            return set(all_spreadsheets)
    return spreadsheets

# The original implementatin of a1_to_rowcol and rowcol_to_a1 can be found here:
# https://github.com/burnash/gspread/blob/master/gspread/utils.py

def a1_to_rowcol(label:str):
    """Translates a cell's address in A1 notation to a tuple of integers.
    :param str label: A cell label in A1 notation, e.g. 'B1'. Letter case is ignored.
    :returns: a tuple containing `row` and `column` numbers. Both indexed from 1 (one).
    :rtype: tuple
    Example:
    &gt;&gt;&gt; a1_to_rowcol('A1')
    (1, 1)
    """

    match = CELL_ADDR_RE.match(label)

    row = int(match.group(2))

    column_label = match.group(1).upper()
    column = 0
    for i, c in enumerate(reversed(column_label)):
        column += (ord(c) - MAGIC_NUMBER) * (26**i)

    return (row, column)

def rowcol_to_a1(row:int, column:int):
    """Translates a row and column cell address to A1 notation.
    :param row: The row of the cell to be converted. Rows start at index 1.
    :type row: int, str
    :param col: The column of the cell to be converted. Columns start at index 1.
    :type row: int, str
    :returns: a string containing the cell's coordinates in A1 notation.
    Example:
    &gt;&gt;&gt; rowcol_to_a1(1, 1)
    A1
    """

    row = int(row)

    column = int(column)
    dividend = column
    column_label = ""
    while dividend:
        (dividend, mod) = divmod(dividend, 26)
        if mod == 0:
            mod = 26
            dividend -= 1
        column_label = chr(mod + MAGIC_NUMBER) + column_label

    label = "{}{}".format(column_label, row)

    return label

def textToAlias(text:str):
    # support for custom aliases between parentheses
    match = CUSTOM_ALIAS_RE.match(text)
    if match:
        return match.group(1)

    for character in REPLACEMENTS:
        text = text.replace(character,REPLACEMENTS.get(character))
    return text

def main():
    spreadsheets = getSpreadsheets()
    if not spreadsheets:
        QtGui.QMessageBox.critical(None, "Error",
            "No spreadsheet selected.\nPlease select a spreadsheet in the tree view.")
        return
    for spreadsheet in spreadsheets:
        for selectedCell in spreadsheet.ViewObject.getView().selectedCells():
            contents = spreadsheet.getContents(selectedCell) #get() throws exception on empty cell
            if contents:
                contents = spreadsheet.get(selectedCell)
                alias = textToAlias(contents)
                row, column = a1_to_rowcol(selectedCell)
                nextCell = rowcol_to_a1(row, column + 1)
                try:
                    spreadsheet.setAlias(nextCell, alias)
                except:
                    inUse = spreadsheet.getCellFromAlias(alias) is not None
                    if inUse:
                        inUseMsg = "&lt;br&gt;&lt;br&gt;&lt;b&gt;Alias&lt;/b&gt; &lt;i&gt;" + alias + "&lt;/i&gt;&lt;b&gt; is already in use at " + \
                        spreadsheet.getCellFromAlias(alias) + ", cannot have duplicate aliases.&lt;/b&gt;"
                    else:
                        inUseMsg = "&lt;br&gt;&lt;br&gt;&lt;b&gt;Remember, aliases cannot begin with a numeral or an " + \
                        "underscore or contain any invalid characters.&lt;/b&gt;"
                    QtGui.QMessageBox.critical(None, "Error",
                        "Unable to set alias &lt;i&gt;" + alias + "&lt;/i&gt; at cell " + nextCell +
                        "&lt;br&gt;in spreadsheet &lt;i&gt;" + spreadsheet.FullName + "&lt;/i&gt;." + inUseMsg)

    App.ActiveDocument.recompute()

main()</pre>
<!-- 
NewPP limit report
Cached time: 20250725120344
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.023 seconds
Real time usage: 0.041 seconds
Preprocessor visited node count: 99/1000000
Post&#8208;expand include size: 2593/2097152 bytes
Template argument size: 6708/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 7078/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   12.592      1 -total
 46.62%    5.870      1 Template:MacroCode
 45.35%    5.711      1 Template:Macro/pl
  6.66%    0.839      1 Template:Caption
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:290419-0!canonical and timestamp 20250725120344 and revision id 1617792. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>