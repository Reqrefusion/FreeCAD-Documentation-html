<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Tutorial KinematicController/pl</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../de/Tutorial_KinematicController.html" class="mw-pt-progress mw-pt-progress--complete" title="Anleitung Kinematiksteuerung (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Tutorial_KinematicController.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Tutorial KinematicController (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Tutorial_KinematicController.html" class="mw-pt-progress mw-pt-progress--complete" title="Assembly3 Tutoriel de contr&ocirc;leur cin&eacute;matique (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="pl" dir="ltr">polski</span></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="32" height="32"></span></span> &#262;wiczenie
</td></tr>
<tr>
<th class="ctOdd">Temat
</th></tr>
<tr>
<td class="ctEven">Sterownik kinematyczny utworzony w &#347;rodowisku Python
</td></tr>
<tr>
<th class="ctOdd">Poziom trudno&#347;ci
</th></tr>
<tr>
<td class="ctEven">Przydatna jest podstawowa znajomo&#347;&#263; j&#281;zyka Python
</td></tr>
<tr>
<th class="ctOdd">Czas wykonania
</th></tr>
<tr>
<td class="ctEven">1 godzina
</td></tr>
<tr>
<th class="ctOdd">Autorzy
</th></tr>
<tr>
<td class="ctEven"><a href="../User;FBXL5.html" title="User:FBXL5">FBXL5</a>
</td></tr>
<tr>
<th class="ctOdd">Wersja FreeCAD
</th></tr>
<tr>
<td class="ctEven">0.20 lub nowszy
</td></tr>
<tr>
<th class="ctOdd">Pliki z przyk&#322;adami
</th></tr>
<tr>
<td class="ctEven"><i>Nie do&#322;&#261;czono</i>
</td></tr>
<tr>
<th class="ctOdd">Zobacz r&oacute;wnie&#380;
</th></tr>
<tr>
<td class="ctEven"><i>-</i>
</td></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr></tbody></table>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Wprowadzenie">Wprowadzenie</span></h2>
<p>Ten poradnik opisuje jak z kilku linijek kodu Python wygenerowa&#263; prosty kontroler kinematyczny do u&#380;ycia z zespo&#322;ami utworzonymi za pomoc&#261; &#347;rodowiska pracy <a href="../pl/Assembly3_Workbench.html" title="Assembly3 Workbench/pl">Z&#322;o&#380;enie 3</a>.
</p><p>Do kodowania mo&#380;na u&#380;y&#263; dowolnego edytora tekstu. M&oacute;j wyb&oacute;r to Atom, ale wbudowany edytor FreeCAD te&#380; dzia&#322;a dobrze.
</p><p>Poni&#380;sze przyk&#322;ady kodu mo&#380;na skopiowa&#263; i wklei&#263; do pustego pliku tekstowego, a nast&#281;pnie zapisa&#263; pod wybran&#261; nazw&#261; jako plik typu <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.py</span> lub <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.FCMacro</span>.
</p><p><span id="Macro_sections"></span>
</p>
<h2><span class="mw-headline" id="Sekcje_makrodefinicji">Sekcje makrodefinicji</span></h2>
<p><span id="Basic_structure"></span>
</p>
<h3><span class="mw-headline" id="Podstawowa_struktura">Podstawowa struktura</span></h3>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2022 Your name LGPL</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Podstawowa struktura sk&#322;ada si&#281; z funkcji <code>main()</code> oraz prze&#322;&#261;cznika sprawdzaj&#261;cego, czy makro jest u&#380;ywane jako kontener dla klas, metod itp. czy te&#380; jest uruchamiane samodzielnie. Tylko druga opcja powoduje uruchomienie funkcji <code>main()</code>. Funkcja ta jest na razie pusta.
</p><p><span id="Find_driving_constraints"></span>
</p>
<h3><span id="Wyznacz_wi.C4.99zy_prowadz.C4.85ce"></span><span class="mw-headline" id="Wyznacz_wi&#281;zy_prowadz&#261;ce">Wyznacz wi&#281;zy prowadz&#261;ce</span></h3>
<p>Wi&#281;zy prowadz&#261;ce s&#261; obiektami w obr&#281;bie dokumentu FreeCAD. Nale&#380;y je oznaczy&#263;, aby mo&#380;na by&#322;o je odnale&#378;&#263;.
</p><p>Dla tego kontrolera przyrostek <code>"Driver"</code> musi by&#263; do&#322;&#261;czony do etykiety wi&#261;zania prowadz&#261;cego. Mo&#380;e on by&#263; oddzielony znakiem <code>"."</code> lub <code>"-"</code> dla jasno&#347;ci, poniewa&#380; b&#281;dziemy sprawdza&#263; tylko czy etykieta ko&#324;czy si&#281; <code>"Driver"</code>.
</p><p>Funkcja, kt&oacute;ra otrzymuje obiekt dokumentu i zwraca list&#281; wi&#281;z&oacute;w prowadz&#261;cych <i>(nazwy w tym przypadku)</i> wykona zadanie.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>
</pre></div>
<p>Funkcja <code>main()</code> &#322;aduje aktywny dokument do zmiennej <code>kin_doc</code>, a nast&#281;pnie wywo&#322;uje funkcj&#281; <code>findTheDrivingConstraints()</code> i przekazuje jej zawarto&#347;&#263; <code>kin_doc</code>. Zwr&oacute;cona lista jest &#322;adowana do <code>drivers</code>, kt&oacute;ra nast&#281;pnie jest sprawdzana, czy zawiera przynajmniej jeden element. Je&#347;li tak jest, lista jest ostatecznie wy&#347;wietlona w widoku <a href="../pl/Report_view.html" title="Report view/pl">Raportu</a>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span>
</pre></div>
<div class="mw-collapsible mw-collapsed">
<p><b>Dotychczasowe makrodefinicje ...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Control_panel"></span>
</p>
<h3><span class="mw-headline" id="Panel_sterowania">Panel sterowania</span></h3>
<p>Panel sterowania jest zbudowany z wid&#380;et&oacute;w Qt, jedno g&#322;&oacute;wne okno zawieraj&#261;ce kilka wid&#380;et&oacute;w wej&#347;cia / wyj&#347;cia.
</p><p>Ka&#380;dy wid&#380;et musi zosta&#263; zaimportowany, zanim b&#281;dzie mo&#380;na go u&#380;y&#263;, ale mo&#380;na je zaimportowa&#263; jako pojedynczy zestaw. Linia importu jest umieszczona w pobli&#380;u g&oacute;rnej cz&#281;&#347;ci pliku.
</p><p><span id="Main_window"></span>
</p>
<h4><span id="Okno_g.C5.82.C3.B3wne"></span><span class="mw-headline" id="Okno_g&#322;&oacute;wne">Okno g&#322;&oacute;wne</span></h4>
<p>W g&#322;&oacute;wnym oknie linia importu wygl&#261;da tak:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">)</span>
</pre></div>
<p>Okno g&#322;&oacute;wne o nazwie <code>ControlPanel</code> to obiekt klasy utworzony z wid&#380;etu <code>QDialog</code>.
</p><p>Posiada ona dwie metody init. Metoda <code>__init__()</code> inicjalizuje nowy obiekt klasy, obs&#322;uguje przychodz&#261;ce argumenty oraz uruchamia metod&#281; <code>initUI()</code>, kt&oacute;ra zarz&#261;dza wszystkimi wid&#380;etami w obr&#281;bie okna g&#322;&oacute;wnego.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
<p>Aby uruchomi&#263; pojedynczy panel sterowania, zostanie utworzona instancja tej klasy o nazwie <code>panel</code>, z <code>kin_doc</code> <i>(obiekt dokumentu)</i> oraz <code>drivers[0]</code> <i>(pierwsze z listy wi&#261;za&#324; dotycz&#261;cych prowadzenia)</i> przekazanymi do tej instancji. Na koniec metoda <code>exec_()</code> klasy otwiera okno dialogowe.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">drivers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</pre></div>
<p>Aby obs&#322;u&#380;y&#263; wi&#281;cej ni&#380; jeden sterownik, musimy sprawdzi&#263; list&#281; sterownik&oacute;w i utworzy&#263; instancj&#281; dla ka&#380;dej pozycji na li&#347;cie i przenie&#347;&#263; bie&#380;&#261;c&#261; pozycj&#281;.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
    <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
    <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
<span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
</pre></div>
<p>Te linie zast&#281;puj&#261; polecenie <code>print()</code> w ga&#322;&#281;zi <i>else</i> funkcji <code>main()</code>.
</p><p>Uwaga: Zebranie <code>panel_list</code> pozwala na uruchomienie wszystkich paneli jednocze&#347;nie. <i>(Nie potrafi&#281; jeszcze wyja&#347;ni&#263; tego zachowania...)</i>
</p><p>Uruchomienie makra spowoduje wy&#347;wietlenie nowego, pustego okna dialogowego czekaj&#261;cego na wid&#380;ety:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-01.png&amp;filetimestamp=20220422085424&amp;.html" class="mw-file-description" title="Puste okno dialogowe"><img alt="Puste okno dialogowe" src="../File/Tutorial_KinCon-01.png" decoding="async" width="300" height="225"></a></span>
</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Dotychczasowe makrodefinicje ...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Setting_parameters"></span>
</p>
<h4><span id="Ustawienie_parametr.C3.B3w"></span><span class="mw-headline" id="Ustawienie_parametr&oacute;w">Ustawienie parametr&oacute;w</span></h4>
<p>Teraz przyszed&#322; czas na wype&#322;nienie metody <code>initUI()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
<p><code>self.actuator</code> reprezentuje wi&#261;zanie nap&#281;dowe, a <code>self.driver_type</code> przechowuje s&#322;owo kluczowe dla jego typu. To ostatnie jest u&#380;ywane do wyboru odpowiedniej w&#322;a&#347;ciwo&#347;ci z ka&#380;dym wi&#261;zaniem.
</p><p><span id="Method_getDriverType()"></span>
</p>
<h5><span id="Metoda_getDriverType.28.29"></span><span class="mw-headline" id="Metoda_getDriverType()">Metoda getDriverType()</span></h5>
<p>Do p&oacute;&#378;niejszego u&#380;ycia potrzebujemy typ sterownika <i>(K&#261;t, Odleg&#322;o&#347;&#263;, D&#322;ugo&#347;&#263;)</i> i dlatego nale&#380;y zdefiniowa&#263; metod&#281; <code>getDriverType()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>
<span class="o">...</span>
</pre></div>
<p>Metoda ta sprawdza, czy typ podanego wi&#261;zania mo&#380;na znale&#378;&#263; na jednej z list i zwraca, kt&oacute;ry rodzaj wymiaru ma by&#263; kontrolowany.
</p><p>Zak&#322;ada si&#281;, &#380;e w dokumencie kinematycznym sterownik jest zaznaczony poprawnie i dzia&#322;a, je&#347;li jest edytowany r&#281;cznie. W tym przypadku nie ma potrzeby filtrowania wi&#261;za&#324; geometrycznych takich jak Wsp&oacute;&#322;liniowo&#347;&#263; czy Zbie&#380;no&#347;&#263; punktu <i>(ale tutaj by&#322;oby to uzasadnione ...)</i>.
</p><p><span id="Window_properties"></span>
</p>
<h5><span class="mw-headline" id="Ustawienia_okna">Ustawienia okna</span></h5>
<p>Rozmiar okna jest okre&#347;lony przez jego minimalny i maksymalny wymiar. U&#380;ycie tych samych warto&#347;ci powoduje, &#380;e rozmiar jest sta&#322;y.
</p><p>Tytu&#322; pokazuje nazw&#281; sterownika i czy jest to k&#261;t, odleg&#322;o&#347;&#263; czy d&#322;ugo&#347;&#263;. Wreszcie okno ma pozosta&#263; na wierzchu wszystkich okien.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>
        <span class="c1"># now make the window visible</span>
<span class="o">...</span>
</pre></div>
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Setting_more_parameters"></span>
</p>
<h4><span id="Ustawienie_dodatkowych_parametr.C3.B3w"></span><span class="mw-headline" id="Ustawienie_dodatkowych_parametr&oacute;w">Ustawienie dodatkowych parametr&oacute;w</span></h4>
<p>Kolejnym krokiem jest wyodr&#281;bnienie aktualnej warto&#347;ci sterownika i ustawienie domy&#347;lnych warto&#347;ci pocz&#261;tkowych i ko&#324;cowych w zale&#380;no&#347;ci od typu sterownika.
</p><p>Odleg&#322;o&#347;&#263; nie mo&#380;e by&#263; ujemna i dok&#322;adnie zero stanowi zagadk&#281; dla rozwi&#261;zania, dlatego warto&#347;&#263; pocz&#261;tkowa jest ustawiona na 0,001. K&#261;ty przyjmuj&#261; warto&#347;ci ujemne i otrzymuj&#261; warto&#347;ci symetryczne. <i>(Czy d&#322;ugo&#347;ci przyjmuj&#261; warto&#347;ci ujemne trzeba ostatecznie udowodni&#263; ...)</i>
</p><p>Przyrostek jednostki musi zosta&#263; zachowany, aby na ko&#324;cu zwr&oacute;ci&#263; warto&#347;&#263; do w&#322;a&#347;ciwo&#347;ci wi&#261;zanie. Odleg&#322;o&#347;ci i d&#322;ugo&#347;ci wymagaj&#261; warto&#347;ci z jednostkami.
</p><p>Radzenie sobie z jednostkami i wy&#347;wietlanie warto&#347;ci jako ci&#261;g&oacute;w w kilku wid&#380;etach wymaga do&#347;&#263; cz&#281;sto konwersji liczb na ci&#261;gi i odwrotnie.
</p><p>Aby uzupe&#322;ni&#263; parametry ustawiamy domy&#347;ln&#261; liczb&#281; krok&oacute;w, kt&oacute;re powinny by&#263; obliczane podczas automatyzacji ruchu, a je&#347;li prze&#322;&#261;cznik <code>self.sequence</code> jest ustawiony na warto&#347;&#263; <code>True</code>, to przy ka&#380;dym kroku ruchu b&#281;dzie robione zdj&#281;cie.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Labels"></span>
</p>
<h4><span class="mw-headline" id="Etykiety">Etykiety</span></h4>
<p>Teraz dodano trzy etykiety, kt&oacute;re wy&#347;wietlaj&#261; warto&#347;&#263; pocz&#261;tkow&#261;, ko&#324;cow&#261; i bie&#380;&#261;c&#261;.
</p><p>Najpierw nale&#380;y zaimportowa&#263; klas&#281; <code>QLabel</code>, tzn. rozszerzy&#263; list&#281; importu w spos&oacute;b nast&#281;puj&#261;cy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">)</span>
</pre></div>
<p>Wracaj&#261;c do metody <code>initUI()</code> wstawiamy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
<span class="o">...</span>
</pre></div>
<p>Umieszczenie odbywa si&#281; za pomoc&#261; dziedziczonej metody <code>setGeometry()</code>. W tym przypadku wykorzystywany jest opis prostok&#261;ta <i>(pozycja X, pozycja Y, szeroko&#347;&#263;, wysoko&#347;&#263;)</i>.
</p><p>Pierwszy i trzeci wiersz mo&#380;na by po&#322;&#261;czy&#263;, ale nie jest to zalecane ze wzgl&#281;du na przejrzysto&#347;&#263;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">),</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>
<p>Uruchomienie makra z dokumentem zespo&#322;u kinematycznego spowoduje powstanie okna dialogowego jak poni&#380;ej:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-02.png&amp;filetimestamp=20220426092511&amp;.html" class="mw-file-description" title="Okno dialogowe wy&#347;wietlaj&#261;ce warto&#347;&#263; pocz&#261;tkow&#261;, warto&#347;&#263; bie&#380;&#261;c&#261; i warto&#347;&#263; ko&#324;cow&#261;"><img alt="Okno dialogowe wy&#347;wietlaj&#261;ce warto&#347;&#263; pocz&#261;tkow&#261;, warto&#347;&#263; bie&#380;&#261;c&#261; i warto&#347;&#263; ko&#324;cow&#261;" src="../File/Tutorial_KinCon-02.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Okno dialogowe wy&#347;wietlaj&#261;ce etykiet&#281; wi&#261;zania i typ sterownika w tytule oraz warto&#347;&#263; pocz&#261;tkow&#261;, warto&#347;&#263; bie&#380;&#261;c&#261; i warto&#347;&#263; ko&#324;cow&#261; w pierwszej linii w obszarze g&#322;&oacute;wnym</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Dotychczasowe makrodefinicje ...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Slider"></span>
</p>
<h4><span class="mw-headline" id="Suwak">Suwak</span></h4>
<p>Aby zmieni&#263; bie&#380;&#261;c&#261; warto&#347;&#263; na dowoln&#261; liczb&#281; mi&#281;dzy warto&#347;ci&#261; pocz&#261;tkow&#261; a ko&#324;cow&#261;, przydatny by&#322;by wid&#380;et suwaka.
</p><p>Najpierw nale&#380;y zaimportowa&#263; klas&#281; <code>QSlider</code>, tzn. rozszerzy&#263; list&#281; importu w spos&oacute;b nast&#281;puj&#261;cy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">)</span>
</pre></div>
<p>Wracaj&#261;c do metody <code>initUI()</code> i zaraz po sekcji <i>labels</i> wstawiamy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Przycisk suwaka jest umieszczany za pomoc&#261; metody <code>setValue()</code>. Jego warto&#347;&#263; musi by&#263; obliczona z bie&#380;&#261;cej warto&#347;ci i wsp&oacute;&#322;czynnika kroku. Stosunek ten musi by&#263; obliczany przy ka&#380;dej zmianie warto&#347;ci pocz&#261;tkowej lub ko&#324;cowej, dlatego po metodzie <code>getDriverType()</code> wstawiamy kolejn&#261; metod&#281;.
</p><p>Praca z proporcj&#261; zamiast zmiany warto&#347;ci minimalnych i maksymalnych suwaka ma t&#281; zalet&#281;, &#380;e pozwala na uzyskanie wi&#281;kszej rozdzielczo&#347;ci dla ma&#322;ych warto&#347;ci.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>
<span class="o">...</span>
</pre></div>
<p>A po niej przychodzi kolejna metoda okre&#347;laj&#261;ca, co zrobi&#263;, gdy zmieni si&#281; pozycja suwaka lub jego warto&#347;&#263;. Metoda <code>onActuatorSlider()</code> jest wywo&#322;ywana przez metod&#281; <code>connect()</code>, kt&oacute;ra jako argument przekazuje r&oacute;wnie&#380; warto&#347;&#263; suwaka.
</p><p>Przelicza bie&#380;&#261;c&#261; warto&#347;&#263; z pozycji suwaka, przepisuje tekst etykiety <code>self.label_current</code> i zmienia w&#322;a&#347;ciwo&#347;&#263; wi&#261;zania zgodnie z typem sterownika.
</p><p>Uruchomienie polecenia <code>"asm3CmdQuickSolve"</code> uruchamia solver do ponownego u&#322;o&#380;enia cz&#281;&#347;ci zespo&#322;u ze zmienion&#261; warto&#347;ci&#261;.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Okno dialogowe z suwakiem powinno wygl&#261;da&#263; tak i jest gotowe do sterowania ruchem:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-03.png&amp;filetimestamp=20220430124115&amp;.html" class="mw-file-description" title="Dwa okna dialogowe z suwakiem"><img alt="Dwa okna dialogowe z suwakiem" src="../File/Tutorial_KinCon-03.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Okna dialogowez dodanym suwakiem, jedno dla sterownika <i>Angle</i> i jedno dla sterownika <i>Distance</i>.</p>
<p>Mo&#380;emy uruchomi&#263; okno dialogowe dla dowolnego otwartego dokumentu, nie b&#281;d&#261; one ze sob&#261; kolidowa&#263;.
</p>
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Text_entry_fields"></span>
</p>
<h4><span class="mw-headline" id="Pola_tekstowe_wprowadzania_danych">Pola tekstowe wprowadzania danych</span></h4>
<p>Do ustawienia warto&#347;ci pocz&#261;tkowej i ko&#324;cowej u&#380;ywamy wid&#380;etu edycji linii.
</p><p>Najpierw nale&#380;y zaimportowa&#263; klas&#281; <code>QLineEdit</code>, tzn. rozszerzy&#263; list&#281; importu w spos&oacute;b nast&#281;puj&#261;cy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">)</span>
</pre></div>
<p>Z powrotem w metodzie <code>initUI()</code> i pomi&#281;dzy etykietami a sekcjami suwak&oacute;w wstawiamy:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Pola wpis&oacute;w wy&#347;wietlaj&#261; domy&#347;lne warto&#347;ci pocz&#261;tkowe i ko&#324;cowe. Nie s&#261; one kompletne, dop&oacute;ki nie dodamy metod radz&#261;cych sobie ze zmienionymi wpisami. Zrobi&#261; to metody <code>self.onEntryStart()</code> i <code>self.onEntryEnd()</code>, kt&oacute;re s&#261; wstawione pomi&#281;dzy metody <code>self.stepRatio()</code> i <code>self.onActuatorSlider()</code>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Oba konwertuj&#261; otrzyman&#261; warto&#347;&#263; &#322;a&#324;cuchow&#261; na liczb&#281; zmiennoprzecinkow&#261; i odpowiednio zmieniaj&#261; <code>self.start_value</code> lub <code>self.end_value</code> oraz odpowiadaj&#261;c&#261; im etykiet&#281;. Po tym warto&#347;&#263; suwaka jest aktualizowana.
</p><p>Okno dialogowe z polami do wprowadzania tekstu powinno wygl&#261;da&#263; tak i jest gotowe do zmiany zakresu ruchu:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-04.png&amp;filetimestamp=20220502070952&amp;.html" class="mw-file-description" title="Dwa okna dialogowe z polami do edycji linii"><img alt="Dwa okna dialogowe z polami do edycji linii" src="../File/Tutorial_KinCon-04.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Okna dialogowe z polami edycji linii, ponownie dla sterownika k&#261;ta i odleg&#322;o&#347;ci.</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Dotychczasowe makrodefinicje ...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">slider_value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Motion"></span>
</p>
<h3><span class="mw-headline" id="Ruch">Ruch</span></h3>
<p>Aby wprawi&#263; zesp&oacute;&#322; w ruch potrzebujemy:
</p>
<ul><li>Przyciski do wyzwalania ruchu w po&#380;&#261;danym kierunku.</li>
<li>Pole wej&#347;ciowe do zmiany liczby krok&oacute;w dla szybszych lub bardziej p&#322;ynnych ruch&oacute;w.</li>
<li>Pole wyboru do wskazania, czy chcemy wykona&#263; sekwencj&#281; zdj&#281;&#263;.</li></ul>
<p><span id="Forward_and_Backward_buttons"></span>
</p>
<h4><span id="Przyciski_w_prz.C3.B3d_i_w_ty.C5.82"></span><span class="mw-headline" id="Przyciski_w_prz&oacute;d_i_w_ty&#322;">Przyciski w prz&oacute;d i w ty&#322;</span></h4>
<p>Aby automatycznie przesuwa&#263; cz&#281;&#347;ci monta&#380;owe, potrzebujemy dw&oacute;ch przycisk&oacute;w do wyzwalania ruch&oacute;w, jednego w kierunku pozycji pocz&#261;tkowej i jednego w kierunku pozycji ko&#324;cowej. Te dwa oraz przycisk zamykaj&#261;cy wykorzystaj&#261; wid&#380;et <code>QPushButton</code>.
</p><p>Ma&#322;e z&#322;o&#380;enia obliczaj&#261; si&#281; troch&#281; za szybko i pokazuj&#261; skoki zamiast p&#322;ynnego ruchu. Aby go spowolni&#263;, u&#380;ywamy metody <code>sleep()</code> modu&#322;u <code>time</code>, kt&oacute;ry najpierw trzeba zaimportowa&#263;.
</p><p>Kolejny import i kolejny wid&#380;et:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">)</span>
</pre></div>
<p>Wracaj&#261;c do metody <code>initUI()</code> wstawiamy przyciski po sekcji <i>slider</i>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Metody zajmuj&#261;ce si&#281; wciskanymi przyciskami to <code>self.onForward()</code>, <code>self.onBackward()</code> oraz <code>self.onClose()</code>. S&#261; one wstawiane po metodzie <code>onActuatorSlider()</code>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="o">...</span>
</pre></div>
<p>Metoda <code>self.onClose()</code> wywo&#322;uje dziedziczon&#261; metod&#281; <code>self.close()</code>, kt&oacute;ra po prostu zamyka okno dialogowe i tym samym ko&#324;czy dzia&#322;anie makrodefinicji.
</p><p>Zar&oacute;wno <code>self.onForward()</code> jak i <code>self.onBackward()</code> licz&#261; kroki, kt&oacute;re pozosta&#322;y do wykonania, aby osi&#261;gn&#261;&#263; &#380;&#261;dan&#261; pozycj&#281; i obliczaj&#261; d&#322;ugo&#347;&#263; kroku zgodnie na podstawie ich liczby. Wst&#281;pnie przyjmiemy domy&#347;ln&#261; liczb&#281; 10 krok&oacute;w.
</p><p>Ka&#380;da runda p&#281;tli <i>while</i> zwi&#281;ksza / zmniejsza bie&#380;&#261;c&#261; warto&#347;&#263; i aktualizuje warto&#347;ci suwak&oacute;w, co powoduje uruchomienie <code>onActuatorSlider()</code> w tle <i>(patrz <a href="#Suwak">Akapit Suwak</a>)</i>. Po przerwie, aby komputer dostarczy&#322; kolejny zaktualizowany widok 3D, odliczanie krok&oacute;w pozosta&#322;ych do przej&#347;cia ko&#324;czy p&#281;tl&#281;.
</p><p>Gdy nie ma ju&#380; &#380;adnych krok&oacute;w, suwak jest ustawiany na pierwsz&#261; / ostatni&#261; pozycj&#281;, tak na wszelki wypadek, gdyby wyst&#261;pi&#322; b&#322;&#261;d zaokr&#261;glenia.
</p><p>Okno dialogowe z przyciskami powinno wygl&#261;da&#263; tak i mo&#380;na teraz przesun&#261;&#263; zesp&oacute;&#322; o 10 krok&oacute;w w kierunku &#380;&#261;danej pozycji pocz&#261;tkowej / ko&#324;cowej:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-05.png&amp;filetimestamp=20220503151644&amp;.html" class="mw-file-description" title="Okno dialogowe z przyciskami"><img alt="Okno dialogowe z przyciskami" src="../File/Tutorial_KinCon-05.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Okno dialogowe z przyciskami.</p>
<div class="mw-collapsible mw-collapsed">
<p><b>Dotychczasowe makrodefinicje ...</b>
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span> <span class="c1"># screen update between steps</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Number_of_steps"></span>
</p>
<h4><span id="Liczba_krok.C3.B3w"></span><span class="mw-headline" id="Liczba_krok&oacute;w">Liczba krok&oacute;w</span></h4>
<p>Domy&#347;lnym ustawieniem jest uzyskanie szybkiego wra&#380;enia, czy zesp&oacute;&#322; porusza si&#281; zgodnie z oczekiwaniami, bez marnowania zbyt wiele czasu obliczeniowego.
</p><p>Je&#347;li cz&#281;&#347;ci skacz&#261;, a nie poruszaj&#261; si&#281; p&#322;ynnie, lub je&#347;li sterowniki oparte na k&#261;tach maj&#261; tendencj&#281; do powodowania problem&oacute;w, gdy r&oacute;&#380;nica mi&#281;dzy dwoma k&#261;tami jest zbyt du&#380;a, to oba te przypadki mo&#380;na naprawi&#263; poprzez zwi&#281;kszenie liczby krok&oacute;w.
</p><p>I tak kolejny wid&#380;et edycji linii jest u&#380;ywany do zmiany liczby krok&oacute;w <i>(umieszczony po istniej&#261;cych wid&#380;etach edycji linii)</i>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># text input field - number of steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntrySteps</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Powi&#261;zana metoda <code>self.onEntrySteps()</code> po prostu wype&#322;nia parametr <code>self.step_value</code> wprowadzon&#261; warto&#347;ci&#261;. Jest ona wstawiana po metodzie <code>onEntryEnd()</code>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onEntrySteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_steps</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_steps</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Okno dialogowe umo&#380;liwiaj&#261;ce zmian&#281; liczby krok&oacute;w powinno wygl&#261;da&#263; nast&#281;puj&#261;co:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-06.png&amp;filetimestamp=20220509085800&amp;.html" class="mw-file-description" title="Okno dialogowe z kolejnym polem do wpisywania tekstu"><img alt="Okno dialogowe z kolejnym polem do wpisywania tekstu" src="../File/Tutorial_KinCon-06.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Okno dialogowe z nast&#281;pnym polem do wpisywania tekstu</p>
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Image_sequence"></span>
</p>
<h4><span id="Sekwencja_obraz.C3.B3w"></span><span class="mw-headline" id="Sekwencja_obraz&oacute;w">Sekwencja obraz&oacute;w</span></h4>
<p>Gdy ruch wykonywany przez z&#322;o&#380;enie spe&#322;nia nasze oczekiwania, mo&#380;emy zrobi&#263; zdj&#281;cie ka&#380;dego kroku. Powsta&#322;a sekwencja zdj&#281;&#263; mo&#380;e pos&#322;u&#380;y&#263; do stworzenia kr&oacute;tkiej animacji gif.
</p><p>Do realizacji tej funkcjonalno&#347;ci potrzebujemy wid&#380;etu <code>QCheckBox</code>, oraz katalogu do przechowywania obrazk&oacute;w.
</p><p>Jeszcze jeden import i wid&#380;et:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">)</span>
</pre></div>
<p>Wracaj&#261;c do metody <code>initUI()</code> wstawiamy pole wyboru po sekcji suwaka:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
        <span class="c1"># output check box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Check to record an image sequence"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"checkBoxOutput"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOutputClicked</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Metoda <code>onOutputClicked()</code> synchronizuje parametr <code>self.sequence</code> i wy&#347;wietlenie znaku kontrolnego.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">onOutputClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Do okre&#347;lenia parametr&oacute;w wyj&#347;ciowych u&#380;ywamy metody <code>output()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="s2">".../FreeCAD/ScreenShots/Sequence"</span>
            <span class="n">file_tag</span> <span class="o">=</span> <span class="s2">".png"</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mi">640</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">480</span>
            <span class="n">background</span> <span class="o">=</span> <span class="s2">"Transparent"</span>
            <span class="c1"># dealing with leading zeros</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Out of Range"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"00"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="c1"># Screen shot</span>
            <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">image_path</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="n">file_tag</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Przede wszystkim &#347;cie&#380;ka do obraz&oacute;w musi by&#263; dostosowana do Twojego systemu operacyjnego. Ostatni&#261; cz&#281;&#347;ci&#261; jest okre&#347;lenie nazwy obrazu bez numeru bie&#380;&#261;cego i tagu pliku. Na razie trzeba to zrobi&#263; samodzielnie.
</p><p>Nast&#281;pnie pod&#261;&#380;aj za tagiem pliku, aby zako&#324;czy&#263; nazw&#281; obrazu, nada&#263; wysoko&#347;&#263; i szeroko&#347;&#263; obrazu oraz spos&oacute;b wype&#322;nienia t&#322;a (<code>"Bie&#380;&#261;ce"</code> <i>(t&#322;o widoku 3D)</i>, <code>"Bia&#322;e"</code>, <code>"Czarne"</code> lub <code>"Przezroczyste"</code>).
</p><p>Aby zawsze mie&#263; trzycyfrow&#261; liczb&#281;, nale&#380;y przed parametrem licznika umie&#347;ci&#263; wiod&#261;ce zera.
</p><p>W ko&#324;cu oskryptowana wersja polecenia <span typeof="mw:File"><a href="../index.php?title=Std_ViewScreenShot.svg&amp;filetimestamp=20240704220016&amp;.html" class="mw-file-description"><img src="../File/Std_ViewScreenShot.svg" decoding="async" width="24" height="24"></a></span> <a href="../pl/Std_ViewScreenShot.html" title="Std ViewScreenShot/pl">Zrzut ekranu</a> jest u&#380;ywana do robienia zdj&#281;cia na podstawie wspomnianych parametr&oacute;w.
</p><p>Nadal nie zrobiono zdj&#281;&#263;!!! Nie ma problemu, poniewa&#380; ta metoda nie zosta&#322;a jeszcze wywo&#322;ana, a wi&#281;c musimy wstawi&#263; wywo&#322;anie w p&#281;tli <i>while</i> <code>onForward()</code> i <code>onBackward()</code>. Zaraz po <code>time.sleep(0,2)</code> wstawiamy t&#281; lini&#281;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="o">...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
<p>Teraz makrodefinicja powinno by&#263; gotowa do sterowania z&#322;o&#380;eniem oraz do robienia zdj&#281;&#263; do animowanego gifa.
</p><p>Ko&#324;cowa wersja okna dialogowego:
</p><p><span typeof="mw:File"><a href="../index.php?title=Tutorial_KinCon-07.png&amp;filetimestamp=20220509122059&amp;.html" class="mw-file-description" title="Dialog window finished"><img alt="Dialog window finished" src="../File/Tutorial_KinCon-07.png" decoding="async" width="300" height="225"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">Uko&#324;czone okno dialogowe.</p>
<div class="mw-collapsible mw-collapsed">
<p><b>I wreszcie ca&#322;e makro</b>
</p>
<div class="mw-collapsible-content">
<p><b>Nie zapomnij ustawi&#263; &#347;cie&#380;ki w metodzie output()!</b>
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2021 Your name LGPL</span>

<span class="c1"># imports and constants</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QSlider</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QCheckBox</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ControlPanel</span><span class="p">(</span><span class="n">QDialog</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    docstring for ControlPanel.</span>
<span class="sd">    """</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ControlPanel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">document</span><span class="p">,</span> <span class="n">actuator</span><span class="p">):</span>
        <span class="c1"># Setting up class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Angle must not be &lt;= 0 and &gt;=180</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="mf">179.999</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" &deg;"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="mf">0.001</span> <span class="c1"># Distance must not be &lt;= 0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span> <span class="o">=</span> <span class="p">(</span><span class="s2">" mm"</span><span class="p">)</span>

        <span class="c1"># the window has 640 x 480 pixels and is centered by default</span>
        <span class="c1">#- set window dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMaximumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setMinimumHeight</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Label</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFlags</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">WindowStaysOnTopHint</span><span class="p">)</span>

        <span class="c1"># create some labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span> <span class="c1"># set to a non-proportional font</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="s2">"osifont"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">130</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>

        <span class="c1"># create some input elements</span>

        <span class="c1"># text input field - Start value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_start</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryStart</span><span class="p">)</span>

        <span class="c1"># text input field - End value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">320</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_end</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntryEnd</span><span class="p">)</span>

        <span class="c1"># text input field - number of steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_steps</span><span class="o">.</span><span class="n">textChanged</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onEntrySteps</span><span class="p">)</span>

        <span class="c1"># Horizontal slider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span> <span class="o">=</span> <span class="n">QSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>                             <span class="c1"># create horizontalSlider</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setOrientation</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">)</span>        <span class="c1"># orientation horizontal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>  <span class="c1"># position coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"horizontalSlider"</span><span class="p">)</span>           <span class="c1"># object name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setInvertedAppearance</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>                <span class="c1"># default: right to left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>                            <span class="c1"># default: (0, 99)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onActuatorSlider</span><span class="p">)</span>

        <span class="c1"># output check box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Check to record an image sequence"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">"checkBoxOutput"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onOutputClicked</span><span class="p">)</span>

        <span class="c1"># forward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&gt;-&gt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onForward</span><span class="p">)</span>
        <span class="c1"># backward button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"&lt;-&lt;"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backward_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onBackward</span><span class="p">)</span>
        <span class="c1"># close button</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">"Close window"</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QRect</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">25</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">onClose</span><span class="p">)</span>

        <span class="c1"># now make the window visible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getDriverType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">constraint</span><span class="p">):</span>
        <span class="n">ANGLE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PlaneCoincident"</span><span class="p">,</span>
            <span class="s2">"AxialAlignment"</span><span class="p">,</span>
            <span class="s2">"PlaneAlignment"</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use negative values, too</span>
        <span class="n">ANGLE_DEG_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"Angle"</span><span class="p">,</span>
            <span class="p">]</span> <span class="c1"># Angel constraints that use positive values only</span>
        <span class="n">DISTANCE_CONSTRAINTS</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">"PointDistance"</span><span class="p">,</span>
            <span class="s2">"PointsDistance"</span>
            <span class="p">]</span> <span class="c1"># Lenght constraints that use positive values only</span>
        <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Angle"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">ANGLE_DEG_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"AnglePos"</span>
        <span class="k">elif</span> <span class="n">constraint</span><span class="o">.</span><span class="n">ConstraintType</span> <span class="ow">in</span> <span class="n">DISTANCE_CONSTRAINTS</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Distance"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Length"</span>

    <span class="k">def</span> <span class="nf">stepRatio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ratio</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="n">ratio</span>

    <span class="k">def</span> <span class="nf">onEntryStart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_start</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_start</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_start</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntryEnd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_end</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_end</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_end</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="c1"># Update the slider</span>
        <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onEntrySteps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_steps</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_steps</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onActuatorSlider</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slider_value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="n">slider_value</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Angle"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"AnglePos"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">driver_type</span> <span class="o">==</span> <span class="s2">"Distance"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator</span><span class="o">.</span><span class="n">Offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_current</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">"Current value: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_suffix</span><span class="p">)</span>
        <span class="n">FreeCADGui</span><span class="o">.</span><span class="n">updateGui</span><span class="p">()</span> <span class="c1"># screen update between steps</span>
        <span class="n">Gui</span><span class="o">.</span><span class="n">runCommand</span><span class="p">(</span><span class="s2">"asm3CmdQuickSolve"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onForward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span><span class="p">)</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">end_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onBackward</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_value</span>
        <span class="n">step</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="n">steps_left</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">steps_left</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-=</span> <span class="n">step</span>
            <span class="n">slider_value</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">current_value</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">stepRatio</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">slider_value</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">steps_left</span><span class="p">)</span>
            <span class="n">steps_left</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actuator_slider</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">onClose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">"Closed"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">onOutputClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_check</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">counter</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
            <span class="n">image_path</span> <span class="o">=</span> <span class="s2">".../FreeCAD/ScreenShots/Sequence"</span>
            <span class="n">file_tag</span> <span class="o">=</span> <span class="s2">".png"</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mi">640</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mi">480</span>
            <span class="n">background</span> <span class="o">=</span> <span class="s2">"Transparent"</span>
            <span class="c1"># dealing with leading zeros</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="mi">999</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Out of Range"</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"00"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">):</span>
                <span class="n">number</span> <span class="o">=</span> <span class="s2">"0"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">number</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span>
            <span class="c1"># Screen shot</span>
            <span class="n">Gui</span><span class="o">.</span><span class="n">activeDocument</span><span class="p">()</span><span class="o">.</span><span class="n">activeView</span><span class="p">()</span><span class="o">.</span><span class="n">saveImage</span><span class="p">(</span><span class="n">image_path</span> <span class="o">+</span> <span class="n">number</span> <span class="o">+</span> <span class="n">file_tag</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>

<span class="c1"># End of ControlPanel()</span>
<span class="c1"># Main section below:</span>

<span class="k">def</span> <span class="nf">findTheDrivingConstraints</span><span class="p">(</span><span class="n">document_object</span><span class="p">):</span>
    <span class="c1"># search through the Objects and find the driving constraint</span>
    <span class="n">driver_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">document_object</span><span class="o">.</span><span class="n">Objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">each</span><span class="o">.</span><span class="n">Label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"Driver"</span><span class="p">):</span>
            <span class="n">driving_constraint</span> <span class="o">=</span> <span class="n">each</span><span class="o">.</span><span class="n">Name</span>
            <span class="n">driver_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">driving_constraint</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">driver_list</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">kin_doc</span> <span class="o">=</span> <span class="n">App</span><span class="o">.</span><span class="n">ActiveDocument</span> <span class="c1"># Kinematic Document</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="n">findTheDrivingConstraints</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drivers</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No driver found!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">panel_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">each_driver</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
            <span class="n">panel</span> <span class="o">=</span> <span class="n">ControlPanel</span><span class="p">(</span><span class="n">kin_doc</span><span class="p">,</span> <span class="n">each_driver</span><span class="p">)</span>
            <span class="n">panel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">panel</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as a module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><a href="#top">Przewi&#324; na g&oacute;r&#281; strony</a></p>
<p><span id="Some_imperfections"></span>
</p>
<h2><span id="Kilka_niedoskona.C5.82o.C5.9Bci"></span><span class="mw-headline" id="Kilka_niedoskona&#322;o&#347;ci">Kilka niedoskona&#322;o&#347;ci</span></h2>
<ul><li>Kolejno&#347;&#263; sekwencji obraz&oacute;w jest odwr&oacute;cona, poniewa&#380; u&#380;ywamy zmiennej steps_left, kt&oacute;ra jest odliczana.</li>
<li>Katalog obraz&oacute;w i nazwa obrazu s&#261; zakodowane na sztywno.</li>
<li>Wiele kontroler&oacute;w nie jest zsynchronizowanych.</li></ul>
<!-- 
NewPP limit report
Cached time: 20250616183211
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.402 seconds
Real time usage: 0.425 seconds
Preprocessor visited node count: 1198/1000000
Post&#8208;expand include size: 8680/2097152 bytes
Template argument size: 47278/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 37/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 221977/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   36.149      1 -total
 37.05%   13.395     37 Template:Code
 12.58%    4.549     75 Template:Incode
  8.28%    2.993      1 Template:TutorialInfo/pl
  6.24%    2.255      6 Template:Caption
  4.80%    1.736     10 Template:Top
  3.50%    1.264      2 Template:FileName
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:287626-0!canonical and timestamp 20250616183210 and revision id 1396654. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>