<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">TechDraw TemplateGenerator/pl</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="pl" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-TechDraw+TemplateGenerator&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--complete" title="TechDraw Vorlagengenerator (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../TechDraw_TemplateGenerator.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="TechDraw TemplateGenerator (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--complete" title="TechDraw Cr&eacute;ation de mod&egrave;les (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="pl" dir="ltr">polski</span></li>
<li><a href="../ru/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--low" title="&#1058;&#1077;&#1093;&#1085;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081;&#1063;&#1077;&#1088;&#1090;&#1105;&#1078; (TechDraw) &#1043;&#1077;&#1085;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;&#1064;&#1072;&#1073;&#1083;&#1086;&#1085;&#1072; (3% translated)" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span> &#262;wiczenie
</td></tr>
<tr>
<th class="ctOdd">Temat
</th></tr>
<tr>
<td class="ctEven">Tworzenie szablonu Rysunku Technicznego - makrodefinicja Python
</td></tr>
<tr>
<th class="ctOdd">Poziom trudno&#347;ci
</th></tr>
<tr>
<td class="ctEven">Podstawowa znajomo&#347;&#263; &#347;rodowiska Python i struktur svg jest przydatna
</td></tr>
<tr>
<th class="ctOdd">Czas wykonania
</th></tr>
<tr>
<td class="ctEven"><i>(Jeszcze nie wiem)</i>
</td></tr>
<tr>
<th class="ctOdd">Autorzy
</th></tr>
<tr>
<td class="ctEven"><a href="../User;FBXL5.html" title="User:FBXL5">FBXL5</a>
</td></tr>
<tr>
<th class="ctOdd">Wersja FreeCAD
</th></tr>
<tr>
<td class="ctEven">0.21 i nowszy
</td></tr>
<tr>
<th class="ctOdd">Pliki z przyk&#322;adami
</th></tr>
<tr>
<td class="ctEven"><i>Nie do&#322;&#261;czono</i>
</td></tr>
<tr>
<th class="ctOdd">Zobacz r&oacute;wnie&#380;
</th></tr>
<tr>
<td class="ctEven"><a href="../pl/Macro_TemplateHelper.html" title="Macro TemplateHelper/pl">Makro TemplateHelper</a>
</td></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr></tbody></table>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Wprowadzenie">Wprowadzenie</span></h2>
<p>Ten poradnik opisuje jak z kilku linijek kodu Pythona wygenerowa&#263; prosty szablon do wykorzystania w &#347;rodowisku pracy Rysunek Techniczny.
</p><p>Do kodowania mo&#380;na u&#380;y&#263; dowolnego edytora tekstu. M&oacute;j wyb&oacute;r to Atom, ale wbudowany edytor FreeCAD te&#380; dzia&#322;a dobrze.
</p><p>Poni&#380;sze przyk&#322;ady kodu mo&#380;na skopiowa&#263; i wklei&#263; do pustego pliku tekstowego, a nast&#281;pnie zapisa&#263; pod wybran&#261; nazw&#261; jako plik typu <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.py</span> lub <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">*.FCMacro</span>.
</p><p>Szablon stanowi t&#322;o dla zada&#324; rysunkowych, a jego wymiary s&#261; wykorzystywane przez sterowniki drukarki do prawid&#322;owego skalowania rysunku.
</p><p>Szablony s&#261; plikami svg, wi&#281;c makrodefinicja musi skomponowa&#263; kilka linii kodu svg <i>(kt&oacute;ry jest podzbiorem kodu xml)</i>.
</p><p><b>Uwaga:</b> Kiedy FreeCAD zosta&#322; przeniesiony z <b>freecadweb.org</b> do <b>freecad.org</b>, ta strona zosta&#322;a odpowiednio zaktualizowana, a wynikowy kod SVG nie jest ju&#380; kompatybilny z wersjami FreeCAD starszymi ni&#380; v0.21. W przypadku tych wersji nale&#380;y r&#281;cznie zmieni&#263; <code>freecad.org</code> na <code>freecadweb.org</code> w wierszu deklaracji przestrzeni nazw w wynikowym kodzie SVG, w przeciwnym razie edytowalne teksty nie zostan&#261; rozpoznane.
</p><p><span id="Structure_of_a_simple_blank_page"></span>
</p>
<h2><span id="Struktura_zwyk.C5.82ej_pustej_strony"></span><span class="mw-headline" id="Struktura_zwyk&#322;ej_pustej_strony">Struktura zwyk&#322;ej pustej strony</span></h2>
<p>Format SVG jest podzbiorem formatu XML.
Dlatego plik SVG, jak ka&#380;dy plik XML, sk&#322;ada si&#281; z dw&oacute;ch cz&#281;&#347;ci:
</p>
<ul><li>Nag&#322;&oacute;wka, czyli deklaracji formatu.</li>
<li>Zawarto&#347;ci, zawieraj&#261;cej informacje co pokaza&#263; i gdzie to umie&#347;ci&#263;</li></ul>
<dl><dd><i>(nie wiem po co ma by&#263; nag&#322;&oacute;wek, plik svg jest nadal poprawnym plikiem szablonu bez niego ...)</i></dd></dl>
<p><span id="Head"></span>
</p>
<h3><span id="Nag.C5.82.C3.B3wek"></span><span class="mw-headline" id="Nag&#322;&oacute;wek">Nag&#322;&oacute;wek</span></h3>
<p>Nag&#322;&oacute;wek to tylko jedna linia deklaruj&#261;ca, kt&oacute;rej wersji j&#281;zyka XML powinien u&#380;y&#263; interpreter do obs&#322;ugi instrukcji w tre&#347;ci.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
</pre></div>
<p><span id="Body"></span>
</p>
<h3><span id="Zawarto.C5.9B.C4.87"></span><span class="mw-headline" id="Zawarto&#347;&#263;">Zawarto&#347;&#263;</span></h3>
<p>Struktura zaczyna si&#281; od znacznika otwieraj&#261;cego, kt&oacute;ry zawiera informacje o przestrzeniach nazw oraz o wielko&#347;ci szablonu i miejscu jego umieszczenia. A ko&#324;czy si&#281; znacznikiem zamykaj&#261;cym.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<dl><dd><b>xmlns=</b><a rel="nofollow" class="external free" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a><b>: Zewn&#281;trzny link do przestrzeni nazw xml, aby wyszuka&#263; standardowe polecenia xml.</b></dd>
<dd><b>version=</b>"1.1": U&#380;ywana wersja xml to 1.1</dd>
<dd><b>xmlns:freecad=</b>...=Svg_Namespace": Zewn&#281;trzny link do strony Wiki FreeCAD <a href="../pl/Svg_Namespace.html" title="Svg Namespace/pl">Svg Namespace</a>. Link nie jest u&#380;ywany do pobierania informacji lub warto&#347;ci w czasie wykonywania, ale jest kluczem do aktywacji niestandardowych atrybut&oacute;w, np. tych dla edytowalnych tekst&oacute;w.</dd>
<dd>"freecad:" zostan&#261; poprzedzone nazwami atrybut&oacute;w niestandardowych.</dd>
<dd><b>width=</b> "420mm": Szeroko&#347;&#263; obszaru rysowania.</dd>
<dd><b>height=</b> "297mm": Wysoko&#347;&#263; obszaru rysowania.</dd>
<dd><b>viewBox=</b> "0 0 420 297": Po&#322;o&#380;enie lewego g&oacute;rnego rogu <i>(0;0)</i> i prawego dolnego rogu <i>(420;297)</i> w przestrzeni konstrukcyjnej svg <i>(w jednostkach svg)</i>.</dd>
<dd>Szeroko&#347;&#263;, wysoko&#347;&#263; i viewBox w tej kombinacji ustawiaj&#261; 1 jednostk&#281; svg na 1 mm dla ca&#322;ego dokumentu. Jednostka wymiarowa mo&#380;e by&#263; od tej pory pomijana.</dd>
<dd>W tym przypadku 420 i 297 daj&#261; stron&#281; A3. Dostosuj te warto&#347;ci, aby wygenerowa&#263; inne rozmiary stron.</dd></dl>
<p>Dla pustej strony rozmiar DIN A3 w orientacji poziomej to wszystko.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<p><span id="Python_code..."></span>
</p>
<h2><span class="mw-headline" id="Kod_Python_...">Kod Python ...</span></h2>
<p>Kodowanie rozpoczyna si&#281; od frameworka zawieraj&#261;cego oddzieln&#261; funkcj&#281; g&#322;&oacute;wn&#261;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Here is where the magic happens"""</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p><span id="..._to_create_a_blank_page"></span>
</p>
<h3><span id="..._aby_stworzy.C4.87_pust.C4.85_stron.C4.99"></span><span class="mw-headline" id="..._aby_stworzy&#263;_pust&#261;_stron&#281;">... aby stworzy&#263; pust&#261; stron&#281;</span></h3>
<p>Proces tworzenia szablonu sk&#322;ada si&#281; z nast&#281;puj&#261;cych etap&oacute;w
</p>
<ul><li>Zlokalizowanie folderu szablon&oacute;w.</li>
<li>Otwarcie pliku do zapisu w celu utworzenia pliku svg od podstaw, napisanie linii nag&#322;&oacute;wka i zamkni&#281;cie pliku w pierwszym kroku.</li>
<li>A nast&#281;pnie wielokrotne otwieranie pliku w celu dodania kolejnych segment&oacute;w, zamykaj&#261;c go ponownie za ka&#380;dym razem.</li></ul>
<p>Makrodefinicja sk&#322;ada si&#281; z kilku funkcji, kt&oacute;re s&#261; wywo&#322;ywane z sekcji g&#322;&oacute;wnej.<br>
Dodatkowe funkcje mo&#380;na wstawi&#263; przed funkcj&#261; EndSvg, a potrzebne wywo&#322;ania przed wywo&#322;aniem EndSvg().<br>
Aby wci&#281;cie by&#322;o prawid&#322;owe, musimy zwraca&#263; uwag&#281; na liczb&#281; spacji u&#380;ywanych podczas operacji zapisu.
</p><p><span id="pathToTemplate()"></span>
</p>
<h4><span id="pathToTemplate.28.29"></span><span class="mw-headline" id="pathToTemplate()">pathToTemplate()</span></h4>
<p>Przed wygenerowaniem jakiegokolwiek kodu potrzebny jest folder do przechowywania nowego pliku szablonu i nale&#380;y ustawi&#263; nazw&#281; pliku.
</p><p>U&#380;ytkownik powinien wybra&#263; folder szablonu. Jego &#347;cie&#380;ka jest nast&#281;pnie zapisywana w preferencjach &#347;rodowiska pracy Rysunek Techniczny. <br>
Nie jest konieczne, aby wiedzie&#263;, gdzie przechowywane s&#261; preferencje, poniewa&#380; FreeCAD posiada polecenia pozwalaj&#261;ce na bezpo&#347;rednie adresowanie potrzebnych parametr&oacute;w.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>
</pre></div>
<p><b>parameter_path</b> przyjmuje &#347;cie&#380;k&#281; do "folderu" w ramach pliku konfiguracyjnego, w kt&oacute;rym znajduje si&#281; parametr "TemplateDir". <br>
<b>template_path</b> przyjmuje zawarto&#347;&#263; "TemplateDir", kt&oacute;ra jest &#347;cie&#380;k&#261; do katalogu z szablonem. <br> 
<b>template_name</b> przyjmuje nazw&#281; szablonu, kt&oacute;ry ma zosta&#263; utworzony.
</p><p>Teraz nazwa szablonu musi by&#263; po&#322;&#261;czona ze &#347;cie&#380;k&#261; szablonu w spos&oacute;b, kt&oacute;ry jest kompatybilny z systemami operacyjnymi opartymi na Uniksie i Windows.<br>
Robi si&#281; to za pomoc&#261; polecenia "os.path.join" i przechowuje w <b>pliku szablonu</b>. Aby w&#322;&#261;czy&#263; to polecenie, wymagana jest instrukcja "import os".
</p><p><span id="createSvgFile()"></span>
</p>
<h4><span id="createSvgFile.28.29"></span><span class="mw-headline" id="createSvgFile()">createSvgFile()</span></h4>
<p>Spowoduje to utworzenie nowego pliku szablonu i zapisanie nag&#322;&oacute;wka xml.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="startSvg()"></span>
</p>
<h4><span id="startSvg.28.29"></span><span class="mw-headline" id="startSvg()">startSvg()</span></h4>
<p>Powoduje to do&#322;&#261;czenie pliku szablonu i utworzenie znacznika otwieraj&#261;cego svg wraz z jego atrybutami.<br>
Ka&#380;da instrukcja zapisu zawiera jedn&#261; lini&#281; kodu svg zako&#324;czon&#261; "\n", znacznikiem CR/LF.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="endSvg()"></span>
</p>
<h4><span id="endSvg.28.29"></span><span class="mw-headline" id="endSvg()">endSvg()</span></h4>
<p>To dalej do&#322;&#261;cza plik szablonu i tworzy znacznik zamykaj&#261;cy svg; To ostatecznie ko&#324;czy kod szablonu.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="main()"></span>
</p>
<h4><span id="main.28.29"></span><span class="mw-headline" id="main()">main()</span></h4>
<p>Funkcja main() wywo&#322;uje funkcje i przekazuje pewne parametry.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>
</pre></div>
<p>W tym przyk&#322;adzie <code>format_width</code> i <code>format_height</code> s&#261; twardo zakodowanymi wymiarami, obie niepotrzebne linie oznaczaj&#261; punkty, w kt&oacute;rych inne sposoby pobierania danych formatu mog&#322;yby umie&#347;ci&#263; swoj&#261; zawarto&#347;&#263;.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<h4><span class="mw-headline" id="Kompletna_makrodefinicja_pustej_strony">Kompletna makrodefinicja pustej strony</span></h4>
<p>To makro sk&#322;ada si&#281; z powy&#380;szych segment&oacute;w kodu, gotowych do uruchomienia.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><br>
<span id="..._to_create_a_page_with_some_ink"></span>
</p>
<h3><span id="..._aby_stworzy.C4.87_stron.C4.99_w_kt.C3.B3rej_jest_troch.C4.99_tuszu"></span><span class="mw-headline" id="..._aby_stworzy&#263;_stron&#281;_w_kt&oacute;rej_jest_troch&#281;_tuszu">... aby stworzy&#263; stron&#281; w kt&oacute;rej jest troch&#281; tuszu</span></h3>
<p>Aby stworzy&#263; rysunek z pustej kartki potrzebujemy:
</p>
<ul><li>ramki czyli prostok&#261;ty utworzone za pomoc&#261; instrukcji <b>rect</b>,</li></ul>
<p>bloku tytu&#322;owego i wi&#281;cej linii utworzonych za pomoc&#261; instrukcji <b>path</b>,
</p>
<ul><li>proste teksty do indeks&oacute;w i etykietowania kom&oacute;rek bloku tytu&#322;owego,</li>
<li>teksty edytowalne, takie jak numer lub nazwa cz&#281;&#347;ci,</li></ul>
<p>Zwykle te elementy graficzne s&#261; u&#380;ywane wielokrotnie, wi&#281;c kod generuj&#261;cy jest umieszczony w czterech funkcjach:
</p>
<ul><li>svgRect() dla prostok&#261;tnych element&oacute;w ramki.</li>
<li>svgPath() dla element&oacute;w prostych.</li>
<li>svgText() dla tekst&oacute;w statycznych.</li>
<li>ediText() dla tekst&oacute;w edytowalnych.</li></ul>
<p>Wszystkie funkcje s&#261; umieszczane wewn&#261;trz powy&#380;szej makrodefinicji przed funkcj&#261; main(), a powi&#261;zane z nimi wywo&#322;ania funkcji s&#261; wstawiane do funkcji main() mi&#281;dzy <code>startSvg(...)</code> i <code>endSvg(...)</code>.
</p><p><span id="svgRect()"></span>
</p>
<h4><span id="funkcja_svgRect.28.29"></span><span class="mw-headline" id="funkcja_svgRect()">funkcja svgRect()</span></h4>
<p>Aby narysowa&#263; prostok&#261;t musimy tylko wywo&#322;a&#263; funkcj&#281; <b>svgRect</b> i przekaza&#263; warto&#347;ci szeroko&#347;ci, wysoko&#347;ci i po&#322;o&#380;enia lewego g&oacute;rnego rogu. Jest to lepiej czytelne w tym miejscu, ni&#380; gdyby svg_line zawiera&#322; ca&#322;&#261; lini&#281; kodu svg.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Instrukcja svg jest podzielona, aby pozosta&#263; w zalecanej d&#322;ugo&#347;ci linii Pythona, mimo to spowoduje to utworzenie pojedynczej linii svg.
</p><p>Wraz z wi&#281;kszym do&#347;wiadczeniem w Pythonie pojawi&#322; si&#281; inny spos&oacute;b wype&#322;niania zmiennej tre&#347;ci: wbudowana funkcja <code>.format()</code> w po&#322;&#261;czeniu z nazwanymi <code>{name}</code>, indeksowanymi <code>{0}</code> lub pustymi <code>{}</code> znacznikami. Nazwy jednoliterowe zmieni&#322;yby dzia&#322;anie funkcji w nast&#281;puj&#261;cy spos&oacute;b:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="si">{W}</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="si">{H}</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">W</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">height</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
<p>(Nawiasy s&#261; opcjonalne, o ile nie ma potrzeby dzielenia ci&#261;gu <b>svg_line</b>)
</p><p><span id="svgPath()"></span>
</p>
<h4><span id="funkcja_svgPath.28.29"></span><span class="mw-headline" id="funkcja_svgPath()">funkcja svgPath()</span></h4>
<p>Aby narysowa&#263; lini&#281; wystarczy wywo&#322;a&#263; funkcj&#281; <b>svgPath</b> i przekaza&#263; wsp&oacute;&#322;rz&#281;dne punktu pocz&#261;tkowego i ko&#324;cowego linii.
</p><p>Zamiast wsp&oacute;&#322;rz&#281;dnych punktu ko&#324;cowego mo&#380;emy przekaza&#263; znacznik do rysowania linii poziomej <i>(h)</i> lub pionowej <i>(v)</i>, a nast&#281;pnie d&#322;ugo&#347;&#263; linii lub znacznik do rysowania linii poziomej <i>(H)</i> lub pionowej <i>(V)</i>, a nast&#281;pnie rz&#281;dn&#261; x lub y punktu ko&#324;cowego.
</p><p>Ka&#380;da &#347;cie&#380;ka zaczyna si&#281; w punkcie pocz&#261;tkowym i pierwsz&#261; czynno&#347;ci&#261; jest ruch z "podniesionym pi&oacute;rem" <i>(bez rysowania)</i> do punktu pocz&#261;tkowego. W tym przypadku ruch wzgl&#281;dny i ruch bezwzgl&#281;dny s&#261; takie same i dlatego nie ma znaczenia, czy znacznik m jest pisany wielk&#261; czy ma&#322;&#261; liter&#261;.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Alternatywna wersja z u&#380;yciem znacznik&oacute;w i funkcji <code>.format()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> </span><span class="si">{C}</span><span class="s2"> </span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> l </span><span class="si">{C}</span><span class="s2">,</span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">x2</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
<p><span id="svgText()"></span>
</p>
<h4><span id="funkcja_svgText.28.29"></span><span class="mw-headline" id="funkcja_svgText()">funkcja svgText()</span></h4>
<p>Aby narysowa&#263; fragment tekstu wystarczy wywo&#322;a&#263; funkcj&#281; <b>svgText</b> i przekaza&#263; wsp&oacute;&#322;rz&#281;dne punktu zakotwiczenia tekstu oraz sam ci&#261;g tekstowy i opcjonalnie k&#261;t dla obracanego tekstu. Aby obr&oacute;ci&#263; tekst, instrukcja transformacji musi zosta&#263; wstawiona do ka&#380;dego znacznika tekstowego osobno. &#346;rodki obrotu s&#261; ustawione na te same wsp&oacute;&#322;rz&#281;dne, co powi&#261;zane punkty zakotwiczenia tekstu.
</p><p><i>(Wyr&oacute;wnanie tekstu jest kontrolowane przez otaczaj&#261;cy znacznik grupy lub domy&#347;lnie wyr&oacute;wnane do lewej)</i>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Alternatywna wersja z u&#380;yciem znacznik&oacute;w i funkcji <code>.format()</code> wygl&#261;da nast&#281;puj&#261;co:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span><span class="p">)</span>
</pre></div>
<p><span id="ediText()"></span>
</p>
<h4><span id="funkcja_ediText.28.29"></span><span class="mw-headline" id="funkcja_ediText()">funkcja ediText()</span></h4>
<p>Aby narysowa&#263; fragment edytowalnego tekstu wystarczy wywo&#322;a&#263; funkcj&#281; <b>ediText</b> i przekaza&#263; jej nazw&#281;, wsp&oacute;&#322;rz&#281;dne punktu zakotwiczenia tekstu oraz sam ci&#261;g tekstowy i opcjonalnie k&#261;t dla obracanego tekstu. Aby obr&oacute;ci&#263; tekst, instrukcja transformacji musi zosta&#263; wstawiona do ka&#380;dego znacznika tekstowego osobno. &#346;rodki obrotu s&#261; ustawione na te same wsp&oacute;&#322;rz&#281;dne, co powi&#261;zane punkty zakotwiczenia tekstu.
</p><p>FreeCAD tworzy obiekt s&#322;ownika z ka&#380;dym wstawionym szablonem, a ka&#380;dy wpis ma nazw&#281; <i>(klucz)</i> i warto&#347;&#263;.
</p><p><i>(Wyr&oacute;wnanie tekstu jest kontrolowane przez otaczaj&#261;cy znacznik grupy lub domy&#347;lnie wyr&oacute;wnane do lewej)</i>.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Alternatywna wersja z u&#380;yciem znacznik&oacute;w i <code>.format()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{EN}</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">" x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{EN}</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">" x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">EN</span> <span class="o">=</span> <span class="n">entry_name</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span>
        <span class="p">)</span>
</pre></div>
<p><span id="createXxxx_functions"></span>
</p>
<h3><span class="mw-headline" id="Funkcja_createXxxx">Funkcja createXxxx</span></h3>
<p>Funkcje te rozpoczynaj&#261; si&#281; od kodu otwieraj&#261;cego plik w trybie do&#322;&#261;czania i zapisuj&#261;cego znacznik otwieraj&#261;cy grup&#281;.
</p><p>Nast&#281;pnie widzimy sekcj&#281; do ustawiania i obliczania warto&#347;ci oraz z instrukcjami zapisu, kt&oacute;re wywo&#322;uj&#261; powy&#380;sze funkcje w celu wygenerowania kodu svg.
</p><p>I wreszcie znacznik zamykaj&#261;cy grup&#281;, po kt&oacute;rym nast&#281;puje instrukcja zamkni&#281;cia pliku.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="Resulting_macro"></span>
</p>
<h3><span class="mw-headline" id="Rezultat">Rezultat</span></h3>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Makro to dodaje kilka podstawowych element&oacute;w graficznych potrzebnych do prawid&#322;owego dzia&#322;ania szablon&oacute;w tj. elementy linii, etykiety oraz teksty do edycji.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Ggenerates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createTitleBlock</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates a title block and transfers it to the position according to the sheet dimensions"""</span>
    <span class="c1">#- calculate title block origin (lower left corner), offset from page origin</span>
    <span class="n">tbX</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group to transfer all included title block elements at once</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span> <span class="o">+</span> <span class="n">tbX</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">tbY</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block line framework</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block static texts (left-aligned by default)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Some static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-13.5 "</span><span class="p">,</span><span class="s2">"More static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"162.5"</span><span class="p">,</span><span class="s2">"-3.5 "</span><span class="p">,</span><span class="s2">"Vertical static text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createEditableText</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates editable texts positioned according to the page origin"""</span>
    <span class="c1">#- calculate offset to titleblock origin</span>
    <span class="n">edX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group editable texts using the same attributes</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-texts</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7.0;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">43.5</span><span class="p">),</span><span class="s2">"Some editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">13.5</span><span class="p">),</span><span class="s2">"More editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-3"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">173</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">4.5</span><span class="p">),</span><span class="s2">"90&deg; editable text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an A3 template with simple frame and title block"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">createFrame</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createTitleBlock</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createEditableText</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>A to jest kod svg pochodz&#261;cy z tej makrodefinicji:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>

<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width =</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"drawing-frame"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"390"</span><span class="w"> </span><span class="na">height=</span><span class="s">"277"</span><span class="w"> </span><span class="na">x=</span><span class="s">"20"</span><span class="w"> </span><span class="na">y=</span><span class="s">"10"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"400"</span><span class="w"> </span><span class="na">height=</span><span class="s">"287"</span><span class="w"> </span><span class="na">x=</span><span class="s">"15"</span><span class="w"> </span><span class="na">y=</span><span class="s">"5"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock"</span>
<span class="w">      </span><span class="na">transform=</span><span class="s">"translate(230,287)"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-frame"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.35;stroke-linecap:miter;stroke-miterlimit:4"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,  0 l   0,-63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-63 l 180,  0"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-30 h 155"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m 155,  0 v -63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-text-non-editable"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"font-size:5.0;text-anchor:start;fill:#000000;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-43.5 "</span><span class="nt">&gt;</span>Some<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-13.5 "</span><span class="nt">&gt;</span>More<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"162.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-3.5 "</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,162.5,-3.5 )"</span><span class="nt">&gt;</span>Vertical<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-editable-texts"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"font-size:7.0;text-anchor:start;fill:#0000d0;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-1"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"243.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>Some<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-2"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"273.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>More<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-3"</span><span class="w"> </span><span class="na">x=</span><span class="s">"403"</span><span class="w"> </span><span class="na">y=</span><span class="s">"282.5"</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,403,282.5)"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>90&deg;<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="nt">&lt;/svg&gt;</span>
</pre></div>
</div> 
</div> 
<p>I jak to powinno wygl&#261;da&#263; po wstawieniu <i>(plus powi&#281;kszony blok tytu&#322;owy)</i>:
</p><p><span typeof="mw:File"><a href="../index.php?title=TechDraw_TemplateGenerator.png&amp;filetimestamp=20240121203255&amp;.html" class="mw-file-description"><img src="../File/TechDraw_TemplateGenerator.png" decoding="async" width="600" height="429" class="mw-file-element" data-file-width="1400" data-file-height="1000"></a></span>
</p><p>Kolorowanie edytowalnych tekst&oacute;w na niebiesko jest tylko osobistym wyborem, aby &#322;atwiej odr&oacute;&#380;ni&#263; statyczne i edytowalne teksty na gotowym rysunku.
</p>
<!-- 
NewPP limit report
Cached time: 20260111153431
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.132 seconds
Real time usage: 0.331 seconds
Preprocessor visited node count: 477/1000000
Post&#8208;expand include size: 3264/2097152 bytes
Template argument size: 21135/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 21/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 100628/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   26.442      1 -total
 48.94%   12.940     21 Template:Code
 27.75%    7.337      1 Template:TutorialInfo/pl
  7.64%    2.020     13 Template:Incode
  7.29%    1.929      2 Template:FileName
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:273986-0!canonical and timestamp 20260111153431 and revision id 1623260. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>