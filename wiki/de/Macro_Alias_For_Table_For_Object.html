<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Alias For Table For Object/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Alias+For+Table+For+Object&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_Alias_For_Table_For_Object.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Alias For Table For Object (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Alias_For_Table_For_Object.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Alias For Table For Object (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../pl/Macro_Alias_For_Table_For_Object.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Alias obiektu do tabeli (4% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Text-x-python.png&amp;filetimestamp=20121224162851&amp;.html" class="mw-file-description" title="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros"><img alt="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros" src="../File/Text-x-python.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></a></span><span> </span>
Alias f&uuml;r Tabelle f&uuml;r Objekt
</p>
</td></tr>
<tr>
<th class="ctOdd">Beschreibung
</th></tr>
<tr>
<td class="ctEven left macro-description">Dieses Makro erstellt automatisch Aliase in einer zweidimensionalen Tabelle unter Verwendung der Namen der Zeilen und Spalten.<br>
<p>Eine zweite Funktion kann eine Verkn&uuml;pfung zwischen einer Zelle und einem Eigenschaftswert in einem Objekt herstellen.<br>
Um diese Funktion nutzen zu k&ouml;nnen, m&uuml;ssen Sie lediglich den Namen des entsprechenden Objekts in die Spalte und den Namen der Eigenschaft in die Zeile eingeben.<br><br>Versionsmakro&nbsp;: beta<br>Datum der letzten &Auml;nderung&nbsp;: 2024-02-22<br>FreeCAD version&nbsp;: Alle<br>Autor: 2cv001<br>
</p>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;2cv001&amp;action=edit&amp;redlink=1.html" class="new" title="User:2cv001 (page does not exist)">2cv001</a>
</td></tr>
<tr>
<th class="ctOdd">Herunterladen
</th></tr>
<tr>
<td class="ctEven macro-download">
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../de/Macros_recipes.html" title="Macros recipes/de">Makros Rezepte</a><br><a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a><br><a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Symbolleisten anpassen</a>
</td></tr>
<tr>
<th class="ctOdd">Macro-Version
</th></tr>
<tr>
<td class="ctEven macro-version">beta
</td></tr>
<tr>
<th class="ctOdd">Datum der letzten &Auml;nderung
</th></tr>
<tr>
<td class="ctEven macro-date">2024-02-22
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Alle
</td></tr>
<tr>
<th class="ctOdd">Standardverkn&uuml;pfung
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Beschreibung">Beschreibung</span></h2>
<p>Dieses Makro erstellt automatisch Aliase in einer zweidimensionalen Tabelle unter Verwendung der Namen der Zeilen und Spalten. Eine zweite Funktion kann eine Verkn&uuml;pfung zwischen einer Zelle und einem Eigenschaftswert eines Objekts herstellen. Um diese Funktion nutzen zu k&ouml;nnen, muss lediglich der Namen des entsprechenden Objekts in die Spalte und den Namen der Eigenschaft in die Zeile eingeben werden. 
</p><p>Die Syntax f&uuml;r den vom Makro erstellten Alias lautet: <code>LabelObject_Property</code>.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=20240220.gif&amp;filetimestamp=20240220190651&amp;.html" class="mw-file-description"><img src="../File/20240220.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p>Das Makro kann auch automatisch Eigenschaftswerte von Objekten (wie K&ouml;rper, Skizze usw.) basierend auf diesen Aliasen ausf&uuml;llen.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=20240220-01.gif&amp;filetimestamp=20240220190916&amp;.html" class="mw-file-description"><img src="../File/20240220-01.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Anwendung">Anwendung</span></h2>
<p><span id="Automatic_alias_creation"></span>
</p>
<h3><span class="mw-headline" id="Automatische_Alias-Erzeugung">Automatische Alias-Erzeugung</span></h3>
<p>Eine Tabelle mit einer Spalte ausf&uuml;llen, die Objektbezeichnungen enth&auml;lt (K&ouml;rper, Skizze, Block, ...), und einer Zeile, die den Eigenschaften entspricht. Im Code findet man die Entsprechungen zwischen den Eigenschaften und den Angaben, die in diese Zeile einzutragen sind. Siehe <code>dico=</code> unten.
</p><p>Beispielsweise <code>posy</code> verwenden f&uuml;r die Eigenschaft <code>Placement.Base.y</code>.
</p><p>Die Zellen in der Tabelle mit der Spalte Objektbezeichnungen und der Zeile Eigenschaften ausw&auml;hlen, dann das Makro ausf&uuml;hren und die erste Option aktivieren:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Capture_d%27%C3%A9cran_2024-02-22_02.png&amp;filetimestamp=20240221131153&amp;.html" class="mw-file-description"><img src="../File/Capture_d%27%C3%A9cran_2024-02-22_02.png" decoding="async" width="228" height="124" class="mw-file-element" data-file-width="228" data-file-height="124"></a></span>
</p><p>Das Makro erstellt Aliase mit dieser Syntax: <code>LabelObject_Property</code>. Zum Beispiel: <code>BodyRect_posy</code>.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Capture_d%27%C3%A9cran_2024-02-21_133729.png&amp;filetimestamp=20240221130001&amp;.html" class="mw-file-description"><img src="../File/Capture_d%27%C3%A9cran_2024-02-21_133729.png" decoding="async" width="1113" height="622" class="mw-file-element" data-file-width="1113" data-file-height="622"></a></span>
</p><p>Teil des dico (den vollst&auml;ndigen dico findet man im Code des Makros): 
</p>
<div class="mw-highlight mw-highlight-lang-text mw-content-ltr" dir="ltr"><pre><span></span>dico={
        "posx"&nbsp;: "Placement.Base.x",
        "posy"&nbsp;: "Placement.Base.y",
        "posz"&nbsp;: "Placement.Base.z",
        "posX"&nbsp;: "Placement.Base.x",
        "posY"&nbsp;: "Placement.Base.y",
        "posZ"&nbsp;: "Placement.Base.z",
        "angle": "Placement.Rotation.Angle",
        "ang" &nbsp;: "Placement.Rotation.Angle",
        "axisx": "Placement.Rotation.Axis.x",
        "axisy": "Placement.Rotation.Axis.y",       
        "axisz": "Placement.Rotation.Axis.z", 
        "axeX"&nbsp;: "Placement.Rotation.Axis.x",
        "axeY"&nbsp;: "Placement.Rotation.Axis.y",       
        "axeZ"&nbsp;: "Placement.Rotation.Axis.z", 
        "attachementX"&nbsp;: "AttachmentOffset.Base.x",
        "attachementY"&nbsp;: "AttachmentOffset.Base.y",
        "attachementZ"&nbsp;: "AttachmentOffset.Base.z",
        "attachementAngle"&nbsp;: "AttachmentOffset.Rotation.Angle",
        "attachementAxisX"&nbsp;: "AttachmentOffset.Rotation.Axis.x",
        "attachementAxisY"&nbsp;: "AttachmentOffset.Rotation.Axis.y",        
        "attachementAxisZ"&nbsp;: "AttachmentOffset.Rotation.Axis.z",
        "Length"&nbsp;: "Length",
        "Length2": "Length2",
        "Radius"&nbsp;: "Radius",
        "Height"&nbsp;: "Height",
        "FirstAngle"&nbsp;: "FirstAngle",
        "SecondAngle": "SecondAngle",
        "Angle1"&nbsp;: "Angle1",
        "Angle2"&nbsp;: "Angle2",
        "Angle3"&nbsp;: "Angle3",
</pre></div>
<p><span id="Automatic_values_in_properties"></span>
</p>
<h3><span class="mw-headline" id="Automatische_Werte_in_Eigenschaften">Automatische Werte in Eigenschaften</span></h3>
<p>Einige Zellen in der Tabelle mit zuvor erstellten Werten und Aliasnamen ausw&auml;hlen. Das Makro ausf&uuml;hren und die zweite Option w&auml;hlen (beide Optionen k&ouml;nnen gleichzeitig ausgew&auml;hlt werden, um sie miteinander zu verkn&uuml;pfen).
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Alias_For_Table_For_Object03.png&amp;filetimestamp=20240221132815&amp;.html" class="mw-file-description"><img src="../File/Alias_For_Table_For_Object03.png" decoding="async" width="224" height="120" class="mw-file-element" data-file-width="224" data-file-height="120"></a></span>
</p><p>Das Makro weist den Eigenschaften Werte &uuml;ber einen Ausdruck zu, der auf den Alias der Zellen verweist. Wenn man von nun an einen Wert in der Tabelle &auml;ndert, &auml;ndert sich der Eigenschaftswert und alles wird neu berechnet.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Alias_For_Table_For_Object04.png&amp;filetimestamp=20240221133045&amp;.html" class="mw-file-description"><img src="../File/Alias_For_Table_For_Object04.png" decoding="async" width="1082" height="640" class="mw-file-element" data-file-width="1082" data-file-height="640"></a></span><br>
</p><p><span id="Examples"></span>
</p>
<h3><span class="mw-headline" id="Beispiele">Beispiele</span></h3>
<p><span id="Pad"></span>
</p>
<h4><span class="mw-headline" id="Aufpolsterung">Aufpolsterung</span></h4>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Alias_For_Table_For_Object_01.gif&amp;filetimestamp=20240221140039&amp;.html" class="mw-file-description"><img src="../File/Macro_Alias_For_Table_For_Object_01.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p><span id="Sketch_constraints"></span>
</p>
<h4><span class="mw-headline" id="Skizzen-Randbedingungen">Skizzen-Randbedingungen</span></h4>
<p>Der Randbedingung einen Namen geben (hier: Breite) (auf die Gro&szlig;-/Kleinschreibung achten). In der Zeile Eigenschaften eine Spalte mit diesem Randbedinungs-Namen hinzuf&uuml;gen und eine Zeile mit der Bezeichnung der Skizze hinzuf&uuml;gen (hier: Skizze). Das Makro ausf&uuml;hren.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Alias_For_Table_For_Object_02.gif&amp;filetimestamp=20240221145555&amp;.html" class="mw-file-description"><img src="../File/Macro_Alias_For_Table_For_Object_02.gif" decoding="async" width="1177" height="609" class="mw-file-element" data-file-width="1177" data-file-height="609"></a></span>
</p><p><span id="Credits"></span>
</p>
<h2><span class="mw-headline" id="Danksagung">Danksagung</span></h2>
<p>Dieses Makro wurde auf Grundlage einer Idee von Esprit entwickelt. Vielen Dank auch an ihn f&uuml;r die zahlreichen Ideen und Tests, die er durchgef&uuml;hrt hat.
</p><p><span id="Version_information"></span>
</p>
<h2><span class="mw-headline" id="Versionsinformation">Versionsinformation</span></h2>
<p>ver 25/02/2024 von 2cv001 <b>Alias_For_Table_For_Object.FCMacro</b>
</p>
<h2><span class="mw-headline" id="Code">Code</span></h2>
<div class="plainlinks" style="width:300px; text-align:center; margin:10px auto;">
<div style="border:1px outset #9eb4b5; background:#f0fdf8; margin:5px; padding:5px; white-space:nowrap; -webkit-border-radius: 5px; -moz-border-radius: 5px;">
<p><span typeof="mw:File"><a href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros-Beta1/main/Alias_For_Table_For_Object.FCMacro" rel="nofollow"><img src="../File/Nuvola_apps_download_manager.png" decoding="async" width="35" height="35" class="mw-file-element" data-file-width="128" data-file-height="128"></a></span>
</p><p><span class="CodeDownload" style="font-weight:bold"><a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros-Beta1/main/Alias_For_Table_For_Object.FCMacro">Download latest version of the macro</a></span>
</p>
</div>
</div>
<pre>#!/usr/bin/env python
# -*- coding: utf-8 -*-
# ========================================================================
# Macro Alias for table for object
# file name&nbsp;: Alias_For_Table_For_Object.FCMacro
# ========================================================================


__Name__   = "Alias for table for object"
__Comment__ ="Automatically creates aliases in a two-dimensional table using the names of the rows and columns"
__Author__ = "2cv001"
__Title__   = "Alias For Table For Object"
__Date__    = "2024/02/20"    #YYYY/MM/DD 14;21 B&eacute;ta
__Version__ = __Date__
__License__ = "Apache-2.0"
__Wiki__ = "https://wiki.freecad.org/Macro_Alias_For_Table_For_Object"
# https://forum.freecad.org/viewtopic.php?t=84878
#===========================================================================================
# The macro automatically creates alias in a two-dimensional table using the name of the row
# and the name of the column. To be able to use the "Table to object" function
# put the name of the concerned object in the column and the name of the property in the row.
# the alias creation function will create alias (except dico, see below)
# with this syntax  "LabelObject_property"
#
# The macro can also automatically fill the properties of objects (body, sketch, ...) based on
# aliases created by 'Create alias for table' and which indicate the object and the property
#
# The dico (see further in the code) is used to convert what you put in the top line to match
# what needs to be put in the expression. For example, if you have "posx" in the
# first line of your selection, in the expression, for the property part, there will be
# "Placement.Base.x"
#==========================================================================================



import FreeCAD, FreeCADGui
import re
from PySide import QtGui, QtCore, QtWidgets

addNumberIfOther=True

class CheckBoxDialog(QtWidgets.QDialog):
    def __init__(self, parent=None):
        super(CheckBoxDialog, self).__init__(parent)

        self.setWindowTitle("Macro FreeCAD")

        self.createAliasForTableCheckBox = QtWidgets.QCheckBox("Alias creation")
        self.createAliasForTableCheckBox.setToolTip("Creates an alias in each selected cell" +
                "\nbased on the first selected row and column" +
                "\nThe aliases will be in the format 'LabelObject_property'")
        self.tableToObjectCheckBox = QtWidgets.QCheckBox("Properties in objects based on aliases")
        self.tableToObjectCheckBox.setToolTip("Automatically fills the properties of objects (body, sketch, ...)" +
                "\nbased on aliases which must be in the format 'LabelObject_property'")
        buttonBox = QtWidgets.QDialogButtonBox(QtWidgets.QDialogButtonBox.Ok | QtWidgets.QDialogButtonBox.Cancel)
        buttonBox.accepted.connect(self.accept)
        buttonBox.rejected.connect(self.reject)

        layout = QtWidgets.QVBoxLayout()
        layout.addWidget(self.createAliasForTableCheckBox)
        layout.addWidget(self.tableToObjectCheckBox)
        layout.addWidget(buttonBox)
        self.setLayout(layout)

    def accept(self):
        super(CheckBoxDialog, self).accept()




def get_column(cell):
    column = ''.join([c for c in cell if not c.isdigit()])
    return column

def get_row(cell):
    row = ''.join([c for c in cell if c.isdigit()])
    if row==''&nbsp;:
        row='1'
    return int(row)




#################################################################################
# part code for alias
#################################################################################
# parameters for alias creation
separateur = " "      # typically put " " so blanks will be replaced by nouveauCaract
nouveauCaract = ''    #Put for example "_" to have the separators replaced by "_". Put "" to have no separator
majuscule = True      #set to True if you want  "Diametre du cercle" to be "DiametreDuCercle"
changeTexteCellule = False  # the text will only be changed if changeCellText is True.
                          # This does not change anything for the allias itself
premierCaractereEnMinuscule = False # Force the first character to be in lower case

# list of characters to be replaced by an equivalent. for example an @ will be replaced by 'a'
# if you add characters, please send me a private message. Il will eventually add it in my code.
caracEquivalents = [ ['&eacute;','e'],['&egrave;','e'],['&ecirc;','e'],['&agrave;','a'],['@','a'],['&amp;','e'],['&ccedil;','c'],
                  ['&sup2;','2'],["'",''],['?',''],['"',''],['(',''],[')',''],['#',''],['.',''],
                  [',',''],[';',''],['$',''],['+',''],['-',''],['*',''],['/',''],['\\',''] ,
                  ['[',''],[']',''],
                  ]



def traitementChaineSource(chaineSource, separateur, nouveauCaract, majuscule):
# If separator is ' ' and nouveauCaract is '_', and majuscule is True
# transforms "Diametre du cylindre" into "Diametre_Du_Cylindre

    def remplaceCararcDansMot(mot):

        def remplaceCartatParEquivalent(caractere):
        # replaces a character with its equivalent if it exists
            caracResult = caractere
            for couple in caracEquivalents:
                if (couple[0] == caractere):
                    caracResult = couple[1]
                    break
            return caracResult

    #replaces all characters of the word with its equivalent if it exists
        motResult = mot
        for caract in mot:
            a = remplaceCartatParEquivalent(caract)
            motResult = motResult.replace(caract, a)
        return motResult


    chaineResult = ''
    first = True
    carctDeSeparation = ''
    for mots in chaineSource.split(separateur):
        mots = remplaceCararcDansMot(mots)
        if (not (first)):
            carctDeSeparation = nouveauCaract
            if (majuscule):
                chaineResult = chaineResult + nouveauCaract + mots[:1].upper() + mots[1:]
                # We use "[:1]" instead of "[0]",
                # for no crash in case of an empty string (which happens if the cell is empty)
        else:
            chaineResult = chaineResult + nouveauCaract + mots
        first=False
    if premierCaractereEnMinuscule&nbsp;:
        chaineResult = chaineResult[:1].lower() + chaineResult[1:]
    return chaineResult


def create_alias_for_table_cells_Selected():
    mySpreadsheet = Gui.ActiveDocument.ActiveView.getSheet()
    aw = Gui.getMainWindow().centralWidget().activeSubWindow() # Store the active window
    # To get list of all selected cells
    sel_items = aw.widget().findChild(QtGui.QTableView).selectedIndexes()

    getCellName = lambda r,c:'{}{}{}'.format(chr(c//26 + 64) if c//26 &gt; 0 else '', chr(c%26 + 65), r + 1)



    for item in sel_items: # The selected cells are scanned

        if  (sel_items[0].column()!=item.column() and sel_items[0].row()!=item.row())&nbsp;:
            cellName=getCellName(item.row(), item.column())
            firstcellName=getCellName(sel_items[0].row(), sel_items[0].column())

            cellTextLine=get_column(firstcellName)+str(get_row(cellName))
            cellTextColumn=get_column(cellName)+ str(get_row(firstcellName))
            try&nbsp;:
                textLine = mySpreadsheet.get(cellTextLine)
                textColumn = mySpreadsheet.get(cellTextColumn)

            except&nbsp;:
                #print('Des cellules en premi&egrave;re colonne ou en premi&egrave;re ligne ne sont pas conformes')
                continue
            textAlias =  str(textLine) + '_'  + str(textColumn)
            textAlias=traitementChaineSource(textAlias, separateur, nouveauCaract, majuscule)
            if addNumberIfOther&nbsp;:
                startIndexForTextAlias=1
                for i in range(startIndexForTextAlias, 201):
                    try:
                        if i == 1:
                            mySpreadsheet.setAlias(cellName, textAlias)
                        else:
                            mySpreadsheet.setAlias(cellName, textAlias + '_' + str(i-1))
                            startIndexForTextAlias=i+1
                        break  # Arr&ecirc;te la boucle si aucune exception n'est lev&eacute;e
                    except:
                        continue  # Passe &agrave; l'it&eacute;ration suivante si une exception est lev&eacute;e





# The dictionary is used to convert what you put in the top line to match
# what needs to be put in the expression. For example, if you have &ldquo;posx&rdquo; in the
# first line of your selection, in the expression, for the property part, there will be
# "Placement.Base.x"
dico={
        "posx"&nbsp;: "Placement.Base.x",
        "posy"&nbsp;: "Placement.Base.y",
        "posz"&nbsp;: "Placement.Base.z",
        "posX"&nbsp;: "Placement.Base.x",
        "posY"&nbsp;: "Placement.Base.y",
        "posZ"&nbsp;: "Placement.Base.z",
        "angle": "Placement.Rotation.Angle",
        "ang": "Placement.Rotation.Angle",
        "axisx": "Placement.Rotation.Axis.x",
        "axisy": "Placement.Rotation.Axis.y",
        "axisz": "Placement.Rotation.Axis.z",
        "axeX": "Placement.Rotation.Axis.x",
        "axeY": "Placement.Rotation.Axis.y",
        "axeZ": "Placement.Rotation.Axis.z",
        "attachementX"&nbsp;: "AttachmentOffset.Base.x",
        "attachementY"&nbsp;: "AttachmentOffset.Base.y",
        "attachementZ"&nbsp;: "AttachmentOffset.Base.z",
        "attachementAngle"&nbsp;: "AttachmentOffset.Rotation.Angle",
        "attachementAxisX"&nbsp;: "AttachmentOffset.Rotation.Axis.x",
        "attachementAxisY"&nbsp;: "AttachmentOffset.Rotation.Axis.y",
        "attachementAxisZ"&nbsp;: "AttachmentOffset.Rotation.Axis.z",
        "Length"&nbsp;: "Length",
        "Length2"&nbsp;: "Length2",
        "Radius"&nbsp;: "Radius",
        "Height"&nbsp;: "Height",
        "FirstAngle"&nbsp;: "FirstAngle",
        "SecondAngle"&nbsp;: "SecondAngle",
        "Angle1"&nbsp;: "Angle1",
        "Angle2"&nbsp;: "Angle2",
        "Angle3"&nbsp;: "Angle3",
     }


def set_constraint_expression(sketchLabel, constraint_name, expression):
    # Get all Sketches with this label
    findConstraint = False
    sketches = App.ActiveDocument.getObjectsByLabel(sketchLabel)
    if len(sketches) &gt; 1&nbsp;:
        print("Warning, multiple sketches have the same label. "
              " All these sketches will be processed. "
              "This may cause problems if different sketches with the same label "
              "have constraints with the same name.")
    # Go through all Sketches

    for sketch in sketches:

        # Go through all constraints in the Sketch
        for i in range(sketch.ConstraintCount):
            # Get the constraint
            constraint = sketch.Constraints[i]

            # Check if the constraint name matches the one we're looking for
            if constraint.Name == constraint_name:
                # Modify the constraint value
                sketch.setExpression(f'Constraints[{i}]', expression)
                findConstraint=True
                break
    return findConstraint


def set_property_based_on_alias(sheet,cell):

    # alias of the cell
    alias = sheet.getAlias(cell)
    # Check if the alias is valid
    if sheet.getContents(cell)!=''&nbsp;:
        if alias is None:
            print(f"The selected cell {cell} does not have an alias.")
            return

    # Separate the alias into body name and property name
    # ex 'body_Name_posX' -&gt; body_Name for the object and posX for property name
    parts = alias.rsplit('_', 1)
    if len(parts)&nbsp;!= 2:
        print("The alias must be in the form 'BodyName_PropertyName'.")
        return

    objLabel, property_name = parts
    try&nbsp;:
        obj=App.ActiveDocument.getObjectsByLabel(objLabel)[0]
    except&nbsp;:
        print('no object with this label&nbsp;: ',objLabel)
        return
    try&nbsp;:
        property_name=dico[property_name]
    except&nbsp;:
        try&nbsp;:
            if  obj.TypeId&nbsp;!= 'Sketcher::SketchObject'&nbsp;:
                print (f'property {property_name} not found in the dictionary. See at the top of the source code')
        except&nbsp;:
            pass



    if obj is None:
        print(f"There is no object named '{objLabel}' in the document.")
        return

    # Create an expression that refers to the cell's alias
    expression = f"&lt;&lt;{sheet.Label}&gt;&gt;.{alias}"

    # Modify the object's property
    # if it's a constraint
    if  obj.TypeId == 'Sketcher::SketchObject'&nbsp;:
        findConstraint=set_constraint_expression(objLabel, property_name, expression)
        if findConstraint&nbsp;: # if not we continue to find a property
            return

    if hasattr(obj, property_name.split('.')[0]): # Placement.Base.x -&gt; Placement
        obj.setExpression(property_name, expression)
    else:
        print(f"The object '{objLabel}' does not have a property '{property_name}'.")


def tableToObject()&nbsp;:
    sheet = Gui.ActiveDocument.ActiveView.getSheet()
    # Check if the spreadsheet is active
    if sheet.TypeId&nbsp;!= 'Spreadsheet::Sheet':
        print("Please select cells in a spreadsheet.")
        return

    # active cell
    #cell = Gui.activeView().currentIndex()

    aw = Gui.getMainWindow().centralWidget().activeSubWindow() # Store the active window
    # To get list of all selected cells
    sel_items = aw.widget().findChild(QtGui.QTableView).selectedIndexes()
    getCellName = lambda r,c:'{}{}{}'.format(chr(c//26 + 64) if c//26 &gt; 0 else '', chr(c%26 + 65), r + 1)
    for cell in sel_items: # The selected cells are scanned
        cellName=getCellName(cell.row(), cell.column())

        if str(sheet.getContents(cellName))!= ''&nbsp;:
            set_property_based_on_alias(sheet, cellName)






def main():
    dialog = CheckBoxDialog()
    result = dialog.exec_()
    if result and dialog.createAliasForTableCheckBox.isChecked()&nbsp;:
        create_alias_for_table_cells_Selected()
    if result and dialog.tableToObjectCheckBox.isChecked()&nbsp;:
        tableToObject()
    return result



if __name__ == '__main__':
    main()
</pre>
<!-- 
NewPP limit report
Cached time: 20251213171054
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.050 seconds
Real time usage: 0.069 seconds
Preprocessor visited node count: 179/1000000
Post&#8208;expand include size: 3463/2097152 bytes
Template argument size: 2222/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 3/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 17033/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   15.490      1 -total
 39.15%    6.065      1 Template:Macro/de
 26.97%    4.177      1 Template:CodeDownload
 17.19%    2.663      1 Template:Code
 12.31%    1.907      6 Template:Incode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:396224-0!canonical and timestamp 20251213171054 and revision id 1715531. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>