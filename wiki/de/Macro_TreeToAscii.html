<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro TreeToAscii/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+TreeToAscii&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_TreeToAscii.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro TreeToAscii (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_TreeToAscii.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro TreeToAscii (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Macro_TreeToAscii.html" class="mw-pt-progress mw-pt-progress--low" title="Macro TreeToAscii (12% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_TreeToAscii.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: TreeToAscii (6% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Text-x-python.png&amp;filetimestamp=20121224162851&amp;.html" class="mw-file-description" title="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros"><img alt="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros" src="../File/Text-x-python.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></a></span><span> </span>
Baum zu ASCII
</p>
</td></tr>
<tr>
<th class="ctOdd">Beschreibung
</th></tr>
<tr>
<td class="ctEven left macro-description">Dieses Makro generiert eine ASCII-Kunst-Darstellung des Baums der ausgew&auml;hlten Objekte<br><br>Versionsmakro&nbsp;: 0.6<br>Datum der letzten &Auml;nderung&nbsp;: 2020-03-23<br>FreeCAD version&nbsp;: 0.17+<br>Autor: OpenBrain<br>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;OpenBrain&amp;action=edit&amp;redlink=1.html" class="new" title="User:OpenBrain (page does not exist)">OpenBrain</a>
</td></tr>
<tr>
<th class="ctOdd">Herunterladen
</th></tr>
<tr>
<td class="ctEven macro-download"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../de/Macros_recipes.html" title="Macros recipes/de">Makros Rezepte</a><br><a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a><br><a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Symbolleisten anpassen</a>
</td></tr>
<tr>
<th class="ctOdd">Macro-Version
</th></tr>
<tr>
<td class="ctEven macro-version">0.6
</td></tr>
<tr>
<th class="ctOdd">Datum der letzten &Auml;nderung
</th></tr>
<tr>
<td class="ctEven macro-date">2020-03-23
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.17+
</td></tr>
<tr>
<th class="ctOdd">Standardverkn&uuml;pfung
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Beschreibung">Beschreibung</span></h2>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This macro has been written mainly aiming at documenting the model construction. It generates an ASCII art representation of the construction tree of selected object(s).
</p>
</div>
<p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Anwendung">Anwendung</span></h2>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Just select the object(s) you want to print the tree and run the macro. It will display the tree of each object in a dialog. All selected objects will be considered as being at the same hierarchy level at the top of the tree (even if they aren't in the real model). Once dialog is open, you can change style and/or pattern and re-generate the ASCII tree.
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=FCTree2Ascii.png&amp;filetimestamp=20200319113217&amp;.html" class="mw-file-description"><img src="../File/FCTree2Ascii.png" decoding="async" width="949" height="487" class="mw-file-element" data-file-width="949" data-file-height="487"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Several styles are provided, at this time mainly to support systems that can encounter problems with Unicode encoding&nbsp;:
</p>
<ul><li><i><b>Modern</b></i>&nbsp;: (default) uses Unicode characters to display forks and branches</li>
<li><i><b>Baroque</b></i>&nbsp;: another Unicode style with larger indentation</li>
<li><i><b>ASCII</b></i>&nbsp;: pure ASCII representation of forks and branches</li></ul>
<p>Creating your own style should not be too difficult by editing the macro and changing/adding a style to 'STYLES' variable. Selected style choice is saved in FreeCAD parameters.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Line pattern is can be customized. It supports different defined metadata&nbsp;:
</p>
<ul><li><i><b>{LBL}</b></i>&nbsp;: object Label (displayed label)</li>
<li><i><b>{NAM}</b></i>&nbsp;: object Name (internal name) eg. 'Box001'</li>
<li><i><b>{SNAM}</b></i>&nbsp;: object ShortName (without digits) eg. 'Box001' will be displayed as 'Box'</li>
<li><i><b>{TYP}</b></i>&nbsp;: object Type eg. 'Part::MultiFuse'</li>
<li><i><b>{BTYP}</b></i>&nbsp;: object BaseType eg. 'Part::MultiFuse' will be displayed as 'Part'</li>
<li><i><b>{STYP}</b></i>&nbsp;: object ShortType (without base) eg. 'Part::MultiFuse' will be displayed as 'MultiFuse'</li></ul>
<p>Default pattern is '{LBL} ({SNAM})', which means eg. object 'Box001' labeled 'myCube' will be displayed as 'myCube (Box001)'.
Notice virtually all characters are allowed. If you want to print curly braces, they need to be doubled. Eg. with same example object, pattern '{LBL} (SNAME) {{{TYP}}} =&gt;' will print 'myCube (Box) {Part::Box} =&gt;'. Available metadata are available in the tooltip of the pattern editing field so you don't need to remember it. Line pattern is saved in FreeCAD parameters.
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Once dialog is open, several actions are available&nbsp;:
</p>
<ul><li><i><b>Copy to clipboard</b></i>&nbsp;: copies the whole tree to your clipboard</li>
<li><i><b>Save to file</b></i>&nbsp;: saves the whole tree to an arbitrary file on your system</li>
<li><i><b>Embed in text file</b></i>&nbsp;: stores the whole tree in a text file embedded in the document (available since FC 0.18.4)</li>
<li>Of course you can copy any part of the tree by selecting it and using standard copy commands</li></ul>
</div>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Das Makro ist &uuml;ber den <a href="../de/Std_AddonMgr.html" title="Std AddonMgr/de">Addon-Manager</a> verf&uuml;gbar.
Der Code wird auf dieser Seite zur Verf&uuml;gung gestellt, f&uuml;r den Fall, dass das Benutzersystem nicht &uuml;ber git-python verf&uuml;gt. Obwohl es aktuell sein sollte, ist die neueste Version immer unter <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD-macros/blob/master/Information/TreeToAscii.FCMacro">FreeCAD-Makro Repositorium</a> verf&uuml;gbar.
</p><p>F&uuml;r ausf&uuml;hrlichere Erkl&auml;rungen siehe Seite <a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a>.
</p><p><span id="Script"></span>
</p>
<h2><span class="mw-headline" id="Skript">Skript</span></h2>
<p><span id="Forum_discussion"></span>
</p>
<h3><span class="mw-headline" id="Forums-Diskussion">Forums-Diskussion</span></h3>
<p>F&uuml;r jegliches Feedback (Fehler, Funktionsw&uuml;nsche, Kommentare usw.) nutzen Sie bitte diesen Forum-Thread: <a rel="nofollow" class="external free" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504">https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504</a>
</p>
<h3><span class="mw-headline" id="Code">Code</span></h3>
<p><b>Macro_FCTree2Ascii.FCMacro</b>
</p>
<pre>#!/usr/bin/python
#####################################
# Copyright (c) openBrain 2020
# Licensed under LGPL v2
#
# This FreeCAD macro prints the Tree of selected object(s) as ASCII art.
# Several styles are available. Tree branch pattern is customizable.
# It can export to clipboard, file or embedded text document.
# This mainly aims at documenting the model.
#
# Version history&nbsp;:
# *0.6&nbsp;: introduce last fork string definition, add new style
# *0.5&nbsp;: beta release
#
#####################################

# -*- coding: utf-8 -*-

__Name__ = 'TreeToAscii'
__Comment__ = 'Prints the Tree of selected object(s) as ASCII art'
__Author__ = 'openBrain'
__Version__ = '0.6'
__Date__ = '2020-03-23'
__License__ = 'LGPL v2'
__Web__ = 'https://wiki.freecad.org/Macro_TreeToAscii'
__Wiki__ = 'https://wiki.freecad.org/Macro_TreeToAscii'
__Icon__ = ''
__Help__ = 'Select object(s) you want to print the tree then run'
__Status__ = 'Beta'
__Requires__ = 'FreeCAD &gt;= 0.17'
__Communication__ = 'https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504'

import FreeCAD as App
import FreeCADGui as Gui
from PySide import QtGui, QtCore  # Special FreeCAD's PySide, which may be PySide2!

PREF_PATH = 'User parameter:BaseApp/Preferences/Mod/TreeToAscii'
PREF_PATTERN = 'TreePattern'
PREF_STYLE = 'TreeStyle'
STYLES = {  # defines styles as NAME&nbsp;: [ branch str, fork str, opt:last fork str]
    'Modern'&nbsp;: [' &#9474; ', ' &#9500; ', ' &#9492; '],  # Unicode U+251C, Unicode U+2502
    'Baroque'&nbsp;: [' &#9474;  ', ' &#9500;&#9472; ',  ' &#9492;&#9472; '],
    'ASCII'&nbsp;: [' | ', ' \\_']
    }
DEF_PATTERN = '{LBL} ({SNAM})'
DEF_STYLE = list(STYLES.keys())[0]

g_ascii_tree=""

def printChildren(objs=None, level=0, baseline=''):
    """Build ASCII tree by recursive call"""
    global g_ascii_tree
    for cnt, obj in enumerate(objs,1):
        data = {
            "LBL"&nbsp;: obj.Label,
            "NAM"&nbsp;: obj.Name,
            "SNAM"&nbsp;: "".join(filter(str.isalpha, obj.Name)),
            "TYP"&nbsp;: obj.TypeId,
            "BTYP"&nbsp;: obj.TypeId.partition('::')[0],
            "STYP"&nbsp;: obj.TypeId.rpartition('::')[-1]
        }
        branch_str = STYLES[gen_style.currentText()][0]
        fork_str = STYLES[gen_style.currentText()][1]
        last_fork_str = STYLES[gen_style.currentText()][-1]
        if cnt == len(objs):
            g_ascii_tree += baseline + last_fork_str
        else:
            g_ascii_tree += baseline + fork_str
        try:
            g_ascii_tree += gen_pattern.text().format(**data)
        except (ValueError, IndexError, KeyError):
            g_ascii_tree = 'Error in generating pattern'
            return
        g_ascii_tree += '\n'
        if cnt == len(objs):
            baselinechi = baseline + ' '*len(branch_str)
        else:
            baselinechi = baseline + branch_str
        printChildren(obj.ViewObject.claimChildren(), level + 1, baselinechi)

def copyToClip():
    """Copies ASCII tree to clipboard"""
    tree_view.selectAll()
    tree_view.copy()
    tree_view.setPlainText("Copied to clipboard")
    QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def saveToFile():
    """Saves ASCII tree to user system file"""
    _path = QtGui.QFileDialog.getSaveFileName()
    if _path[0]:
        save_file = QtCore.QFile(_path[0])
        if save_file.open(QtCore.QFile.ReadWrite):
            save_fileContent = QtCore.QTextStream(save_file)
            save_fileContent &lt;&lt; g_ascii_tree
            save_file.flush()
            save_file.close()
            tree_view.setPlainText("Saved to file&nbsp;: " + _path[0])
        else:
            tree_view.setPlainText("ERROR&nbsp;: Can't open file&nbsp;: " + _path[0])
        QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def embedToText():
    """Stores ASCII tree into an embedded document"""
    text_doc = None
    try:
        text_doc = App.ActiveDocument.addObject("App::TextDocument","ModelTree")
    except:
        tree_view.setPlainText("ERROR&nbsp;: can't create Text document. Maybe your version is too old")
    if text_doc:
        text_doc.Text = g_ascii_tree
        tree_view.setPlainText("Embedded to text document&nbsp;: " + text_doc.Label)
    QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def updateTxt():
    """Updates ASCII tree"""
    global g_ascii_tree
    g_ascii_tree=""
    printChildren(Gui.Selection.getSelection())
    tree_view.setPlainText(g_ascii_tree)


def onGenerate():
    """Called when updating ASCII tree"""
    p.SetString(PREF_PATTERN, gen_pattern.text())
    p.SetString(PREF_STYLE, gen_style.currentText())
    updateTxt()

# Get saved parameters or use defaults.
p = App.ParamGet(PREF_PATH)
g_name_pattern = p.GetString(PREF_PATTERN, DEF_PATTERN)
g_tree_style = p.GetString(PREF_STYLE, DEF_STYLE)
if g_tree_style not in STYLES:
    g_tree_style = DEF_STYLE

# Build UI and show
dlg = QtGui.QDialog(Gui.getMainWindow(), QtCore.Qt.Tool)
dlg_layout = QtGui.QVBoxLayout(dlg)
gen_layout = QtGui.QHBoxLayout()
gen_pattern = QtGui.QLineEdit(g_name_pattern, dlg)
gen_pattern.setToolTip("""Defined variables are&nbsp;:
    {LBL}&nbsp;: object Label
    {NAM}&nbsp;: object Name
    {SNAM}&nbsp;: object ShortName (without digits)
    {TYP}&nbsp;: object Type
    {BTYP}&nbsp;: object BaseType
    {STYP}&nbsp;: object ShortType (without base)
If you need to print curly braces, they have to be doubled""")
gen_run = QtGui.QPushButton("Generate",dlg)
gen_run.clicked.connect(onGenerate)
gen_style = QtGui.QComboBox(dlg)
gen_style.addItems(list(STYLES.keys()))
gen_style.setCurrentIndex(list(STYLES.keys()).index(g_tree_style))
gen_layout.addWidget(QtGui.QLabel("Generating pattern: "))
gen_layout.addWidget(gen_pattern)
gen_layout.addWidget(QtGui.QLabel("Style&nbsp;: "))
gen_layout.addWidget(gen_style)
gen_layout.addWidget(gen_run)
tree_view = QtGui.QPlainTextEdit(g_ascii_tree)
tree_view.setReadOnly(True)
tree_view.setMinimumWidth(Gui.getMainWindow().width()/2)
tree_view.setMinimumHeight(Gui.getMainWindow().height()/2)
tree_view.setLineWrapMode(QtGui.QPlainTextEdit.NoWrap)
button_box = QtGui.QDialogButtonBox()
copy_clip_but = QtGui.QPushButton("Copy to clipboard", button_box)
button_box.addButton(copy_clip_but, QtGui.QDialogButtonBox.ActionRole)
copy_clip_but.clicked.connect(copyToClip)
_but = QtGui.QPushButton("Save to file", button_box)
button_box.addButton(_but, QtGui.QDialogButtonBox.ActionRole)
_but.clicked.connect(saveToFile)
store_embed_but = QtGui.QPushButton("Embed in a text file", button_box)
button_box.addButton(store_embed_but, QtGui.QDialogButtonBox.ActionRole)
store_embed_but.clicked.connect(embedToText)
close_dlg_but = QtGui.QPushButton("Close", button_box)
button_box.addButton(close_dlg_but, QtGui.QDialogButtonBox.RejectRole)
button_box.rejected.connect(dlg.reject)
dlg_layout.insertLayout(0,gen_layout)
dlg_layout.addWidget(tree_view)
dlg_layout.addWidget(button_box)
updateTxt()
dlg.exec_()
</pre>
<!-- 
NewPP limit report
Cached time: 20251023090729
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.037 seconds
Real time usage: 0.075 seconds
Preprocessor visited node count: 110/1000000
Post&#8208;expand include size: 2318/2097152 bytes
Template argument size: 250/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 8062/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.981      1 -total
 61.65%    6.153      1 Template:Macro/de
 36.62%    3.655      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:396545-0!canonical and timestamp 20251023090729 and revision id 1674777. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>