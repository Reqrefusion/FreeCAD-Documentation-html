<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">TechDraw TemplateGenerator/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-TechDraw+TemplateGenerator&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../TechDraw_TemplateGenerator.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="TechDraw TemplateGenerator (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--high" title="TechDraw Cr&eacute;ation de mod&egrave;les (92% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../pl/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--high" title="Rysunek Techniczny: Generator szablon&oacute;w (92% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span> Anleitung
</td></tr>
<tr>
<th class="ctOdd">Thema
</th></tr>
<tr>
<td class="ctEven">Eine TechDraw-Vorlagen unter Verwendung eines Python-Makros erstellen
</td></tr>
<tr>
<th class="ctOdd">Niveau
</th></tr>
<tr>
<td class="ctEven">Grundkenntnisse von Python und SVG-Strukturen sind hilfreich
</td></tr>
<tr>
<th class="ctOdd">Bearbeitungszeit
</th></tr>
<tr>
<td class="ctEven">(noch nicht bekannt)
</td></tr>
<tr>
<th class="ctOdd">Autoren
</th></tr>
<tr>
<td class="ctEven"><a href="../User;FBXL5.html" title="User:FBXL5">FBXL5</a>
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version
</th></tr>
<tr>
<td class="ctEven">0.21 und neuer
</td></tr>
<tr>
<th class="ctOdd">Beispieldateien
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><a href="../de/Macro_TemplateHelper.html" title="Macro TemplateHelper/de">Makro TemplateHelper</a>
</td></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr></tbody></table>
<p><span id="Introduction"></span>
</p>
<h2><span class="mw-headline" id="Einleitung">Einleitung</span></h2>
<p>Diese Anleitung beschreibt, wie man eine einfache Vorlage zur Benutzung mit dem  TechDraw-Arbeitsbereich aus ein paar Zeilen Python-Kode erstellt.
</p><p>Jeder Texteditor kann zum Erstellen von Kode genutzt werden. Mein Favorit ist Atom, aber FreeCADs eingebauter Editor funktioniert auch bestens.
</p><p>Die folgenden Kode-Beispiele k&ouml;nnen kopiert, in eine leere Textdatei eingef&uuml;gt und dann unter einem selbstgew&auml;hlten Namen als *.py oder *.FCMacro abgespeichert werden.
</p><p>Eine Vorlage stellt einen Hintergrund f&uuml;r Zeichnungsaufgaben bereit und ihre Ma&szlig;e werden vom Druckertreiber f&uuml;r die korrekte Skalierung der Zeichnung verwendet.
</p><p>Die Vorlagen sind SVG-Dateien, daher muss ein Makro einige Zeilen SVG-Kode (eine Untermenge von XML-Kode) zusammenstellen.
</p><p><b>Hinweis:</b> nachdem FreeCAD von <b>freecadweb.org</b> nach <b>freecad.org</b> umgezogen ist, wurde diese Seite entsprechend aktualisiert und der resultierende SVG-Code ist nicht mehr kompatibel mit FreeCAD-Versionen, die &auml;lter sind als v0.21. F&uuml;r diese versionen muss <code>freecad.org</code> in der Deklarationszeile des resultierenden SVG-Codes von Hand auf <code>freecadweb.org</code> zur&uuml;ckge&auml;ndert werden, da die editierbaren Texte sonst nicht erkannt werden.
</p><p><span id="Structure_of_a_simple_blank_page"></span>
</p>
<h2><span class="mw-headline" id="Struktur_einer_einfachen_leeren_Seite">Struktur einer einfachen leeren Seite</span></h2>
<p>Das SVG-Format ist eine Untermenge des XML-Formats.
Daher besteht eine SVG-Datei, wie auch jede XML-Datei, aus zwei Teilen:
</p>
<ul><li>Einem Kopf mit eine Formatdeklaration</li>
<li>Einem K&ouml;rper, der die Informationen dar&uuml;ber enth&auml;lt, was anzuzeigen ist und wo es platziert wird</li></ul>
<dl><dd>(Ich wei&szlig; nicht, warum die Kopfzeile enthalten sein soll; die SVG-Datei funktioniert auch ohne sie als Vorlagedatei)</dd></dl>
<p><span id="Head"></span>
</p>
<h3><span class="mw-headline" id="Kopf">Kopf</span></h3>
<p>Der Kopf besteht aus nur einer Zeile zur Angabe der Version der XML-Sprache, die verwendet werden soll, um die im K&ouml;rper befindlichen Anweisungen  zu verarbeiten.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
</pre></div>
<p><span id="Body"></span>
</p>
<h3><span id="K.C3.B6rper"></span><span class="mw-headline" id="K&ouml;rper">K&ouml;rper</span></h3>
<p>Der K&ouml;rper startet mit einem &ouml;ffnenden Tag, der Informationen &uuml;ber Namensr&auml;ume, &uuml;ber die Gr&ouml;&szlig;e der Vorlage und dar&uuml;ber, wo sie platziert wird enth&auml;lt. Und er h&ouml;rt mit einem schlie&szlig;enden Tag auf.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<dl><dd><b>xmlns=</b>"<a rel="nofollow" class="external free" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>": Externer Verweis auf den XML-Namensraum, um Standard-XML-Befehle nachzuschlagen.</dd>
<dd><b>version=</b>"1.1": Die verwendete  XML-Version ist 1.1</dd>
<dd><b>xmlns:freecad=</b>"...=Svg_Namespace": Externe Verkn&uuml;pfung zu FreeCADs Wikiseite <a href="../de/Svg_Namespace.html" title="Svg Namespace/de">Svg-Namensraum</a>". Die Verkn&uuml;pfung wird nicht zum Nachladen von Informationen oder Werten zur Laufzeit genutzt, sondern als Schl&uuml;ssel zum Aktivieren der speziellen Attribute, wie z.B. die editierbare Texte.</dd>
<dd>"freecad:" wird den besagten speziellen Attributen vorangestellt.</dd>
<dd><b>width=</b>"420mm": Breite der Zeichenfl&auml;che.</dd>
<dd><b>height=</b>"297mm": H&ouml;he der Zeichenfl&auml;che.</dd>
<dd><b>viewBox=</b>"0 0 420 297": Position der oberen linken Ecke (0;0) und der unteren rechten Ecke (420;297) im SVG-Konstruktionsraum (in SVG-Einheiten).</dd>
<dd>Width, height, and viewBox, in dieser Kombination, setzen 1 SVG-Einheit gleich 1 mm, f&uuml;r das gesamte Dokument. Von jetzt an kann die Ma&szlig;einheit weggelassen werden.</dd>
<dd>In diesem Falle ergeben 420 und 297 eine A3-Seite. Diese Werte werden angepasst, um andere Seitenformate zu erzeugen.</dd></dl>
<p>F&uuml;r eine leere DIN-A3-Seite im Querformat war das alles.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<p><span id="Python_code..."></span>
</p>
<h2><span class="mw-headline" id="Python-Kode...">Python-Kode...</span></h2>
<p>Die Skripterstellung beginnt mit einem Ger&uuml;st, das eine separate Hauptfunktion "main" enth&auml;lt
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Here is where the magic happens"""</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p><span id="..._to_create_a_blank_page"></span>
</p>
<h3><span class="mw-headline" id="..._zum_Erstellen_einer_leeren_Seite">... zum Erstellen einer leeren Seite</span></h3>
<p>Der Ablauf zur Erstellung einer Vorlage besteht aus den Schritten:
</p>
<ul><li>Den Volagenordner lokalisieren.</li>
<li>Eine Datei zum Schreiben zu &ouml;ffnen und so als ersten Schritt eine leere SVG-Datei anzulegen, eine Kopfzeile zu schreiben und die Datei zu schlie&szlig;en.</li>
<li>Danach wiederholt die Datei zum Anh&auml;ngen weiterer Segmente jeweils &ouml;ffnen und nach erfolgtem Anh&auml;ngen wieder schlie&szlig;en.</li></ul>
<p>Das Makro besteht aus mehreren Funktionen, die von der Hauptfunktion "main()" aufgerufen werden.<br>
Zus&auml;tzliche Funktionen k&ouml;nnen vor der EndSvg-Funktion eingef&uuml;gt werden und die dazugeh&ouml;rigen Aufrufe werden vor dem EndSvg()-Aufruf eingesetzt.<br>
Man muss auf die Anzahl der Leerzeichen achten, die mit den Schreiboperationen erzeugt werden, und damit auf den korrekten Zeileneinzug.
</p>
<h4><span id="pathToTemplate.28.29"></span><span class="mw-headline" id="pathToTemplate()">pathToTemplate()</span></h4>
<p>Bevor &uuml;berhaupt Kode erzeugt wird, ben&ouml;tigt man einen Ordner zum Speichern der neuen Vorlagen und es muss ein Dateiname vergeben werde.
</p><p>Der Benutzer sollte bereits einen Vorlagenordner ausgew&auml;hlt haben. Sein Pfad ist dann in den TechDraw-Voreinstellungen gespeichert. <br> Es ist nicht n&ouml;tig zu wissen, wo die Voreinstellungen gespeichert werden, da FreeCAD Befehle enth&auml;lt, mit denen man die ben&ouml;tigten Parameter direkt ansprechen kann.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>
</pre></div>
<p><b>parameter_path</b> erh&auml;lt den Pfad zum "Verzeichnis" innerhalb der Konfigurationsdatei, wo die Variable "TemplateDir" gefunden werden kann.<br>
<b>template_path</b> erh&auml;lt den Inhalt von "TemplateDir", also den Pfad zum Vorlagenverzeichnis.<br>
<b>template_name</b> erh&auml;lt den Namen der neu zu erstellenden Vorlage.
</p><p>Nun muss der <b>template_name</b> noch so mit dem <b>template_path</b> verkn&uuml;pft werden, dass das Ergebnis sowohl zu unix-basierten Betriebssystemen als auch zu Windows kompatibel ist.<br>
Dies wird mit dem Befehl "os.path.join" erreicht und in der Variablen <b>template_file</b> gespeichert. Um diesen Befehl zu aktivieren, wird eine Importanweisung "import os" verlangt.
</p>
<h4><span id="createSvgFile.28.29"></span><span class="mw-headline" id="createSvgFile()">createSvgFile()</span></h4>
<p>Dies erstellt eine neue Vorlage und speichert die XML-Kopfzeile.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<h4><span id="startSvg.28.29"></span><span class="mw-headline" id="startSvg()">startSvg()</span></h4>
<p>Dies wird an die Vorlagendatei angef&uuml;gt und erstellt den &ouml;ffnenden SVG-Tag inklusive seiner Attribute.<br>Jede Schreibanweisung enth&auml;lt eine einzelne SVG-Codezeile, die auf "\n" endet, dem Kennzeichen f&uuml;r CR/LF.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="endSvg()"></span>
</p>
<h4><span id="Funktion_endSvg.28.29"></span><span class="mw-headline" id="Funktion_endSvg()">Funktion endSvg()</span></h4>
<p>Dies wird wieder an die Vorlagendatei angef&uuml;gt und erstellt den schlie&szlig;enden SVG-Tag; Damit wird der SVG-Code letztlich abgeschlossen.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="main()"></span>
</p>
<h4><span id="Funktion_main.28.29"></span><span class="mw-headline" id="Funktion_main()">Funktion main()</span></h4>
<p>Die Funktion main() ruft alle weiteren Funktionen auf und &uuml;bergibt einige Parameter.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>
</pre></div>
<p>In diesem Beispiel sind die Werte f&uuml;r <code>format_width</code> und <code>format_height</code> festgeschriebene (hard coded) Abmessungen, Die beiden eigentlich nicht notwendigen Zeilen markieren den Punkt an dem andere Funktionen zum Ermitteln der Formatdaten ihren Inhalt ablegen k&ouml;nnen.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<h4><span id="Das_komplette_Makro_f.C3.BCr_eine_leere_Seite"></span><span class="mw-headline" id="Das_komplette_Makro_f&uuml;r_eine_leere_Seite">Das komplette Makro f&uuml;r eine leere Seite</span></h4>
<p>Dieses Makro enth&auml;lt die obigen Codeabschnitte und ist startbereit.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><br>
<span id="..._to_create_a_page_with_some_ink"></span>
</p>
<h3><span class="mw-headline" id="..._zum_Erstellen_einer_Seite_mit_ein_paar_Strichen">... zum Erstellen einer Seite mit ein paar Strichen</span></h3>
<p>Um aus einer leeren Seite eine Zeichnung zu machen, braucht man:
</p>
<ul><li>Rahmen, d.h. Rechtecke, die mit der Anweisung <b>rect</b> erstellt werden.</li>
<li>Ein Schriftfeld und noch etwas mehr, das aus Linien besteht, die mit der Anweisung <b>path</b> erstellt werden.</li>
<li>Einfache Texte f&uuml;r Indizes und die Benennungen der Schriftfeldzellen.</li>
<li>Editierbare Texte f&uuml;r z.B. Sachnummer und Benennung.</li></ul>
<p>Diese graphischen Elemente werden normalerweise mehrfach benutzt, daher werden f&uuml;r die erzeugenden Kodes vier Funktionen erstellt:
</p>
<ul><li>svgRect() f&uuml;r rechteckige Rahmenelemente.</li>
<li>svgPath() f&uuml;r gerade Linienelemente.</li>
<li>svgText() f&uuml;r unver&auml;nderliche Texte.</li>
<li>ediText() f&uuml;r editierbares Texte.</li></ul>
<p>Alle Funktionen werden innerhalb des obigen Makros vor der Funktion main() eingef&uuml;gt und die dazugeh&ouml;rigen Funktionsaufrufe zwischen <code>startSvg(...)</code> und <code>endSvg(...)</code> in der Funktion main().
</p><p><span id="svgRect()"></span>
</p>
<h3><span id="Funktion_svgRect.28.29"></span><span class="mw-headline" id="Funktion_svgRect()">Funktion svgRect()</span></h3>
<p>Um ein Rechteck zu zeichnen, muss die Funktion <b>svgRect</b> aufgerufen und die Werte f&uuml;r Breite, H&ouml;he und die Position der linken oberen Ecke &uuml;bergeben werden. Das liest sich an dieser Stelle besser als wenn svg_line die komplette SVG-Codezeile enthalten w&uuml;rde.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Die SVG-Anweisung ist geteilt, um innerhalb der empfohlenen Python-Zeilenl&auml;nge zu bleiben, sie ergibt trotzdem eine einzelne SVG-Zeile.
</p><p>Mit etwas mehr Python-Erfahrung ergab sich auch eine andere M&ouml;glichkeit variablen Inhalt einzuf&uuml;gen: die eingebaute Funktion <code>.format()</code> in Verbindung mit benannten <code>{name}</code>, indizierten <code>{0}</code> oder leeren <code>{}</code> Platzhaltern. Namen mit nur einem Buchstaben &auml;ndern die Funktion so:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="si">{W}</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="si">{H}</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">W</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">height</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
<p>(Die runden Klammern sind optional, so lange wir die Zeichenkette f&uuml;r <b>svg_line</b> nicht aufteilen m&uuml;ssen)
</p><p><span id="svgPath()"></span>
</p>
<h3><span id="Funktion_svgPath.28.29"></span><span class="mw-headline" id="Funktion_svgPath()">Funktion svgPath()</span></h3>
<p>Um eine Linie zu zeichnen, muss die Funktion  <b>svgPath</b> aufgerufen und die Koordinaten f&uuml;r Start- und Endpunkt einer Linie &uuml;bergeben werden.
</p><p>Anstatt der Endpunktkoordinaten kann ein Kennwert &uuml;bergeben werden, um eine horizontale (h) oder vertikale (v) Linie zu zeichnen, gefolgt von der L&auml;nge der Linie, oder ein Kennwert, um eine Horizontale (H) oder vertikale (V) Linie zu zeichnen, gefolgt von der X- bzw. Y-Ordinate des Endpunktes.
</p><p>Jeder Pfad beginnt am Ursprung und die erste Aktion ist eine Bewegung mit "angehobenem Stift" (nicht zeichnend) zum Startpunkt. In diesem Fall sind die relative und die absolute Bewegung identisch und daher ist es egal, ob der M-Tag ein gro&szlig;es oder ein kleines M enth&auml;lt.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Die alternative Version mit Platzhaltern und <code>.format()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> </span><span class="si">{C}</span><span class="s2"> </span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> l </span><span class="si">{C}</span><span class="s2">,</span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">x2</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
<p><span id="svgText()"></span>
</p>
<h3><span id="Funktion_svgText.28.29"></span><span class="mw-headline" id="Funktion_svgText()">Funktion svgText()</span></h3>
<p>Um etwas Text zu zeichnen, muss die Funktion <b>svgText</b> aufgerufen und die Koordinaten f&uuml;r den Ankerpunkt des Textes, die Textzeichenkette selbst sowie wahlweise ein Winkel f&uuml;r gedrehten Text &uuml;bergeben werden. Zum Drehen von Texten muss eine Transformationsanweisung in jeden einzelnen Text-Tag eingef&uuml;gt werden; die Drehpunkte m&uuml;ssen dieselben Koordinaten erhalten, wie die zugeh&ouml;rigen Text-Ankerpunkte.
</p><p>(Die Textausrichtung wird durch den umschlie&szlig;enden Gruppen-Tag gesteuert oder ist standardm&auml;&szlig;ig linksb&uuml;ndig)
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Die alternative Version mit Platzhaltern und <code>.format()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> fill=</span><span class="se">\"</span><span class="s2">#000</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">Y</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span><span class="p">)</span>
</pre></div>
<p><span id="ediText()"></span>
</p>
<h4><span id="Funktion_ediText.28.29"></span><span class="mw-headline" id="Funktion_ediText()">Funktion ediText()</span></h4>
<p>Um einen editierbaren Text zu zeichnen, muss die Funktion  <b>ediText</b> aufgerufen und die Koordinaten f&uuml;r den Ankerpunkt des Textes, die Textzeichenkette selbst sowie wahlweise ein Winkel f&uuml;r gedrehten Text &uuml;bergeben werden. Zum Drehen von Texten muss eine Transformationsanweisung in jeden einzelnen Text-Tag eingef&uuml;gt werden; die Drehpunkte m&uuml;ssen dieselben Koordinaten erhalten, wie die zugeh&ouml;rigen Text-Ankerpunkte.
</p><p>FreeCAD erzeugt ein Dictionary-Objekt f&uuml;r jede hinzugef&uuml;gte Vorlage, und jeder Eintrag hat einen Namen (key) und einen Wert (value).
</p><p>(Die Textausrichtung wird durch den umschlie&szlig;enden Gruppen-Tag gesteuert oder ist standardm&auml;&szlig;ig linksb&uuml;ndig)
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>Die alternative Version mit Platzhaltern und <code>.format()</code>:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{EN}</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="se">\"</span><span class="s2"> fill=</span><span class="se">\"</span><span class="s2">#00d</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{N}</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="se">\"</span><span class="s2"> fill=</span><span class="se">\"</span><span class="s2">#00d</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">EN</span> <span class="o">=</span> <span class="n">entry_name</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span>
        <span class="p">)</span>
</pre></div>
<p><span id="createXxxx_functions"></span>
</p>
<h3><span class="mw-headline" id="Funktionstyp_createXxxx">Funktionstyp createXxxx</span></h3>
<p>Diese Funktionen beginnen mit Kode zum &ouml;ffnen einer Datei im Anf&uuml;ge-Modus (append mode) sowie zum schreiben des &ouml;ffnenden Gruppen-Tags.
</p><p>Dann folgt ein Abschnitt zum setzen und berechnen von Werten und mit Schreibanweisungen, die die obigen Funktionen zum erstellen von SVG-Kode aufrufen.
</p><p>Und am Ende steht der schlie&szlig;ende Gruppen-Tag, gefolgt von einer Anweisung zum Schlie&szlig;en der Datei.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="Resulting_macro"></span>
</p>
<h3><span class="mw-headline" id="Das_resultierende_Makro">Das resultierende Makro</span></h3>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Dieses Makro f&uuml;gt ein paar grundlegende graphische Elemente hinzu, die f&uuml;r richtige Vorlagen gebraucht werden, wie z.B. Linienelemente, Texte und editierbares Texte.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Ggenerates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createTitleBlock</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates a title block and transfers it to the position according to the sheet dimensions"""</span>
    <span class="c1">#- calculate title block origin (lower left corner), offset from page origin</span>
    <span class="n">tbX</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group to transfer all included title block elements at once</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span> <span class="o">+</span> <span class="n">tbX</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">tbY</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block line framework</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block static texts (left-aligned by default)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Some static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-13.5 "</span><span class="p">,</span><span class="s2">"More static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"162.5"</span><span class="p">,</span><span class="s2">"-3.5 "</span><span class="p">,</span><span class="s2">"Vertical static text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createEditableText</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates editable texts positioned according to the page origin"""</span>
    <span class="c1">#- calculate offset to titleblock origin</span>
    <span class="n">edX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group editable texts using the same attributes</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-texts</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7.0;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">43.5</span><span class="p">),</span><span class="s2">"Some editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">13.5</span><span class="p">),</span><span class="s2">"More editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-3"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">173</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">4.5</span><span class="p">),</span><span class="s2">"90&deg; editable text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an A3 template with simple frame and title block"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">createFrame</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createTitleBlock</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createEditableText</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Und das ist der SVG-Kode aus diesem Makro:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>

<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width =</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"drawing-frame"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"390"</span><span class="w"> </span><span class="na">height=</span><span class="s">"277"</span><span class="w"> </span><span class="na">x=</span><span class="s">"20"</span><span class="w"> </span><span class="na">y=</span><span class="s">"10"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"400"</span><span class="w"> </span><span class="na">height=</span><span class="s">"287"</span><span class="w"> </span><span class="na">x=</span><span class="s">"15"</span><span class="w"> </span><span class="na">y=</span><span class="s">"5"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock"</span>
<span class="w">      </span><span class="na">transform=</span><span class="s">"translate(230,287)"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-frame"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.35;stroke-linecap:miter;stroke-miterlimit:4"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,  0 l   0,-63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-63 l 180,  0"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-30 h 155"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m 155,  0 v -63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-text-non-editable"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"font-size:5.0;text-anchor:start;fill:#000000;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-43.5 "</span><span class="nt">&gt;</span>Some<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-13.5 "</span><span class="nt">&gt;</span>More<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"162.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-3.5 "</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,162.5,-3.5 )"</span><span class="nt">&gt;</span>Vertical<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-editable-texts"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"font-size:7.0;text-anchor:start;fill:#0000d0;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-1"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"243.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>Some<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-2"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"273.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>More<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-3"</span><span class="w"> </span><span class="na">x=</span><span class="s">"403"</span><span class="w"> </span><span class="na">y=</span><span class="s">"282.5"</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,403,282.5)"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>90&deg;<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="nt">&lt;/svg&gt;</span>
</pre></div>
</div> 
</div> 
<p>Und so soll es aussehen, wenn sie (die Vorlage) eingef&uuml;gt wurde (mit vergr&ouml;&szlig;ertem Schriftfeld):
</p><p><span typeof="mw:File"><a href="../index.php?title=TechDraw_TemplateGenerator.png&amp;filetimestamp=20240121203255&amp;.html" class="mw-file-description"><img src="../File/TechDraw_TemplateGenerator.png" decoding="async" width="600" height="429" class="mw-file-element" data-file-width="1400" data-file-height="1000"></a></span>
</p><p>Die editierbaren Texte in blau einzuf&auml;rben ist nur eine pers&ouml;nliche Vorliebe, um unver&auml;nderlichen und editierbaren Text einfacher unterscheiden zu k&ouml;nnen.
</p>
<!-- 
NewPP limit report
Cached time: 20250803110005
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.132 seconds
Real time usage: 0.148 seconds
Preprocessor visited node count: 460/1000000
Post&#8208;expand include size: 3026/2097152 bytes
Template argument size: 21155/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 21/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 100802/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   10.443      1 -total
 53.24%    5.560     21 Template:Code
 19.69%    2.056      1 Template:TutorialInfo/de
 11.17%    1.166     13 Template:Incode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:266938-0!canonical and timestamp 20250803110005 and revision id 1623041. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>