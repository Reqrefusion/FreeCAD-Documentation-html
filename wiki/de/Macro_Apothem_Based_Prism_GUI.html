<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Apothem Based Prism GUI/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Apothem+Based+Prism+GUI&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--low" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Apothem Based Prism GUI (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Apothem Based Prism GUI (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../hr/Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-progress mw-pt-progress--high" title="Macro Apothem Based Prism GUI (80% translated)" lang="hr" dir="ltr">hrvatski</a></li>
<li><a href="../it/Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro GUI per creare un prisma da apotema (100% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-progress mw-pt-progress--complete" title="Makrodefinicja: Apothem Based Prism GUI (100% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="../ko/Macro_Apothem_Based_Prism_GUI.html" class="mw-pt-progress mw-pt-progress--med" title="&#48320;&#49900;&#44144;&#47532; &#44592;&#48152; &#44033;&#44592;&#46181; GUI &#47588;&#53356;&#47196; (40% translated)" lang="ko" dir="ltr">&#54620;&#44397;&#50612;</a></li></ul></div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Part_Prism_Apothem.svg&amp;filetimestamp=20141024202313&amp;.html" class="mw-file-description"><img src="../File/Part_Prism_Apothem.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Apothem Based Prism
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">This macro will present the user with a dialog to provide the distance between centers, the number of sides, and height and will create a prism based on the apothem, or inradius of a polygon. This can be extremely handy when one only knows the distance between flats. An example of this would be hexagonal stock of plastics or metal provided by vendors. Most vendors define such stock by the distance between flats. If one is using such stock in their projects, this Macro can be a real time saver.<br><br>Macro version: 1.0<br>Last modified: 2014-12-31<br>FreeCAD version: All<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/4e/Part_Prism_Apothem.svg">ToolBar Icon</a><br>Author: Quick61<br>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Quick61.html" title="User:Quick61">Quick61</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/4e/Part_Prism_Apothem.svg">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="../How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="../Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2014-12-31
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Description">Description</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>This macro will present the user with a dialog to provide the distance between centers, the number of sides, and height and will create a prism based on the apothem, or inradius of a polygon. This can be extremely handy when one only knows the distance between flats. An example of this would be hexagonal stock of plastics or metal provided by vendors. Most vendors define such stock by the distance between flats.  If one is using such stock in their projects, this Macro can be a real time saver.
</p>
</div> 
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="How_To_Use">How To Use</span></h2>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Copy the Macro into your FreeCAD Macro directory. Then either run the macro from the Execute Macro dialog or create a shortcut to use from your custom toolbar.
</p>
</div>  
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>When run, the Macro wil present the user with a dialog like seen below. First enter the desired distance between flats. This can be any number and can include a decimal value, it will not take fractional input. Next enter the number of sides. This number is a whole number and should be an even number as well for proper results. Lastly enter the height you wish the prism to be. Again, this can be any number and can include a decimal value. Click OK and the prism will be created in your document.
</p>
</div> 
<figure class="mw-default-size mw-halign-center" typeof="mw:File"><a href="../index.php?title=ABP_Screenshot.png&amp;filetimestamp=20141024182502&amp;.html" class="mw-file-description"><img src="../File/ABP_Screenshot.png" decoding="async" width="364" height="286" class="mw-file-element" data-file-width="364" data-file-height="286"></a><figcaption></figcaption></figure>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="The_Macro">The Macro</span></h2>
</div>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Part_Prism_Apothem.svg&amp;filetimestamp=20141024202313&amp;.html" class="mw-file-description"><img src="../File/Part_Prism_Apothem.svg" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><b>Macro_Apothem_Based_Prism_GUI.FCMacro</b>
</p>
<pre># # # # # # # # # # #
#
# Apothem Based Prism
#
# This script will take the input of the distance between flats, (apothem, aka inradius), 
# and the number of sidesfor a regular polygon along with a height and produce a 
# correctly sized prism derived from the circumradius.
#
# # # # # # # # # # #
 
import FreeCAD, FreeCADGui, Part, PartGui, math
from FreeCAD import Base
from PySide import QtGui, QtCore
from math import cos, radians
App = FreeCAD
Gui = FreeCADGui
 
class p():
 
 
    def priSm(self):
 
        try:
            dbf = float(self.d1.text())
            nos = int(self.d2.text())
            hth = float(self.d3.text())
            aR = dbf / 2
            op1 = 180/float(nos)
            coS = cos(math.radians(op1))
            cR = aR / coS
            prism=App.ActiveDocument.addObject("Part::Prism","Prism")
            prism.Polygon=nos
            prism.Circumradius=cR
            prism.Height=hth
            prism.Placement=Base.Placement(Base.Vector(0.00,0.00,0.00),Base.Rotation(0.00,0.00,0.00,1.00))
            prism.Label='Prism'
            App.ActiveDocument.recompute()
            Gui.SendMsgToActiveView("ViewFit")
        except:
            FreeCAD.Console.PrintError("Unable to complete task")
 
            self.close()
 
    def close(self):
        self.dialog.hide()
 
 
#
# Make dialog box and get input for distance between flats, number of sides, and height
#
 
    def __init__(self):
        self.dialog = None
 
        self.dialog = QtGui.QDialog()
        self.dialog.resize(280,110)
 
        self.dialog.setWindowTitle("Apothem Based Prism")
        la = QtGui.QVBoxLayout(self.dialog)
 
        iN1 = QtGui.QLabel("Distance Between Flats")
        la.addWidget(iN1)
        self.d1 = QtGui.QLineEdit()
        la.addWidget(self.d1)
 
        iN2 = QtGui.QLabel("Number Of Sides (Best results - use even numbers)")
        la.addWidget(iN2)
        self.d2 = QtGui.QLineEdit()
        la.addWidget(self.d2)
 
        iN3 = QtGui.QLabel("Prism Height")
        la.addWidget(iN3)
        self.d3 = QtGui.QLineEdit()
        la.addWidget(self.d3)
 
        okbox = QtGui.QDialogButtonBox(self.dialog)
        okbox.setOrientation(QtCore.Qt.Horizontal)
        okbox.setStandardButtons(QtGui.QDialogButtonBox.Cancel|QtGui.QDialogButtonBox.Ok)
        la.addWidget(okbox)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("accepted()"), self.priSm)
        QtCore.QObject.connect(okbox, QtCore.SIGNAL("rejected()"), self.close)
        QtCore.QMetaObject.connectSlotsByName(self.dialog)
        self.dialog.show()
        self.dialog.exec_()
 
p()</pre>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Additions">Additions</span></h2>
<p>SVG icon for use in custom toolbar shortcut.
</p>
</div>
<p><span typeof="mw:File"><a href="../index.php?title=Part_Prism_Apothem.svg&amp;filetimestamp=20141024202313&amp;.html" class="mw-file-description"><img src="../File/Part_Prism_Apothem.svg" decoding="async" width="128" height="128" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p>
<h2><span class="mw-headline" id="Danksagungen">Danksagungen</span></h2>
<p>Ein Dank a die FreeCAD-Hauptentwickler  <a rel="nofollow" class="external text" href="https://forum.freecad.org/memberlist.php?mode=viewprofile&amp;u=765">shoogen</a> und FreeCAD-Programmierer <a rel="nofollow" class="external text" href="https://forum.freecad.org/memberlist.php?mode=viewprofile&amp;u=1375">wandererfan</a> f&uuml;r ihre unsch&auml;tzbare Hilfe und Beratung bei der Erstellung dieses Makros.
</p>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20250929150153
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.055 seconds
Real time usage: 0.082 seconds
Preprocessor visited node count: 107/1000000
Post&#8208;expand include size: 2393/2097152 bytes
Template argument size: 3462/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 4301/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.904      1 -total
 50.62%    1.976      1 Template:Macro
 27.64%    1.079      1 Template:MacroCode
 17.98%    0.702      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:391912-0!canonical and timestamp 20250929150153 and revision id 1651887. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>