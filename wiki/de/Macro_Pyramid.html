<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Pyramid/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Pyramid&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_Pyramid.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Pyramid (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Pyramid.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Pyramid (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Macro_Pyramid.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Pyramid (100% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Pyramid.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Piramida (7% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Pyramidicon.svg&amp;filetimestamp=20191110125144&amp;.html" class="mw-file-description"><img src="../File/Pyramidicon.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="230" data-file-height="233"></a></span><span> </span>
Pyramide
</p>
</td></tr>
<tr>
<th class="ctOdd">Beschreibung
</th></tr>
<tr>
<td class="ctEven left macro-description">Dieses Makro erstellt eine parametrische Pyramide. Die Radien und die H&ouml;he werden &auml;hnlich wie bei Part Kegel beim Erstellen festgelegt. Alle Parameter k&ouml;nnen angepasst werden. Es ist m&ouml;glich, Pyramiden mit einer perfekten Spitze zu erstellen.<br><br>Versionsmakro&nbsp;: 01.01<br>Datum der letzten &Auml;nderung&nbsp;: 2019-11-10<br>FreeCAD version&nbsp;: Alle<br>Herunterladen&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/46/Pyramidicon.svg">Werkzeugleisten-Symbol</a><br>Autor: Eddy Verlinden, Genk, Belgium<br>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;Eddy_Verlinden,_Genk,_Belgium&amp;action=edit&amp;redlink=1.html" class="new" title="User:Eddy Verlinden, Genk, Belgium (page does not exist)">Eddy Verlinden, Genk, Belgium</a>
</td></tr>
<tr>
<th class="ctOdd">Herunterladen
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/46/Pyramidicon.svg">Werkzeugleisten-Symbol</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../de/Macros_recipes.html" title="Macros recipes/de">Makros Rezepte</a><br><a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a><br><a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Symbolleisten anpassen</a>
</td></tr>
<tr>
<th class="ctOdd">Macro-Version
</th></tr>
<tr>
<td class="ctEven macro-version">01.01
</td></tr>
<tr>
<th class="ctOdd">Datum der letzten &Auml;nderung
</th></tr>
<tr>
<td class="ctEven macro-date">2019-11-10
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Alle
</td></tr>
<tr>
<th class="ctOdd">Standardverkn&uuml;pfung
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><a href="../de/Macro_Polyhedrons.html" title="Macro Polyhedrons/de">Makro Polyeder</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Beschreibung">Beschreibung</span></h2>
<p>Dieses Makro erstellt eine parametrische Pyramide.
</p>
<ul><li>Sowohl die Radien als auch die H&ouml;he werden beim Erstellen festgelegt, &auml;hnlich wie bei Part Kegel.</li>
<li>Alle Parameter k&ouml;nnen angepasst werden.</li>
<li>Es ist m&ouml;glich, Pyramiden mit einer perfekten Spitze zu erstellen.</li></ul>
<p>Hinweis: 
</p><p>Bei Interesse an Polyedern, kann das <b>Makro Polyeder</b> verwendet werden.
Auch der externe Arbeitsbereich  <a rel="nofollow" class="external text" href="https://github.com/eddyverl/FreeCad-Pyramids-and-Polyhedrons">Pyramiden und Polyeder</a> kann genutzt werden, der dieselbe Funktion enth&auml;lt.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Polyhedrons.png&amp;filetimestamp=20200119103352&amp;.html" class="mw-file-description"><img src="../File/Polyhedrons.png" decoding="async" width="747" height="423" class="mw-file-element" data-file-width="747" data-file-height="423"></a></span>
</p>
<p style="text-align:left; font-style:italic; max-width:800px; box-sizing:border-box; margin-block:1em; margin-inline:clamp(1em, 6vw, 2em); padding-inline:clamp(0.75em, 4vw, 2em); word-break:normal; overflow-wrap:break-word;">Beispielerstellung mit dem externen Arbeitsbereich <a rel="nofollow" class="external text" href="https://github.com/eddyverl/FreeCad-Pyramids-and-Polyhedrons">Pyramiden und Polyeder</a>, die dieselbe Funktion enth&auml;lt.</p>
<p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Anwendung">Anwendung</span></h2>
<ul><li>Installation: Den  <span typeof="mw:File"><a href="../index.php?title=AddonManager.svg&amp;filetimestamp=20250123011258&amp;.html" class="mw-file-description"><img src="../File/AddonManager.svg" decoding="async" width="24" height="24" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span> <a href="../de/Std_AddonMgr.html" title="Std AddonMgr/de">Addon-Manager</a> zum Installieren des Makros benutzen.</li>
<li>Einmal installiert, Men&uuml; &rarr; Makro &rarr; Makros &ouml;ffnen. Auf pyramid.py klicken und anschlie&szlig;end die Schaltfl&auml;che <span class="ButtonTemplate" style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.3em; padding: 0px 8px 1px 8px; font-weight:normal;color: #202122;">Ausf&uuml;hren</span> dr&uuml;cken.</li>
<li>Es erscheint eine geknotete Pyramide, &auml;hnlich wie Part Kegel</li>
<li>Die Parameter genau wie bei Part Kegel &auml;ndern.</li>
<li>Mehr Informationen unter  <a rel="nofollow" class="external text" href="https://github.com/eddyverl/FreeCad-Pyramids-and-Polyhedrons">Pyramiden und Polyeder</a>.</li></ul>
<p><span id="Script"></span>
</p>
<h2><span class="mw-headline" id="Skript">Skript</span></h2>
<p>Werkzeugleisten-Symbol <span typeof="mw:File"><a href="../index.php?title=Pyramidicon.svg&amp;filetimestamp=20191110125144&amp;.html" class="mw-file-description"><img src="../File/Pyramidicon.svg" decoding="async" width="64" height="65" class="mw-file-element" data-file-width="230" data-file-height="233"></a></span>
</p><p><b>pyramid.py</b>
</p>
<pre># ***************************************************************************
# *   Copyright (c) 2019  Eddy Verlinden                                    *   
# *                                                                         *
# *   This file is part of the FreeCAD CAx development system.              *
# *                                                                         *
# *   This program is free software; you can redistribute it and/or modify  *
# *   it under the terms of the GNU Lesser General Public License (LGPL)    *
# *   as published by the Free Software Foundation; either version 2 of     *
# *   the License, or (at your option) any later version.                   *
# *   for detail see the LICENCE text file.                                 *
# *                                                                         *
# *   FreeCAD is distributed in the hope that it will be useful,            *
# *   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
# *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
# *   GNU Lesser General Public License for more details.                   *
# *                                                                         *
# *   You should have received a copy of the GNU Library General Public     *
# *   License along with FreeCAD; if not, write to the Free Software        *
# *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  *
# *   USA                                                                   *
# *                                                                         *
# ***************************************************************************


__Title__   = "Macro_Pyramid"
__Author__  = "Eddy Verlinden"
__Version__ = "01.02"
__Date__    = "2021-01-09"
__Comment__ = "This macro creates a parametric pyramid."

import sys
import FreeCAD,FreeCADGui
import Part
import math



def create(obj_name):
    obj=FreeCAD.ActiveDocument.addObject("Part::FeaturePython",obj_name) 
    fpo = Pyramid(obj)
    ViewProviderBox(obj.ViewObject)  
    FreeCAD.ActiveDocument.recompute()
    return fpo


def horizontal_regular_polygon_vertexes(sidescount,radius,z, startangle = 0):
    vertexes = []
    if radius&nbsp;!= 0&nbsp;:
        for i in range(0,sidescount+1):
            angle = 2 * math.pi * i / sidescount + math.pi + startangle
            vertex = (radius * math.cos(angle), radius * math.sin(angle), z)
            vertexes.append(vertex)
    else:
        vertex = (0,0,z)
        vertexes.append(vertex)
    return vertexes


def horizontal_regular_pyramid_vertexes(sidescount,radius,z, startangle = 0):
    vertexes = []
    odd = 0
    if (sidescount&nbsp;% 2) == 0:
        odd = 1
    if radius&nbsp;!= 0&nbsp;:
        for i in range(0,sidescount+1):
            angle = 2 * math.pi * i / sidescount + (math.pi * (odd/sidescount + 1/2)) + startangle * math.pi / 180
            vertex = (radius * math.cos(angle), radius * math.sin(angle), z)
            vertexes.append(vertex)
    else:
        vertex = (0,0,z)
        vertexes.append(vertex)
    return vertexes

# =========================================================================== 

class Pyramid:
 
    radius1value = 0
    radius2value = 0
    sidescountvalue = 0
    side1value = 0
    side2value = 0
    anglez = 0

    def __init__(self, obj, sidescount = 5,radius_bottom = 2 , radius_top = 4, height = 10, angz = 0):
        obj.addProperty("App::PropertyLength","Radius1","Pyramid","Radius of the pyramid").Radius1=radius_bottom
        obj.addProperty("App::PropertyLength","Radius2","Pyramid","Radius of the pyramid").Radius2=radius_top
        obj.addProperty("App::PropertyLength","Height","Pyramid","Height of the pyramid").Height = height
        obj.addProperty("App::PropertyInteger","Sidescount","Pyramid","Sidescount of the pyramid").Sidescount = sidescount
        obj.addProperty("App::PropertyLength","Sidelength1","Pyramid","Sidelength1 of the pyramid")
        obj.addProperty("App::PropertyLength","Sidelength2","Pyramid","Sidelength2 of the pyramid")
        obj.addProperty("App::PropertyAngle","Z_rotation","Pyramid","alfa angle around Z").Z_rotation = angz

        obj.Proxy = self

        
    def execute (self,obj):
              
        sidescount = int(obj.Sidescount)
        angle = 2 * math.pi / sidescount
        radius_bottom = float(obj.Radius1)
        radius_top = float(obj.Radius2)
        sidelength_top = float(obj.Sidelength2)
        sidelength_bottom = float(obj.Sidelength1)
        height = float(obj.Height)
        anglez = float(obj.Z_rotation)

        if radius_bottom&nbsp;!= self.radius1value or sidescount&nbsp;!= self.sidescountvalue:
            obj.Sidelength1 = radius_bottom * math.sin(angle/2) * 2
            self.radius1value = radius_bottom
            self.side1value = float(obj.Sidelength1)
        elif sidelength_bottom&nbsp;!= self.side1value:
            self.radius1value = float(obj.Sidelength1 / 2) / math.sin(angle/2) 
            obj.Radius1 = self.radius1value
            radius_bottom = self.radius1value
            self.side1value = float(obj.Sidelength1)

        if radius_top&nbsp;!= self.radius2value or sidescount&nbsp;!= self.sidescountvalue: 
            obj.Sidelength2 = radius_top * math.sin(angle/2) * 2
            self.radius2value = float(radius_top)
            self.side2value = float(obj.Sidelength2)
        elif sidelength_top&nbsp;!= self.side2value:
            self.radius2value = float(obj.Sidelength2 / 2) / math.sin(angle/2) 
            obj.Radius2 = self.radius2value
            radius_top = self.radius2value
            self.side2value = float(obj.Sidelength2)
            
        self.sidescountvalue = sidescount
        faces = []
        if radius_bottom == 0 and radius_top == 0:
            FreeCAD.Console.PrintMessage("Both radiuses are zero" + "\n")
        else:
            vertexes_bottom = horizontal_regular_pyramid_vertexes(sidescount,radius_bottom,0     ,anglez)
            vertexes_top    = horizontal_regular_pyramid_vertexes(sidescount,radius_top   ,height,anglez)

            if radius_bottom&nbsp;!= 0:
                polygon_bottom = Part.makePolygon(vertexes_bottom)
                face_bottom = Part.Face(polygon_bottom)
                faces.append(face_bottom)
            if radius_top&nbsp;!= 0:    
                polygon_top = Part.makePolygon(vertexes_top)
                face_top = Part.Face(polygon_top)
                faces.append(face_top)

            for i in range(sidescount):            
                if radius_top == 0:
                    vertexes_side=[vertexes_bottom[i],vertexes_bottom[i+1],vertexes_top[0],vertexes_bottom[i]]
                elif radius_bottom == 0:
                    vertexes_side=[vertexes_bottom[0],vertexes_top[i+1],vertexes_top[i],vertexes_bottom[0]]
                else:
                    vertexes_side=[vertexes_bottom[i],vertexes_bottom[i+1],vertexes_top[i+1],vertexes_top[i],vertexes_bottom[i]]
                polygon_side=Part.makePolygon(vertexes_side)
                faces.append(Part.Face(polygon_side))

            shell = Part.makeShell(faces)   
            solid = Part.makeSolid(shell)
            obj.Shape = solid        
            

# ===========================================================================    

class ViewProviderBox:
    def __init__(self, obj):
        obj.Proxy = self

    def attach(self, obj):
        return

    def updateData(self, fp, prop):
        return

    def getDisplayModes(self,obj):
        return "As Is"
        
    def getDefaultDisplayMode(self):
        return "As Is"

    def setDisplayMode(self,mode):
        return "As Is"

    def onChanged(self, vobj, prop):
        pass
        
    def getIcon(self):
        return """
        /* XPM */
        static char * xpm[] = {
        "32 32 9 1",
        " 	c None",
        ".	c #01035E",
        "+	c #0F0C1D",
        "@	c #4849B7",
        "#	c #5F5E61",
        "$	c #6567FE",
        "%	c #8E9192",
        "&amp;	c #A5A6A4",
        "*	c #FBFEFA",
        "                                ",
        "                                ",
        "                        #       ",
        "                       +#       ",
        "                     &amp;++#       ",
        "                    #+++%       ",
        "                   ++.@+&amp;       ",
        "                 &amp;++.$++&amp;       ",
        "               &nbsp;%++@$$++&amp;       ",
        "               #++@$$@++&amp;       ",
        "             &amp;+++@$$$@++&amp;       ",
        "           &nbsp;%+.+@$$$$+.+&amp;       ",
        "           #+.+@$$$$$+.+&amp;       ",
        "         &amp;+..+@$$$$$@+.+&amp;       ",
        "        &amp;+..+@$$$$$$@+.+&amp;       ",
        "       #+..+@$$$$$$$+..+&amp;       ",
        "      +..++@$$$$$$$$+..+&amp;       ",
        "   &nbsp;%+++++++@$$$$$$@+..+&amp;       ",
        "   #++++...+++@$$$$.+..+&amp;       ",
        "    +........+++@$$+...+&amp;       ",
        "    &amp;+.........+++.+...+        ",
        "     #+...........++...+        ",
        "      #+...........++..+        ",
        "       +............+..+        ",
        "       &amp;++...........+.+        ",
        "        &nbsp;%+++........+++        ",
        "           &amp;#++.......++        ",
        "              #++..+++++&amp;       ",
        "               &nbsp;%++#%           ",
        "                                ",
        "                                ",
        "                                "};
        """
    def __getstate__(self):
        return None

    def __setstate__(self,state):
        return None
       
# ===========================================================================    

if FreeCAD.ActiveDocument == None:
    FreeCAD.newDocument()

create ("Pyramid")
FreeCADGui.SendMsgToActiveView("ViewFit")</pre>
<p><span id="Link"></span>
</p>
<h2><span class="mw-headline" id="Verweis">Verweis</span></h2>
<p>Diskussion im FreeCAD-Forum: <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=40485&amp;p=344116&amp;hilit=Eddyverl#p344116">Macros for pyramids and polyhedrons</a>
</p>
<!-- 
NewPP limit report
Cached time: 20251024050033
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.062 seconds
Real time usage: 0.092 seconds
Preprocessor visited node count: 116/1000000
Post&#8208;expand include size: 3566/2097152 bytes
Template argument size: 10710/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 10953/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   11.517      1 -total
 43.21%    4.976      1 Template:Macro/de
 34.12%    3.930      1 Template:MacroCode
 11.84%    1.364      1 Template:Caption
  8.80%    1.013      1 Template:Button
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:391815-0!canonical and timestamp 20251024050033 and revision id 1676344. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>