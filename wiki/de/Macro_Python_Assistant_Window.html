<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Python Assistant Window/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Python+Assistant+Window&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--high" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_Python_Assistant_Window.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Python Assistant Window (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--med" title="Macro Python Assistant Window (54% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--med" title="Macro Python Assistant Window (54% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Okno Asystent Python (3% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Text-x-python.png&amp;filetimestamp=20121224162851&amp;.html" class="mw-file-description" title="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros"><img alt="Generisches Makro-Symbol Erstellen Sie Ihr pers&ouml;nliches Symbol mit demselben Namen des Makros" src="../File/Text-x-python.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></a></span><span> </span>
Makro Python-Assistentenfenster
</p>
</td></tr>
<tr>
<th class="ctOdd">Beschreibung
</th></tr>
<tr>
<td class="ctEven left macro-description">Dieses Makro bietet einen Arbeitsbereich zum Ausschneiden/Kopieren/Einf&uuml;gen von Python-Code. Es ist segmentiert, sodass verschiedene Abschnitte ausgew&auml;hlt werden k&ouml;nnen, und bleibt zwischen FreeCAD-Sitzungen bestehen.<br><br>Versionsmakro&nbsp;: 1.0<br>Datum der letzten &Auml;nderung&nbsp;: 2015-01-21<br>FreeCAD version&nbsp;: Alle<br>Herunterladen&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">Werkzeugleisten-Symbol</a><br>Autor: Piffpoof<br>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Piffpoof.html" title="User:Piffpoof">Piffpoof</a>
</td></tr>
<tr>
<th class="ctOdd">Herunterladen
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">Werkzeugleisten-Symbol</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../de/Macros_recipes.html" title="Macros recipes/de">Makros Rezepte</a><br><a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a><br><a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Symbolleisten anpassen</a>
</td></tr>
<tr>
<th class="ctOdd">Macro-Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Datum der letzten &Auml;nderung
</th></tr>
<tr>
<td class="ctEven macro-date">2015-01-21
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Alle
</td></tr>
<tr>
<th class="ctOdd">Standardverkn&uuml;pfung
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p>Einer der leistungsstarken Aspekte von Python ist die Python-Konsole, die sowohl als Ausgabeger&auml;t als auch als dynamischer Interpreter f&uuml;r Quellcode dient. Das Python-Assistentenfenster (im Folgenden als &bdquo;PAF&rdquo; bezeichnet) bietet zus&auml;tzliche Funktionen f&uuml;r die Python-Konsole.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="http://pastebin.com/raw/2m0u94Z1">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "http://pastebin.com/raw/2m0u94Z1" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("http://pastebin.com/raw/2m0u94Z1")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="http://pastebin.com/raw/2m0u94Z1">http://pastebin.com/raw/2m0u94Z1</a>"&gt;raw code&lt;/a&gt;</div>
<p><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowScreenSnapshot.jpg&amp;filetimestamp=20150121165407&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowScreenSnapshot.jpg" decoding="async" width="500" height="488" class="mw-file-element" data-file-width="561" data-file-height="547"></a></span>
</p><p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Beschreibung">Beschreibung</span></h2>
<p>Als moderne Entwicklungsumgebung hat Python gegen&uuml;ber &auml;lteren Sprachen und deren Entwicklungsumgebungen viele Vorteile. Ein gro&szlig;er Vorteil ist die Python-Konsole, in der Code interaktiv eingegeben und die Ergebnisse empfangen werden k&ouml;nnen. (<a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>). Diese Ergebnisse k&ouml;nnen dann kopiert und entweder zum Erstellen von Python-Quellcode (in einem Quellcode-Editor) verwendet oder in ge&auml;nderter Form wieder in die Python-Konsole eingef&uuml;gt werden, um weitere Ausgaben zu erhalten. Dies ist eine sehr leistungsf&auml;hige Methode zur Entwicklung von Code.
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>As powerful as it may be, two readily apparent shortcomings with the Python Console are:
</p>
<ul><li>the console is of limited size and the results of your work from 20 minutes ago may be scrolled far off the screen, they are not lost but they are awkward to retrieve</li>
<li>the console is cleared each time you quite your FreeCAD session, the console is empty (aside from the Python startup message) next time you start FreeCAD</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The PAW provides the following:
</p>
<ul><li>it is persistent between FreeCAD sessions, things will not "disappear" from it unless the user removes them</li>
<li>it has a contextual menu that allows the following:
<ul><li>the standard editing operands: Copy &amp; Paste &amp; Select All</li>
<li>Copy a selection to the Python Console</li>
<li>Copy the complete contents of the PAW to the Python Console</li>
<li>Append the contents of the Python Console to the PAW</li>
<li>insert textual markers that facilitate management of the text</li>
<li>selection between any two consecutive markers</li>
<li>remove the prefix "&gt;&gt;&gt; " which the Python Console uses to denote output</li>
<li>reduce multiple blank lines to single blank lines</li>
<li>personalise the working environment by managing the PAW (as well as the main FreeCAD window) by a slider-based GUI</li></ul></li></ul>
</div>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Der gesamte Code f&uuml;r pythonAssistantWindow.FCMacro befindet sich in einem Makro. Die Installation besteht also darin, den Code in das entsprechende Makroverzeichnis zu kopieren und pythonAssistantWindow &uuml;ber das Makro-Men&uuml;, die Python-Konsole oder eine Symbolleisten-Schaltfl&auml;che (die bevorzugte Methode) aufzurufen.
</p>
<ul><li>Siehe <a href="../de/How_to_install_macros.html" title="How to install macros/de">How to install macros/de</a> &uuml;ber Informationen zur Installation dieses Makro-Codes</li>
<li>Siehe <a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Customize Toolbars/de</a> &uuml;ber Informationen zur Installation als Schaltfl&auml;che in einer Symbolleiste</li></ul>
<p><b>Hinweis</b>: Eine globale Variable innerhalb von FreeCAD wird verwendet, um den persistenten Speicher zu koordinieren.
</p><p><b>Hinweis</b>: Eine Textdatei im Verzeichnis &bdquo;UserAppData&rdquo; wird verwendet, um den Textinhalt des PAF zwischen FreeCAD-Sitzungen zu speichern.
</p><p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Anwendung">Anwendung</span></h2>
<p>Das PAF l&auml;sst sich am besten als Schaltfl&auml;che in einer Symbolleiste verwenden. Es kann &uuml;ber das Makro-Men&uuml; oder durch Einf&uuml;gen des Codes in die Python-Konsole ausgef&uuml;hrt werden, aber die beiden letztgenannten Optionen beeintr&auml;chtigen die Benutzerfreundlichkeit erheblich.
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>When FreeCAD is started there will be no sign of the PAW, other than a button on a toolbar. Clicking the button will cause:
</p>
<ul><li>the PAW to open in the lower right corner
<ul><li>the default settings are for the about 1/3 of the screen width to be dedicated to the PAW with the remainder being used by the main FreeCAD window, the height of the PAW will be about 1/3 of the window height</li></ul></li>
<li>the contents of the PAW when it last ran will appear in the window - there should be no difference from the last time it was used
<ul><li>if the PAW has not run before then the contents will be empty</li></ul></li>
<li>if the PAW is already open but hidden by other windows then it will be raised to the top so that it becomes visible</li>
<li>closing the PAW will cause the contents to be written to file and the window will close - there is no Dialog asking whether to save or not</li>
<li>however there is a Dialog asking whether to save if FreeCAD is quit (Menu-&gt;Quit FreeCAD) with unsaved changes in thePAW</li></ul>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Most of the functionality for the PAW is provided by the contextual menu, the options are:
</p>
<ul><li>Copy<br>- provide the standard Copy function</li>
<li>Copy selection to console<br>- the current selection is copied to the end of the Python Console</li>
<li>Copy contents to console<br>- the complete contents of the PAW is copied to the end of the Python Console</li>
<li>Paste<br>- provide the standard Paste function</li>
<li>Append contents of Python Console to PAW<br>- the copies of the Python Console are placed at the end of the PAW - note that the contents of the Python Console may be a mixture of Python Code, output from Python Code, error message text, output from any part of FreeCAD</li>
<li>Select between Markers<br>- markers are used to divide up the text of the PAW into sections, once the contents are in sections then a section can be selected individually and worked with (e.g. Copy, Copy to the Python Console, Delete). The intention of Markers is to allow separate and unrelated sequences of Python statement to exist in the PAW, and then be managed and worked with individually.</li>
<li>Select all<br>- provide the standard Select All function</li>
<li>Clearbr<br>- provide the standard Clear function where all the text in the PAW is deleted</li>
<li>Insert marker<br>- insert a textual Marker at the current cursor location</li>
<li>Remove "&gt;&gt;&gt; "<br>- after Python Console output is copied to the PAW, any lines which were output from executed Python commands will be prefixed with "&gt;&gt;&gt; ", this option removed those prefixes so the output can be used as context free data</li>
<li>Reduce multiple blank lines to single blank lines<br>- compacts the text by removing multiple blank lines</li>
<li>Alter GUI settings<br>- brings up a modal window with three controls:</li>
<li><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowGui2.jpg&amp;filetimestamp=20150121170002&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowGui2.jpg" decoding="async" width="500" height="134" class="mw-file-element" data-file-width="508" data-file-height="136"></a></span>
<ul><li>a slider to set the percentage of the screen width dedicated to the PAW (remembering that there is a certain width which the FreeCAD main window will not go below)</li>
<li>a slider to set the percentage of the height of the screen dedicated to the PAW</li>
<li>a pair of radio buttons to indicate whether the PAW should be placed at the top or bottom of the left hand side of the screen</li></ul></li>
<li>Save as file<br>- the contents of the PAW window are written out to a user selected file - the contents of the PAW are not altered</li>
<li>Close window<br>- the PAW window is closed and the contents written out to the persistent storage file<br><b>Note</b>: there is no Dialog asking about saving, it is done automatically</li></ul>
</div>
<p><span id="User_Interface"></span>
</p>
<h2><span id="Benutzeroberfl.C3.A4che"></span><span class="mw-headline" id="Benutzeroberfl&auml;che">Benutzeroberfl&auml;che</span></h2>
<p>Die Benutzeroberfl&auml;che ist ein einfaches Textbearbeitungsfenster mit einer Schaltfl&auml;che zum Starten von PAF und einem Kontextmen&uuml; mit Optionen f&uuml;r die Bearbeitung des Textes im Textbearbeitungsfenster. Die Optionen werden im Abschnitt Verwendung beschrieben.
</p><p><span id="Examples"></span>
</p>
<h2><span class="mw-headline" id="Beispiele">Beispiele</span></h2>
<p><b>Ein erstes Beispiel</b>
</p><p>Im Januar ben&ouml;tigt Ihr Kollege Hilfe beim Python-Code, um eine Datei zu aktualisieren. Sie schreiben und debuggen den Code auf Ihrem Computer und senden ihm den Quellcode. Sie haben drei verschiedene M&ouml;glichkeiten gefunden, um die Aufgabe zu l&ouml;sen, und sind sich nicht sicher, welche davon die beste ist. Sie kopieren alle drei fertigen Versionen auf den PAF und trennen sie durch Markierungen.
</p><p>Zu Beginn des Monats Mai arbeiten Sie fr&ouml;hlich mit FreeCAD an Ihrem Flaschenprojekt. Es gibt einige Probleme, den genauen Python-Code zu finden, um das Gew&uuml;nschte zu generieren, also modellieren Sie dies grafisch und der entsprechende Python-Code wird in der Python-Konsole generiert. Mit PAF kopieren Sie den Inhalt der Python-Konsole in PAF. Sie formen ihn, indem Sie ihn zur&uuml;ckverschieben und ausf&uuml;hren, die Ergebnisse kopieren, sie in PAF modifizieren und zur&uuml;ckkopieren, bis Sie zufrieden sind.
</p><p>Am n&auml;chsten Montag kommt Ihr Chef zu Ihnen und sagt, dass im Werk dringend ein CAD-Operator ben&ouml;tigt wird, da es Probleme mit der Faltsequenz f&uuml;r den neuen Verpackungsstrom gibt. Sie fliegen noch am selben Tag dorthin und bleiben zwei Wochen lang vor Ort. Sie erledigen Ihren Auftrag und kehren dann an Ihren normalen Arbeitsplatz zur&uuml;ck.
</p><p>Als Sie zur&uuml;ckkommen, ist offensichtlich, dass andere Ihren Bereich als Mittagspausenraum genutzt haben, sodass Sie ein wenig aufr&auml;umen m&uuml;ssen. Wenn Sie FreeCAD starten und auf die Schaltfl&auml;che PAF in der Symbolleiste klicken, finden Sie Ihre Arbeit von gestern vor, als w&auml;re sie erst gestern entstanden. Sie erkennen, dass die L&ouml;sung f&uuml;r Ihr Flaschendesign in dem Dateicode liegt, den Sie im Januar geschrieben haben, zusammen mit dem, was Sie zwei Wochen zuvor hinterlassen haben. Schnell k&ouml;nnen Sie die Code-Segmente ausw&auml;hlen und in die Python-Konsole kopieren, um sie auszuf&uuml;hren und zu optimieren.
</p><p>Sobald der Code stabil ist, k&ouml;nnen man ihn entweder als Python-Datei oder als FreeCAD-Makrodatei speichern.
</p><p><b>Ein weiteres Beispiel</b>
</p><p>Sie versuchen herauszufinden, was mit den Rotationswerten verschiedener Objekte in einer Baugruppe nicht stimmt. Von den 27 Objekten k&ouml;nnen Sie kein Muster erkennen, welche Objekte betroffen sind. Also schreiben Sie ein paar Zeilen Python-Code, um die fehlerhaften Objekte zu isolieren, und f&uuml;gen diesen Code in die PAF ein. Dann schreiben Sie ein paar Zeilen Python-Code, um die Label- und Rotationswerte zu erhalten, und f&uuml;gen diesen Code ebenfalls in die PAF ein. Kopieren Sie den Code, um alle Objekte aufzulisten, die Sie sehen m&ouml;chten, und wiederholen Sie dies f&uuml;r jedes Objekt &ndash; alles im PAF. Die Python-Konsole enth&auml;lt alle diese Ergebnisse (einschlie&szlig;lich Tippfehlern und Fehlermeldungen), aber sie ist l&auml;ngst aus dem sichtbaren Bereich des Fensters herausgescrollt. Jetzt haben Sie also einen &uuml;bersichtlichen Satz von Python-Zeilen, den Sie aus dem PAF kopieren, in die Python-Konsole einf&uuml;gen und schon haben Sie die genaue Liste der Objekte, die debuggt werden m&uuml;ssen &ndash; zusammen mit ihren spezifischen Werten. Bei Bedarf k&ouml;nnen Sie die Ergebnisse aus der Python-Konsole dann wieder in den PAF einf&uuml;gen &ndash; setzen Sie ihnen das Python-Kommentarzeichen (&bdquo;#&ldquo;) vor, wenn Sie sie im Python-Code speichern und ausf&uuml;hrbar halten m&ouml;chten. Schlie&szlig;lich k&ouml;nnen Sie diese Zusammenstellung aus dem PAF in einer Datei speichern, damit sie sicher auf der Festplatte liegt. So sind Sie bereit f&uuml;r das n&auml;chste Mal, wenn Sie die Logik im Code &uuml;bernehmen oder anpassen m&uuml;ssen.
</p><p><span id="Options"></span>
</p>
<h2><span class="mw-headline" id="Optionen">Optionen</span></h2>
<p>Die einzige Option f&uuml;r das PAW ist die M&ouml;glichkeit, seine anf&auml;ngliche Anzeigegr&ouml;&szlig;e und -form entsprechend der Gr&ouml;&szlig;e und Form des FreeCAD-Hauptfensters zu &auml;ndern. Es gibt drei Konstanten im Python-Code, die die anf&auml;ngliche Gr&ouml;&szlig;e und Platzierung des PAW festlegen.
</p><p><span id="Remarks"></span>
</p>
<h2><span class="mw-headline" id="Anmerkungen">Anmerkungen</span></h2>
<p>Dieser Code enth&auml;lt einen sehr einfachen Konzeptnachweis f&uuml;r einen persistenten Speicher. Er kann f&uuml;r alle n&uuml;tzlich sein, die eine solche Kapazit&auml;t ben&ouml;tigen.
</p><p><span id="Links"></span>
</p>
<h2><span class="mw-headline" id="Verweise">Verweise</span></h2>
<p>keine (bisher)
</p><p><span id="Script"></span>
</p>
<h2><span class="mw-headline" id="Skript">Skript</span></h2>
<div id="itsfree" class="warning-box"><b>Wenn die Skriptliste nicht mit den FreeCAD-Versionsinformationen und einer letzten Zeile &bdquo;thus ends the macro...&ldquo; endet, hat das Wiki das Skript erneut verschluckt und es muss es erneut heruntergeladen oder kopiert werden von [<a rel="nofollow" class="external text" href="http://pastebin.com/raw.php?i=2m0u94Z1">ungek&uuml;rzte Skript auf pastebin.com</a>]</b></div>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Python_Assistant_Window.png&amp;filetimestamp=20150121133000&amp;.html" class="mw-file-description"><img src="../File/Macro_Python_Assistant_Window.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><b>Macro_Python_Assistant_Window.FCMacro</b>
</p>
<pre>#
#
#				Python Assistant Window
#				v 0.1 initial release
#
#
#***********************************************************************************
#
# provide a text editing window with functions to aid in coding Python within FreeCAD
#
############ To Do ############
# - contextual window doesn't fire if cursor is on last position in file
# - executing "from PySide import QtGui, QtCore" on console seems to close window
# - is it possible to copy code to console and then select and execute it?
##############################
#***********************************************************************************
# The next three variables define the width and height and vertical positioning
# of the Python Assistant Window
# 'pawWidthPercent' specifies the percentage of the screen width to be assigned to the Python Assistant Window
# 'pawHeightPercent' specifies the percentage of the screen height to be assigned to the Python Assistant Window
# 'pawAtBottomFlag' specifies if the Python Assistant Window is at the top or the bottom
# The Python Assistant Window is automatically placed at the left,
# so pawWidthPercent = 26, pawHeightPercent = 41, pawAtBottomFlag = False will cause the
# following:
# 1) the main FreeCAD window will be placed in the upper left corner of the screen,
#	 it's height will be 100% of the screen height,
#	 it's width will be 74% (=100%-26%) of the screen
# 2) the Python Assistant Window will be placed in the left side of the screen,
#	 it's height will be 41% of the screen height,
#	 it's width will be 26% of the screen
#	 it will be at the top (leaving empty space below it)
# The empty space (either above or below the Python Assistant Window),
# is left for the text editor (for editing the Macros) to be placed in.
#
pawWidthPercentInitial		= 37.5 # percent of the screen width
pawHeightPercentInitial		= 32.0 # percent of the screen height
pawAtBottomFlagInitial		= True
#***********************************************************************************
# import statements
import sys, operator, os
from os.path import expanduser
from PySide import QtGui, QtCore

# UI Class definitions

class PythonAssistantWindow(QtGui.QMainWindow):
	""""""
	def __init__(self, pythonTextToEdit):
		self.textIn = pythonTextToEdit
		super(PythonAssistantWindow, self).__init__()
		self.initUI(pythonTextToEdit)
	def initUI(self, pythonTextToEdit):
		"""Constructor"""
		# set default return value and pointer to subsequent child window
		self.result			= userCancelled
		self.childWindow	= None
		self.alertWindow	= None
		# set window dimensions for Python Advisor Window from the constants at the top of Macro file
		self.pawWinWidth	= pawWidthPercentInitial/100.0 * availableWidth
		self.pawWinHeight	= pawHeightPercentInitial/100.0 * availableHeight
		self.left			= screenWidth - self.pawWinWidth
		if pawAtBottomFlagInitial:
			self.top		= screenHeight - self.pawWinHeight
		else:
			self.top		= 0		
		self.editorHeight	= self.pawWinHeight
		# set dimensions for main FreeCAD window
		self.mainWinWidth	= availableWidth - (self.pawWinWidth+interWindowGap)
		self.mainWinHeight	= availableHeight
		# define main window
		FreeCADGui.getMainWindow().setGeometry(0, 0, self.mainWinWidth, self.mainWinHeight)
		# now set up this window
		self.setGeometry(self.left, self.top, self.pawWinWidth, self.pawWinHeight)
		self.setWindowTitle("Python Assistant Window")
		#
		centralWidget 		=  QtGui.QWidget(self)
		layout 				=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		# set up text editing widget
		self.text_editor = QtGui.QPlainTextEdit(self)
		self.text_editor.move(0,0)
		self.text_editor.resize(self.pawWinWidth,self.editorHeight)
		self.text_editor.appendPlainText(self.textIn)
		self.text_editor.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.text_editor.textChanged.connect(self.onTextChanged)
		# set up a monospace font for the text editor to match the Python console
		font = QtGui.QFont()
		font.setFamily("Courier")
		font.setStyleHint(QtGui.QFont.Monospace)
		font.setFixedPitch(True)
		font.setPointSize(12)
		self.text_editor.setFont(font)
		#self.text_editor.cursorPositionChanged.connect(self.onCursorPosition)
		self.cursor = self.text_editor.textCursor()
		# populate layout
		layout.addWidget(self.text_editor,0,0)
		self.setCentralWidget(centralWidget)
		# set contextual menu options for text editing widget
		# menu dividers
		mnuDivider1 = QtGui.QAction(self)
		mnuDivider1.setText(menuDividerText)
		mnuDivider1.triggered.connect(self.onMenuDivider)
		mnuDivider2 = QtGui.QAction(self)
		mnuDivider2.setText(menuDividerText)
		mnuDivider2.triggered.connect(self.onMenuDivider)
		mnuDivider3 = QtGui.QAction(self)
		mnuDivider3.setText(menuDividerText)
		mnuDivider3.triggered.connect(self.onMenuDivider)
		mnuDivider4 = QtGui.QAction(self)
		mnuDivider4.setText(menuDividerText)
		mnuDivider4.triggered.connect(self.onMenuDivider)
		# clear text
		mnuClear = QtGui.QAction(self)
		mnuClear.setText("Clear")
		mnuClear.triggered.connect(self.onClear)
		# paste copy/paste buffer
		mnuPaste = QtGui.QAction(self)
		mnuPaste.setText("Paste")
		mnuPaste.triggered.connect(self.onPaste)
		# paste contents of console
		mnuAppendFromConsole = QtGui.QAction(self)
		mnuAppendFromConsole.setText("Append contents of console")
		mnuAppendFromConsole.triggered.connect(self.onAppendFromConsole)
		# select between markers
		mnuSelectMarkers = QtGui.QAction(self)
		mnuSelectMarkers.setText("Select between markers")
		mnuSelectMarkers.triggered.connect(self.onSelectMarkers)
		# select all
		mnuSelectAll = QtGui.QAction(self)
		mnuSelectAll.setText("Select all")
		mnuSelectAll.triggered.connect(self.onSelectAll)
		# insert marker
		mnuInsertMarker = QtGui.QAction(self)
		mnuInsertMarker.setText("Insert marker")
		mnuInsertMarker.triggered.connect(self.onInsertMarker)
		# remove console generated "&gt;&gt;&gt; " character strings
		mnuStripPrefix = QtGui.QAction(self)
		mnuStripPrefix.setText("Remove '&gt;&gt;&gt; '")
		mnuStripPrefix.triggered.connect(self.onStripPrefix)
		# remove blank lines
		mnuReduceBlankLines = QtGui.QAction(self)
		mnuReduceBlankLines.setText("Delete multiple blank lines")
		mnuReduceBlankLines.triggered.connect(self.onReduceBlankLines)
		# copy selection
		mnuCopy = QtGui.QAction(self)
		mnuCopy.setText("Copy")
		mnuCopy.triggered.connect(self.onCopy)
		# copy selection to console
		mnuCopySelectionToConsole = QtGui.QAction(self)
		mnuCopySelectionToConsole.setText("Copy selection to console")
		mnuCopySelectionToConsole.triggered.connect(self.onCopySelectionToConsole)
		# copy to console
		mnuCopyToConsole = QtGui.QAction(self)
		mnuCopyToConsole.setText("Copy contents to console")
		mnuCopyToConsole.triggered.connect(self.onCopyToConsole)
		# save as file
		mnuSaveAsFile = QtGui.QAction(self)
		mnuSaveAsFile.setText("Save contents to file")
		mnuSaveAsFile.triggered.connect(self.onSaveAsFile)
		# close window
		mnuCloseWindow = QtGui.QAction(self)
		mnuCloseWindow.setText("Close window")
		mnuCloseWindow.triggered.connect(self.onCloseWindow)
		# alter GUI settings
		mnuSettings = QtGui.QAction(self)
		mnuSettings.setText("=Alter GUI settings=")
		mnuSettings.triggered.connect(self.onSettings)
		# define menu and add options
		self.text_editor.setContextMenuPolicy(QtCore.Qt.ActionsContextMenu)
		self.text_editor.addAction(mnuCopy)
		self.text_editor.addAction(mnuCopySelectionToConsole)
		self.text_editor.addAction(mnuCopyToConsole)
		self.text_editor.addAction(mnuDivider1)
		self.text_editor.addAction(mnuPaste)
		self.text_editor.addAction(mnuAppendFromConsole)
		self.text_editor.addAction(mnuSelectMarkers)
		self.text_editor.addAction(mnuSelectAll)
		self.text_editor.addAction(mnuClear)
		self.text_editor.addAction(mnuDivider2)
		self.text_editor.addAction(mnuInsertMarker)
		self.text_editor.addAction(mnuStripPrefix)
		self.text_editor.addAction(mnuReduceBlankLines)
		self.text_editor.addAction(mnuDivider3)
		self.text_editor.addAction(mnuSaveAsFile)
		self.text_editor.addAction(mnuSettings)
		self.text_editor.addAction(mnuCloseWindow)
		#
		self.show()
	#----------------------------------------------------------------------
	def onMenuDivider(self):
		# just a divider in the menu so we don't do anything
		pass
	def onClear(self):
		# clear editing field
		self.text_editor.clear()
	def onPaste(self):
		# paste contents of system copy/paste buffer into QPlainTextEdit field
		self.text_editor.paste()
	def onAppendFromConsole(self):
		# copy text from "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		consoleStr	= pcPTE.document().toPlainText()
		self.text_editor.appendPlainText(copyFromConsoleText)
		self.text_editor.appendPlainText("")
		self.text_editor.appendPlainText(consoleStr)
	def onCopy(self):
		# copy selected text to system copy/paste buffer
		self.text_editor.copy()
	def onCopySelectionToConsole(self):
		# copy selected text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		#
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		textToCopy = cursorText[cursor.selectionStart():cursor.selectionEnd()]
		if len(textToCopy)&gt;0:
			pcPTE.appendPlainText(textToCopy)
	def onCopyToConsole(self):
		# copy text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		pcPTE.appendPlainText(copyToConsoleText)
		pcPTE.appendPlainText()
	def onInsertMarker(self):
		# insert marker
		self.text_editor.insertPlainText(markerText)
	def onStripPrefix(self):
		# strip out "&gt;&gt;&gt; " from text edit window
		self.text_editor.selectAll()
		if len(self.text_editor.toPlainText())&gt;0:
			self.text_editor.selectAll()
			tmp = self.text_editor.toPlainText()
			self.text_editor.clear()
			self.text_editor.appendPlainText(tmp.replace("&gt;&gt;&gt; ",""))
	def onReduceBlankLines(self):
		# reduce multiple blank lines to single blank lines
		contents = self.text_editor.toPlainText()
		self.text_editor.clear()
		self.text_editor.appendPlainText(os.linesep.join([s for s in contents.splitlines() if s]))
	def onSelectMarkers(self):
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		bNum = cursor.blockNumber(); cNum = cursor.columnNumber()
		pos = cursor.position(); cursorTextLength = len(cursorText)
		occurrences = [i for i in range(len(cursorText)) if cursorText.startswith(markerText, i)]
		if len(occurrences)==0:
			self.alertWindow = QtGui.QMessageBox()
			self.alertWindow.setText("There are no markers...")
			self.alertWindow.show()
		elif len(occurrences)==1:
			hdrStart = occurrences[0]
			hdrEnd = hdrStart + markerTextLength
			if pos&lt;hdrStart:
				selectStart = 0; selectEnd = hdrStart
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
			if pos&gt;hdrEnd:
				selectStart = hdrEnd; selectEnd = cursorTextLength
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
		else:
			startOccurrences = list(); endOccurrences = list(occurrences)
			for i in range(len(occurrences)):
				startOccurrences.append(occurrences[i] + markerTextLength + 1)
			startOccurrences.insert( 0, 0)
			endOccurrences.insert( len(occurrences), cursorTextLength)
			for i in range(len(occurrences)+1):
				if startOccurrences[i]&lt;pos&lt;endOccurrences[i]:
					if i==0:
						selectStart = startOccurrences[i]
					else:
						selectStart = startOccurrences[i]-1
					selectEnd = endOccurrences[i]
					self.cursor.setPosition(selectStart)
					self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
					self.text_editor.setTextCursor(self.cursor)
					break
	def onSelectAll(self):
		self.text_editor.selectAll()
	def onCloseWindow(self):
		self.close()
	def onSettings(self):
		# get new width (as&nbsp;%), height (as&nbsp;%), vertical flag
		self.childWindow = GetGuiConfigParams(self)
		pass
	def onTextChanged(self):
		FreeCAD.PythonAssistantWindowStatus[1] = True
	def onCursorPosition(self):
		#print ("Line: {} | Column: {}".format(
		#	self.text_editor.textCursor().blockNumber(),
		#	self.text_editor.textCursor().columnNumber()))
		#print self.text_editor.textCursor().position()+self.text_editor.textCursor().columnNumber()
		pass
	def onSaveAsFile(self):
		filePath = QtGui.QFileDialog.getSaveFileName(parent=None,caption="Save contents as",dir=expanduser("~"),filter="*.txt")
		file = open(filePath[0],"w")
		file.write(self.text_editor.toPlainText())
		file.close()
	def closeEvent(self,event):
		# write out contents for next session
		file = open(persistenceFile,"w")
		file.write(self.text_editor.toPlainText())
		file.close()
		# clear global flag
		del FreeCAD.PythonAssistantWindowStatus
		self.close()

class GetGuiConfigParams(QtGui.QMainWindow):
	""""""
	def __init__(self, parentWindow):
		self.parentWindow = parentWindow
		super(GetGuiConfigParams, self).__init__()
		self.initUI(parentWindow)
	def initUI(self, parentWindow):
		"""Constructor"""
		self.result							= userCancelled
		# grab geometry from our parent so we can tell if user has changed values
		self.initialParentWindowX			= self.parentWindow.geometry().x()
		self.initialParentWindowY			= self.parentWindow.geometry().y()
		self.initialParentWindowH			= self.parentWindow.geometry().height()
		self.initialParentWindowW			= self.parentWindow.geometry().width()
		self.initialHeightSliderSetting		= self.initialParentWindowH/float(availableHeight)*100
		self.initialWidthSliderSetting		= self.initialParentWindowW/float(availableWidth-interWindowGap)*100
		# set some fixed GUI attributes
		width								= 450
		height								= 40
		buttonWidth							= 80
		sliderWidth							= 100
		self.setWindowTitle("GUI Configuration")
		self.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
		self.resize(width, height)
		self.widthSlider					= self.initialWidthSliderSetting
		self.heightSlider					= self.initialHeightSliderSetting
		#
		centralWidget 						=  QtGui.QWidget(self)
		layout 								=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		verticalLine 						=  QtGui.QFrame()
		# sliders
		widthSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		widthSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		widthSlider.valueChanged[int].connect(self.widthSliderChangeValue)
		widthSlider.setFixedWidth(sliderWidth)
		widthSlider.setValue(self.initialWidthSliderSetting)
		heightSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		heightSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		heightSlider.valueChanged[int].connect(self.heightSliderChangeValue)
		heightSlider.setFixedWidth(sliderWidth)
		heightSlider.setValue(self.initialHeightSliderSetting)
		# labels
		pawWidthLbl		= QtGui.QLabel("Python Assistant Window width", self)
		pawHeightLbl	= QtGui.QLabel("Python Assistant Window height", self)
		# radio buttons - window top or bottom
		self.rb1 = QtGui.QRadioButton("Window at Top",self)
		self.rb1.clicked.connect(self.onRb1)
		self.rb2 = QtGui.QRadioButton("Window at Bottom",self)
		self.rb2.toggle() # set default value
		self.rb2.clicked.connect(self.onRb2)
		if self.parentWindow.geometry().y()==0:
			self.rb1.toggle()
		# cancel button
		cancelButton = QtGui.QPushButton('Cancel', self)
		cancelButton.clicked.connect(self.onCancel)
		cancelButton.setFixedWidth(buttonWidth)
		# OK button
		okButton = QtGui.QPushButton('OK', self)
		okButton.clicked.connect(self.onOk)
		okButton.setFixedWidth(buttonWidth)
		#
		verticalLine.setFrameStyle(QtGui.QFrame.VLine)
		verticalLine.setSizePolicy(QtGui.QSizePolicy.Minimum,QtGui.QSizePolicy.Expanding)
		#
		pawWidthLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		pawHeightLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb1.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb2.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		# populate layout
		layout.addWidget(widthSlider,0,0)
		layout.addWidget(pawWidthLbl,0,1)
		layout.addWidget(heightSlider,2,0)
		layout.addWidget(pawHeightLbl,2,1)
		layout.addWidget(verticalLine,0,2,3,1)
		layout.addWidget(self.rb1,0,3)
		layout.addWidget(self.rb2,2,3)
		layout.addWidget(cancelButton,3,1,QtCore.Qt.AlignRight)
		layout.addWidget(okButton,3,3)
		#
		self.setCentralWidget(centralWidget)
		#
		self.show()
	def widthSliderChangeValue(self, value):
		self.widthSliderValue = value
	def heightSliderChangeValue(self, value):
		self.heightSliderValue = value
	def onRb1(self):
		pass
	def onRb2(self):
		pass
	def onCancel(self):
		self.result = userCancelled
		self.close()
	def onOk(self):
		self.result = "OK"
		# the two slider values are the width and height of the Python Assistant Window
		# resize main FreeCAD window
		freeCadMainWidth	= ((1-(self.widthSliderValue/100.0)) * availableWidth)-(3*interWindowGap)
		FreeCADGui.getMainWindow().setGeometry(0, 0, freeCadMainWidth, availableHeight)
		# resize the PAW window
		newPawWidth			= availableWidth-freeCadMainWidth
		newPawHeight		= (self.heightSliderValue/100.0) * availableHeight
		if self.rb1.isChecked():
			newPawTop		= 0
		else:
			newPawTop		= availableHeight - newPawHeight
		self.parentWindow.setGeometry(freeCadMainWidth+interWindowGap, newPawTop, newPawWidth-interWindowGap, newPawHeight)
		self.close()

#----------------------------------------------------------------------

# Class definitions
		
# Function definitions

def onFreeCADShutdown():
	# this will be invoked when FreeCAD is told to shut down
	#QtGui.QMessageBox.information(None,"","FreeCAD shutting down")
	if FreeCAD.PythonAssistantWindowStatus[1]:
		reply = QtGui.QMessageBox.question(None, "",
			"The Python Assistant Window has changes, do you want to save them?",
			QtGui.QMessageBox.Yes | QtGui.QMessageBox.No, QtGui.QMessageBox.No)
		if reply == QtGui.QMessageBox.Yes:
			# write out contents for next session
			file = open(persistenceFile,"w")
			file.write(FreeCAD.PythonAssistantWindowStatus[0].text_editor.toPlainText())
			file.close()
	del FreeCAD.PythonAssistantWindowStatus

# Constant definitions

userCancelled		= "Cancelled"
markerText			= "#=========== marker ===========\n"
markerTextLength	= len(markerText)
copyFromConsoleText	= "#=========== copy from console ==========="
copyToConsoleText	= "#============ copy to console ============"
menuDividerText		= "--------"
interWindowGap		= 3 # space between 2 windows for appearance sake
persistenceFile		= App.ConfigGet("UserAppData")+"PythonAssistantWindow.txt"
# code ***********************************************************************************
# put down user data saving routine for when FreeCAD exits
mw=Gui.getMainWindow()
mw.mainWindowClosed.connect(onFreeCADShutdown)
# get screen dimensions
screenWidth			= QtGui.QDesktopWidget().screenGeometry().width()
screenHeight		= QtGui.QDesktopWidget().screenGeometry().height()
# get dimensions for available space on screen
availableWidth		= QtGui.QDesktopWidget().availableGeometry().width()
availableHeight		= QtGui.QDesktopWidget().availableGeometry().height()

if not hasattr(FreeCAD,"PythonAssistantWindowStatus"):
	previousContents = ""
	if os.path.isfile(persistenceFile):
		# read contents of last session
		file = open(persistenceFile,"r")
		previousContents = file.read()
		file.close()
	# open window with contents from last session
	form = PythonAssistantWindow(previousContents)
	# save pointer to window so it can be located again and Raised when it becomes obscured
	FreeCAD.PythonAssistantWindowStatus = [None, False]
	FreeCAD.PythonAssistantWindowStatus[0] = form
else:
	# window is open so Raise it so it is visible
	FreeCAD.PythonAssistantWindowStatus[0].raise_()
	pass
#
#OS: Mac OS X
#Word size: 64-bit
#Version: 0.14.3703 (Git)
#Branch: releases/FreeCAD-0-14
#Hash: c6edd47334a3e6f209e493773093db2b9b4f0e40
#Python version: 2.7.5
#Qt version: 4.8.6
#Coin version: 3.1.3
#SoQt version: 1.5.0
#OCC version: 6.7.0
#
#thus ends the macro...
</pre>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20251021140056
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.087 seconds
Real time usage: 0.124 seconds
Preprocessor visited node count: 153/1000000
Post&#8208;expand include size: 3639/2097152 bytes
Template argument size: 1123/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 22460/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   10.714      1 -total
 49.06%    5.256      1 Template:Macro/de
 17.50%    1.875      1 Template:Codeextralink
 14.10%    1.511      1 Template:VeryImportantMessage
 13.16%    1.410      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:394584-0!canonical and timestamp 20251021140056 and revision id 1669743. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>