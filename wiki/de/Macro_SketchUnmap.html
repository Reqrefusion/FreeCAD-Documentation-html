<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro SketchUnmap/de</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="de" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+SketchUnmap&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--high" lang="de" dir="ltr">Deutsch</span></li>
<li><a href="../Macro_SketchUnmap.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro SketchUnmap (100% translated)" lang="en" dir="ltr">English</a></li>
<li><a href="../fr/Macro_SketchUnmap.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro SketchUnmap (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="../it/Macro_SketchUnmap.html" class="mw-pt-progress mw-pt-progress--low" title="Macro SketchUnmap (4% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_SketchUnmap.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: SketchUnmap (4% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=SketchUnmap.svg&amp;filetimestamp=20190614162801&amp;.html" class="mw-file-description"><img src="../File/SketchUnmap.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Skizzenzuordnung aufheben
</p>
</td></tr>
<tr>
<th class="ctOdd">Beschreibung
</th></tr>
<tr>
<td class="ctEven left macro-description">Dieses Makro setzt die Platzierung einer Skizze auf eine absolute Position zur&uuml;ck und erstellt schlie&szlig;lich eine Bezugsebene. Dieses Makro wurde haupts&auml;chlich geschrieben, um das Problem der topologischen Benennung zu umgehen, das ein Modell besch&auml;digen kann, wenn eine Skizze direkt oder indirekt an eine Fl&auml;che oder ein anderes topologisches Element angeh&auml;ngt wurde.
<p>Um eine Besch&auml;digung zu verhindern, sollte das Makro angewendet werden, solange das Modell noch intakt ist. Es kann ein besch&auml;digtes Modell nicht &bdquo;reparieren&rdquo;. Wenn Sie Ihr Modell besch&auml;digt haben, machen Sie die letzten &Auml;nderungen r&uuml;ckg&auml;ngig, bis das Modell wieder intakt ist, wenden Sie das Makro auf die instabilen Skizzen an und wiederholen Sie dann den vorherigen Vorgang.<br><br>Versionsmakro&nbsp;: 0.6.2<br>Datum der letzten &Auml;nderung&nbsp;: 2019-06-14<br>FreeCAD version&nbsp;: 0.17 und h&ouml;her<br>Herunterladen&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/3/34/SketchUnmap.svg">Werkzeugleisten-Symbol</a><br>Autor: OpenBrain<br>
</p>
</td></tr>
<tr>
<th class="ctOdd">Autor
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;OpenBrain&amp;action=edit&amp;redlink=1.html" class="new" title="User:OpenBrain (page does not exist)">OpenBrain</a>
</td></tr>
<tr>
<th class="ctOdd">Herunterladen
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/3/34/SketchUnmap.svg">Werkzeugleisten-Symbol</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../de/Macros_recipes.html" title="Macros recipes/de">Makros Rezepte</a><br><a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a><br><a href="../de/Customize_Toolbars.html" title="Customize Toolbars/de">Symbolleisten anpassen</a>
</td></tr>
<tr>
<th class="ctOdd">Macro-Version
</th></tr>
<tr>
<td class="ctEven macro-version">0.6.2
</td></tr>
<tr>
<th class="ctOdd">Datum der letzten &Auml;nderung
</th></tr>
<tr>
<td class="ctEven macro-date">2019-06-14
</td></tr>
<tr>
<th class="ctOdd">FreeCAD-Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.17 und h&ouml;her
</td></tr>
<tr>
<th class="ctOdd">Standardverkn&uuml;pfung
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Siehe auch
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p><span id="Description"></span>
</p>
<h2><span class="mw-headline" id="Beschreibung">Beschreibung</span></h2>
<p><span id="Context"></span>
</p>
<h3><span class="mw-headline" id="Zusammenhang">Zusammenhang</span></h3>
<p>Dieses Makro wurde haupts&auml;chlich geschrieben, um das Problem der topologischen Benennung zu umgehen, das ein Modell besch&auml;digen kann, wenn eine Skizze direkt oder indirekt an eine Fl&auml;che oder ein anderes topologisches Element angeh&auml;ngt wurde.
Um eine Besch&auml;digung zu verhindern, sollte das Makro angewendet werden, solange das Modell noch intakt ist. Es kann ein besch&auml;digtes Modell nicht &bdquo;reparieren&rdquo;. Wenn das Modell besch&auml;digt wurde, die letzten &Auml;nderungen r&uuml;ckg&auml;ngig machen, bis das Modell wieder intakt ist, das Makro auf die instabilen Skizzen anwenden und dann den vorherigen Vorgang wiederholen.
</p><p><span id="Usage"></span>
</p>
<h3><span class="mw-headline" id="Anwendung">Anwendung</span></h3>
<p>Funktional entfernt das Makro die aktuelle Zuordnung der Skizze, auf die es angewendet wird, und wendet dann eine absolute Platzierung darauf an, sodass es immun gegen &Auml;nderungen der Zuordnungsunterst&uuml;tzung ist.
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>To do so, the macro will basically propose 3 options (if your sketch isn't in a PartDesign Body, only first option is available and will be applied automatically)&nbsp;:
</p>
<ul><li>"Raw" mode =&gt; the sketch placement is made absolute in the body referential, nothing more</li>
<li>"DP@Face mode" =&gt; a datum plane is created where the mapping face is, then the sketch is attached to it respecting its attachment offset</li>
<li>"DP@Sketch" mode =&gt; a datum place is created where the sketch is (including attachment offset), then the sketch is attached to its origin</li></ul>
</div>
<p>Um das Makro zu verwenden, einfach die Zielskizze ausw&auml;hlen (z. B. in der Baumansicht) und dann das Makro ausf&uuml;hren. Das war's schon!
</p>
<h3><span class="mw-headline" id="Installation">Installation</span></h3>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The macro is available through <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>.
Code is provided on this page for convenience in case user system doesn't have git-python. Though it should be up-to-date, latest release is always available at <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD-macros/blob/master/Sketcher/SketchUnmap.FCMacro">FreeCAD-macro repository</a>
</p>
</div>
<p>Ausf&uuml;hrlichere Erl&auml;uterungen findet man unter: <a href="../de/How_to_install_macros.html" title="How to install macros/de">Wie man Makros installiert</a>.
</p>
<h3><span class="mw-headline" id="Details">Details</span></h3>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>For better understanding, below is an example&nbsp;:
Let's suppose a simple cube whose top (yellow) face has been drafted. A cylinder is created with a padded circle whose sketch has been mapped (Flat face) to the drafted face and offset to match needs (Attachment offset)&nbsp;:
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Unmap_ex1.png&amp;filetimestamp=20190610103430&amp;.html" class="mw-file-description"><img src="../File/Unmap_ex1.png" decoding="async" width="936" height="361" class="mw-file-element" data-file-width="936" data-file-height="361"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Now for some reason, you need to revert the pull direction of the draft (of course without the cylinder to move). Here is what basically happen&nbsp;:
</p>
</div>
<p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Unmap_ex2.png&amp;filetimestamp=20190610103518&amp;.html" class="mw-file-description"><img src="../File/Unmap_ex2.png" decoding="async" width="1024" height="366" class="mw-file-element" data-file-width="1024" data-file-height="366"></a></span>
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>The treeview shows an error, the 3D view isn't updated, and the circle sketch is floating in the middle of nowhere...
</p>
</div>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>Now comes the job of the macro (that you need to run before changing the reference face, when the sketch is still at its right place). Select the sketch and run it. If your sketch is in a body, a message box will ask to choose among the 3 different options (if your sketch is out of a body, it will automatically apply the 1st one)&nbsp;:
</p>
</div>
<ul><li>"Raw" mode</li>
<li>"DP@Face mode"</li>
<li>"DP@Sketch" mode</li></ul>
<p>Was in Bezug auf das Bild Folgendes ergibt:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Unmap_macro.png&amp;filetimestamp=20190610103544&amp;.html" class="mw-file-description"><img src="../File/Unmap_macro.png" decoding="async" width="669" height="782" class="mw-file-element" data-file-width="669" data-file-height="782"></a></span>
</p><p><span id="Script"></span>
</p>
<h2><span class="mw-headline" id="Skript">Skript</span></h2>
<p>Werkzeugleisten-Symbol <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=SketchUnmap.svg&amp;filetimestamp=20190614162801&amp;.html" class="mw-file-description"><img src="../File/SketchUnmap.svg" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><b>Macro_SketchUnmap.FCMacro</b>
</p>
<pre>#!/usr/bin/python
#####################################
# Copyright (c) openBrain 2019
# Licensed under LGPL v2
#
# This FreeCAD macro will unmap a sketch from eg. a face and make its placement absolute in the body. It proposes 3 options (forcely the first if sketch not in a body)&nbsp;:
# * "Raw" mode =&gt; the sketch placement is made absolute in the body referential, nothing more
# * "DP@Face mode" =&gt; a datum plane is created where the mapping face is, then the sketch is attached to it respecting its attachment offset
# * "DP@Sketch" mode =&gt; a datum place is created where the sketch is (including attachment offset), then the sketch is attached to its origin
#
# Main use of the macro is to make design more robust to topological naming issue
#
# Version history&nbsp;:
# *0.6.2&nbsp;: add icon (metadata)
# *0.6.1&nbsp;: minor changes after PR review
# *0.6&nbsp;: some typo improvement + commenting for official PR
# *0.5&nbsp;: beta release
#
#####################################

__Name__ = 'SketchUnmap'
__Comment__ = 'Unmap a sketch &amp; makes its placement absolute"'
__Author__ = 'openBrain'
__Version__ = '0.6.2'
__Date__ = '2019-06-14'
__License__ = 'LGPL v2'
__Web__ = 'https://wiki.freecad.org/Macro_SketchUnmap'
__Wiki__ = 'https://wiki.freecad.org/Macro_SketchUnmap'
__Icon__ = 'https://wiki.freecad.org/images/3/34/SketchUnmap.svg'
__Help__ = 'Select the sketch to unmap (eg. in the tree view) then run the macro'
__Status__ = 'Beta'
__Requires__ = 'FreeCAD &gt;= 0.17'
__Communication__ = 'https://forum.freecad.org/viewtopic.php?f=22&amp;t=36078'
#    __Files__ = ''

__dbg__ = False  #True for debugging

from PySide import QtGui

def cslM(msg): #Print message in console
    FreeCAD.Console.PrintMessage('\n')
    FreeCAD.Console.PrintMessage(msg)

def cslW(msg): #Print warning in console
    FreeCAD.Console.PrintMessage('\n')
    FreeCAD.Console.PrintWarning(msg)

def cslE(msg): #Print error in console
    FreeCAD.Console.PrintMessage('\n')
    FreeCAD.Console.PrintError(msg)

def cslD(msg): #Print debug message in console
    if __dbg__:
        FreeCAD.Console.PrintMessage('\n')
        FreeCAD.Console.PrintMessage("Debug&nbsp;: " + str(msg))

_0Vec_ = FreeCAD.Vector(0, 0, 0) #Shortener for null vector
_ZVec_ = FreeCAD.Vector(0, 0, 1) #Shortener for Z axis

if __dbg__:  ##Clear report view in debug mode
    FreeCADGui.getMainWindow().findChild(QtGui.QTextEdit, "Report view").clear()

cslM("Starting SketchUnmap macro")
cslD("Checking selection")

##If selection is wrong, print error message and exit
if (len(Gui.Selection.getSelection())&nbsp;!= 1 or str(Gui.Selection.getSelection()[0])&nbsp;!= '&lt;Sketcher::SketchObject&gt;'):
    cslE("You must select a sketch that you want to unmap (and only one) ... Exiting")
else:
    cslD("Selection OK")
    App.ActiveDocument.openTransaction("SketchUnmap") #Open transaction for undo management
    sk = Gui.Selection.getSelection()[0] #Get target sketch
    skNatPl = sk.Placement #Store placement
    skNatAO = sk.AttachmentOffset #Store attachment offset
    skInBody = False
    for obj in sk.InList: ##Check if sketch is inside a Body
        if obj.TypeId == 'PartDesign::Body':
            skInBody = True
            skBody = obj
    cslD("Sketch in a body&nbsp;: " + str(skInBody))
    msgb = QtGui.QMessageBox() ##Prepare the message box to choose option
    msgb.setWindowTitle("Unmap Sketch&nbsp;: Mode selection")
    msgb.setText("""Choose which unmapping mode you want to apply&nbsp;:
    Raw =&gt; the sketch placement is made absolute in the body referential, nothing more
    DP@Face =&gt; a datum plane is created where the mapping face is, then the sketch is attached to it respecting its attachment offset
    DP@Sketch =&gt; a datum place is created where the sketch is (including attachment offset), then the sketch is attached to its origin
        Click 'Cancel' to cancel operation""")
    msgb.setIcon(QtGui.QMessageBox.Question)
    rbut = msgb.addButton("Raw", QtGui.QMessageBox.AcceptRole)
    fbut = msgb.addButton("DP@Face", QtGui.QMessageBox.AcceptRole)
    sbut = msgb.addButton("DP@Sketch", QtGui.QMessageBox.AcceptRole)
    cbut = msgb.addButton("Cancel", QtGui.QMessageBox.RejectRole)
    if skInBody: #If sketch in a Body
        msgb.exec_() ##Show message box and get user choice
        msgbRep = msgb.clickedButton()
    else:
        msgbRep = rbut #Else apply raw mode automatically
    if msgbRep == rbut: #If raw mode
        sk.Support = None ##Just unmap the sketch so its placement is absolute
        sk.MapMode = 'Deactivated'
    elif msgbRep == fbut: #If DP@Face mode
        newDP = skBody.newObject('PartDesign::Plane','DP' + sk.Name) #Create a datum plane
        if sk.Label&nbsp;!= sk.Name: ##Eventually clarify its label
            newDP.Label = 'DP' + sk.Label
        newDP.Support = None ##Plane is placed absolute
        newDP.MapMode = 'Deactivated'
        newDP.Placement = skNatPl.multiply(skNatAO.inverse()) #Plane placement is set to former face one
        sk.Support = [(newDP,'')] #Sketch is mapped to plane keeping its attachment offset
    elif  msgbRep == sbut: #If DP@Sketch mode
        newDP = skBody.newObject('PartDesign::Plane','DP' + sk.Name) #Create a datum plane
        if sk.Label&nbsp;!= sk.Name: ##Eventually clarify its label
            newDP.Label = 'DP' + sk.Label
        newDP.Support = None ##Plane is placed absolute
        newDP.MapMode = 'Deactivated'
        newDP.Placement = skNatPl #Plane placement is set to former sketch one
        sk.Support = [(newDP,'')] ##Sketch is mapped to plane resetting its attachment offset
        sk.AttachmentOffset = App.Placement(_0Vec_, App.Rotation(_ZVec_, 0))
    App.ActiveDocument.commitTransaction() #Commit transaction for undo management
    cslM("SketchUnmap Macro ended correctly")</pre>
<p><span id="Limitations"></span>
</p>
<h3><span id="Einschr.C3.A4nkungen"></span><span class="mw-headline" id="Einschr&auml;nkungen">Einschr&auml;nkungen</span></h3>
<ul><li>Jeweils nur eine Skizze bearbeiten</li>
<li>Nur Skizzenobjekte bearbeiten</li></ul>
<p><span id="Forum_discussion"></span>
</p>
<h3><span class="mw-headline" id="Forums-Diskussion">Forums-Diskussion</span></h3>
<p>F&uuml;r jegliches Feedback (Fehler, Funktionsw&uuml;nsche, Kommentare usw.) nutze bitte diesen Forum-Thread: <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=36078">(FR) macro to remap sketch to different reference</a>
</p>
<!-- 
NewPP limit report
Cached time: 20251024145709
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.043 seconds
Real time usage: 0.072 seconds
Preprocessor visited node count: 118/1000000
Post&#8208;expand include size: 2744/2097152 bytes
Template argument size: 6899/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 6934/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    9.372      1 -total
 53.37%    5.002      1 Template:Macro/de
 44.61%    4.181      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:396526-0!canonical and timestamp 20251024145708 and revision id 1676604. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>