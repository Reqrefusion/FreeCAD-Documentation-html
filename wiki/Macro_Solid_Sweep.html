<link href="site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Solid Sweep</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="de/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--complete" title="Makro Solid Sweep (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><span class="mw-pt-languages-ui mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="en" dir="ltr">English</span></li>
<li><a href="es/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Solid Sweep (82% translated)" lang="es" dir="ltr">espa&ntilde;ol</a></li>
<li><a href="fr/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Solid Sweep (100% translated)" lang="fr" dir="ltr">fran&ccedil;ais</a></li>
<li><a href="it/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Solid Sweep (100% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="pl/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--stub" title="Makrodefinicja: Solid Sweep (9% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="cs/Macro_Solid_Sweep.html" class="mw-pt-progress mw-pt-progress--complete" title="Makro T&#283;leso vle&#269;en&iacute;m profilu (82% translated)" lang="cs" dir="ltr">&#269;e&scaron;tina</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="index.php?title=Macro_Solid_Sweep.png&amp;filetimestamp=20190616103223&amp;.html" class="mw-file-description"><img src="File/Macro_Solid_Sweep.png" decoding="async" width="32" height="32"></a></span><span> </span>
Solid Sweep
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Creates a solid by sweeping a profile from a trajectory.<br><br>Macro version: 1.0<br>Last modified: 2011-12-03<br>FreeCAD version: All<br>Download: <a rel="nofollow" class="external text" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png">ToolBar Icon</a><br>Author: Normandc<br>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="User;Normandc.html" title="User:Normandc">Normandc</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://www.freecadweb.org/wiki/images/6/6d/Macro_Solid_Sweep.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2011-12-03
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This macro creates a solid by sweeping a 2D profile along a trajectory previously selected in the 3D view. The 2D elements can be created through the regular tools in FreeCAD's GUI.
</p><p>It should be noted that the resulting solid will <b>not</b> be parametric. If you decide to change your profile or trajectory, you'll need to run the macro again.
</p><p><span typeof="mw:File"><a href="index.php?title=Solid_sweep.png&amp;filetimestamp=20111203061804&amp;.html" class="mw-file-description" title="A few examples of sweeping all using the same oblong section and three kinds of trajectory."><img alt="A few examples of sweeping all using the same oblong section and three kinds of trajectory." src="File/Solid_sweep.png" decoding="async" width="500" height="331"></a></span>
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<ol><li>Create two 2D elements, one for the section and one for the trajectory, of the types listed below.</li>
<li>Select, either in the <a href="Tree_view.html" title="Tree view">Tree view</a> or in the <a href="3D_view.html" title="3D view">3D view</a> (<b>The order is important!</b>):
<ol><li>The trajectory</li>
<li>Then the profile</li></ol></li>
<li>Open the <a href="Macros.html" title="Macros">Macro manager</a></li>
<li>Select the <b>Solid Sweep</b> macro</li>
<li>Click <span style="background: #f5f5f5; -moz-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); -webkit-box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); box-shadow: 0.1em 0.1em 0.2em rgba(0,0,0,0.1); border: 2px solid #989898; border-radius: 0.4em; padding: 0px 10px 1px 10px; font-weight:normal;">Execute</span></li></ol>
<p><b>Result:</b> A <b>Sweep</b> object will be created in the Project tree.
</p>
<h2><span class="mw-headline" id="Supported_2D_elements">Supported 2D elements</span></h2>
<ul><li>Wires</li>
<li><span typeof="mw:File"><a href="index.php?title=Sketcher_NewSketch.svg&amp;filetimestamp=20231231201726&amp;.html" class="mw-file-description"><img src="File/Sketcher_NewSketch.svg" decoding="async" width="24" height="24"></a></span> <a href="Sketcher_Workbench.html" title="Sketcher Workbench">Sketches</a></li>
<li><span typeof="mw:File"><a href="index.php?title=Draft_BSpline.svg&amp;filetimestamp=20210319100925&amp;.html" class="mw-file-description"><img src="File/Draft_BSpline.svg" decoding="async" width="24" height="24"></a></span> <a href="Draft_BSpline.html" title="Draft BSpline">Draft BSpline</a></li>
<li>2D primitives from the <i>Part &rarr; <span typeof="mw:File"><a href="index.php?title=Part_Primitives.svg&amp;filetimestamp=20240522201556&amp;.html" class="mw-file-description"><img src="File/Part_Primitives.svg" decoding="async" width="24" height="24"></a></span> <a href="Part_Primitives.html" title="Part Primitives">Create Primitives</a> ...</i> menu (circle, helix)</li></ul>
<h2><span class="mw-headline" id="Tips">Tips</span></h2>
<ul><li>The section has to be a closed profile or the result will not be a solid.</li>
<li>The section does not need to be located on the trajectory, but it's preferable that it be normal (perpendicular) to the trajectory.</li>
<li>The trajectory can either be an open or closed profile (circle, or line and arc segments) but all elements need to be tangent or the resulting shape will be unexpected. For example, a trajectory with straight corners like a rectangle will not produce a solid.</li>
<li>If the solid gets twisted, edit the macro to change the <i>isFrenet</i> value to 0 (zero) and try again.</li>
<li>Setting the <i>makeSolid</i> variable to 0 (zero) in the macro will produce a set of surfaces with open ends.</li></ul>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="index.php?title=Macro_Solid_Sweep.png&amp;filetimestamp=20190616103223&amp;.html" class="mw-file-description"><img src="File/Macro_Solid_Sweep.png" decoding="async" width="64" height="64"></a></span>
</p><p><b>Macro_Solid_Sweep.FCMacro</b>
</p>
<pre>import Part, FreeCAD, math, PartGui, FreeCADGui
from FreeCAD import Base

# get the selected objects, with first selection for the trajectory and second for the section
s = FreeCADGui.Selection.getSelection()
try:
     shape1=s[0].Shape
     shape2=s[1].Shape
except:
     print "Wrong selection"

traj = Part.Wire([shape1])
section = Part.Wire([shape2])

# create Part objec in the current document
myObject=App.ActiveDocument.addObject("Part::Feature","Sweep")

# variable makeSolid = 1 to create solid, 0 to create surfaces
makeSolid = True #1
isFrenet = True #1

# create a 3D shape and assigh it to the current document
Sweep = Part.Wire(traj).makePipeShell([section],makeSolid,isFrenet)
myObject.Shape = Sweep</pre>
<p><br>
</p>
<h2><span class="mw-headline" id="Credits">Credits</span></h2>
<p>Thanks to <a href="User;Wmayer.html" title="User:Wmayer">Wmayer</a> for his help in writing this script.
</p><p>Two examples of uses can be found in <a rel="nofollow" class="external text" href="http://forum.freecadweb.org/viewtopic.php?f=8&amp;t=1222&amp;start=50#p11120">this forum topic</a>, along with download links to the FCStd files. Using a helix as trajectory, a solid sweep can be used to create a bolt thread.
</p>
<!-- 
NewPP limit report
Cached time: 20250705104335
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.079 seconds
Real time usage: 0.095 seconds
Preprocessor visited node count: 117/1000000
Post&#8208;expand include size: 2211/2097152 bytes
Template argument size: 1151/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 2037/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.203      1 -total
 39.21%    2.432      1 Template:Macro
 29.39%    1.823      1 Template:Button
 28.47%    1.766      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:1850-0!canonical and timestamp 20250705104334 and revision id 1601889. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="site.js"></script>