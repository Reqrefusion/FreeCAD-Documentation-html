<link href="../../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">User:Reqrefusion/FreeCAD-Ribbon/05 ‚Äê Scripts</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><figure class="mw-halign-center" typeof="mw:Error mw:File/Thumb"><a href="../../index.php?title=Special;Upload&amp;wpDestFile=FreeCAD-Ribbon_Scripts_Menu.png.html" class="new" title="File:FreeCAD-Ribbon Scripts Menu.png"><span class="mw-file-element mw-broken-media" data-width="300">File:FreeCAD-Ribbon Scripts Menu.png</span></a><figcaption></figcaption></figure>
<p>Scripts are provided to help setup and customize the FreeCAD Ribbon.  
</p><p>The script are located in the directory "Scripts" in the folder of this add-on. For example, in windows this is:  
<i>"C:\Users\&lt;User name&gt;\AppData\Roaming\FreeCAD\Mod\FreeCAD-Ribbon\Scripts"</i>  
</p><p>You can of course customize these scripts or add your own scripts if you like. These will then also appear in the script menu.
Click on a script and it will be opened in FreeCAD. You can then run it by pressing Ctrl+F6 or go to Macro -&gt; Execute macro.
</p>
<meta property="mw:PageProp/toc">
<h4><span class="mw-headline" id="CreateDefaultRibbonStructure.py">CreateDefaultRibbonStructure.py</span></h4>
<figure class="mw-halign-center" typeof="mw:Error mw:File/Thumb"><a href="../../index.php?title=Special;Upload&amp;wpDestFile=FreeCAD-Ribbon_Script_CreateDefaultRibbonStructure_1.png.html" class="new" title="File:FreeCAD-Ribbon Script CreateDefaultRibbonStructure 1.png"><span class="mw-file-element mw-broken-media" data-width="400">File:FreeCAD-Ribbon Script CreateDefaultRibbonStructure 1.png</span></a><figcaption></figcaption></figure>
<figure class="mw-halign-center" typeof="mw:Error mw:File/Thumb"><a href="../../index.php?title=Special;Upload&amp;wpDestFile=FreeCAD-Ribbon_Script_CreateDefaultRibbonStructure_2.png.html" class="new" title="File:FreeCAD-Ribbon Script CreateDefaultRibbonStructure 2.png"><span class="mw-file-element mw-broken-media" data-width="400">File:FreeCAD-Ribbon Script CreateDefaultRibbonStructure 2.png</span></a><figcaption></figcaption></figure>
<p>This macro is ment to create a starting point for your own Ribbon design. When running this script, for every workbench every first command of a panel will be set to large. If you have already some customizations done for a workbench you can add this to the script. Comments are provided within the script to clarify the functions. The standard customization as provided with the Ribbon is already added to the script.  
</p><p>After running this script, a file called "RibbonStructure_default.json" is created. This is used by the Ribbon Design Dialog to reset the ribbon.  
You can change the name of this file to a different name if you like.
</p>
<h4><span class="mw-headline" id="FixRibbonStructure.py">FixRibbonStructure.py</span></h4>
<p>This script can be used to fix errors in the file "RibbonStructure.json".
It will look for panels under workbenches that shouldn't be there and removes them.
This cleans up the file and can help resolve issues with errors like unable to remove separators.
</p>
<h4><span class="mw-headline" id="GenerateCommandsList.py">GenerateCommandsList.py</span></h4>
<p>With this script you can create a list of commands. The list looks as shown in the picture below.  
</p>
<figure class="mw-halign-center" typeof="mw:Error mw:File/Thumb"><a href="../../index.php?title=Special;Upload&amp;wpDestFile=FreeCAD-Ribbon_Script_GenerateCommandsList.png.html" class="new" title="File:FreeCAD-Ribbon Script GenerateCommandsList.png"><span class="mw-file-element mw-broken-media" data-width="400">File:FreeCAD-Ribbon Script GenerateCommandsList.png</span></a><figcaption></figcaption></figure>
<p>A list item consists of the commandname followed by a list. This list consists of three items:  
</p>
<ol><li>The name of the workbench to which the command belongs to</li>
<li>The menu text of this command. (This is what is shown on the ribbon by default)</li>
<li>Three dots. You can replace these dots with your own menu text.</li></ol>
<p>This command list is used by the next script: "UpdateCommandNames.py"  
</p><p>As with "CreateDefaultRibbonStructure.py" you can add toolbars, workbenches, icon only toolbars, etc to the various lists. These will be ignored by the script. 
</p>
<h4><span class="mw-headline" id="UpdateCommandNames.py">UpdateCommandNames.py</span></h4>
<p>With this script you can update your "RibbonStructure.json" file with your custom menu text.
If you want to update a different json file, you can change this in the script.
</p>
<!-- 
NewPP limit report
Cached time: 20251115225503
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.174 seconds
Real time usage: 0.786 seconds
Preprocessor visited node count: 15/1000000
Post&#8208;expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:401473-0!canonical and timestamp 20251115225503 and revision id 1692753. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../../site.js"></script>