<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro TreeToAscii/fr</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+TreeToAscii&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_TreeToAscii.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro TreeToAscii (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../it/Macro_TreeToAscii.html" class="mw-pt-progress mw-pt-progress--low" title="Macro TreeToAscii (12% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_TreeToAscii.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: TreeToAscii (6% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Text-x-python.png&amp;filetimestamp=20121224162851&amp;.html" class="mw-file-description" title="Generic macro icon"><img alt="Generic macro icon" src="../File/Text-x-python.png" decoding="async" width="32" height="32" class="mw-file-element"></a></span><span> </span>
Macro TreeToAscii
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Cette macro g&eacute;n&egrave;re une repr&eacute;sentation graphique ASCII de l'arborescence du ou des objets s&eacute;lectionn&eacute;s.<br><br>Version macro&nbsp;: 0.6<br>Date derni&egrave;re modification&nbsp;: 2020-03-23<br>Version FreeCAD&nbsp;: 0.17+<br>Auteur: OpenBrain<br>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;OpenBrain&amp;action=edit&amp;redlink=1.html" class="new" title="User:OpenBrain (page does not exist)">OpenBrain</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">0.6
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2020-03-23
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.17+
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Cette macro a &eacute;t&eacute; &eacute;crite dans le but principal de documenter la construction du mod&egrave;le. Elle g&eacute;n&egrave;re une repr&eacute;sentation graphique ASCII de l'arborescence de la  construction du ou des objet(s) s&eacute;lectionn&eacute;(s).
</p><p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<p>S&eacute;lectionnez simplement le ou les objets dont vous souhaitez imprimer l'arborescence et ex&eacute;cutez la macro. Elle affichera l'arborescence de chaque objet dans une bo&icirc;te de dialogue. Tous les objets s&eacute;lectionn&eacute;s seront consid&eacute;r&eacute;s comme &eacute;tant au m&ecirc;me niveau de hi&eacute;rarchie en haut de l'arborescence (m&ecirc;me s'ils ne sont pas dans le mod&egrave;le r&eacute;el). Une fois la bo&icirc;te de dialogue ouverte, vous pouvez changer de style et/ou de motif et recr&eacute;er l'arborescence en ASCII.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=FCTree2Ascii.png&amp;filetimestamp=20200319113217&amp;.html" class="mw-file-description"><img src="../File/FCTree2Ascii.png" decoding="async" width="949" height="487" class="mw-file-element"></a></span>
</p><p>Plusieurs styles sont fournis, pour l'instant principalement pour prendre en charge les syst&egrave;mes qui peuvent rencontrer des probl&egrave;mes avec le codage Unicode&nbsp;:
</p>
<ul><li><i><b>Modern</b></i>&nbsp;: (par d&eacute;faut) utilise des caract&egrave;res Unicode pour afficher les fourches et les branches</li>
<li><i><b>Baroque</b></i>&nbsp;: un autre style Unicode avec une plus grande indentation</li>
<li><i><b>ASCII</b></i>&nbsp;: repr&eacute;sentation ASCII pure des fourches et branches</li></ul>
<p>La cr&eacute;ation de votre propre style ne devrait pas &ecirc;tre trop difficile en modifiant la macro et en changeant/ajoutant un style &agrave; la variable "STYLES". Le choix du style s&eacute;lectionn&eacute; est enregistr&eacute; dans les param&egrave;tres FreeCAD.
</p><p>Le motif de ligne peut &ecirc;tre personnalis&eacute;. Il prend en charge diff&eacute;rentes m&eacute;tadonn&eacute;es d&eacute;finies&nbsp;:
</p>
<ul><li><i><b>{LBL}</b></i>&nbsp;: objet &eacute;tiquette Label (&eacute;tiquette affich&eacute;e)</li>
<li><i><b>{NAM}</b></i>&nbsp;: objet nom Name (nom interne) par ex. "Box001"</li>
<li><i><b>{SNAM}</b></i>&nbsp;: objet nom court ShortName (sans chiffres) par exemple. 'Box001' sera affich&eacute; comme 'Box'</li>
<li><i><b>{TYP}</b></i>&nbsp;: objet Type par exemple. 'Part::MultiFuse'</li>
<li><i><b>{BTYP}</b></i>&nbsp;: objet BaseType par exemple. "Part::MultiFuse" sera affich&eacute; comme "Part"</li>
<li><i><b>{STYP}</b></i>&nbsp;: objet ShortType (sans base) par ex. "Part::MultiFuse" sera affich&eacute; comme "MultiFuse"</li></ul>
<p>Le mod&egrave;le par d&eacute;faut est "{LBL} ({SNAM})", ce qui signifie par exemple que l'objet "Box001" &eacute;tiquet&eacute; "myCube" sera affich&eacute; comme "myCube (Box001)".
Notez que pratiquement tous les caract&egrave;res sont autoris&eacute;s. Si vous souhaitez imprimer des accolades, vous devez les doubler. Par exemple, avec le m&ecirc;me objet d'exemple, le mod&egrave;le "{LBL} (SNAME) {{{TYP}}} =&gt;" affichera "myCube (Box) {Part::Box} =&gt;". Les m&eacute;tadonn&eacute;es disponibles sont disponibles dans l'info-bulle du champ d'&eacute;dition de motif, vous n'avez donc pas besoin de vous en souvenir. Le motif de la ligne est enregistr&eacute; dans les param&egrave;tres FreeCAD.
</p><p>Une fois la bo&icirc;te de dialogue ouverte, plusieurs actions sont disponibles&nbsp;:
</p>
<ul><li><i><b>Copy to clipboard</b></i>&nbsp;: copie tout l'arborescence dans votre presse-papiers</li>
<li><i><b>Save to file</b></i>&nbsp;: enregistre l'arborescence enti&egrave;re dans un fichier arbitraire sur votre syst&egrave;me</li>
<li><i><b>Embed in text file</b></i>&nbsp;: stocke l'arborescence enti&egrave;re dans un fichier texte incorpor&eacute; dans le document (disponible depuis FC 0.18.4)</li>
<li>Bien s&ucirc;r, vous pouvez copier n'importe quelle partie de l'arborescence en la s&eacute;lectionnant et en utilisant les commandes de copie standard.</li></ul>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>La macro est disponible via le <a href="../fr/Std_AddonMgr.html" title="Std AddonMgr/fr">gestionnaire des extensions</a>.
Le code est fourni sur cette page pour plus de commodit&eacute; au cas o&ugrave; votre syst&egrave;me n'ait pas git-python. Bien qu'elle devrait &ecirc;tre &agrave; jour, la derni&egrave;re version de la macro est toujours disponible sur <a rel="nofollow" class="external text" href="https://github.com/FreeCAD/FreeCAD-macros/blob/master/Information/TreeToAscii.FCMacro">d&eacute;p&ocirc;t FreeCAD-macro</a>
</p><p>Pour des explications plus d&eacute;taill&eacute;es, consultez la page <a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer les macros</a>.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p><span id="Forum_discussion"></span>
</p>
<h3><span class="mw-headline" id="Discussion_du_forum">Discussion du forum</span></h3>
<p>Pour tout commentaire (bug, demande de fonctionnalit&eacute;, commentaires...), merci d'utiliser ce fil de discussion&nbsp;: <a rel="nofollow" class="external free" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504">https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504</a>
</p>
<h3><span class="mw-headline" id="Code">Code</span></h3>
<p><b>Macro_FCTree2Ascii.FCMacro</b>
</p>
<pre>#!/usr/bin/python
#####################################
# Copyright (c) openBrain 2020
# Licensed under LGPL v2
#
# This FreeCAD macro prints the Tree of selected object(s) as ASCII art.
# Several styles are available. Tree branch pattern is customizable.
# It can export to clipboard, file or embedded text document.
# This mainly aims at documenting the model.
#
# Version history&nbsp;:
# *0.6&nbsp;: introduce last fork string definition, add new style
# *0.5&nbsp;: beta release
#
#####################################

# -*- coding: utf-8 -*-

__Name__ = 'TreeToAscii'
__Comment__ = 'Prints the Tree of selected object(s) as ASCII art'
__Author__ = 'openBrain'
__Version__ = '0.6'
__Date__ = '2020-03-23'
__License__ = 'LGPL v2'
__Web__ = 'https://wiki.freecad.org/Macro_TreeToAscii'
__Wiki__ = 'https://wiki.freecad.org/Macro_TreeToAscii'
__Icon__ = ''
__Help__ = 'Select object(s) you want to print the tree then run'
__Status__ = 'Beta'
__Requires__ = 'FreeCAD &gt;= 0.17'
__Communication__ = 'https://forum.freecad.org/viewtopic.php?f=22&amp;t=43504'

import FreeCAD as App
import FreeCADGui as Gui
from PySide import QtGui, QtCore  # Special FreeCAD's PySide, which may be PySide2!

PREF_PATH = 'User parameter:BaseApp/Preferences/Mod/TreeToAscii'
PREF_PATTERN = 'TreePattern'
PREF_STYLE = 'TreeStyle'
STYLES = {  # defines styles as NAME&nbsp;: [ branch str, fork str, opt:last fork str]
    'Modern'&nbsp;: [' &#9474; ', ' &#9500; ', ' &#9492; '],  # Unicode U+251C, Unicode U+2502
    'Baroque'&nbsp;: [' &#9474;  ', ' &#9500;&#9472; ',  ' &#9492;&#9472; '],
    'ASCII'&nbsp;: [' | ', ' \\_']
    }
DEF_PATTERN = '{LBL} ({SNAM})'
DEF_STYLE = list(STYLES.keys())[0]

g_ascii_tree=""

def printChildren(objs=None, level=0, baseline=''):
    """Build ASCII tree by recursive call"""
    global g_ascii_tree
    for cnt, obj in enumerate(objs,1):
        data = {
            "LBL"&nbsp;: obj.Label,
            "NAM"&nbsp;: obj.Name,
            "SNAM"&nbsp;: "".join(filter(str.isalpha, obj.Name)),
            "TYP"&nbsp;: obj.TypeId,
            "BTYP"&nbsp;: obj.TypeId.partition('::')[0],
            "STYP"&nbsp;: obj.TypeId.rpartition('::')[-1]
        }
        branch_str = STYLES[gen_style.currentText()][0]
        fork_str = STYLES[gen_style.currentText()][1]
        last_fork_str = STYLES[gen_style.currentText()][-1]
        if cnt == len(objs):
            g_ascii_tree += baseline + last_fork_str
        else:
            g_ascii_tree += baseline + fork_str
        try:
            g_ascii_tree += gen_pattern.text().format(**data)
        except (ValueError, IndexError, KeyError):
            g_ascii_tree = 'Error in generating pattern'
            return
        g_ascii_tree += '\n'
        if cnt == len(objs):
            baselinechi = baseline + ' '*len(branch_str)
        else:
            baselinechi = baseline + branch_str
        printChildren(obj.ViewObject.claimChildren(), level + 1, baselinechi)

def copyToClip():
    """Copies ASCII tree to clipboard"""
    tree_view.selectAll()
    tree_view.copy()
    tree_view.setPlainText("Copied to clipboard")
    QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def saveToFile():
    """Saves ASCII tree to user system file"""
    _path = QtGui.QFileDialog.getSaveFileName()
    if _path[0]:
        save_file = QtCore.QFile(_path[0])
        if save_file.open(QtCore.QFile.ReadWrite):
            save_fileContent = QtCore.QTextStream(save_file)
            save_fileContent &lt;&lt; g_ascii_tree
            save_file.flush()
            save_file.close()
            tree_view.setPlainText("Saved to file&nbsp;: " + _path[0])
        else:
            tree_view.setPlainText("ERROR&nbsp;: Can't open file&nbsp;: " + _path[0])
        QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def embedToText():
    """Stores ASCII tree into an embedded document"""
    text_doc = None
    try:
        text_doc = App.ActiveDocument.addObject("App::TextDocument","ModelTree")
    except:
        tree_view.setPlainText("ERROR&nbsp;: can't create Text document. Maybe your version is too old")
    if text_doc:
        text_doc.Text = g_ascii_tree
        tree_view.setPlainText("Embedded to text document&nbsp;: " + text_doc.Label)
    QtCore.QTimer.singleShot(3000, lambda:tree_view.setPlainText(g_ascii_tree))

def updateTxt():
    """Updates ASCII tree"""
    global g_ascii_tree
    g_ascii_tree=""
    printChildren(Gui.Selection.getSelection())
    tree_view.setPlainText(g_ascii_tree)


def onGenerate():
    """Called when updating ASCII tree"""
    p.SetString(PREF_PATTERN, gen_pattern.text())
    p.SetString(PREF_STYLE, gen_style.currentText())
    updateTxt()

# Get saved parameters or use defaults.
p = App.ParamGet(PREF_PATH)
g_name_pattern = p.GetString(PREF_PATTERN, DEF_PATTERN)
g_tree_style = p.GetString(PREF_STYLE, DEF_STYLE)
if g_tree_style not in STYLES:
    g_tree_style = DEF_STYLE

# Build UI and show
dlg = QtGui.QDialog(Gui.getMainWindow(), QtCore.Qt.Tool)
dlg_layout = QtGui.QVBoxLayout(dlg)
gen_layout = QtGui.QHBoxLayout()
gen_pattern = QtGui.QLineEdit(g_name_pattern, dlg)
gen_pattern.setToolTip("""Defined variables are&nbsp;:
    {LBL}&nbsp;: object Label
    {NAM}&nbsp;: object Name
    {SNAM}&nbsp;: object ShortName (without digits)
    {TYP}&nbsp;: object Type
    {BTYP}&nbsp;: object BaseType
    {STYP}&nbsp;: object ShortType (without base)
If you need to print curly braces, they have to be doubled""")
gen_run = QtGui.QPushButton("Generate",dlg)
gen_run.clicked.connect(onGenerate)
gen_style = QtGui.QComboBox(dlg)
gen_style.addItems(list(STYLES.keys()))
gen_style.setCurrentIndex(list(STYLES.keys()).index(g_tree_style))
gen_layout.addWidget(QtGui.QLabel("Generating pattern: "))
gen_layout.addWidget(gen_pattern)
gen_layout.addWidget(QtGui.QLabel("Style&nbsp;: "))
gen_layout.addWidget(gen_style)
gen_layout.addWidget(gen_run)
tree_view = QtGui.QPlainTextEdit(g_ascii_tree)
tree_view.setReadOnly(True)
tree_view.setMinimumWidth(Gui.getMainWindow().width()/2)
tree_view.setMinimumHeight(Gui.getMainWindow().height()/2)
tree_view.setLineWrapMode(QtGui.QPlainTextEdit.NoWrap)
button_box = QtGui.QDialogButtonBox()
copy_clip_but = QtGui.QPushButton("Copy to clipboard", button_box)
button_box.addButton(copy_clip_but, QtGui.QDialogButtonBox.ActionRole)
copy_clip_but.clicked.connect(copyToClip)
_but = QtGui.QPushButton("Save to file", button_box)
button_box.addButton(_but, QtGui.QDialogButtonBox.ActionRole)
_but.clicked.connect(saveToFile)
store_embed_but = QtGui.QPushButton("Embed in a text file", button_box)
button_box.addButton(store_embed_but, QtGui.QDialogButtonBox.ActionRole)
store_embed_but.clicked.connect(embedToText)
close_dlg_but = QtGui.QPushButton("Close", button_box)
button_box.addButton(close_dlg_but, QtGui.QDialogButtonBox.RejectRole)
button_box.rejected.connect(dlg.reject)
dlg_layout.insertLayout(0,gen_layout)
dlg_layout.addWidget(tree_view)
dlg_layout.addWidget(button_box)
updateTxt()
dlg.exec_()
</pre>
<!-- 
NewPP limit report
Cached time: 20250713100756
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.023 seconds
Real time usage: 0.032 seconds
Preprocessor visited node count: 104/1000000
Post&#8208;expand include size: 1976/2097152 bytes
Template argument size: 282/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 7902/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    3.945      1 -total
 69.96%    2.760      1 Template:Macro/fr
 27.48%    1.084      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:198908-0!canonical and timestamp 20250713100756 and revision id 1611620. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>