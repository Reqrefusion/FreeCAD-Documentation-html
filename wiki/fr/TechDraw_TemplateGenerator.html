<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">TechDraw TemplateGenerator/fr</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-TechDraw+TemplateGenerator&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--complete" title="TechDraw Vorlagengenerator (100% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../TechDraw_TemplateGenerator.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="TechDraw TemplateGenerator (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../pl/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--complete" title="Rysunek Techniczny: Generator szablon&oacute;w (100% translated)" lang="pl" dir="ltr">polski</a></li>
<li><a href="../ru/TechDraw_TemplateGenerator.html" class="mw-pt-progress mw-pt-progress--low" title="&#1058;&#1077;&#1093;&#1085;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1081;&#1063;&#1077;&#1088;&#1090;&#1105;&#1078; (TechDraw) &#1043;&#1077;&#1085;&#1077;&#1088;&#1072;&#1090;&#1086;&#1088;&#1064;&#1072;&#1073;&#1083;&#1086;&#1085;&#1072; (3% translated)" lang="ru" dir="ltr">&#1088;&#1091;&#1089;&#1089;&#1082;&#1080;&#1081;</a></li></ul></div>
<table class="fcinfobox wikitable ct" style="width: 230px; float: right; margin-left: 1em">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;"><span typeof="mw:File"><span><img src="../File/Freecad.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="48" data-file-height="48"></span></span> Tutoriel
</td></tr>
<tr>
<th class="ctOdd">Th&egrave;me
</th></tr>
<tr>
<td class="ctEven">Cr&eacute;er un mod&egrave;le TechDraw &agrave; l'aide d'une macro Python
</td></tr>
<tr>
<th class="ctOdd">Niveau
</th></tr>
<tr>
<td class="ctEven">Des connaissances de base en Python et de structures SVG sont utiles.
</td></tr>
<tr>
<th class="ctOdd">Temps d'ex&eacute;cution estim&eacute;
</th></tr>
<tr>
<td class="ctEven">(ne sait pas)
</td></tr>
<tr>
<th class="ctOdd">Auteurs
</th></tr>
<tr>
<td class="ctEven"><a href="../User;FBXL5.html" title="User:FBXL5">FBXL5</a>
</td></tr>
<tr>
<th class="ctOdd">Version de FreeCAD
</th></tr>
<tr>
<td class="ctEven">0.21 et plus
</td></tr>
<tr>
<th class="ctOdd">Fichiers exemples
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><a href="../fr/Macro_TemplateHelper.html" title="Macro TemplateHelper/fr">Macro TemplateHelper</a>
</td></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr></tbody></table>
<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>Ce tutoriel d&eacute;crit comment g&eacute;n&eacute;rer un mod&egrave;le simple &agrave; utiliser avec l'atelier TechDraw &agrave; partir de quelques lignes de code Python.
</p><p>N'importe quel &eacute;diteur de texte peut &ecirc;tre utilis&eacute; pour coder. Mon choix se porte sur Atom, mais l'&eacute;diteur int&eacute;gr&eacute; de FreeCAD fonctionne bien aussi.
</p><p>Les exemples de code suivants peuvent &ecirc;tre copi&eacute;s et coll&eacute;s dans un fichier texte vide, puis enregistr&eacute;s sous le nom de votre choix en tant que fichier *.py ou *.FCMacro.
</p><p>Un mod&egrave;le fournit un arri&egrave;re-plan pour les t&acirc;ches de dessin et ses dimensions sont utilis&eacute;es par les pilotes d'imprimante pour mettre le dessin &agrave; l'&eacute;chelle correctement.
</p><p>Les mod&egrave;les sont des fichiers svg et une macro doit donc composer quelques lignes de code svg (qui est un sous-ensemble du code xml).
</p><p><b>Remarque&nbsp;:</b> lorsque FreeCAD a &eacute;t&eacute; migr&eacute; de <b>freecadweb.org</b> &agrave; <b>freecad.org</b>, cette page a &eacute;t&eacute; mise &agrave; jour en cons&eacute;quence et le code SVG r&eacute;sultant n'est plus compatible avec les versions de FreeCAD ant&eacute;rieures &agrave; la v0.21. Pour ces versions, vous devez changer manuellement <code>freecad.org</code> en <code>freecadweb.org</code> &agrave; la ligne de d&eacute;claration de l'espace des noms dans le code SVG r&eacute;sultant, sinon les textes &eacute;ditables ne sont pas reconnus.
</p><p><span id="Structure_of_a_simple_blank_page"></span>
</p>
<h2><span id="Structure_d.27une_simple_page_blanche"></span><span class="mw-headline" id="Structure_d'une_simple_page_blanche">Structure d'une simple page blanche</span></h2>
<p>Le format SVG est un sous-ensemble du format XML.
C'est pourquoi un fichier SVG, comme tout fichier XML, se compose de deux parties&nbsp;:
</p>
<ul><li>En-t&ecirc;te, une d&eacute;claration de format</li>
<li>Corps, contient les informations &agrave; afficher et o&ugrave; les placer.</li></ul>
<dl><dd>(je ne sais pas pourquoi il devrait y avoir un titre, le fichier svg est toujours un fichier mod&egrave;le valide sans lui...)</dd></dl>
<p><span id="Head"></span>
</p>
<h3><span id="L.27en-t.C3.AAte"></span><span class="mw-headline" id="L'en-t&ecirc;te">L'en-t&ecirc;te</span></h3>
<p>L'en-t&ecirc;te n'est qu'une ligne pour d&eacute;clarer quelle version du langage XML un interpr&eacute;teur doit utiliser pour traiter les instructions du corps.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
</pre></div>
<p><span id="Body"></span>
</p>
<h3><span class="mw-headline" id="Le_corps">Le corps</span></h3>
<p>Le corps commence par une balise d'ouverture qui contient des informations sur les espaces de nom et sur la taille du mod&egrave;le et l'endroit o&ugrave; le placer. Et il se termine par une balise de fermeture.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<dl><dd><b>xmlns=</b> "<a rel="nofollow" class="external free" href="http://www.w3.org/2000/svg">http://www.w3.org/2000/svg</a>"&nbsp;: lien externe vers l'espace de noms xml pour rechercher les commandes xml standard</dd>
<dd><b>version=</b> "1.1"&nbsp;: la version de xml utilis&eacute;e est 1.1</dd>
<dd><b>xmlns:freecad=</b>"...=Svg_Namespace"&nbsp;: lien externe vers la page wiki <a href="../fr/Svg_Namespace.html" title="Svg Namespace/fr">Svg Namespace</a> de FreeCAD. Le lien n'est pas utilis&eacute; pour r&eacute;cup&eacute;rer des informations ou des valeurs au moment de l'ex&eacute;cution, mais c'est la cl&eacute; pour activer les attributs personnalis&eacute;s, par exemple ceux pour les textes &eacute;ditables.</dd>
<dd>"freecad&nbsp;:" sera pr&eacute;fix&eacute; &agrave; ces noms d'attributs personnalis&eacute;s.</dd>
<dd><b>width=</b> "420mm"&nbsp;: largeur de la zone de dessin</dd>
<dd><b>height=</b> "297mm"&nbsp;: hauteur de la zone de dessin</dd>
<dd><b>viewBox=</b> "0 0 420 297"&nbsp;: position du coin sup&eacute;rieur gauche (0;0) et du coin inf&eacute;rieur droit (420;297) dans l'espace de construction svg (en unit&eacute;s svg).</dd>
<dd>Width, height et viewBox dans cette combinaison d&eacute;finissent 1 unit&eacute; svg &agrave; 1 mm pour l'ensemble du document. Une unit&eacute; dimensionnelle peut &ecirc;tre omise &agrave; partir de maintenant.</dd>
<dd>Dans ce cas, 420 et 297 donnent une page A3. Personnalisez ces valeurs pour g&eacute;n&eacute;rer d'autres tailles de page.</dd></dl>
<p>Pour une page blanche de taille DIN A3 en orientation paysage, c'est tout.
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>
<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width=</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/svg&gt;</span>
</pre></div>
<p><span id="Python_code..."></span>
</p>
<h2><span class="mw-headline" id="Code_Python...">Code Python...</span></h2>
<p>Le codage commence par un cadre contenant une fonction principale distincte&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Here is where the magic happens"""</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p><span id="..._to_create_a_blank_page"></span>
</p>
<h3><span id="...pour_cr.C3.A9er_une_page_blanche"></span><span class="mw-headline" id="...pour_cr&eacute;er_une_page_blanche">...pour cr&eacute;er une page blanche</span></h3>
<p>Le processus de cr&eacute;ation d'un mod&egrave;le consiste &agrave;&nbsp;:
</p>
<ul><li>Localiser le dossier du mod&egrave;le.</li>
<li>Ouvrir un fichier en &eacute;criture pour cr&eacute;er un fichier svg &agrave; partir de z&eacute;ro, &eacute;crire la ligne d'en-t&ecirc;te et fermer le fichier dans un premier temps.</li>
<li>Et ensuite, ouvrir le fichier &agrave; plusieurs reprises pour ajouter d'autres segments, en le refermant &agrave; chaque fois.</li></ul>
<p>La macro est compos&eacute;e de plusieurs fonctions qui sont appel&eacute;es &agrave; partir de la section principale.<br>
Des fonctions suppl&eacute;mentaires peuvent &ecirc;tre ins&eacute;r&eacute;es avant la fonction EndSvg et les appels n&eacute;cessaires sont plac&eacute;s avant l'appel &agrave; EndSvg().<br>
Nous devons surveiller le nombre d'espaces utilis&eacute;s avec les op&eacute;rations d'&eacute;criture pour une indentation correcte.
</p>
<h4><span id="pathToTemplate.28.29"></span><span class="mw-headline" id="pathToTemplate()">pathToTemplate()</span></h4>
<p>Avant que le code ne soit g&eacute;n&eacute;r&eacute;, un dossier est n&eacute;cessaire pour stocker le nouveau fichier mod&egrave;le, et un nom de fichier doit &ecirc;tre d&eacute;fini.
</p><p>L'utilisateur doit avoir s&eacute;lectionn&eacute; un dossier de mod&egrave;le. Son chemin d'acc&egrave;s est alors enregistr&eacute; dans les pr&eacute;f&eacute;rences de TechDraw.<br>
Il n'est pas n&eacute;cessaire de savoir o&ugrave; sont stock&eacute;es les pr&eacute;f&eacute;rences, car FreeCAD dispose de commandes permettant d'adresser directement les param&egrave;tres n&eacute;cessaires.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>
</pre></div>
<p><b>parameter_path</b> re&ccedil;oit le chemin vers le "dossier" dans le fichier de configuration o&ugrave; se trouve le param&egrave;tre "TemplateDir". <br>
<b>template_path</b> re&ccedil;oit le contenu de "TemplateDir" qui est le chemin vers le r&eacute;pertoire du mod&egrave;le. <br> 
<b>template_name</b> re&ccedil;oit le nom du mod&egrave;le &agrave; cr&eacute;er.
</p><p>Maintenant, le nom du mod&egrave;le doit &ecirc;tre associ&eacute; au chemin du mod&egrave;le d'une mani&egrave;re qui soit compatible avec les syst&egrave;mes d'exploitation bas&eacute;s sur unix et Windows.<br>
Ceci est fait avec la commande "os.path.join" et stock&eacute; dans le <b>template_file</b>. Pour activer cette commande, une instruction "import os" est n&eacute;cessaire.
</p>
<h4><span id="createSvgFile.28.29"></span><span class="mw-headline" id="createSvgFile()">createSvgFile()</span></h4>
<p>Cette op&eacute;ration cr&eacute;e un nouveau fichier mod&egrave;le et enregistre la ligne d'en-t&ecirc;te xml.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<h4><span id="startSvg.28.29"></span><span class="mw-headline" id="startSvg()">startSvg()</span></h4>
<p>Cette instruction ajoute le fichier mod&egrave;le et cr&eacute;e la balise d'ouverture svg, y compris ses attributs.<br>
Chaque instruction d'&eacute;criture contient une seule ligne de code svg se terminant par "\n", le marqueur pour CR/LF.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<h4><span id="endSvg.28.29"></span><span class="mw-headline" id="endSvg()">endSvg()</span></h4>
<p>Cette instruction ajoute ensuite le fichier mod&egrave;le et cr&eacute;e la balise de fermeture svg, ce qui termine le code du mod&egrave;le.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<h4><span id="main.28.29"></span><span class="mw-headline" id="main()">main()</span></h4>
<p>La fonction main() appelle les fonctions et transmet certains param&egrave;tres.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>
</pre></div>
<p>Dans cet exemple, <code>format_width</code> et <code>format_height</code> sont des dimensions cod&eacute;es en dur, les deux lignes inutiles marquent les points o&ugrave; d'autres moyens de r&eacute;cup&eacute;ration des donn&eacute;es de format pourraient placer leur contenu.
</p>
<div class="mw-collapsible mw-collapsed toccolours">
<h4><span id="La_macro_compl.C3.A8te_de_la_page_blanche"></span><span class="mw-headline" id="La_macro_compl&egrave;te_de_la_page_blanche">La macro compl&egrave;te de la page blanche</span></h4>
<p>Cette macro se compose de segments de code comme ci-dessus, pr&ecirc;ts &agrave; &ecirc;tre ex&eacute;cut&eacute;s.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an empty A3 template"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div> 
</div> 
<p><br>
<span id="..._to_create_a_page_with_some_ink"></span>
</p>
<h3><span id="...pour_cr.C3.A9er_une_page_avec_du_contenu"></span><span class="mw-headline" id="...pour_cr&eacute;er_une_page_avec_du_contenu">...pour cr&eacute;er une page avec du contenu</span></h3>
<p>Pour faire un dessin &agrave; partir d'une page blanche, nous avons besoin de&nbsp;:
</p>
<dl><dd><ul><li>de cadres, c'est-&agrave;-dire des rectangles cr&eacute;&eacute;s avec l'instruction <b>rect</b>.</li>
<li>d'un cartouche et de lignes cr&eacute;&eacute;es avec l'instruction <b>path</b>.</li>
<li>de textes simples pour les index et l'&eacute;tiquetage des cellules du bloc titre</li>
<li>de textes modifiables comme le num&eacute;ro ou le nom de la pi&egrave;ce.</li></ul></dd></dl>
<p>Normalement, ces &eacute;l&eacute;ments graphiques sont utilis&eacute;s de mani&egrave;re r&eacute;p&eacute;t&eacute;e et le code de g&eacute;n&eacute;ration est donc divis&eacute; en quatre fonctions&nbsp;:
</p>
<ul><li>svgRect() pour les &eacute;l&eacute;ments de cadre rectangulaire.</li>
<li>svgPath() pour les &eacute;l&eacute;ments de ligne droite.</li>
<li>svgText() pour les textes statiques.</li>
<li>ediText() pour les textes modifiables.</li></ul>
<p>Toutes les fonctions sont plac&eacute;es &agrave; l'int&eacute;rieur de la macro ci-dessus avant la fonction main() et leurs appels de fonction sont ins&eacute;r&eacute;s dans la fonction main() entre <code>startSvg(...)</code> et <code>endSvg(...)</code>.
</p>
<h4><span id="svgRect.28.29"></span><span class="mw-headline" id="svgRect()">svgRect()</span></h4>
<p>Pour dessiner un rectangle, il suffit d'appeler la fonction <b>svgRect</b> et de lui transmettre les valeurs de largeur, de hauteur et de position du coin sup&eacute;rieur gauche. C'est plus lisible &agrave; cet endroit que si svg_line contenait toute la ligne de code svg.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>L'instruction svg est divis&eacute;e pour rester dans la longueur des lignes recommand&eacute;e par Python, il en r&eacute;sultera n&eacute;anmoins une seule ligne svg.
</p><p>Avec plus d'exp&eacute;rience en Python, une autre fa&ccedil;on de remplir le contenu des variables est apparue&nbsp;: la fonction int&eacute;gr&eacute;e <code>.format()</code> en relation avec les param&egrave;tres nomm&eacute;s <code>{nom}</code>, index&eacute;s <code>{0}</code> ou vides <code>{}</code>. ou des espaces vides <code>{}</code>. Les noms &agrave; caract&egrave;re unique modifient la fonction comme suit&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="si">{W}</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="si">{H}</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">W</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">height</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
<p>(Les crochets/parenth&egrave;ses sont facultatifs tant que nous n'avons pas besoin de diviser la cha&icirc;ne <b>svg_line</b>)
</p>
<h4><span id="svgPath.28.29"></span><span class="mw-headline" id="svgPath()">svgPath()</span></h4>
<p>Pour dessiner une ligne, il suffit d'appeler la fonction <b>svgPath</b> et de fournir les coordonn&eacute;es du point de d&eacute;part et du point d'arriv&eacute;e d'une ligne.
</p><p>Au lieu des coordonn&eacute;es du point final, nous pouvons remettre une &eacute;tiquette pour dessiner une ligne horizontale (h) ou verticale (v) suivie de la longueur de la ligne ou l'&eacute;tiquette pour dessiner une ligne horizontale (H) ou verticale (V) suivie de l'ordonn&eacute;e x ou y du point final.
</p><p>Chaque chemin commence &agrave; l'origine et la premi&egrave;re action est un mouvement avec le "stylo lev&eacute;" (pas de dessin) vers le point de d&eacute;part. Dans ce cas, le mouvement relatif et le mouvement absolu sont identiques et il n'est donc pas important que l'&eacute;tiquette m (m-tag? ndlt) soit en majuscule ou en minuscule.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>La version alternative avec des espaces r&eacute;serv&eacute;s et <code>.format()</code>&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> </span><span class="si">{C}</span><span class="s2"> </span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m </span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2"> l </span><span class="si">{C}</span><span class="s2">,</span><span class="si">{D}</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">x2</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
<h4><span id="svgText.28.29"></span><span class="mw-headline" id="svgText()">svgText()</span></h4>
<p>Pour dessiner un morceau de texte, il suffit d'appeler la fonction <b>svgText</b> et de lui fournir les coordonn&eacute;es du point d'ancrage du texte, la cha&icirc;ne de texte elle-m&ecirc;me et, &eacute;ventuellement, un angle pour le texte pivot&eacute;. Pour faire pivoter un texte, une instruction de transformation doit &ecirc;tre ins&eacute;r&eacute;e dans chaque balise de texte s&eacute;par&eacute;ment&nbsp;; les centres de rotation sont fix&eacute;s aux m&ecirc;mes coordonn&eacute;es que les points d'ancrage du texte.
</p><p>(L'alignement du texte est contr&ocirc;l&eacute; par la balise de groupe qui l'entoure ou align&eacute; &agrave; gauche par d&eacute;faut).
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>La version alternative avec des espaces r&eacute;serv&eacute;s et <code>.format()</code> :La version alternative avec des espaces r&eacute;serv&eacute;s et <code>.format()</code>&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span><span class="p">)</span>
</pre></div>
<h4><span id="ediText.28.29"></span><span class="mw-headline" id="ediText()">ediText()</span></h4>
<p>Pour dessiner un morceau de texte &eacute;ditable, il suffit d'appeler la fonction <b>ediText</b> et de lui fournir un nom, les coordonn&eacute;es du point d'ancrage du texte, la cha&icirc;ne de texte elle-m&ecirc;me, et &eacute;ventuellement un angle pour le texte pivot&eacute;. Pour faire pivoter un texte, une instruction de transformation doit &ecirc;tre ins&eacute;r&eacute;e dans chaque balise de texte s&eacute;par&eacute;ment&nbsp;; les centres de rotation sont fix&eacute;s aux m&ecirc;mes coordonn&eacute;es que les points d'ancrage du texte.
</p><p>FreeCAD cr&eacute;e un objet dictionnaire avec chaque mod&egrave;le ins&eacute;r&eacute; et chaque entr&eacute;e poss&egrave;de un nom (cl&eacute;) et une valeur.
</p><p>(L'alignement du texte est contr&ocirc;l&eacute; par la balise de groupe qui l'entoure ou align&eacute; &agrave; gauche par d&eacute;faut).
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>
</pre></div>
<p>La version alternative avec des espaces r&eacute;serv&eacute;s et <code>.format()</code>&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{EN}</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">" x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="si">{EN}</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span>
            <span class="s2">" x=</span><span class="se">\"</span><span class="si">{X}</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="si">{Y}</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate(</span><span class="si">{SA}</span><span class="s2">,"</span> <span class="o">+</span>
            <span class="s2">"</span><span class="si">{X}</span><span class="s2">,</span><span class="si">{Y}</span><span class="s2">)</span><span class="se">\"</span><span class="s2">&gt; &lt;tspan&gt;</span><span class="si">{SV}</span><span class="s2">&lt;/tspan&gt; &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">EN</span> <span class="o">=</span> <span class="n">entry_name</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">SV</span> <span class="o">=</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">SA</span> <span class="o">=</span> <span class="n">str_angle</span>
        <span class="p">)</span>
</pre></div>
<p><span id="createXxxx_functions"></span>
</p>
<h3><span class="mw-headline" id="Fonctions_createXxxx">Fonctions createXxxx</span></h3>
<p>Ces fonctions commencent par du code pour ouvrir un fichier en mode append et pour &eacute;crire la balise d'ouverture de groupe.
</p><p>Suit une section permettant de d&eacute;finir et de calculer des valeurs, ainsi que des instructions d'&eacute;criture appelant les fonctions susmentionn&eacute;es afin de g&eacute;n&eacute;rer du code svg.
</p><p>Et enfin la balise de fermeture de groupe suivie d'une instruction pour fermer le fichier.
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>
</pre></div>
<p><span id="Resulting_macro"></span>
</p>
<h3><span id="Macro_r.C3.A9sultante"></span><span class="mw-headline" id="Macro_r&eacute;sultante">Macro r&eacute;sultante</span></h3>
<div class="mw-collapsible mw-collapsed toccolours">
<p>Cette macro ajoute certains &eacute;l&eacute;ments graphiques de base n&eacute;cessaires &agrave; l'&eacute;laboration de mod&egrave;les appropri&eacute;s, &agrave; savoir des &eacute;l&eacute;ments de ligne, des textes et des textes modifiables.
</p>
<div class="mw-collapsible-content">
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#! python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># (c) 2024 Your name LGPL</span>

<span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># to enable the use of os.path.join()</span>


<span class="c1"># - SVG creation -</span>
<span class="k">def</span> <span class="nf">createSvgFile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create a file and insert a header line (with t as the space saving variant of template)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>  <span class="c1"># w = write, overwrites existing files</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;?xml version=</span><span class="se">\"</span><span class="s2">1.0</span><span class="se">\"</span><span class="s2"> encoding=</span><span class="se">\"</span><span class="s2">UTF-8</span><span class="se">\"</span><span class="s2"> standalone=</span><span class="se">\"</span><span class="s2">no</span><span class="se">\"</span><span class="s2">?&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">startSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Create svg-tag including namespace and format definitions</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1"># a = append, new lines are added at the end of an existing file</span>
    <span class="c1"># encoding="utf-8", helps with special characters if the Python interpreter is in ASCII mode</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;svg</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Namespace declarations</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns=</span><span class="se">\"</span><span class="s2">http://www.w3.org/2000/svg</span><span class="se">\"</span><span class="s2"> version=</span><span class="se">\"</span><span class="s2">1.1</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  xmlns:freecad=</span><span class="se">\"</span><span class="s2">http://www.freecad.org/wiki/index.php?title=Svg_Namespace</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- Format definition</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  width =</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"mm</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"  viewBox=</span><span class="se">\"</span><span class="s2">0 0 "</span> <span class="o">+</span> <span class="n">sheet_width</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">sheet_height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1"># identical values for width and height and Viewbox' width and height</span>
    <span class="c1"># will synchronise mm and svg-units</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">endSvg</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Create closing svg-tag</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"&lt;/svg&gt;"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">svgRect</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Ggenerates an svg-instruction to draw a rectangle with the given values</span>
    <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">"&lt;rect width=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">width</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> height=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">height</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgPath</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>
    <span class="c1"># Generates an svg-instruction to draw a path element (line) with the given values</span>
    <span class="k">if</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"v"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"V"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"h"</span> <span class="ow">or</span> <span class="n">x2</span> <span class="o">==</span> <span class="s2">"H"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">" "</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;path d=</span><span class="se">\"</span><span class="s2">m "</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">+</span> <span class="s2">" l "</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> /&gt;"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">svgText</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place a text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span>
            <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">ediText</span><span class="p">(</span><span class="n">entry_name</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">str_angle</span><span class="o">=</span><span class="s2">"0"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""</span>
<span class="sd">    Generates an svg-instruction to place an editable text element with the given values.</span>
<span class="sd">    Optional str_angle enables vertical and arbitrarily rotated editable texts</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">str_angle</span> <span class="o">==</span> <span class="s2">"0"</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span> <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">svg_line</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">"&lt;text freecad:editable=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">entry_name</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> x=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> y=</span><span class="se">\"</span><span class="s2">"</span> <span class="o">+</span> <span class="n">y</span>
            <span class="o">+</span> <span class="s2">"</span><span class="se">\"</span><span class="s2"> transform=</span><span class="se">\"</span><span class="s2">rotate("</span> <span class="o">+</span> <span class="n">str_angle</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;  &lt;tspan&gt;"</span>
            <span class="o">+</span> <span class="n">str_value</span> <span class="o">+</span> <span class="s2">"&lt;/tspan&gt;  &lt;/text&gt;"</span>
            <span class="p">)</span>
    <span class="k">return</span> <span class="n">svg_line</span>

<span class="k">def</span> <span class="nf">createFrame</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
    <span class="c1"># Creates rectangles for sheet frame and drawing area</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">drawing-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner of inner Frame, drawing area</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">20</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- calculate upper left corner outer frame, sheet frame</span>
    <span class="n">frame_x</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">frame_y</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="c1">#- frame dimensions</span>
    <span class="n">frame_width</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span><span class="o">-</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">frame_height</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1">#- frame rectangle</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      "</span> <span class="o">+</span> <span class="n">svgRect</span><span class="p">(</span><span class="n">frame_width</span><span class="p">,</span> <span class="n">frame_height</span><span class="p">,</span> <span class="n">frame_x</span><span class="p">,</span> <span class="n">frame_y</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createTitleBlock</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates a title block and transfers it to the position according to the sheet dimensions"""</span>
    <span class="c1">#- calculate title block origin (lower left corner), offset from page origin</span>
    <span class="n">tbX</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">tbY</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group to transfer all included title block elements at once</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      transform=</span><span class="se">\"</span><span class="s2">translate("</span> <span class="o">+</span> <span class="n">tbX</span> <span class="o">+</span> <span class="s2">","</span> <span class="o">+</span> <span class="n">tbY</span> <span class="o">+</span> <span class="s2">")</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block line framework</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-frame</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">fill:none;stroke:#000000;stroke-width:0.35;</span><span class="se">\</span>
<span class="s2">stroke-linecap:miter;stroke-miterlimit:4</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">,</span><span class="s2">"180"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"-30"</span><span class="p">,</span><span class="s2">"h"</span><span class="p">,</span><span class="s2">"155"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgPath</span><span class="p">(</span><span class="s2">"155"</span><span class="p">,</span><span class="s2">"  0"</span><span class="p">,</span><span class="s2">"v"</span><span class="p">,</span><span class="s2">"-63"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="c1">#- sub-group of title block static texts (left-aligned by default)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-text-non-editable</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        style=</span><span class="se">\"</span><span class="s2">font-size:5.0;text-anchor:start;fill:#000000;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-43.5 "</span><span class="p">,</span><span class="s2">"Some static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"  4.5"</span><span class="p">,</span><span class="s2">"-13.5 "</span><span class="p">,</span><span class="s2">"More static text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"        "</span> <span class="o">+</span> <span class="n">svgText</span><span class="p">(</span><span class="s2">"162.5"</span><span class="p">,</span><span class="s2">"-3.5 "</span><span class="p">,</span><span class="s2">"Vertical static text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      &lt;/g&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">createEditableText</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">sheet_width</span><span class="p">,</span> <span class="n">sheet_height</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Creates editable texts positioned according to the page origin"""</span>
    <span class="c1">#- calculate offset to titleblock origin</span>
    <span class="n">edX</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_width</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">-</span> <span class="mi">180</span> <span class="c1"># 180 according to DIN EN ISO 7200</span>
    <span class="n">edY</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sheet_height</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span>
    <span class="n">t</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">"utf-8"</span><span class="p">)</span>
    <span class="c1">#- group editable texts using the same attributes</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;g id=</span><span class="se">\"</span><span class="s2">titleblock-editable-texts</span><span class="se">\"\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"      style=</span><span class="se">\"</span><span class="s2">font-size:7.0;text-anchor:start;fill:#0000d0;</span><span class="se">\</span>
<span class="s2">font-family:osifont</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-1"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">43.5</span><span class="p">),</span><span class="s2">"Some editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-2"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">60</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">13.5</span><span class="p">),</span><span class="s2">"More editable text"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
        <span class="s2">"      "</span> <span class="o">+</span> <span class="n">ediText</span><span class="p">(</span><span class="s2">"EdiText-3"</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">edX</span> <span class="o">+</span> <span class="mi">173</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="n">edY</span> <span class="o">-</span> <span class="mf">4.5</span><span class="p">),</span><span class="s2">"90&deg; editable text"</span><span class="p">,</span><span class="s2">"-90"</span><span class="p">)</span>
        <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>
        <span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">"    &lt;/g&gt;</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">close</span>

<span class="k">def</span> <span class="nf">pathToTemplate</span><span class="p">(</span><span class="n">template_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Link a given template name to the path of the template folder"""</span>
    <span class="c1">#- Get the path to the template folder that is set in the FreeCAD parameters</span>
    <span class="n">parameter_path</span> <span class="o">=</span> <span class="n">FreeCAD</span><span class="o">.</span><span class="n">ParamGet</span><span class="p">(</span><span class="s2">"User parameter:BaseApp/Preferences/Mod/TechDraw/Files"</span><span class="p">)</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">parameter_path</span><span class="o">.</span><span class="n">GetString</span><span class="p">(</span><span class="s2">"TemplateDir"</span><span class="p">)</span>
    <span class="c1">#- Link template_path and template_name for any OS</span>
    <span class="n">path_to_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">template_path</span><span class="p">,</span> <span class="n">template_name</span><span class="p">)</span>  <span class="c1"># to join path segments OS neutral</span>
    <span class="k">return</span> <span class="n">path_to_file</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""This one creates an A3 template with simple frame and title block"""</span>
    <span class="c1">#- Set the name of the template file and get its location</span>
    <span class="n">template_file</span> <span class="o">=</span> <span class="n">pathToTemplate</span><span class="p">(</span><span class="s2">"MyTemplate.svg"</span><span class="p">)</span>  <span class="c1"># Change the template name here</span>
    <span class="c1">#- Here starts the compiling of the svg file</span>
    <span class="n">createSvgFile</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># overwrites existing File</span>
    <span class="c1">#- Set sheet format (DIN A3)</span>
    <span class="n">format_width</span>  <span class="o">=</span> <span class="s2">"420"</span>
    <span class="n">format_height</span> <span class="o">=</span> <span class="s2">"297"</span>
    <span class="n">startSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>  <span class="c1"># adds svg start tag</span>
    <span class="n">createFrame</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createTitleBlock</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">createEditableText</span><span class="p">(</span><span class="n">template_file</span><span class="p">,</span> <span class="n">format_width</span><span class="p">,</span> <span class="n">format_height</span><span class="p">)</span>
    <span class="n">endSvg</span><span class="p">(</span><span class="n">template_file</span><span class="p">)</span>  <span class="c1"># adds svg end tag</span>
    <span class="c1"># At this point a new SVG-file is generated and saved</span>
    <span class="k">return</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="c1"># This will be true only if the file is "executed"</span>
    <span class="c1"># but not if imported as module</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Et voici le code svg qui sort de cette macro&nbsp;:
</p>
<div class="mw-highlight mw-highlight-lang-xml mw-content-ltr" dir="ltr"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span>

<span class="nt">&lt;svg</span>
<span class="w">  </span><span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span><span class="w"> </span><span class="na">version=</span><span class="s">"1.1"</span>
<span class="w">  </span><span class="na">xmlns:freecad=</span><span class="s">"http://www.freecad.org/wiki/index.php?title=Svg_Namespace"</span>
<span class="w">  </span><span class="na">width =</span><span class="s">"420mm"</span>
<span class="w">  </span><span class="na">height=</span><span class="s">"297mm"</span>
<span class="w">  </span><span class="na">viewBox=</span><span class="s">"0 0 420 297"</span><span class="nt">&gt;</span>
<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"drawing-frame"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.5;stroke-linecap:round"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"390"</span><span class="w"> </span><span class="na">height=</span><span class="s">"277"</span><span class="w"> </span><span class="na">x=</span><span class="s">"20"</span><span class="w"> </span><span class="na">y=</span><span class="s">"10"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;rect</span><span class="w"> </span><span class="na">width=</span><span class="s">"400"</span><span class="w"> </span><span class="na">height=</span><span class="s">"287"</span><span class="w"> </span><span class="na">x=</span><span class="s">"15"</span><span class="w"> </span><span class="na">y=</span><span class="s">"5"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock"</span>
<span class="w">      </span><span class="na">transform=</span><span class="s">"translate(230,287)"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-frame"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"fill:none;stroke:#000000;stroke-width:0.35;stroke-linecap:miter;stroke-miterlimit:4"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,  0 l   0,-63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-63 l 180,  0"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m   0,-30 h 155"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;path</span><span class="w"> </span><span class="na">d=</span><span class="s">"m 155,  0 v -63"</span><span class="w"> </span><span class="nt">/&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">      </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-text-non-editable"</span>
<span class="w">        </span><span class="na">style=</span><span class="s">"font-size:5.0;text-anchor:start;fill:#000000;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-43.5 "</span><span class="nt">&gt;</span>Some<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"  4.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-13.5 "</span><span class="nt">&gt;</span>More<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">        </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">x=</span><span class="s">"162.5"</span><span class="w"> </span><span class="na">y=</span><span class="s">"-3.5 "</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,162.5,-3.5 )"</span><span class="nt">&gt;</span>Vertical<span class="w"> </span>static<span class="w"> </span>text<span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;/g&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="w">    </span><span class="nt">&lt;g</span><span class="w"> </span><span class="na">id=</span><span class="s">"titleblock-editable-texts"</span>
<span class="w">      </span><span class="na">style=</span><span class="s">"font-size:7.0;text-anchor:start;fill:#0000d0;font-family:osifont"</span><span class="nt">&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-1"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"243.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>Some<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-2"</span><span class="w"> </span><span class="na">x=</span><span class="s">"290"</span><span class="w"> </span><span class="na">y=</span><span class="s">"273.5"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>More<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">      </span><span class="nt">&lt;text</span><span class="w"> </span><span class="na">freecad:editable=</span><span class="s">"EdiText-3"</span><span class="w"> </span><span class="na">x=</span><span class="s">"403"</span><span class="w"> </span><span class="na">y=</span><span class="s">"282.5"</span><span class="w"> </span><span class="na">transform=</span><span class="s">"rotate(-90,403,282.5)"</span><span class="nt">&gt;</span><span class="w">  </span><span class="nt">&lt;tspan&gt;</span>90&deg;<span class="w"> </span>editable<span class="w"> </span>text<span class="nt">&lt;/tspan&gt;</span><span class="w">  </span><span class="nt">&lt;/text&gt;</span>
<span class="w">    </span><span class="nt">&lt;/g&gt;</span>

<span class="nt">&lt;/svg&gt;</span>
</pre></div>
</div> 
</div> 
<p>Et ce &agrave; quoi il devrait ressembler une fois ins&eacute;r&eacute; (avec un bloc titre agrandi)&nbsp;:
</p><p><span typeof="mw:File"><a href="../index.php?title=TechDraw_TemplateGenerator.png&amp;filetimestamp=20240121203255&amp;.html" class="mw-file-description"><img src="../File/TechDraw_TemplateGenerator.png" decoding="async" width="600" height="429" class="mw-file-element" data-file-width="1400" data-file-height="1000"></a></span>
</p><p>La coloration en bleu des textes modifiables est un choix personnel qui permet de distinguer plus facilement les textes statiques des textes modifiables sur le dessin fini.
</p>
<!-- 
NewPP limit report
Cached time: 20260111153425
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.127 seconds
Real time usage: 0.555 seconds
Preprocessor visited node count: 465/1000000
Post&#8208;expand include size: 3063/2097152 bytes
Template argument size: 21112/2097152 bytes
Highest expansion depth: 4/100
Expensive parser function count: 21/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 100638/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   73.682      1 -total
 69.82%   51.447     21 Template:Code
 14.03%   10.338     15 Template:Incode
  8.51%    6.270      1 Template:TutorialInfo/fr
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:269039-0!canonical and timestamp 20260111153425 and revision id 1623228. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>