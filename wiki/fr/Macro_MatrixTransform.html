<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro MatrixTransform/fr</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="wiki//Macro_MatrixTransform.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro MatrixTransform (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="wiki/it//Macro_MatrixTransform.html" class="mw-pt-progress mw-pt-progress--complete" title="Macro Trasformazioni (100% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="wiki/pl//Macro_MatrixTransform.html" class="mw-pt-progress mw-pt-progress--stub" title="Makrodefinicja: Przekszta&#322;cenie szyku (6% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../File/Macro_MatrixTransform.png" class="mw-file-description"><img src="../File/Macro_MatrixTransform.png" decoding="async" width="32" height="32"></a></span><span> </span>
MatrixTransform
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Transforme unobjet en modifiant la matrice 3x3 (parametrique).<br> <span style="background-color:#ff0000; color:#ffff00;">Cette macro est compos&eacute;e de 2 macro: <b>MatrixTransform.FCMacro</b> (lanceur) et <b>MatrixTransform.py</b> (ex&eacute;cuteur).</span> <br> Le <b>.FCMacro</b> est install&eacute; avec AddonManager vous devez installer la macro <b>.py</b> manuellement. <br> Lien des deux macros: <br> <a rel="nofollow" class="external text" href="https://github.com/DeepSOIC/FreeCAD-Macros/raw/master/MatrixTransform/MatrixTransform.FCMacro">MatrixTransform.FCMacro</a> (lanceur) <br> <a rel="nofollow" class="external text" href="https://github.com/DeepSOIC/FreeCAD-Macros/raw/master/MatrixTransform/MatrixTransform.py">MatrixTransform.py</a> (ex&eacute;cuteur)<br><br>Version macro&nbsp;: 1.1<br>Date derni&egrave;re modification&nbsp;: 2024-12-09<br>Version FreeCAD&nbsp;: All<br>T&eacute;l&eacute;chargement&nbsp;: <a rel="nofollow" class="external text" href="https://www.freecadweb.org/wiki/images/d/db/Macro_MatrixTransform.png">ToolBar Icon</a><br>Auteur: DeepSOIC<br>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="wiki//User;DeepSOIC.html" title="User:DeepSOIC">DeepSOIC</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://www.freecadweb.org/wiki/images/d/db/Macro_MatrixTransform.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="wiki/fr//Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="wiki/fr//How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="wiki/fr//Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.1
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2024-12-09
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">All
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Utilisation"><span class="tocnumber">3</span> <span class="toctext">Utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Exemple_de_matrices"><span class="tocnumber">3.1</span> <span class="toctext">Exemple de matrices</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Pas_de_transformation"><span class="tocnumber">3.1.1</span> <span class="toctext">Pas de transformation</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Echelle_non_uniforme"><span class="tocnumber">3.1.2</span> <span class="toctext">Echelle non uniforme</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Partage"><span class="tocnumber">3.1.3</span> <span class="toctext">Partage</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Script"><span class="tocnumber">4</span> <span class="toctext">Script</span></a></li>
</ul>
</div>

</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Applique une transformation lin&eacute;aire d&eacute;finie par une matrice 3x3 &agrave; une forme. Il est possible de:
</p>
<ul><li>appliquer une mise &agrave; l'&eacute;chelle non lin&eacute;aire &agrave; une forme</li>
<li>cisailler une forme</li>
<li>faire pivoter une forme</li></ul>
<p>La transformation dans la macro est lin&eacute;aire. Les lignes restent droites, les plans restent plans, les choses parall&egrave;les restent parall&egrave;les, seuls les angles sont d&eacute;form&eacute;s.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="wiki//Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/DeepSOIC/FreeCAD-Macros/master/MatrixTransform/MatrixTransform.FCMacro">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "https://raw.githubusercontent.com/DeepSOIC/FreeCAD-Macros/master/MatrixTransform/MatrixTransform.FCMacro" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("https://raw.githubusercontent.com/DeepSOIC/FreeCAD-Macros/master/MatrixTransform/MatrixTransform.FCMacro")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/DeepSOIC/FreeCAD-Macros/master/MatrixTransform/MatrixTransform.FCMacro">https://raw.githubusercontent.com/DeepSOIC/FreeCAD-Macros/master/MatrixTransform/MatrixTransform.FCMacro</a>"&gt;raw code&lt;/a&gt;</div>
<p><br>
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>T&eacute;l&eacute;chargez ces deux fichiers et enregistrez-les dans votre r&eacute;pertoire de macros:
</p><p><a rel="nofollow" class="external text" href="https://github.com/DeepSOIC/FreeCAD-Macros/raw/master/MatrixTransform/MatrixTransform.FCMacro">MatrixTransform.FCMacro</a>
</p><p><a rel="nofollow" class="external text" href="https://github.com/DeepSOIC/FreeCAD-Macros/raw/master/MatrixTransform/MatrixTransform.py">MatrixTransform.py</a>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<ol><li>S&eacute;lectionnez la forme &agrave; transformer</li>
<li>Dans le menu FreeCAD: Macro &rarr; Macros ... &rarr; ouble-cliquez sur MatrixTransform.FCMacro. Un nouvel objet sera cr&eacute;&eacute;.</li>
<li>S&eacute;lectionnez le nouvel objet et modifiez les propri&eacute;t&eacute;s v1, v2, v3 de l'onglet Donn&eacute;es pour d&eacute;finir la matrice de transformation.</li></ol>
<p>La Matrix est d&eacute;finies par trois vecteurs:
</p>
<pre>          v1x   v2x   v3x                  
   M = (  v1y   v2y   v3y )                  
          v1z   v2z   v3z                  
</pre>
<p>Ici, v1,v2,v3 sont les secteurs d&eacute;finis dans les propri&eacute;t&eacute;s. Elles correspondent &agrave; la nouvelle direction par rapport aux axes originaux X,Y,Z.
</p><p><span id="example_matrices"></span>
</p>
<h3><span class="mw-headline" id="Exemple_de_matrices">Exemple de matrices</span></h3>
<h4><span class="mw-headline" id="Pas_de_transformation">Pas de transformation</span></h4>
<pre>   1  0  0
   0  1  0
   0  0  1
</pre>
<h4><span class="mw-headline" id="Echelle_non_uniforme">Echelle non uniforme</span></h4>
<pre>   scaleX    0      0
      0   scaleY    0
      0      0   scaleZ
</pre>
<h4><span class="mw-headline" id="Partage">Partage</span></h4>
<p>(Op&eacute;ration qui rend le texte normal en italique; en supposant que le texte est dans le plan XY)
</p>
<pre>   1  shear  0
   0    1    0
   0    0    1
</pre>
<p>'Shear' coefficient qui d&eacute;finit la quantit&eacute; de cisaillement. 0 n'est pas un cisaillement. 1 cr&eacute;e le texte en italique avec une inclinaison de 45 degr&eacute;s. -1 cisaille &agrave; la fa&ccedil;on d'une barre oblique inverse.
</p><p><br>
Attention: Toute la g&eacute;om&eacute;trie est convertie en B-splines, m&ecirc;me si ce n'est pas obligatoire.
Cela peut causer toutes sortes de probl&egrave;mes. A n'utilisez que si c'est absolument n&eacute;cessaire.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../File/Macro_MatrixTransform.png" class="mw-file-description"><img src="../File/Macro_MatrixTransform.png" decoding="async" width="64" height="64"></a></span>
</p>
<div style="clear:both"></div>
<p><b>MatrixTransform.py:</b>
</p>
<pre>#***************************************************************************
#*                                                                         *
#*   Copyright (c) 2015 2024 - Victor Titov (DeepSOIC)                     *
#*                                               &lt;vv.titov@gmail.com&gt;      *  
#*                                                                         *
#*   This program is free software; you can redistribute it and/or modify  *
#*   it under the terms of the GNU Lesser General Public License (LGPL)    *
#*   as published by the Free Software Foundation; either version 2 of     *
#*   the License, or (at your option) any later version.                   *
#*   for detail see the LICENCE text file.                                 *
#*                                                                         *
#*   This program is distributed in the hope that it will be useful,       *
#*   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
#*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
#*   GNU Library General Public License for more details.                  *
#*                                                                         *
#*   You should have received a copy of the GNU Library General Public     *
#*   License along with this program; if not, write to the Free Software   *
#*   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  *
#*   USA                                                                   *
#*                                                                         *
#***************************************************************************

__title__="Macro MatrixTransform"
__author__ = "DeepSOIC"
__doc__ = '''
Macro MatrixTransform.
Distorts geometry according to vector transformation defined by the matrix.

Matrix is defined by three vectors:
       v1x   v2x   v3x                  
M = (  v1y   v2y   v3y )                  
       v1z   v2z   v3z                  
Here, v1,v2,v3 are vectors that can be defined in properties. They correspond
to new directions of what was originally X,Y,Z axes.

exmaple matrices:

No transformation:
1  0  0
0  1  0
0  0  1

non-uniform scaling:
scaleX    0      0
   0   scaleY    0
   0      0   scaleZ

shearing (operation that makes regular text into italic; assuming text is in XY
plane):
1  shear  0
0    1    0
0    0    1
('shear' coefficient defines the amount of shearing. 0 is no shearing. 1 makes
the text italic by 45 degrees. -1 shears in backslash-like fashion.)


Warning. All geometry is converted to B-splines, even if it doesn't have to.
This can cause all sorts of trouble. Use only if absolutely necessary.
'''

import FreeCAD as App
if App.GuiUp:
    import FreeCADGui as Gui
import Part

def makeMatrixTransformFeature():
    '''makeMatrixTransformFeature(): makes a MatrixTransform parametric feature object. Returns the new object.'''
    obj = App.ActiveDocument.addObject("Part::FeaturePython","Transform")
    MatrixTransform(obj)
    ViewProviderMatrixTransform(obj.ViewObject)
    return obj

class MatrixTransform:
    "The FuseCompound object"
    def __init__(self,obj):
        obj.addProperty("App::PropertyLink","Base","MatrixTransform","Input shape")
        obj.addProperty("App::PropertyVector","v1","MatrixTransform","Vector for new X axis; first column of transform matrix.")
        obj.addProperty("App::PropertyVector","v2","MatrixTransform","Vector for new Y axis; second column of transform matrix.")
        obj.addProperty("App::PropertyVector","v3","MatrixTransform","Vector for new Z axis; third column of transform matrix.")
        obj.v1 = App.Vector(1,0,0)
        obj.v2 = App.Vector(1,1,0)
        obj.v3 = App.Vector(0,0,1)
        obj.Proxy = self
        

    def execute(self,obj):
        v1 = obj.v1
        v2 = obj.v2
        v3 = obj.v3
        m = App.Matrix(  v1.x, v2.x, v3.x, 0,
                         v1.y, v2.y, v3.y, 0,
                         v1.z, v2.z, v3.z, 0,
                         0,    0,    0,    1   )
        obj.Shape = obj.Base.Shape.transformGeometry(m)

class ViewProviderMatrixTransform:
    
    def __init__(self,vobj):
        vobj.Proxy = self
       
    def getIcon(self):
        return ""

    def attach(self, vobj):
        self.ViewObject = vobj
        self.Object = vobj.Object
  
    def setEdit(self,vobj,mode):
        return False
    
    def unsetEdit(self,vobj,mode):
        return

    def __getstate__(self):
        return None

    def __setstate__(self,state):
        return None

    def claimChildren(self):
        return [self.Object.Base]
        
    def onDelete(self, feature, subelements): # subelements is a tuple of strings
        try:
            self.Object.Base.ViewObject.show()
        except Exception as err:
            App.Console.PrintError("Error in onDelete: " + str(err)) #err.message
        return True

def run():
    sel = Gui.Selection.getSelection()
    try:
        if len(sel)&nbsp;!= 1:
            raise Exception("Select a shape to transform, first! Then run this macro.")
        obj = makeMatrixTransformFeature()
        obj.Base = sel[0]
        obj.Proxy.execute(obj)
    except Exception as err:
        from PySide import QtGui
        mb = QtGui.QMessageBox()
        mb.setIcon(mb.Icon.Warning)
        mb.setText(str(err)) #err.message
        mb.setWindowTitle("Macro MatrixTransform")
        mb.exec_()
        App.Console.PrintError("Error in onDelete: " + str(err)) #err.message

##import MatrixTransform
##MatrixTransform.run()</pre>
<p><b>Macro MatrixTransform.FCMacro</b>
</p>
<pre>#***************************************************************************
#*                                                                         *
#*   Copyright (c) 2015 - Victor Titov (DeepSOIC)                          *
#*                                               &lt;vv.titov@gmail.com&gt;      *  
#*                                                                         *
#*   This program is free software; you can redistribute it and/or modify  *
#*   it under the terms of the GNU Lesser General Public License (LGPL)    *
#*   as published by the Free Software Foundation; either version 2 of     *
#*   the License, or (at your option) any later version.                   *
#*   for detail see the LICENCE text file.                                 *
#*                                                                         *
#*   This program is distributed in the hope that it will be useful,       *
#*   but WITHOUT ANY WARRANTY; without even the implied warranty of        *
#*   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the         *
#*   GNU Library General Public License for more details.                  *
#*                                                                         *
#*   You should have received a copy of the GNU Library General Public     *
#*   License along with this program; if not, write to the Free Software   *
#*   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  *
#*   USA                                                                   *
#*                                                                         *
#***************************************************************************

__title__="Macro MatrixTransform"
__author__ = "DeepSOIC"
__doc__ = '''
Macro MatrixTransform.
Distorts geometry according to vector transformation defined by the matrix.

Matrix is defined by three vectors:
       v1x   v2x   v3x                  
M = (  v1y   v2y   v3y )                  
       v1z   v2z   v3z                  
Here, v1,v2,v3 are vectors that can be defined in properties. They correspond
to new directions of what was originally X,Y,Z axes.

exmaple matrices:

No transformation:
1  0  0
0  1  0
0  0  1

non-uniform scaling:
scaleX    0      0
   0   scaleY    0
   0      0   scaleZ

shearing (operation that makes regular text into italic; assuming text is in XY
plane):
1  shear  0
0    1    0
0    0    1
('shear' coefficient defines the amount of shearing. 0 is no shearing. 1 makes
the text italic by 45 degrees. -1 shears in backslash-like fashion.)


Instruciotns:
Select the object to be sheared, then run the macro. A new object will be
created, with shear matrix filled in by default. Edit values of v1, v2, v3 to
change the behavior.

Warning. All geometry is converted to B-splines, even if it doesn't have to.
This can cause all sorts of trouble. Use only if absolutely necessary.
'''

import MatrixTransform
MatrixTransform.run()</pre>
<p><b>Run the macro</b>
</p><p>MatrixTransform.FCMacro:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="kn">import</span> <span class="nn">MatrixTransform</span>
<span class="n">MatrixTransform</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
<!-- 
NewPP limit report
Cached time: 20241209190448
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.060 seconds
Real time usage: 0.065 seconds
Preprocessor visited node count: 146/1000000
Post&#8208;expand include size: 3834/2097152 bytes
Template argument size: 10321/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 1/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 10637/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.821      1 -total
 36.80%    2.510      1 Template:Macro/fr
 21.99%    1.500      1 Template:Codeextralink
 14.50%    0.989      1 Template:Code
 12.51%    0.853      2 Template:MacroCode
 11.92%    0.813      1 Template:ColoredText
  7.20%    0.491      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:74000-0!canonical and timestamp 20241209190448 and revision id 1515960. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>