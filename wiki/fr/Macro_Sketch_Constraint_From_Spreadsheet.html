<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Sketch Constraint From Spreadsheet/fr</span></h1><?xml encoding="UTF-8"><div class="mw-parser-output"><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../de/Macro_Sketch_Constraint_From_Spreadsheet.html" class="mw-pt-progress mw-pt-progress--complete" title="Makro Skizzen-Beschr&auml;nkungen aus Kalkulationstabellen (91% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_Sketch_Constraint_From_Spreadsheet.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Sketch Constraint From Spreadsheet (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../pl/Macro_Sketch_Constraint_From_Spreadsheet.html" class="mw-pt-progress mw-pt-progress--stub" title="Makrodefinicja: Wi&#261;zania szkicownika z arkusza kalkulacyjnego (3% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" class="mw-file-description"><img src="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" decoding="async" width="32" height="32"></a></span><span> </span>
Macro Sketch Constraint From Spreadsheet
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Macro qui, par un simple clic sur une cellule du tableur, ajoute une contrainte de longueur &agrave; une ligne, un cercle ou entre 2 points en utilisant un alias ou une adresse de cellule du tableur (ex. C2). Les modifications futures de la feuille de calcul mettront &agrave; jour la contrainte. La macro peut cr&eacute;er des alias pour vous.<br>Il suffit de s&eacute;lectionner une ligne, deux points ou une contrainte, de cliquer sur une cellule de la feuille de calcul et d'ex&eacute;cuter la macro. Vous pouvez s&eacute;lectionner des lignes, des points aux extr&eacute;mit&eacute;s d'une ligne, des points, des cercles ou des arcs de cercle.<br><br>Version macro&nbsp;: 02.00<br>Date derni&egrave;re modification&nbsp;: 2025-03-09<br>Version FreeCAD&nbsp;: Toutes<br>T&eacute;l&eacute;chargement&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg">Ic&ocirc;ne de la barre d'outils</a><br>Auteur: 2cv001<br>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;2cv001&amp;action=edit&amp;redlink=1.html" class="new" title="User:2cv001 (page does not exist)">2cv001</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/d/dc/Macro_Sketch_Constraint_From_Spreadsheet.svg">Ic&ocirc;ne de la barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">02.00
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2025-03-09
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Description"><span class="tocnumber">1</span> <span class="toctext">Description</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilisation"><span class="tocnumber">2</span> <span class="toctext">Utilisation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Cr%C3%A9ation_automatique_d'objets"><span class="tocnumber">2.1</span> <span class="toctext">Cr&eacute;ation automatique d'objets</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Cr%C3%A9ation_automatique_d'alias"><span class="tocnumber">2.2</span> <span class="toctext">Cr&eacute;ation automatique d'alias</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Mode_automatique"><span class="tocnumber">2.2.1</span> <span class="toctext">Mode automatique</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Mode_manuel"><span class="tocnumber">2.2.2</span> <span class="toctext">Mode manuel</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Cr%C3%A9ation_de_contraintes"><span class="tocnumber">2.3</span> <span class="toctext">Cr&eacute;ation de contraintes</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Liens"><span class="tocnumber">3</span> <span class="toctext">Liens</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Cr%C3%A9dits"><span class="tocnumber">4</span> <span class="toctext">Cr&eacute;dits</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Script"><span class="tocnumber">5</span> <span class="toctext">Script</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Code"><span class="tocnumber">5.1</span> <span class="toctext">Code</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#T%C3%A9l%C3%A9chargement"><span class="tocnumber">5.1.1</span> <span class="toctext">T&eacute;l&eacute;chargement</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p><b>Contactez-moi sur le forum FreeCAD en cas de probl&egrave;me.</b>
</p><p>Macro qui, par un simple clic sur une cellule du tableur, ajoute une contrainte de longueur &agrave; une ligne ou entre 2 points en utilisant un alias ou une adresse de cellule du tableur (ex. C2). Les modifications ult&eacute;rieures de la feuille de calcul mettront &agrave; jour la contrainte. La macro peut cr&eacute;er des alias pour vous.
</p><p>Il suffit de s&eacute;lectionner 1 ligne, 2 points ou une contrainte, de cliquer sur une cellule du tableur et d'ex&eacute;cuter la macro. Vous pouvez s&eacute;lectionner des polylignes, des points aux extr&eacute;mit&eacute;s d'une ligne, des points, des cercles ou des arcs de cercle.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet1.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet1.gif" decoding="async" width="1059" height="566"></a></span>
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro">https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro</a>"&gt;raw code&lt;/a&gt;</div>
<p><br>
<span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<p><span id="Automatic_Object_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_automatique_d.27objets"></span><span class="mw-headline" id="Cr&eacute;ation_automatique_d'objets">Cr&eacute;ation automatique d'objets</span></h3>
<p>Si vous ex&eacute;cutez la macro et que vous n'avez pas encore cr&eacute;&eacute; de feuille de calcul, de corps ou d'esquisse, la macro vous propose de les cr&eacute;er et ouvre ensuite l'esquisse en mode &eacute;dition et la feuille de calcul afin que vous puissiez commencer &agrave; la remplir.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet7.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet7.gif" decoding="async" width="1093" height="673"></a></span>
</p><p><span id="Automatic_Alias_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_automatique_d.27alias"></span><span class="mw-headline" id="Cr&eacute;ation_automatique_d'alias">Cr&eacute;ation automatique d'alias</span></h3>
<p>Ce n'est pas obligatoire, mais il est pr&eacute;f&eacute;rable d'utiliser des alias dans votre feuille de calcul. La macro peut cr&eacute;er des alias &agrave; partir des textes contenus dans les cellules.<br>
Deux modes&nbsp;: 
</p>
<ul><li>un mode manuel o&ugrave; vous s&eacute;lectionnez vous-m&ecirc;me les cellules contenant du texte pour l'alias et un mode automatique.</li>
<li>et un mode automatique&nbsp;:</li></ul>
<p><span id="Automatic_mode"></span>
</p>
<h4><span class="mw-headline" id="Mode_automatique">Mode automatique</span></h4>
<p>Un mode automatique o&ugrave; les alias sont automatiquement cr&eacute;&eacute;s en utilisant une zone de texte d&eacute;finie par une cellule. La zone comprend la cellule et celles qui se trouvent en dessous. Ces textes correspondent au nom de l'alias. L'alias est cr&eacute;&eacute; &agrave; droite de son texte." La cellule d&eacute;sign&eacute;e (ici A3) est &eacute;ditable dans ces bo&icirc;tes de dialogue&nbsp;:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet2302.png" class="mw-file-description" title="Alias automatic creation"><img alt="Alias automatic creation" src="../File/SketchConstraintFromSpreadsheet2302.png" decoding="async" width="502" height="312"></a></span>
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet2303.png" class="mw-file-description" title="Alias automatic creation"><img alt="Alias automatic creation" src="../File/SketchConstraintFromSpreadsheet2303.png" decoding="async" width="438" height="190"></a></span>
<span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet2304.gif" class="mw-file-description" title="Alias automatic creation"><img alt="Alias automatic creation" src="../File/SketchConstraintFromSpreadsheet2304.gif" decoding="async" width="1122" height="683"></a></span>
<br>
</p><p><br>
<span id="Manual_mode"></span>
</p>
<h4><span class="mw-headline" id="Mode_manuel">Mode manuel</span></h4>
<p>Pour utiliser le mode manuel, ne cochez pas l'option "Automatic alias".
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet2301.png" class="mw-file-description" title="Alias creation"><img alt="Alias creation" src="../File/SketchConstraintFromSpreadsheet2301.png" decoding="async" width="407" height="170"></a></span>
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet8.gif" class="mw-file-description" title="Alias creation"><img alt="Alias creation" src="../File/SketchConstraintFromSpreadsheet8.gif" decoding="async" width="958" height="531"></a></span>
</p><p><span id="Constraints_creation"></span>
</p>
<h3><span id="Cr.C3.A9ation_de_contraintes"></span><span class="mw-headline" id="Cr&eacute;ation_de_contraintes">Cr&eacute;ation de contraintes</span></h3>
<p>1) S&eacute;lectionnez&nbsp;:
</p>
<ul><li>une ligne,</li>
<li>deux points (extr&eacute;mit&eacute; d'une ligne, centre d'un cercle, etc.)</li>
<li>ou une contrainte de longueur.</li></ul>
<p><span class="mw-default-size" typeof="mw:File"><a href="../File/SelectPoints.png" class="mw-file-description"><img src="../File/SelectPoints.png" decoding="async" width="817" height="266"></a></span>
</p><p>2) Cliquez sur une cellule de la feuille de calcul, avec ou sans alias, qui contient une valeur num&eacute;rique&nbsp;:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/Capture1.png" class="mw-file-description"><img src="../File/Capture1.png" decoding="async" width="339" height="265"></a></span>
</p><p>3) Lancez la macro.
</p><p>4) S&eacute;lectionnez le type de contrainte souhait&eacute;&nbsp;:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/Choose_type_of_constraint.png" class="mw-file-description"><img src="../File/Choose_type_of_constraint.png" decoding="async" width="168" height="135"></a></span>
</p><p>Si la cellule a un alias, la propri&eacute;t&eacute; de longueur de la contrainte sera quelque chose comme "Spreadsheet.alias". Dans le cas contraire, il s'agira de quelque chose comme "Spreadsheet.D4".
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/If_the_spreadsheet_has_an_alias.png" class="mw-file-description"><img src="../File/If_the_spreadsheet_has_an_alias.png" decoding="async" width="679" height="486"></a></span>
</p><p>5) Si la contrainte provoque un conflit dans l'esquisse et que la case "conflict detection" est coch&eacute;e, la macro propose de supprimer la nouvelle contrainte&nbsp;:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet3.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet3.gif" decoding="async" width="1059" height="566"></a></span>
</p><p>Si vous s&eacute;lectionnez une contrainte existante, vous pouvez remplacer sa valeur par une valeur provenant d'une feuille de calcul&nbsp;:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet2.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet2.gif" decoding="async" width="1059" height="566"></a></span>
<span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet4.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet4.gif" decoding="async" width="1092" height="473"></a></span>
</p><p>La macro peut &eacute;galement g&eacute;rer une g&eacute;om&eacute;trie externe provenant d'une autre esquisse&nbsp;:
<span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet9.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet9.gif" decoding="async" width="1140" height="771"></a></span>
</p><p>Pour &ecirc;tre encore plus pr&eacute;cis, si, par exemple, une ligne est horizontale plut&ocirc;t que verticale, &agrave; l'ouverture de la bo&icirc;te de dialogue, le focus sera sur le bouton permettant d'appliquer une contrainte horizontale. Si la ligne est verticale et non horizontale, le focus sera sur le bouton permettant d'appliquer une contrainte verticale. Dans les deux cas, il vous suffit d'appuyer sur la touche Entr&eacute;e si vous &ecirc;tes satisfait de votre choix.
</p><p><br>
<span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheet5.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheet5.gif" decoding="async" width="933" height="418"></a></span>
</p><p>La macro fonctionne &eacute;galement pour les propri&eacute;t&eacute;s des objets. Si vous cliquez, par exemple, sur la propri&eacute;t&eacute; Length d'une protrusion, puis sur une cellule avec la valeur souhait&eacute;e, la propri&eacute;t&eacute; Length de la protrusion est automatiquement modifi&eacute;e.
<br>
</p><p><br>
<span class="mw-default-size" typeof="mw:File"><a href="../File/SketchConstraintFromSpreadsheetchangePropertyPad.gif" class="mw-file-description"><img src="../File/SketchConstraintFromSpreadsheetchangePropertyPad.gif" decoding="async" width="1175" height="573"></a></span>
</p><p><span id="Links"></span>
</p>
<h2><span class="mw-headline" id="Liens">Liens</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?t=75972">Forum de discussion (fran&ccedil;ais)</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?style=5&amp;t=76990">Forum discussion (English)</a></li>
<li><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Liste des macros</a></li>
<li><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer des macros</a></li>
<li><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Personnaliser la barre d'outils</a></li></ul>
<p><span id="Credits"></span>
</p>
<h2><span id="Cr.C3.A9dits"></span><span class="mw-headline" id="Cr&eacute;dits">Cr&eacute;dits</span></h2>
<p>Merci &agrave; openBrain, mario52 et onekk pour leur aide sur le code!<br>
Merci &agrave; Syres pour les tests, revues et pour l'aide sur le format dans le code.<br>
Merci &agrave; Roy043 et David69 pour les diverses r&eacute;visions et am&eacute;liorations du wiki.<br>
Merci &agrave; L'ami Ren&eacute; pour les tests et les id&eacute;es.
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>Ic&ocirc;ne de la barre d'outils <span class="mw-default-size" typeof="mw:File"><a href="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" class="mw-file-description"><img src="../File/Macro_Sketch_Constraint_From_Spreadsheet.svg" decoding="async" width="61" height="61"></a></span>
</p>
<h3><span class="mw-headline" id="Code">Code</span></h3>
<p>ver 02.00 2025/03/09 by 2cv001 <b>Macro_Sketch_Constraint_From_Spreadsheet.FCMacro</b>
<span id="Download"></span>
</p>
<h4><span id="T.C3.A9l.C3.A9chargement"></span><span class="mw-headline" id="T&eacute;l&eacute;chargement">T&eacute;l&eacute;chargement</span></h4>
<p><br>
</p>
<div class="plainlinks" style="width:300px; text-align:center; margin:10px auto;">
<div style="border:1px outset #9eb4b5; background:#f0fdf8; margin:5px; padding:5px; white-space:nowrap; -webkit-border-radius: 5px; -moz-border-radius: 5px;">
<p><span typeof="mw:File"><a href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro" rel="nofollow"><img src="../File/Nuvola_apps_download_manager.png" decoding="async" width="35" height="35"></a></span>
</p><p><span class="CodeDownload" style="font-weight:bold"><a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/2cv001/FreeCAD-macros/master/Spreadsheet/Sketch_Constraint_From_Spreadsheet.FCMacro">Download latest version of the macro</a></span>
</p>
</div>
</div>

<!-- 
NewPP limit report
Cached time: 20250309110850
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc, no&#8208;toc&#8208;conversion]
CPU time usage: 0.070 seconds
Real time usage: 0.097 seconds
Preprocessor visited node count: 159/1000000
Post&#8208;expand include size: 4123/2097152 bytes
Template argument size: 1879/2097152 bytes
Highest expansion depth: 6/100
Expensive parser function count: 1/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 1862/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.817      1 -total
 42.57%    2.902      1 Template:CodeDownload
 28.18%    1.921      1 Template:Macro/fr
 25.41%    1.732      1 Template:Codeextralink
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:307752-0!canonical and timestamp 20250309110849 and revision id 1557490. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>