<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Guitar Nut/fr</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Guitar+Nut&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_Guitar_Nut.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Guitar Nut (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../it/Macro_Guitar_Nut.html" class="mw-pt-progress mw-pt-progress--high" title="Macro Guitar Nut (94% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Guitar_Nut.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Nakr&#281;tka gitarowa (6% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_Guitar_Nut.png&amp;filetimestamp=20200426140847&amp;.html" class="mw-file-description"><img src="../File/Macro_Guitar_Nut.png" decoding="async" width="32" height="32" class="mw-file-element"></a></span><span> </span>
Macro Guitar Nut
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Cr&eacute;e des formes d'&eacute;crous de guitare complexes.<br>Plus pr&eacute;cis&eacute;ment, il peut cr&eacute;er un &eacute;crou avec le bas des fentes de cordes &agrave; la hauteur souhait&eacute;e au-dessus d'un manche du rayon souhait&eacute;. Le diam&egrave;tre de chaque cha&icirc;ne est configurable et les fentes peuvent &ecirc;tre configur&eacute;es pour tenir compte de la largeur n&eacute;cessaire pour emp&ecirc;cher la liaison. Voir la section <a href="#Utilisation/fr">Utilisation</a> pour plus de d&eacute;tails.<br><br>Version macro&nbsp;: 0.1<br>Date derni&egrave;re modification&nbsp;: 2020-01-27<br>Version FreeCAD&nbsp;: Toutes<br>T&eacute;l&eacute;chargement&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/9/94/Macro_Guitar_Nut.png">Ic&ocirc;ne de la barre d'outils</a><br>Auteur: jsiddall<br>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;Jsiddall&amp;action=edit&amp;redlink=1.html" class="new" title="User:Jsiddall (page does not exist)">jsiddall</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/9/94/Macro_Guitar_Nut.png">Ic&ocirc;ne de la barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">0.1
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2020-01-27
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><a href="../fr/Macro_Guitar_fretboard.html" title="Macro Guitar fretboard/fr">Macro_Guitar_fretboard</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>Guitar Nut Maker est une macro FreeCAD qui cr&eacute;e une forme d'&eacute;crou de guitare complexe.
</p><p>Cette macro cr&eacute;e un &eacute;crou avec le bas des fentes de cordes &agrave; la hauteur souhait&eacute;e au-dessus d'un manche du rayon souhait&eacute;.  
</p><p><br>
Les fentes peuvent &ecirc;tre &eacute;largies &agrave; l'arri&egrave;re de l'&eacute;crou puis sur la face, et les fentes peuvent &ecirc;tre cr&eacute;&eacute;es avec l'angle de rupture souhait&eacute;. Les emplacements peuvent &ecirc;tre sur des centres &eacute;gaux ou avoir un espace &eacute;gal entre eux. 
</p><p>Le diam&egrave;tre de chaque cha&icirc;ne est configurable et les fentes peuvent &ecirc;tre rendues plus configurables que la cha&icirc;ne pour emp&ecirc;cher la liaison. Le haut de l'&eacute;crou est sph&eacute;rique et peut &ecirc;tre configur&eacute; au-dessus / en dessous du point central des cordes. Les bords de l'&eacute;crou ne sont pas fa&ccedil;onn&eacute;s, ni le haut profil&eacute; de la face vers l'arri&egrave;re, mais ces transformations peuvent &ecirc;tre appliqu&eacute;es manuellement dans FreeCAD, ou bien apr&egrave;s le fraisage de la pi&egrave;ce.
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Nut_macro.png&amp;filetimestamp=20200128012636&amp;.html" class="mw-file-description"><img src="../File/Nut_macro.png" decoding="async" width="800" height="440" class="mw-file-element"></a></span>
</p>
<p style="text-align:left; font-style:italic; width:800px; margin-left:1em; margin-right:1em;">R&eacute;sultats &agrave; l'aide de la macro Guitar Nut Maker</p>
<p><span id="Usage"></span>
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<ol><li>T&eacute;l&eacute;charger la macro depuis le <span typeof="mw:File"><a href="../index.php?title=Std_AddonMgr.svg&amp;filetimestamp=20240704212012&amp;.html" class="mw-file-description"><img src="../File/Std_AddonMgr.svg" decoding="async" width="24" height="24" class="mw-file-element"></a></span> <a href="../fr/Std_AddonMgr.html" title="Std AddonMgr/fr">Gestionnaire des extensions</a></li>
<li>Ex&eacute;cuter la macro</li></ol>
<h2><span class="mw-headline" id="Limitations">Limitations</span></h2>
<ul><li>Le code de la macro doit &ecirc;tre modifi&eacute; avec les param&egrave;tres souhait&eacute;s avant l'utilisation.</li></ul>
<div style="clear:both"></div>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>Ic&ocirc;ne de la barre d'outils <span typeof="mw:File"><a href="../index.php?title=Macro_Guitar_Nut.png&amp;filetimestamp=20200426140847&amp;.html" class="mw-file-description"><img src="../File/Macro_Guitar_Nut.png" decoding="async" width="64" height="64" class="mw-file-element"></a></span>
</p><p><b>GuitarNut.FCMacro</b>
</p>
<pre># FreeCAD Guitar Nut Macro
# This macro creates a guitar/bass nut with conical slots at the
# desired spacing and diameter to export to CAM software 

__Name__ = 'Guitar Nut'
__Comment__ = 'This macro creates a guitar/bass nut'
__Author__ = 'Jeff Siddall'
__Version__ = '0.1'
__Date__ = '2020-01-27'
__License__ = 'GPL-3.0-or-later'
__Web__ = ''
__Wiki__ = ''
__Icon__ = 'https://wiki.freecad.org/images/9/94/Macro_Guitar_Nut.png'
__Help__ = 'Macro file must be edited with the desired nut parameters before use'
__Status__ = 'Beta'
__Requires__ = ''
__Communication__ = ''
__Files__ = ''

import FreeCAD, Part, math
from FreeCAD import Base, Vector

class Nut():
    if App.ActiveDocument is None:
        # Create new document called "Nut" if there is no open document
        doc = App.newDocument("Nut")

# Enter desired values below
# Unless specified, units are mm
equalcenters = 0 # If equalcenters = 1 then the spacing of the strings is equal; if 0 then the space between the strings is equal
strings = 5 # Number of strings

# Always enter values below with a decimal point, even if that means adding ".0" on the end!
length = 49.0 # Nut length (neck width); 38.1 mm = 1.5", 41.275 = 1-5/8"
width = 6.350 # Nut width; 3.175 mm = 1/8"; 6.35 mm = 1/4"
fretboardmaxheight = 6.350 # Maximum fretboard height above the bottom of the nut slot; 6.35 mm = 1/4"
radius = 184.15 # Fretboard radius; 184.15 mm = 7.25"; 304.8 = 12"; 406.4 mm = 16"
# List of string thicknesses, starting at bottom string, separated by commas, enclosed in square brackets
# Bottom string 1.143 mm = 0.045" 
# 1.651 mm = 0.065"
# 2.159 mm = 0.085"
# Top string on a 4 string 2.667 mm = 0.105"
# Top string on a 5 string 3.175 mm = 0.125"
stringthickness = [1.143, 1.651, 2.159, 2.667, 3.175] # 5 string bass, 45-125/ 4 string bass 45-105
#stringthickness = [3.175, 2.667, 2.159, 1.651, 1.143] # Reverse string, 5 string bass, 45-125/ 4 string bass 45-105
#stringthickness = [0.254, 0.3302, 0.4318, 0.6604, 0.9144, 1.1684] # 6 string guitar, 10-46
stringheight = 1.1938 # Height of bottom of strings above fretboard; 1.1938 mm = 0.047" or the height of a typical medium/jumbo fret
slotmargin = 0.05 # extra slot width on each side of the string; 0.05 mm = 0.00197"
overhang = 3.0 # Distance from edge of each outside string to end of nut
breakangle = 14.0 # Angle of the nut slot in degrees; this should be greater than the actual string angle to ensure the string only contacts at the leading edge of the nut
slotradincrease = 0.2 # How much bigger the radius of the end of the slot is than the face
slotdepthfactor = 1.3 # Factor to control how deep the slots should be.  Values greater than 1 create deeper slots than default.
toparcoffsetfactor = 1.8 # Factor to control how far off-center the nut top arc is.  Adjust as required.
# End of user configuration variables
# Do not make any changes below this line!

stringindex = 0 # Start at the bottom string
stringspacing = 0

# Find the centers of the outside strings
# Bottom string
center1 = (length / 2) - overhang - (stringthickness[0] / 2)

# Top string
center2 = -((length / 2) - overhang - (stringthickness[strings - 1] / 2))

# Outside string values
outsidestringradiusdiff = (stringthickness[strings - 1] - stringthickness[0]) / 2
outsidestringavgradius = (stringthickness[strings - 1] + stringthickness[0]) / 2 / 2
centerspacing = center1 - center2

# Find the string spacings for both spacing models
if equalcenters:
    # Calculate the correct spacing for equal spaced strings
    stringspacing = centerspacing / (strings - 1)

else:
    # Calculate the space between strings
    totalstringwidth = 0
    stringindex1 = 0
    while (stringindex1 &lt; strings):
        totalstringwidth = totalstringwidth + stringthickness[stringindex1]
        stringindex1 = stringindex1 + 1

    stringspacing = (centerspacing - totalstringwidth + (2 * outsidestringavgradius)) / (strings - 1)

print("Creating nut blank")
# Height is much larger than needed but will be cut down with the "common" operation later
nutshape = Part.makeBox(width, length, ((fretboardmaxheight + stringheight) * 2), Vector(-width, -(length / 2), 0))

print("Creating nut top surface")
# Make a sphere to shape the top of the nut, which should pass through  each string center
# Because the thickness of the strings varies, the Y-position of the sphere needs to be compensated
# The fretboard "z" portion is:
fretboardz = radius - (((radius ** 2) - ((centerspacing / 2) ** 2)) ** 0.5)

# The formula to calculate the effective radius of the center of outside strings is:
# r^2 = z^2 + y^2
# r^2 = ((r - (outsidestringradiusdiff + fretboardz))^2) + ((centerspacing/2)^2)
# r^2 = r^2 - 2r*(outsidestringradiusdiff + fretboardz) + ((outsidestringradiusdiff + fretboardz)^2) + (centerspacing^2)
# 2r*(outsidestringradiusdiff + fretboardz) = ((outsidestringradiusdiff + fretboardz)^2) + (centerspacing^2)
# r  = ((outsidestringradiusdiff + fretboardz)/2) + ((centerspacing^2)/(2*(outsidestringradiusdiff + fretboardz)))
nutradius = ((abs(outsidestringradiusdiff / 4) + fretboardz) / 2) + (((centerspacing / 2) ** 2) / (2 * (abs(outsidestringradiusdiff / 4) + fretboardz)))

# The center of the arc of the nut radius must also be offset
# This formula was derived empirically so might nead adjusting
yoffset = -centerspacing / 2 * toparcoffsetfactor * (outsidestringradiusdiff / (2 * outsidestringavgradius)) * (1 - (nutradius / radius))

top = Part.makeSphere(nutradius, Vector(0, yoffset, (-nutradius + fretboardmaxheight + stringheight + (outsidestringavgradius * slotdepthfactor) + slotmargin)))

nutshape = nutshape.common(top)

cumulativestringwidth = 0 # Add up the amount of string thickness for equal spacing

# Build the slots
while (stringindex &lt; strings):
    print("Creating slot for string " + str(stringindex))
    ypos = 0

    if equalcenters:
        # For equal centers move each string over by the fixed amount of stringspacing
        ypos = center1 - (stringindex * stringspacing)

    else:
        # For equal spacing adjust for the thickness of each string

        # Add up the cumulative string thickness
        if stringindex == 0:
            # For the first string the thickness is already included in center1 so don't add anything
            cumulativestringwidth = 0

        else:
            # Add half the previous string and half this string
            cumulativestringwidth = cumulativestringwidth + (stringthickness[stringindex] / 2) + (stringthickness[stringindex - 1] / 2)

        ypos = center1 - (stringindex * stringspacing) - cumulativestringwidth

    zstartpos = (((radius ** 2) - (ypos ** 2)) ** 0.5) - radius + fretboardmaxheight + stringheight + (stringthickness[stringindex] / 2) + slotmargin # Cartesian coordinate formula: z = sqrt(r^2 - y^2)
    # calculate the end of the slot based on the string break angle 
    zendpos = zstartpos - (math.tan(math.radians(breakangle)) * width)

    slotstartrad = (stringthickness[stringindex] / 2) + slotmargin
    slotendrad = slotstartrad + slotradincrease

    # Make the string slot as 2 circles offset in the Z axis to create the break angle, then made into a face, then extruded up to allow the slot to protrude to the nut surface
    slotstart = Part.makeCircle(slotstartrad, Vector(0, ypos, zstartpos), Vector(1, 0, 0), 180, 360)
    slotend = Part.makeCircle(slotendrad, Vector(-width, ypos, zendpos), Vector(1, 0, 0), 180, 360)
    slotbottom = Part.makeRuledSurface(slotstart, slotend)
    slotextrude = slotbottom.extrude(Vector(0, 0, ((fretboardmaxheight + stringheight) * 2)))

    nutshape = nutshape.cut(slotextrude)
    stringindex = stringindex + 1

nut = App.ActiveDocument.addObject("Part::Feature","Nut")
nut.Shape = nutshape
print("Finished creating nut")</pre>
<p><span id="Link"></span>
</p>
<h2><span class="mw-headline" id="Liens">Liens</span></h2>
<p>Discussion sur le forum <a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=24&amp;t=5827&amp;">Guitar fretboard macro / guitar body</a>
</p>
<!-- 
NewPP limit report
Cached time: 20250712110727
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.025 seconds
Real time usage: 0.032 seconds
Preprocessor visited node count: 115/1000000
Post&#8208;expand include size: 2787/2097152 bytes
Template argument size: 8708/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 8802/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.845      1 -total
 34.99%    2.045      1 Template:Macro/fr
 22.86%    1.336      1 Template:Clear
 20.20%    1.181      1 Template:MacroCode
 17.81%    1.041      1 Template:Caption
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:193452-0!canonical and timestamp 20250712110727 and revision id 1610703. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>