<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Image Scaling/fr</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Image+Scaling&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../de/Macro_Image_Scaling.html" class="mw-pt-progress mw-pt-progress--med" title="Makro BildSkalierung (58% translated)" lang="de" dir="ltr">Deutsch</a></li>
<li><a href="../Macro_Image_Scaling.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Image Scaling (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--med" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../it/Macro_Image_Scaling.html" class="mw-pt-progress mw-pt-progress--med" title="Macro Scala immagine (58% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Image_Scaling.html" class="mw-pt-progress mw-pt-progress--med" title="Makrodefinicja: Skalowanie obraz&oacute;w (58% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Image_Scaling.svg&amp;filetimestamp=20181206021928&amp;.html" class="mw-file-description"><img src="../File/Image_Scaling.svg" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Image Scaling
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Mise &agrave; l'&eacute;chelle des dessins, graphiques, diagrammes, plans et autres images 2D similaires dans l'atelier Image. Elle fonctionne pour les images import&eacute;es en tant qu'images planes dans l'espace 3D.<br>
<p>Remarque&nbsp;: pour les photos d'objets ou les images impliquant des objets situ&eacute;s &agrave; diff&eacute;rentes distances du point de vue, l'effet de <a rel="nofollow" class="external text" href="https://fr.wikipedia.org/wiki/Parallaxe">parallaxe</a> (distorsion due &agrave; la &laquo;&nbsp;diff&eacute;rence dans la position apparente d'un objet vu selon deux lignes de vue diff&eacute;rentes&nbsp;&raquo;) doit &ecirc;tre pris en compte. Dans le diagramme suivant, les deux objets bleus sont coplanaires, le plan &eacute;tant perpendiculaire au point de vue de l'utilisateur, et la mise &agrave; l'&eacute;chelle peut &ecirc;tre utilis&eacute;e.<br><br>Version macro&nbsp;: 1.0<br>Date derni&egrave;re modification&nbsp;: 2016-01-19<br>Version FreeCAD&nbsp;: 0.17 et moins<br>T&eacute;l&eacute;chargement&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/0/05/Image_Scaling.svg">Ic&ocirc;ne de la barre d'outils</a><br>Auteur: JAndersM<br>
</p>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../index.php?title=User;JAndersM&amp;action=edit&amp;redlink=1.html" class="new" title="User:JAndersM (page does not exist)">JAndersM</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/0/05/Image_Scaling.svg">Ic&ocirc;ne de la barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2016-01-19
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.17 et moins
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Description">Description</span></h2>
</div>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Description_2">Description</span></h2>
<p>Macro pour mettre facilement un dessin &agrave; bonne &eacute;chelle graphiques, diagramme, blueprint, plan et des images 2D en vue de s'en servir comme patron pour pouvoir calquer le dessin avec les outils de FreeCAD. Il fonctionne avec les images import&eacute;es dans l'espace 3D.
</p>
</div>
<p>Remarque: Pour les photos, objets ou images il faut garder &agrave; l'esprit l'effet de <a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Parallax">Parallaxe</a> (distorsion due &agrave; la "diff&eacute;rence entre la position apparente d'un objet vu le long de deux lignes diff&eacute;rentes &agrave; la vue"). Dans le sch&eacute;ma ci-dessous les 2 objets bleus sont coplanaires perpendiculairement au plan du point de vue de l'utilisateur et la mise &agrave; l'&eacute;chelle peut &ecirc;tre utilis&eacute;e:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Perspective.png&amp;filetimestamp=20160118222402&amp;.html" class="mw-file-description"><img src="../File/Perspective.png" decoding="async" width="355" height="265" class="mw-file-element" data-file-width="355" data-file-height="265"></a></span>
</p><p>Dans le second sch&eacute;ma, les objets rouges et verts ne sont pas coplanaires avec les 2 objets bleus et la mise &agrave; l'&eacute;chelle ne peut pas &ecirc;tre utilis&eacute;e. En outre, le fait que l'objet rouge soit co-planaire avec 1 objet bleu il ne peut &ecirc;tre d&eacute;termin&eacute; &agrave; partir du diagramme uniquement bas&eacute; au point de vue de l'utilisateur:
</p><p><span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Parallax.jpg&amp;filetimestamp=20160119154927&amp;.html" class="mw-file-description"><img src="../File/Parallax.jpg" decoding="async" width="361" height="272" class="mw-file-element" data-file-width="361" data-file-height="272"></a></span>   
</p>
<div lang="en" dir="ltr" class="mw-content-ltr">
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
</div>
<div class="mw-translate-fuzzy">
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<ul><li>ex&eacute;cuter la macro - un dialogue appara&icirc;t</li>
<li>cliquez sur les deux points de l'image dont vous connaissez la vraie distance entre</li>
<li>S&eacute;lectionnez le plan d'image dans l'arborescence</li>
<li>Entrez la vraie distance en mm entre les points dans le champ de texte de la bo&icirc;te de dialogue et cliquez sur OK</li>
<li>L'image est mise &agrave; l'&eacute;chelle et la bo&icirc;te de dialogue se ferme.</li></ul>
</div>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<div lang="en" dir="ltr" class="mw-content-ltr">
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Image_Scaling.svg&amp;filetimestamp=20181206021928&amp;.html" class="mw-file-description"><img src="../File/Image_Scaling.svg" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p>
</div>
<p><b>Macro_Image_Scaling.FCMacro</b>
</p>
<pre>import FreeCADGui, FreeCAD, Part
import math
import pivy.coin as pvy
from PySide import QtCore, QtGui
import DraftTrackers, Draft

__title__   = "Macro Image Scaling"
__author__  = "JAndersM"
__url__     = "https://freecad.org/index-fr.html"
__version__ = "00.01"
__date__    = "19/01/2016"

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    def _fromUtf8(s):
        return s

try:
    _encoding = QtGui.QApplication.UnicodeUTF8
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig, _encoding)
except AttributeError:
    def _translate(context, text, disambig):
        return QtGui.QApplication.translate(context, text, disambig)

def distance(p1,p2):
    dx=p2[0]-p1[0]
    dy=p2[1]-p1[1]
    dz=p2[2]-p1[2]
    return math.sqrt(dx*dx+dy*dy+dz*dz)
    
class Ui_Dialog(object):
    def setupUi(self, Dialog):
        self.view = FreeCADGui.ActiveDocument.ActiveView
        self.stack = []
        self.callback = self.view.addEventCallbackPivy(pvy.SoMouseButtonEvent.getClassTypeId(),self.getpoint)
        self.callmouse=self.view.addEventCallbackPivy(pvy.SoLocation2Event.getClassTypeId(),self.getmousepoint)
        self.distance=0
        self.dialog=Dialog
        Dialog.setObjectName(_fromUtf8("Dialog"))
        Dialog.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
        Dialog.resize(300, 102)
        self.buttonBox = QtGui.QDialogButtonBox(Dialog)
        self.buttonBox.setGeometry(QtCore.QRect(50, 70, 191, 32))
        self.buttonBox.setOrientation(QtCore.Qt.Horizontal)
        self.buttonBox.setStandardButtons(QtGui.QDialogButtonBox.Cancel.__or__(QtGui.QDialogButtonBox.Ok))
        self.buttonBox.setObjectName(_fromUtf8("buttonBox"))
        self.buttonBox.button(QtGui.QDialogButtonBox.Ok).setEnabled(False)
        self.label = QtGui.QLabel(Dialog)
        self.label.setGeometry(QtCore.QRect(30, 10, 66, 17))
        self.label.setObjectName(_fromUtf8("label"))
        self.lineEdit = QtGui.QLineEdit(Dialog)
        self.lineEdit.setGeometry(QtCore.QRect(100, 10, 113, 29))
        self.lineEdit.setObjectName(_fromUtf8("lineEdit"))
        self.label1 = QtGui.QLabel(Dialog)
        self.label1.setGeometry(QtCore.QRect(20, 45, 260, 17))
        self.label1.setObjectName(_fromUtf8("label1"))
        self.retranslateUi(Dialog)
        QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(_fromUtf8("accepted()")), self.accept)
        QtCore.QObject.connect(self.buttonBox, QtCore.SIGNAL(_fromUtf8("rejected()")), self.reject)
        QtCore.QMetaObject.connectSlotsByName(Dialog)
        self.tracker = DraftTrackers.lineTracker(scolor=(1,0,0))
        self.tracker.raiseTracker()
        self.tracker.on()
        self.dialog.show()

    def retranslateUi(self, Dialog):
        Dialog.setWindowTitle(_translate("Dialog", "Dialog", None))
        self.label.setText(_translate("Dialog", "Distance", None))
        self.label1.setText(_translate("Dialog", "Select first point", None))
        
    def accept(self):
        sel = FreeCADGui.Selection.getSelection()
        try:
            locale=QtCore.QLocale.system()
            d, ok = locale.toFloat(self.lineEdit.text())
            if not ok:
                raise ValueError
            s=d/self.distance
            sel[0].XSize.Value=sel[0].XSize.Value*s
            sel[0].YSize.Value=sel[0].YSize.Value*s
            FreeCAD.Console.PrintMessage("Scale="+str(s))
            self.tracker.off()
            self.tracker.finalize()
            self.dialog.hide()
        except (ValueError, ZeroDivisionError) as e:
            self.label1.setText(_translate("Dialog", "&lt;font color='red'&gt;Enter distance&lt;/font&gt;", None))
            return
        except (IndexError, AttributeError) as e:
            self.label1.setText(_translate("Dialog", "&lt;font color='red'&gt;Select ImagePlane&lt;/font&gt;", None))
            return
        
    def reject(self):
        self.stack=[]
        self.view.removeEventCallbackPivy(pvy.SoMouseButtonEvent.getClassTypeId(),self.callback)
        self.view.removeEventCallbackPivy(pvy.SoLocation2Event.getClassTypeId(),self.callmouse)
        self.tracker.off()
        self.tracker.finalize()
        self.dialog.hide()
    
    def getmousepoint(self, event_cb):
        event = event_cb.getEvent()
        if len(self.stack)==1:
            pos = event.getPosition()
            point = self.view.getPoint(pos[0],pos[1])
            self.tracker.p2(point)
               
    def getpoint(self,event_cb):
        event = event_cb.getEvent()           
        if event.getState() == pvy.SoMouseButtonEvent.DOWN:
            pos = event.getPosition()
            point = self.view.getPoint(pos[0],pos[1])
            self.stack.append(point)
            self.label1.setText(_translate("Dialog", "Select second point", None))
            if len(self.stack)==1:
                self.tracker.p1(point)
            elif len(self.stack) == 2:
                self.distance=distance(self.stack[0], self.stack[1])
                self.tracker.p2(point)
                self.view.removeEventCallbackPivy(pvy.SoMouseButtonEvent.getClassTypeId(),self.callback)
                self.view.removeEventCallbackPivy(pvy.SoLocation2Event.getClassTypeId(),self.callmouse)
                self.buttonBox.button(QtGui.QDialogButtonBox.Ok).setEnabled(True)
                self.label1.setText(_translate("Dialog", "Select Image Plane and type distance", None))
                
#Init               
d = QtGui.QWidget()
ui = Ui_Dialog()
ui.setupUi(d)</pre>
<p><span id="Links"></span>
</p>
<h2><span class="mw-headline" id="Liens">Liens</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://forum.freecad.org/viewtopic.php?f=22&amp;t=13877">Forum discussion</a></li>
<li><a rel="nofollow" class="external text" href="https://forum.freecad.org/download/file.php?id=19542">t&eacute;l&eacute;chargez le zip</a></li>
<li><a rel="nofollow" class="external text" href="https://youtu.be/2iFE40uHrA8">Movie created by microelly2</a></li></ul>
<!-- 
NewPP limit report
Cached time: 20251124160028
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.069 seconds
Real time usage: 0.097 seconds
Preprocessor visited node count: 103/1000000
Post&#8208;expand include size: 2703/2097152 bytes
Template argument size: 6659/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 6759/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    5.317      1 -total
 68.16%    3.624      1 Template:Macro/fr
 29.23%    1.554      1 Template:MacroCode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:63634-0!canonical and timestamp 20251124160028 and revision id 1702340. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="../site.js"></script>