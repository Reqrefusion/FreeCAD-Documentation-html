<link href="../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Python Assistant Window/fr</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="fr" dir="ltr"><div class="mw-pt-languages noprint navigation-not-searchable" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><ul class="mw-pt-languages-list"><li><a href="../index.php?title=Special;Translate&amp;group=page-Macro+Python+Assistant+Window&amp;language=&amp;task=view.html" class="new" title="Start translation for this language" lang="" dir="ltr"></a></li>
<li><a href="../Macro_Python_Assistant_Window.html" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete" title="Macro Python Assistant Window (100% translated)" lang="en" dir="ltr">English</a></li>
<li><span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete" lang="fr" dir="ltr">fran&ccedil;ais</span></li>
<li><a href="../it/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--high" title="Macro Python Assistant Window (96% translated)" lang="it" dir="ltr">italiano</a></li>
<li><a href="../pl/Macro_Python_Assistant_Window.html" class="mw-pt-progress mw-pt-progress--low" title="Makrodefinicja: Okno Asystent Python (4% translated)" lang="pl" dir="ltr">polski</a></li></ul></div>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="../index.php?title=Macro_Python_Assistant_Window.png&amp;filetimestamp=20150121133000&amp;.html" class="mw-file-description"><img src="../File/Macro_Python_Assistant_Window.png" decoding="async" width="32" height="32" class="mw-file-element"></a></span><span> </span>
Macro Python Assistant Window
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Cette macro fournit un espace de travail couper/copier/coller pour le code Python. Elle est segment&eacute;e afin de pouvoir s&eacute;lectionner diff&eacute;rentes sections et est persistante entre les sessions FreeCAD.<br><br>Version macro&nbsp;: 1.0<br>Date derni&egrave;re modification&nbsp;: 2015-01-21<br>Version FreeCAD&nbsp;: Toutes<br>T&eacute;l&eacute;chargement&nbsp;: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">Ic&ocirc;ne de la barre d'outils</a><br>Auteur: Piffpoof<br>
</td></tr>
<tr>
<th class="ctOdd">Auteur
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="../User;Piffpoof.html" title="User:Piffpoof">Piffpoof</a>
</td></tr>
<tr>
<th class="ctOdd">T&eacute;l&eacute;chargement
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/4/45/Macro_Python_Assistant_Window.png">Ic&ocirc;ne de la barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Liens
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="../fr/Macros_recipes.html" title="Macros recipes/fr">Page des macros</a><br><a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer une macro</a><br><a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Comment cr&eacute;er une barre d'outils</a>
</td></tr>
<tr>
<th class="ctOdd">Version Macro
</th></tr>
<tr>
<td class="ctEven macro-version">1.0
</td></tr>
<tr>
<th class="ctOdd">Derni&egrave;re modification
</th></tr>
<tr>
<td class="ctEven macro-date">2015-01-21
</td></tr>
<tr>
<th class="ctOdd">Version(s) FreeCAD
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">Toutes
</td></tr>
<tr>
<th class="ctOdd">Raccourci clavier
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">Voir aussi
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<p>L'un des aspects les plus puissants de Python est la console Python, qui sert &agrave; la fois de p&eacute;riph&eacute;rique de sortie et d'interpr&eacute;teur dynamique du code source. La fen&ecirc;tre de l'assistant Python (appel&eacute;e ult&eacute;rieurement "PAW") fournit des fonctionnalit&eacute;s suppl&eacute;mentaires &agrave; la console Python.
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="cursor:not-allowed">
<p>Temporary code for external macro link. Do not use this code. This code is used exclusively by <a href="../Std_AddonMgr.html" title="Std AddonMgr">Addon Manager</a>. <i>Link for optional manual installation: <a rel="nofollow" class="external text" href="http://pastebin.com/raw/2m0u94Z1">Macro</a></i>
</p>
<div class="mw-collapsible-content">
<pre>

# This code is copied instead of the original macro code
# to guide the user to the online download page.
# Use it if the code of the macro is larger than 64 KB and cannot be included in the wiki
# or if the RAW code URL is somewhere else in the wiki.

from PySide import QtGui, QtCore

diag = QtGui.QMessageBox(QtGui.QMessageBox.Information,
    "Information",
    "This macro must be downloaded from this link\n"
    "\n"
    "http://pastebin.com/raw/2m0u94Z1" + "\n"
    "\n"
    "Quit this window to access the download page")

diag.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
diag.setWindowModality(QtCore.Qt.ApplicationModal)
diag.exec_()

import webbrowser 
webbrowser.open("http://pastebin.com/raw/2m0u94Z1")
</pre>
</div>
</div>
<div style="display:none;">&lt;class="rawcodeurl"&gt;&lt;a href="<a rel="nofollow" class="external free" href="http://pastebin.com/raw/2m0u94Z1">http://pastebin.com/raw/2m0u94Z1</a>"&gt;raw code&lt;/a&gt;</div>
<p><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowScreenSnapshot.jpg&amp;filetimestamp=20150121165407&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowScreenSnapshot.jpg" decoding="async" width="500" height="488" class="mw-file-element"></a></span>
</p>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>En tant qu&rsquo;environnement de d&eacute;veloppement moderne, Python pr&eacute;sente de nombreux avantages par rapport aux langages plus anciens et &agrave; leurs environnements de d&eacute;veloppement. Un avantage important est la console Python o&ugrave; le code peut &ecirc;tre entr&eacute; de mani&egrave;re interactive et les r&eacute;sultats re&ccedil;us (<a rel="nofollow" class="external text" href="https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a>). Ces r&eacute;sultats peuvent ensuite &ecirc;tre copi&eacute;s et utilis&eacute;s pour construire le code source Python (dans un &eacute;diteur de source) ou &ecirc;tre recoll&eacute;s dans la console Python sous une forme modifi&eacute;e pour recevoir une sortie ult&eacute;rieure. C'est une m&eacute;thode tr&egrave;s puissante de d&eacute;veloppement de code.
</p><p>Aussi puissant que cela puisse para&icirc;tre, la console Python pr&eacute;sente deux inconv&eacute;nients &eacute;vidents:
</p>
<ul><li>la taille de la console est limit&eacute;e et il est possible que les r&eacute;sultats de votre travail d'il y a 20 minutes d&eacute;filent loin de l'&eacute;cran. Ils ne sont pas perdus, mais ils sont difficiles &agrave; r&eacute;cup&eacute;rer.</li>
<li>la console est effac&eacute;e chaque fois que vous avez termin&eacute; votre session FreeCAD, la console est vide (&agrave; part le message de d&eacute;marrage Python) lors du prochain d&eacute;marrage de FreeCAD</li></ul>
<p>Le PAW fournit les &eacute;l&eacute;ments suivants:
</p>
<ul><li>il est persistant entre les sessions FreeCAD, les choses ne "dispara&icirc;tront" pas &agrave; moins que l'utilisateur ne les supprime</li>
<li>il a un menu contextuel qui permet ce qui suit:
<ul><li>les op&eacute;randes d'&eacute;dition standard: Copier/Coller &amp; Tout s&eacute;lectionner</li>
<li>Copier une s&eacute;lection dans la console Python</li>
<li>Copiez le contenu complet du PAW dans la console Python</li>
<li>Ajouter le contenu de la console Python au PAW</li>
<li>ins&eacute;rer des marqueurs textuels facilitant la gestion du texte</li>
<li>s&eacute;lection entre deux marqueurs cons&eacute;cutifs</li>
<li>supprime le pr&eacute;fixe "&gt;&gt;&gt;" que la console Python utilise pour indiquer la sortie</li>
<li>r&eacute;duire plusieurs lignes vides &agrave; une seule ligne vide</li>
<li>personnaliser l'environnement de travail en g&eacute;rant le PAW (ainsi que la fen&ecirc;tre principale de FreeCAD) &agrave; l'aide d'une interface graphique bas&eacute;e sur un curseur</li></ul></li></ul>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Tout le code de pythonAssistantWindow.FCMacro est dans une macro. L'installation consiste donc &agrave; copier le code dans le r&eacute;pertoire Macro appropri&eacute; et &agrave; appeler pythonAssistantWindow &agrave; partir du menu Macro, de la console Python ou d'un bouton de la barre d'outils (m&eacute;thode recommand&eacute;e).
</p>
<ul><li>voir <a href="../fr/How_to_install_macros.html" title="How to install macros/fr">Comment installer des macros</a> pour des informations sur la fa&ccedil;on d'installer ce code de macro</li>
<li>voir <a href="../fr/Customize_Toolbars.html" title="Customize Toolbars/fr">Personnaliser les barres d'outils</a> pour plus d'informations sur l'installation en tant que bouton dans une barre d'outils</li></ul>
<p><b>Remarque</b>: une variable globale dans FreeCAD est utilis&eacute;e pour coordonner le stockage persistant.
</p><p><b> Remarque</b>: un fichier texte du r&eacute;pertoire "UserAppData" est utilis&eacute; pour stocker le contenu textuel de PAW entre les sessions FreeCAD.
</p>
<h2><span class="mw-headline" id="Utilisation">Utilisation</span></h2>
<p>Le PAW est mieux utilis&eacute; comme un bouton dans une barre d&rsquo;outils. Il peut &ecirc;tre ex&eacute;cut&eacute; &agrave; partir du menu Macro ou du code coll&eacute; sur la console Python, mais les deux derni&egrave;res options nuisent grandement &agrave; sa facilit&eacute; d'utilisation.
</p><p>Lorsque FreeCAD est d&eacute;marr&eacute;, il n&rsquo;y a aucun signe de PAW, &agrave; part un bouton sur une barre d&rsquo;outils. Cliquer sur le bouton provoquera:
</p>
<ul><li>le PAW &agrave; ouvrir dans le coin inf&eacute;rieur droit
<ul><li>les param&egrave;tres par d&eacute;faut sont pour environ 1/3 de la largeur de l'&eacute;cran &agrave; d&eacute;dier au PAW, le reste &eacute;tant utilis&eacute; par la fen&ecirc;tre principale de FreeCAD, la hauteur du PAW sera d'environ 1/3 de la hauteur de la fen&ecirc;tre.</li></ul></li>
<li>le contenu du fichier PAW lors de sa derni&egrave;re ex&eacute;cution appara&icirc;tra dans la fen&ecirc;tre - il ne devrait y avoir aucune diff&eacute;rence par rapport &agrave; la derni&egrave;re utilisation.
<ul><li>si le PAW n'a pas &eacute;t&eacute; ex&eacute;cut&eacute; avant, le contenu sera vide</li></ul></li>
<li>si le PAW est d&eacute;j&agrave; ouvert mais cach&eacute; par d'autres fen&ecirc;tres, il sera &eacute;lev&eacute; vers le haut pour devenir visible</li>
<li>la fermeture du PAW entra&icirc;nera l'&eacute;criture du contenu dans le fichier et la fen&ecirc;tre se fermera - il n'y a pas de bo&icirc;te de dialogue vous demandant s'il faut sauvegarder ou non</li>
<li>Cependant, une bo&icirc;te de dialogue vous demande si vous souhaitez enregistrer si FreeCAD est quitt&eacute; (Menu &rarr; Quitter FreeCAD) avec les modifications non enregistr&eacute;es dans le fichier PAW.</li></ul>
<p>La plupart des fonctionnalit&eacute;s du PAW sont fournies par le menu contextuel. Les options sont les suivantes:
</p>
<ul><li>Copie <br> - fournit la fonction de copie standard</li>
<li>Copier la s&eacute;lection sur la console <br> - la s&eacute;lection actuelle est copi&eacute;e &agrave; la fin de la console Python</li>
<li>Copier le contenu sur la console <br> - l'int&eacute;gralit&eacute; du contenu du PAW est copi&eacute; &agrave; la fin de la console Python</li>
<li>Coller <br> - fournit la fonction de collage standard</li>
<li>Ajouter le contenu de la console Python &agrave; PAW <br> - les copies de la console Python sont plac&eacute;es &agrave; la fin du fichier PAW - notez que le contenu de la console Python peut &ecirc;tre un m&eacute;lange de code Python, sortie du code Python, erreur texte du message, sortie de n'importe quelle partie de FreeCAD</li>
<li>S&eacute;lectionner entre les marqueurs <br> - les marqueurs sont utilis&eacute;s pour diviser le texte du PAW en sections, une fois le contenu en sections, une section peut &ecirc;tre s&eacute;lectionn&eacute;e individuellement et utilis&eacute;e (par exemple, Copier, Copier dans la console Python, Supprimer ). L&rsquo;intention de Markers est de permettre aux s&eacute;quences d&rsquo;instruction Python distinctes et non li&eacute;es d&rsquo;exister dans le PAW, puis d&rsquo;&ecirc;tre g&eacute;r&eacute;es et trait&eacute;es individuellement.</li>
<li>Tout s&eacute;lectionner <br> - fournit la fonction standard Tout s&eacute;lectionner</li>
<li>Clearbr <br> - fournit la fonction standard Clear o&ugrave; tout le texte du PAW est supprim&eacute;</li>
<li>Ins&eacute;rer un marqueur <br> - ins&egrave;re un marqueur textuel &agrave; l&rsquo;emplacement actuel du curseur</li>
<li>Supprimez "&gt;&gt;&gt;" <br> - une fois la sortie de la console Python copi&eacute;e dans PAW, toutes les lignes g&eacute;n&eacute;r&eacute;es &agrave; partir de commandes Python ex&eacute;cut&eacute;es porteront le pr&eacute;fixe "&gt;&gt;&gt;". Cette option supprime ces pr&eacute;fixes afin que la sortie &ecirc;tre utilis&eacute; comme donn&eacute;es sans contexte</li>
<li>R&eacute;duction de plusieurs lignes vides en une seule ligne vide <br> - compacte le texte en supprimant plusieurs lignes vides</li>
<li>Modifier les param&egrave;tres de l'interface graphique <br> - ouvre une fen&ecirc;tre modale avec trois contr&ocirc;les:</li>
<li><span typeof="mw:File"><a href="../index.php?title=PythonAssistantWindowGui2.jpg&amp;filetimestamp=20150121170002&amp;.html" class="mw-file-description"><img src="../File/PythonAssistantWindowGui2.jpg" decoding="async" width="500" height="134" class="mw-file-element"></a></span>
<ul><li>un curseur pour d&eacute;finir le pourcentage de la largeur de l'&eacute;cran d&eacute;di&eacute; au PAW (en gardant &agrave; l'esprit qu'il y a une certaine largeur que la fen&ecirc;tre principale de FreeCAD ne passera pas en dessous)</li>
<li>un curseur pour d&eacute;finir le pourcentage de la hauteur de l'&eacute;cran d&eacute;di&eacute; au PAW</li>
<li>une paire de boutons radio pour indiquer si le PAW doit &ecirc;tre plac&eacute; en haut ou en bas du c&ocirc;t&eacute; gauche de l'&eacute;cran</li></ul></li>
<li>Enregistrer en tant que fichier <br> - le contenu de la fen&ecirc;tre PAW est &eacute;crit dans un fichier s&eacute;lectionn&eacute; par l'utilisateur - le contenu de PAW n'est pas modifi&eacute;</li>
<li>Fermer la fen&ecirc;tre <br> - la fen&ecirc;tre PAW est ferm&eacute;e et le contenu est enregistr&eacute; dans le fichier de stockage persistant <br> <b> Remarque </b>: il n'y a pas de bo&icirc;te de dialogue demandant de sauvegarder, cela se fait automatiquement</li></ul>
<h2><span class="mw-headline" id="Interface_utilisateur">Interface utilisateur</span></h2>
<p>L&rsquo;interface utilisateur est un simple &eacute;diteur de texte, un bouton permet de d&eacute;marrer le PAW et un menu contextuel d&rsquo;options pour afficher le texte dans la fen&ecirc;tre d&rsquo;&eacute;dition. Les options sont d&eacute;crites dans la section Utilisation.
</p>
<h2><span class="mw-headline" id="Exemples">Exemples</span></h2>
<p><b>Un premier exemple</b>
</p><p>En janvier, votre coll&egrave;gue a besoin d'aide avec du code Python pour mettre &agrave; jour un fichier. Vous &eacute;crivez et d&eacute;boguez sur votre ordinateur et lui envoyez le code source. Vous avez propos&eacute; 3 fa&ccedil;ons diff&eacute;rentes de faire le travail et vous ne savez pas quelle est la meilleure solution. Vous copiez les 3 versions finies sur le PAW et les s&eacute;parez par des marqueurs.
</p><p>Au d&eacute;but du mois de mai, vous travaillez avec plaisir sur le projet de la bouteille avec FreeCAD. Il y a quelques probl&egrave;mes pour obtenir le code Python exact pour g&eacute;n&eacute;rer ce qui est requis. Vous devez donc le mod&eacute;liser graphiquement et le code Python &eacute;quivalent est g&eacute;n&eacute;r&eacute; sur la console Python. En utilisant PAW, vous copiez le contenu de la console Python dans PAW. Vous le fa&ccedil;onnez en le d&eacute;pla&ccedil;ant et en l'ex&eacute;cutant, en copiant les r&eacute;sultats, en les modifiant dans PAW et en les recopiant jusqu'&agrave; ce que vous soyez heureux.
</p><p>Le lundi suivant, votre patron s'est pr&eacute;cipit&eacute; pour dire qu'il y avait une forte demande pour un op&eacute;rateur de CAO &agrave; l'usine qui rencontre des probl&egrave;mes avec la s&eacute;quence de pliage pour la nouvelle cha&icirc;ne d'emballage. Vous y allez imm&eacute;diatement et vous y restez 2 semaines. Vous terminez votre mission et revenez &agrave; votre espace de travail habituel.
</p><p>&Agrave; votre retour, &eacute;videmment les gens utilisent votre espace de travail pour le d&eacute;jeuner, vous devez donc le nettoyer un peu. Lorsque vous d&eacute;marrez FreeCAD et que vous cliquez sur le bouton PAW de la barre d&rsquo;outils, votre dernier projet s&rsquo;ajoute &agrave; celui de la veille. Vous r&eacute;alisez que la solution &agrave; la conception de votre bouteille r&eacute;side dans le code de fichier que vous avez &eacute;crit en janvier et dans ce que vous avez laiss&eacute; deux semaines plus t&ocirc;t. Rapidement, vous pouvez s&eacute;lectionner et copier les segments de code dans la console Python pour les ex&eacute;cuter et les affiner.
</p><p>Une fois le code stabilis&eacute;, vous pouvez l'enregistrer dans un fichier pour un fichier Python ou un fichier de macro FreeCAD.
</p><p><b>Autre Exemple</b>
</p><p>Vous essayez de savoir ce qui ne va pas avec les valeurs de rotation de divers objets dans un assemblage. Sur 27 objets, vous ne pouvez voir aucun motif quant aux objets qui seront affect&eacute;s. Vous devez donc regrouper quelques lignes de Python pour isoler les objets incorrects, puis les coller dans le PAW. Ensuite, prenez quelques lignes de Python pour obtenir les valeurs Label et Rotation, collez &eacute;galement ce code dans PAW. Copiez le code pour d&eacute;tailler tous les objets que vous avez besoin de voir dans la liste et r&eacute;p&eacute;tez-le pour chaque objet, le tout dans le PAW. La console Python aura tous ces r&eacute;sultats (y compris les erreurs de frappe et les messages d'erreurs), mais elle aura fait d&eacute;filer la partie visible de la fen&ecirc;tre il y a longtemps. Vous avez maintenant un ensemble concis de lignes Python, vous le copiez &agrave; partir de PAW, vous le collez dans la console Python et vous obtenez la liste exacte des objets n&eacute;cessitant un d&eacute;bogage, ainsi que leurs valeurs sp&eacute;cifiques. Si n&eacute;cessaire, vous pouvez ensuite coller les r&eacute;sultats de la console Python dans PAW - pr&eacute;fixez-le avec le caract&egrave;re de commentaire Python ('#') si vous souhaitez l'enregistrer dans le code Python et le garder ex&eacute;cutable. Enfin, vous pouvez enregistrer cette agglom&eacute;ration dans un fichier du PAW afin qu&rsquo;elle soit s&eacute;curis&eacute;e sur disque. Pr&ecirc;t pour la prochaine fois que vous devez voler ou adapter la logique du code.
</p>
<h2><span class="mw-headline" id="Options">Options</span></h2>
<p>La seule option pour le PAW est la possibilit&eacute; de modifier la taille et la forme de son affichage initial en fonction de la taille et de la forme de la fen&ecirc;tre principale de FreeCAD. Le code Python contient 3 valeurs constantes: la taille initiale et l'emplacement du fichier PAW.
</p>
<h2><span class="mw-headline" id="Remarques">Remarques</span></h2>
<p>Il existe une preuve de concept tr&egrave;s simple pour un travail de stockage persistant dans ce code. Il peut &ecirc;tre utile &agrave; quiconque ayant besoin d'une telle capacit&eacute;.
</p>
<h2><span class="mw-headline" id="Links">Links</span></h2>
<p>none (so far)
</p>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<div id="itsfree" style="text-align:center;color:black;background:#FDE0A8;margin:1em 7em;padding:0.5em 2em;border:2px solid #FF5706;"><b>Si la liste de scripts ne se termine pas par les informations de version de FreeCAD et que la derni&egrave;re ligne de la phrase "termine ainsi la macro ...", le script est sur le Wiki mais vous pouvez le t&eacute;l&eacute;charger ou le copier &agrave; partir de [<a rel="nofollow" class="external text" href="http://pastebin.com/raw.php?i=2m0u94Z1">unabbreviated script on pastebin.com</a>]</b></div>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="../index.php?title=Macro_Python_Assistant_Window.png&amp;filetimestamp=20150121133000&amp;.html" class="mw-file-description"><img src="../File/Macro_Python_Assistant_Window.png" decoding="async" width="64" height="64" class="mw-file-element"></a></span>
</p><p><b>Macro_Python_Assistant_Window.FCMacro</b>
</p>
<pre>#
#
#				Python Assistant Window
#				v 0.1 initial release
#
#
#***********************************************************************************
#
# provide a text editing window with functions to aid in coding Python within FreeCAD
#
############ To Do ############
# - contextual window doesn't fire if cursor is on last position in file
# - executing "from PySide import QtGui, QtCore" on console seems to close window
# - is it possible to copy code to console and then select and execute it?
##############################
#***********************************************************************************
# The next three variables define the width and height and vertical positioning
# of the Python Assistant Window
# 'pawWidthPercent' specifies the percentage of the screen width to be assigned to the Python Assistant Window
# 'pawHeightPercent' specifies the percentage of the screen height to be assigned to the Python Assistant Window
# 'pawAtBottomFlag' specifies if the Python Assistant Window is at the top or the bottom
# The Python Assistant Window is automatically placed at the left,
# so pawWidthPercent = 26, pawHeightPercent = 41, pawAtBottomFlag = False will cause the
# following:
# 1) the main FreeCAD window will be placed in the upper left corner of the screen,
#	 it's height will be 100% of the screen height,
#	 it's width will be 74% (=100%-26%) of the screen
# 2) the Python Assistant Window will be placed in the left side of the screen,
#	 it's height will be 41% of the screen height,
#	 it's width will be 26% of the screen
#	 it will be at the top (leaving empty space below it)
# The empty space (either above or below the Python Assistant Window),
# is left for the text editor (for editing the Macros) to be placed in.
#
pawWidthPercentInitial		= 37.5 # percent of the screen width
pawHeightPercentInitial		= 32.0 # percent of the screen height
pawAtBottomFlagInitial		= True
#***********************************************************************************
# import statements
import sys, operator, os
from os.path import expanduser
from PySide import QtGui, QtCore

# UI Class definitions

class PythonAssistantWindow(QtGui.QMainWindow):
	""""""
	def __init__(self, pythonTextToEdit):
		self.textIn = pythonTextToEdit
		super(PythonAssistantWindow, self).__init__()
		self.initUI(pythonTextToEdit)
	def initUI(self, pythonTextToEdit):
		"""Constructor"""
		# set default return value and pointer to subsequent child window
		self.result			= userCancelled
		self.childWindow	= None
		self.alertWindow	= None
		# set window dimensions for Python Advisor Window from the constants at the top of Macro file
		self.pawWinWidth	= pawWidthPercentInitial/100.0 * availableWidth
		self.pawWinHeight	= pawHeightPercentInitial/100.0 * availableHeight
		self.left			= screenWidth - self.pawWinWidth
		if pawAtBottomFlagInitial:
			self.top		= screenHeight - self.pawWinHeight
		else:
			self.top		= 0		
		self.editorHeight	= self.pawWinHeight
		# set dimensions for main FreeCAD window
		self.mainWinWidth	= availableWidth - (self.pawWinWidth+interWindowGap)
		self.mainWinHeight	= availableHeight
		# define main window
		FreeCADGui.getMainWindow().setGeometry(0, 0, self.mainWinWidth, self.mainWinHeight)
		# now set up this window
		self.setGeometry(self.left, self.top, self.pawWinWidth, self.pawWinHeight)
		self.setWindowTitle("Python Assistant Window")
		#
		centralWidget 		=  QtGui.QWidget(self)
		layout 				=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		# set up text editing widget
		self.text_editor = QtGui.QPlainTextEdit(self)
		self.text_editor.move(0,0)
		self.text_editor.resize(self.pawWinWidth,self.editorHeight)
		self.text_editor.appendPlainText(self.textIn)
		self.text_editor.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.text_editor.textChanged.connect(self.onTextChanged)
		# set up a monospace font for the text editor to match the Python console
		font = QtGui.QFont()
		font.setFamily("Courier")
		font.setStyleHint(QtGui.QFont.Monospace)
		font.setFixedPitch(True)
		font.setPointSize(12)
		self.text_editor.setFont(font)
		#self.text_editor.cursorPositionChanged.connect(self.onCursorPosition)
		self.cursor = self.text_editor.textCursor()
		# populate layout
		layout.addWidget(self.text_editor,0,0)
		self.setCentralWidget(centralWidget)
		# set contextual menu options for text editing widget
		# menu dividers
		mnuDivider1 = QtGui.QAction(self)
		mnuDivider1.setText(menuDividerText)
		mnuDivider1.triggered.connect(self.onMenuDivider)
		mnuDivider2 = QtGui.QAction(self)
		mnuDivider2.setText(menuDividerText)
		mnuDivider2.triggered.connect(self.onMenuDivider)
		mnuDivider3 = QtGui.QAction(self)
		mnuDivider3.setText(menuDividerText)
		mnuDivider3.triggered.connect(self.onMenuDivider)
		mnuDivider4 = QtGui.QAction(self)
		mnuDivider4.setText(menuDividerText)
		mnuDivider4.triggered.connect(self.onMenuDivider)
		# clear text
		mnuClear = QtGui.QAction(self)
		mnuClear.setText("Clear")
		mnuClear.triggered.connect(self.onClear)
		# paste copy/paste buffer
		mnuPaste = QtGui.QAction(self)
		mnuPaste.setText("Paste")
		mnuPaste.triggered.connect(self.onPaste)
		# paste contents of console
		mnuAppendFromConsole = QtGui.QAction(self)
		mnuAppendFromConsole.setText("Append contents of console")
		mnuAppendFromConsole.triggered.connect(self.onAppendFromConsole)
		# select between markers
		mnuSelectMarkers = QtGui.QAction(self)
		mnuSelectMarkers.setText("Select between markers")
		mnuSelectMarkers.triggered.connect(self.onSelectMarkers)
		# select all
		mnuSelectAll = QtGui.QAction(self)
		mnuSelectAll.setText("Select all")
		mnuSelectAll.triggered.connect(self.onSelectAll)
		# insert marker
		mnuInsertMarker = QtGui.QAction(self)
		mnuInsertMarker.setText("Insert marker")
		mnuInsertMarker.triggered.connect(self.onInsertMarker)
		# remove console generated "&gt;&gt;&gt; " character strings
		mnuStripPrefix = QtGui.QAction(self)
		mnuStripPrefix.setText("Remove '&gt;&gt;&gt; '")
		mnuStripPrefix.triggered.connect(self.onStripPrefix)
		# remove blank lines
		mnuReduceBlankLines = QtGui.QAction(self)
		mnuReduceBlankLines.setText("Delete multiple blank lines")
		mnuReduceBlankLines.triggered.connect(self.onReduceBlankLines)
		# copy selection
		mnuCopy = QtGui.QAction(self)
		mnuCopy.setText("Copy")
		mnuCopy.triggered.connect(self.onCopy)
		# copy selection to console
		mnuCopySelectionToConsole = QtGui.QAction(self)
		mnuCopySelectionToConsole.setText("Copy selection to console")
		mnuCopySelectionToConsole.triggered.connect(self.onCopySelectionToConsole)
		# copy to console
		mnuCopyToConsole = QtGui.QAction(self)
		mnuCopyToConsole.setText("Copy contents to console")
		mnuCopyToConsole.triggered.connect(self.onCopyToConsole)
		# save as file
		mnuSaveAsFile = QtGui.QAction(self)
		mnuSaveAsFile.setText("Save contents to file")
		mnuSaveAsFile.triggered.connect(self.onSaveAsFile)
		# close window
		mnuCloseWindow = QtGui.QAction(self)
		mnuCloseWindow.setText("Close window")
		mnuCloseWindow.triggered.connect(self.onCloseWindow)
		# alter GUI settings
		mnuSettings = QtGui.QAction(self)
		mnuSettings.setText("=Alter GUI settings=")
		mnuSettings.triggered.connect(self.onSettings)
		# define menu and add options
		self.text_editor.setContextMenuPolicy(QtCore.Qt.ActionsContextMenu)
		self.text_editor.addAction(mnuCopy)
		self.text_editor.addAction(mnuCopySelectionToConsole)
		self.text_editor.addAction(mnuCopyToConsole)
		self.text_editor.addAction(mnuDivider1)
		self.text_editor.addAction(mnuPaste)
		self.text_editor.addAction(mnuAppendFromConsole)
		self.text_editor.addAction(mnuSelectMarkers)
		self.text_editor.addAction(mnuSelectAll)
		self.text_editor.addAction(mnuClear)
		self.text_editor.addAction(mnuDivider2)
		self.text_editor.addAction(mnuInsertMarker)
		self.text_editor.addAction(mnuStripPrefix)
		self.text_editor.addAction(mnuReduceBlankLines)
		self.text_editor.addAction(mnuDivider3)
		self.text_editor.addAction(mnuSaveAsFile)
		self.text_editor.addAction(mnuSettings)
		self.text_editor.addAction(mnuCloseWindow)
		#
		self.show()
	#----------------------------------------------------------------------
	def onMenuDivider(self):
		# just a divider in the menu so we don't do anything
		pass
	def onClear(self):
		# clear editing field
		self.text_editor.clear()
	def onPaste(self):
		# paste contents of system copy/paste buffer into QPlainTextEdit field
		self.text_editor.paste()
	def onAppendFromConsole(self):
		# copy text from "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		consoleStr	= pcPTE.document().toPlainText()
		self.text_editor.appendPlainText(copyFromConsoleText)
		self.text_editor.appendPlainText("")
		self.text_editor.appendPlainText(consoleStr)
	def onCopy(self):
		# copy selected text to system copy/paste buffer
		self.text_editor.copy()
	def onCopySelectionToConsole(self):
		# copy selected text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		#
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		textToCopy = cursorText[cursor.selectionStart():cursor.selectionEnd()]
		if len(textToCopy)&gt;0:
			pcPTE.appendPlainText(textToCopy)
	def onCopyToConsole(self):
		# copy text to "Python console"
		mainWindow	= FreeCADGui.getMainWindow()
		pcDW		= mainWindow.findChild(QtGui.QDockWidget, "Python console")
		pcPTE		= pcDW.findChild(QtGui.QPlainTextEdit, "Python console")
		pcPTE.appendPlainText(copyToConsoleText)
		pcPTE.appendPlainText()
	def onInsertMarker(self):
		# insert marker
		self.text_editor.insertPlainText(markerText)
	def onStripPrefix(self):
		# strip out "&gt;&gt;&gt; " from text edit window
		self.text_editor.selectAll()
		if len(self.text_editor.toPlainText())&gt;0:
			self.text_editor.selectAll()
			tmp = self.text_editor.toPlainText()
			self.text_editor.clear()
			self.text_editor.appendPlainText(tmp.replace("&gt;&gt;&gt; ",""))
	def onReduceBlankLines(self):
		# reduce multiple blank lines to single blank lines
		contents = self.text_editor.toPlainText()
		self.text_editor.clear()
		self.text_editor.appendPlainText(os.linesep.join([s for s in contents.splitlines() if s]))
	def onSelectMarkers(self):
		cursor		= self.text_editor.textCursor()
		cursorText	= self.text_editor.toPlainText()
		bNum = cursor.blockNumber(); cNum = cursor.columnNumber()
		pos = cursor.position(); cursorTextLength = len(cursorText)
		occurrences = [i for i in range(len(cursorText)) if cursorText.startswith(markerText, i)]
		if len(occurrences)==0:
			self.alertWindow = QtGui.QMessageBox()
			self.alertWindow.setText("There are no markers...")
			self.alertWindow.show()
		elif len(occurrences)==1:
			hdrStart = occurrences[0]
			hdrEnd = hdrStart + markerTextLength
			if pos&lt;hdrStart:
				selectStart = 0; selectEnd = hdrStart
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
			if pos&gt;hdrEnd:
				selectStart = hdrEnd; selectEnd = cursorTextLength
				self.cursor.setPosition(selectStart)
				self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
				self.text_editor.setTextCursor(self.cursor)
		else:
			startOccurrences = list(); endOccurrences = list(occurrences)
			for i in range(len(occurrences)):
				startOccurrences.append(occurrences[i] + markerTextLength + 1)
			startOccurrences.insert( 0, 0)
			endOccurrences.insert( len(occurrences), cursorTextLength)
			for i in range(len(occurrences)+1):
				if startOccurrences[i]&lt;pos&lt;endOccurrences[i]:
					if i==0:
						selectStart = startOccurrences[i]
					else:
						selectStart = startOccurrences[i]-1
					selectEnd = endOccurrences[i]
					self.cursor.setPosition(selectStart)
					self.cursor.setPosition(selectEnd, QtGui.QTextCursor.KeepAnchor)
					self.text_editor.setTextCursor(self.cursor)
					break
	def onSelectAll(self):
		self.text_editor.selectAll()
	def onCloseWindow(self):
		self.close()
	def onSettings(self):
		# get new width (as&nbsp;%), height (as&nbsp;%), vertical flag
		self.childWindow = GetGuiConfigParams(self)
		pass
	def onTextChanged(self):
		FreeCAD.PythonAssistantWindowStatus[1] = True
	def onCursorPosition(self):
		#print ("Line: {} | Column: {}".format(
		#	self.text_editor.textCursor().blockNumber(),
		#	self.text_editor.textCursor().columnNumber()))
		#print self.text_editor.textCursor().position()+self.text_editor.textCursor().columnNumber()
		pass
	def onSaveAsFile(self):
		filePath = QtGui.QFileDialog.getSaveFileName(parent=None,caption="Save contents as",dir=expanduser("~"),filter="*.txt")
		file = open(filePath[0],"w")
		file.write(self.text_editor.toPlainText())
		file.close()
	def closeEvent(self,event):
		# write out contents for next session
		file = open(persistenceFile,"w")
		file.write(self.text_editor.toPlainText())
		file.close()
		# clear global flag
		del FreeCAD.PythonAssistantWindowStatus
		self.close()

class GetGuiConfigParams(QtGui.QMainWindow):
	""""""
	def __init__(self, parentWindow):
		self.parentWindow = parentWindow
		super(GetGuiConfigParams, self).__init__()
		self.initUI(parentWindow)
	def initUI(self, parentWindow):
		"""Constructor"""
		self.result							= userCancelled
		# grab geometry from our parent so we can tell if user has changed values
		self.initialParentWindowX			= self.parentWindow.geometry().x()
		self.initialParentWindowY			= self.parentWindow.geometry().y()
		self.initialParentWindowH			= self.parentWindow.geometry().height()
		self.initialParentWindowW			= self.parentWindow.geometry().width()
		self.initialHeightSliderSetting		= self.initialParentWindowH/float(availableHeight)*100
		self.initialWidthSliderSetting		= self.initialParentWindowW/float(availableWidth-interWindowGap)*100
		# set some fixed GUI attributes
		width								= 450
		height								= 40
		buttonWidth							= 80
		sliderWidth							= 100
		self.setWindowTitle("GUI Configuration")
		self.setWindowFlags(QtCore.Qt.WindowStaysOnTopHint)
		self.resize(width, height)
		self.widthSlider					= self.initialWidthSliderSetting
		self.heightSlider					= self.initialHeightSliderSetting
		#
		centralWidget 						=  QtGui.QWidget(self)
		layout 								=  QtGui.QGridLayout()
		centralWidget.setLayout(layout)
		verticalLine 						=  QtGui.QFrame()
		# sliders
		widthSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		widthSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		widthSlider.valueChanged[int].connect(self.widthSliderChangeValue)
		widthSlider.setFixedWidth(sliderWidth)
		widthSlider.setValue(self.initialWidthSliderSetting)
		heightSlider = QtGui.QSlider(QtCore.Qt.Horizontal, self)
		heightSlider.setFocusPolicy(QtCore.Qt.NoFocus)
		heightSlider.valueChanged[int].connect(self.heightSliderChangeValue)
		heightSlider.setFixedWidth(sliderWidth)
		heightSlider.setValue(self.initialHeightSliderSetting)
		# labels
		pawWidthLbl		= QtGui.QLabel("Python Assistant Window width", self)
		pawHeightLbl	= QtGui.QLabel("Python Assistant Window height", self)
		# radio buttons - window top or bottom
		self.rb1 = QtGui.QRadioButton("Window at Top",self)
		self.rb1.clicked.connect(self.onRb1)
		self.rb2 = QtGui.QRadioButton("Window at Bottom",self)
		self.rb2.toggle() # set default value
		self.rb2.clicked.connect(self.onRb2)
		if self.parentWindow.geometry().y()==0:
			self.rb1.toggle()
		# cancel button
		cancelButton = QtGui.QPushButton('Cancel', self)
		cancelButton.clicked.connect(self.onCancel)
		cancelButton.setFixedWidth(buttonWidth)
		# OK button
		okButton = QtGui.QPushButton('OK', self)
		okButton.clicked.connect(self.onOk)
		okButton.setFixedWidth(buttonWidth)
		#
		verticalLine.setFrameStyle(QtGui.QFrame.VLine)
		verticalLine.setSizePolicy(QtGui.QSizePolicy.Minimum,QtGui.QSizePolicy.Expanding)
		#
		pawWidthLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		pawHeightLbl.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb1.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		self.rb2.setSizePolicy(QtGui.QSizePolicy.Expanding,QtGui.QSizePolicy.Expanding)
		# populate layout
		layout.addWidget(widthSlider,0,0)
		layout.addWidget(pawWidthLbl,0,1)
		layout.addWidget(heightSlider,2,0)
		layout.addWidget(pawHeightLbl,2,1)
		layout.addWidget(verticalLine,0,2,3,1)
		layout.addWidget(self.rb1,0,3)
		layout.addWidget(self.rb2,2,3)
		layout.addWidget(cancelButton,3,1,QtCore.Qt.AlignRight)
		layout.addWidget(okButton,3,3)
		#
		self.setCentralWidget(centralWidget)
		#
		self.show()
	def widthSliderChangeValue(self, value):
		self.widthSliderValue = value
	def heightSliderChangeValue(self, value):
		self.heightSliderValue = value
	def onRb1(self):
		pass
	def onRb2(self):
		pass
	def onCancel(self):
		self.result = userCancelled
		self.close()
	def onOk(self):
		self.result = "OK"
		# the two slider values are the width and height of the Python Assistant Window
		# resize main FreeCAD window
		freeCadMainWidth	= ((1-(self.widthSliderValue/100.0)) * availableWidth)-(3*interWindowGap)
		FreeCADGui.getMainWindow().setGeometry(0, 0, freeCadMainWidth, availableHeight)
		# resize the PAW window
		newPawWidth			= availableWidth-freeCadMainWidth
		newPawHeight		= (self.heightSliderValue/100.0) * availableHeight
		if self.rb1.isChecked():
			newPawTop		= 0
		else:
			newPawTop		= availableHeight - newPawHeight
		self.parentWindow.setGeometry(freeCadMainWidth+interWindowGap, newPawTop, newPawWidth-interWindowGap, newPawHeight)
		self.close()

#----------------------------------------------------------------------

# Class definitions
		
# Function definitions

def onFreeCADShutdown():
	# this will be invoked when FreeCAD is told to shut down
	#QtGui.QMessageBox.information(None,"","FreeCAD shutting down")
	if FreeCAD.PythonAssistantWindowStatus[1]:
		reply = QtGui.QMessageBox.question(None, "",
			"The Python Assistant Window has changes, do you want to save them?",
			QtGui.QMessageBox.Yes | QtGui.QMessageBox.No, QtGui.QMessageBox.No)
		if reply == QtGui.QMessageBox.Yes:
			# write out contents for next session
			file = open(persistenceFile,"w")
			file.write(FreeCAD.PythonAssistantWindowStatus[0].text_editor.toPlainText())
			file.close()
	del FreeCAD.PythonAssistantWindowStatus

# Constant definitions

userCancelled		= "Cancelled"
markerText			= "#=========== marker ===========\n"
markerTextLength	= len(markerText)
copyFromConsoleText	= "#=========== copy from console ==========="
copyToConsoleText	= "#============ copy to console ============"
menuDividerText		= "--------"
interWindowGap		= 3 # space between 2 windows for appearance sake
persistenceFile		= App.ConfigGet("UserAppData")+"PythonAssistantWindow.txt"
# code ***********************************************************************************
# put down user data saving routine for when FreeCAD exits
mw=Gui.getMainWindow()
mw.mainWindowClosed.connect(onFreeCADShutdown)
# get screen dimensions
screenWidth			= QtGui.QDesktopWidget().screenGeometry().width()
screenHeight		= QtGui.QDesktopWidget().screenGeometry().height()
# get dimensions for available space on screen
availableWidth		= QtGui.QDesktopWidget().availableGeometry().width()
availableHeight		= QtGui.QDesktopWidget().availableGeometry().height()

if not hasattr(FreeCAD,"PythonAssistantWindowStatus"):
	previousContents = ""
	if os.path.isfile(persistenceFile):
		# read contents of last session
		file = open(persistenceFile,"r")
		previousContents = file.read()
		file.close()
	# open window with contents from last session
	form = PythonAssistantWindow(previousContents)
	# save pointer to window so it can be located again and Raised when it becomes obscured
	FreeCAD.PythonAssistantWindowStatus = [None, False]
	FreeCAD.PythonAssistantWindowStatus[0] = form
else:
	# window is open so Raise it so it is visible
	FreeCAD.PythonAssistantWindowStatus[0].raise_()
	pass
#
#OS: Mac OS X
#Word size: 64-bit
#Version: 0.14.3703 (Git)
#Branch: releases/FreeCAD-0-14
#Hash: c6edd47334a3e6f209e493773093db2b9b4f0e40
#Python version: 2.7.5
#Qt version: 4.8.6
#Coin version: 3.1.3
#SoQt version: 1.5.0
#OCC version: 6.7.0
#
#thus ends the macro...
</pre>
<div style="clear:both"></div>
<!-- 
NewPP limit report
Cached time: 20250713083652
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.027 seconds
Real time usage: 0.036 seconds
Preprocessor visited node count: 128/1000000
Post&#8208;expand include size: 3364/2097152 bytes
Template argument size: 1158/2097152 bytes
Highest expansion depth: 7/100
Expensive parser function count: 2/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 22282/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    6.078      1 -total
 36.64%    2.227      1 Template:Macro/fr
 28.86%    1.754      1 Template:Codeextralink
 16.73%    1.017      1 Template:VeryImportantMessage
 13.76%    0.836      1 Template:Clear
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:56425-0!canonical and timestamp 20250713083652 and revision id 1611493. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../site.js"></script>