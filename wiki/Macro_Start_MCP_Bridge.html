<link href="site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macro Start MCP Bridge</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><p><br>
</p>
<table class="fcinfobox wikitable ct" width="100%" style="float: right; width: 230px; margin-left: 10px;">
<tbody><tr>
<td class="ctTitle" style="font-weight: bold; font-size: 125%;">
<p><span typeof="mw:File"><a href="index.php?title=Macro_Start_MCP_Bridge.png&amp;filetimestamp=20260106011106&amp;.html" class="mw-file-description"><img src="File/Macro_Start_MCP_Bridge.png" decoding="async" width="32" height="32" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span><span> </span>
Macro Start MCP Bridge
</p>
</td></tr>
<tr>
<th class="ctOdd">Description
</th></tr>
<tr>
<td class="ctEven left macro-description">Start the MCP (Model Context Protocol) bridge server  which is part of the <a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-robust-mcp-and-more">FreeCAD Robust MCP server</a> which helps facilitate AI assistant integration with FreeCAD. Enables AI tools like Claude Code to control FreeCAD programmatically.<br><br>Macro version: 0.5.0-beta<br>Last modified: 2026-01-05<br>FreeCAD version: 0.21+<br>Download: <a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/thumb/d/d7/Macro_Start_MCP_Bridge.png/48px-Macro_Start_MCP_Bridge.png">ToolBar Icon</a><br>Author: Sean P. Kane<br>
</td></tr>
<tr>
<th class="ctOdd">Author
</th></tr>
<tr>
<td class="ctEven macro-author"><a href="index.php?title=User;Sean_P._Kane&amp;action=edit&amp;redlink=1.html" class="new" title="User:Sean P. Kane (page does not exist)">Sean P. Kane</a>
</td></tr>
<tr>
<th class="ctOdd">Download
</th></tr>
<tr>
<td class="ctEven macro-download"><a rel="nofollow" class="external text" href="https://wiki.freecad.org/images/thumb/d/d7/Macro_Start_MCP_Bridge.png/48px-Macro_Start_MCP_Bridge.png">ToolBar Icon</a>
</td></tr>
<tr>
<th class="ctOdd">Links
</th></tr>
<tr>
<td class="ctEven macro-Links"><a href="Macros_recipes.html" title="Macros recipes">Macros recipes</a><br><a href="How_to_install_macros.html" title="How to install macros">How to install macros</a><br><a href="Customize_Toolbars.html" title="Customize Toolbars">How to customize toolbars</a>
</td></tr>
<tr>
<th class="ctOdd">Macro Version
</th></tr>
<tr>
<td class="ctEven macro-version">0.5.0-beta
</td></tr>
<tr>
<th class="ctOdd">Date last modified
</th></tr>
<tr>
<td class="ctEven macro-date">2026-01-05
</td></tr>
<tr>
<th class="ctOdd">FreeCAD Version(s)
</th></tr>
<tr>
<td class="ctEven FreeCAD-version">0.21+
</td></tr>
<tr>
<th class="ctOdd">Default shortcut
</th></tr>
<tr>
<td class="ctEven"><i>None</i>
</td></tr>
<tr>
<th class="ctOdd">See also
</th></tr>
<tr>
<td class="ctEven"><a href="Python_scripting_tutorial.html" title="Python scripting tutorial">Python Scripting Tutorial</a>
</td></tr>
<tr>
<th class="ctOdd">
</th></tr>
<tr>
<td class="ctToc"><br><meta property="mw:PageProp/toc">
</td></tr>
</tbody></table>
<h2><span class="mw-headline" id="Description">Description</span></h2>
<p>This macro starts the MCP (Model Context Protocol) bridge server which is part of the <a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-robust-mcp-and-more">FreeCAD Robust MCP server</a> on GitHub. This enables AI assistants like <a rel="nofollow" class="external text" href="https://claude.com/claude-code">Claude Code</a> and other MCP-compatible clients to control FreeCAD programmatically.
</p><p><b>What is MCP?</b>
</p><p>The Model Context Protocol (MCP) is an open standard developed by Anthropic that allows AI assistants to interact with external tools and applications. With this bridge running, an AI assistant can:
</p>
<ul><li>Create and manipulate FreeCAD documents</li>
<li>Build 3D models using Part and PartDesign workbenches</li>
<li>Execute Python code within FreeCAD's environment</li>
<li>Export models to various formats (STEP, STL, 3MF, etc.)</li>
<li>Query object properties and document state</li></ul>
<p><b>Server Ports:</b>
</p>
<ul><li><b>XML-RPC</b> (port 9875): Compatible with neka-nat's original freecad-mcp implementation</li>
<li><b>JSON-RPC Socket</b> (port 9876): Modern protocol for MCP clients</li></ul>
<p><b>Key Features:</b>
</p>
<ul><li>Dual protocol support (XML-RPC and JSON-RPC)</li>
<li>Full access to FreeCAD's Python API</li>
<li>Safe code execution with result capture</li>
<li>Console output streaming</li>
<li>Works with Claude Code, and other MCP-compatible AI tools</li></ul>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<p><b>Prerequisites:</b>
</p>
<ol><li>Install the freecad-robust-mcp package from PyPI or GitHub</li>
<li>Configure the macro with the correct project path (done automatically by the installer)</li></ol>
<p><b>Starting the Bridge:</b>
</p>
<ol><li>Open FreeCAD</li>
<li>Run the macro from <b>Macro &rarr; Macros &rarr; StartMCPBridge &rarr; Execute</b></li>
<li>The console will show:
<dl><dd><div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">MCP</span> <span class="n">Bridge</span> <span class="n">started</span><span class="err">!</span>
  <span class="o">-</span> <span class="n">XML</span><span class="o">-</span><span class="n">RPC</span><span class="p">:</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9875</span>
  <span class="o">-</span> <span class="n">Socket</span><span class="p">:</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">9876</span>

<span class="n">You</span> <span class="n">can</span> <span class="n">now</span> <span class="n">connect</span> <span class="n">your</span> <span class="n">MCP</span> <span class="n">client</span> <span class="p">(</span><span class="n">Claude</span> <span class="n">Code</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span><span class="p">)</span> <span class="n">to</span> <span class="n">FreeCAD</span><span class="o">.</span>
</pre></div></dd></dl></li></ol>
<p><b>Connecting an AI Client:</b>
</p><p>For Claude Code, add this to your MCP settings:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="p">{</span>
  <span class="s2">"mcpServers"</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">"freecad"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"command"</span><span class="p">:</span> <span class="s2">"freecad-mcp"</span><span class="p">,</span>
      <span class="s2">"args"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"--mode"</span><span class="p">,</span> <span class="s2">"xmlrpc"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
<h2><span class="mw-headline" id="Requirements">Requirements</span></h2>
<ul><li>FreeCAD 0.21 or later</li>
<li>Python 3.11+ (must match FreeCAD's bundled Python version)</li>
<li>The freecad-robust-mcp package installed</li></ul>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><b>Method 1: Using the Installer Script</b>
</p><p>If you have the freecad-robust-mcp project cloned locally:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">just</span> <span class="n">install</span><span class="o">-</span><span class="n">bridge</span><span class="o">-</span><span class="n">macro</span>
</pre></div>
<p>This automatically:
</p>
<ul><li>Copies the macro to your FreeCAD macro directory</li>
<li>Injects the correct project path</li>
<li>Sets up the icon</li></ul>
<p><b>Method 2: Manual Installation</b>
</p>
<ol><li>Install the freecad-robust-mcp package:
<dl><dd><div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">freecad</span><span class="o">-</span><span class="n">robust</span><span class="o">-</span><span class="n">mcp</span>
</pre></div></dd></dl></li>
<li>Download the macro file: <a href="index.php?title=Special;Upload&amp;wpDestFile=StartMCPBridge.FCMacro.html" class="new" title="StartMCPBridge.FCMacro">StartMCPBridge.FCMacro</a></li>
<li>Edit the macro and replace <code>__PROJECT_PATH__</code> with the actual path to the installed package</li>
<li>Copy the file to your FreeCAD macro directory:
<ul><li><b>macOS</b>: <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">~/Library/Application Support/FreeCAD/Macro/</span></li>
<li><b>Linux</b>: <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">~/.local/share/FreeCAD/Macro/</span></li>
<li><b>Windows</b>: <span style="font-weight:bold; font-family:monospace, Consolas, Courier New, Courier;">%APPDATA%/FreeCAD/Macro/</span></li></ul></li></ol>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p><b>Error: "MCP Bridge macro not properly installed"</b>
</p><p>The project path placeholder was not replaced during installation. Run:
</p>
<div class="mw-highlight mw-highlight-lang-python mw-content-ltr" dir="ltr"><pre><span></span><span class="n">just</span> <span class="n">install</span><span class="o">-</span><span class="n">bridge</span><span class="o">-</span><span class="n">macro</span>
</pre></div>
<p><b>Error: "Failed to import MCP Bridge module"</b>
</p><p>The freecad-robust-mcp package is not installed or not accessible. Ensure:
</p>
<ul><li>The package is installed: <code>pip install freecad-robust-mcp</code></li>
<li>The project path in the macro points to the correct location</li></ul>
<p><b>Connection Issues</b>
</p>
<ul><li>Verify the bridge is running (check the FreeCAD console for startup messages)</li>
<li>Ensure no firewall is blocking ports 9875 and 9876</li>
<li>Try connecting with a simple test: <code>curl <a rel="nofollow" class="external free" href="http://localhost:9875">http://localhost:9875</a></code></li></ul>
<h2><span class="mw-headline" id="Source_Code">Source Code</span></h2>
<p>The full source code is hosted on GitHub:
</p>
<ul><li><a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-robust-mcp-and-more/blob/main/macros/Start_MCP_Bridge/StartMCPBridge.FCMacro">StartMCPBridge.FCMacro on GitHub</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/spkane/freecad-robust-mcp-and-more">GitHub Repository (freecad-robust-mcp-and-more)</a></li></ul>
<h2><span class="mw-headline" id="Script">Script</span></h2>
<p>ToolBar Icon <span class="mw-default-size" typeof="mw:File"><a href="index.php?title=Macro_Start_MCP_Bridge.png&amp;filetimestamp=20260106011106&amp;.html" class="mw-file-description"><img src="File/Macro_Start_MCP_Bridge.png" decoding="async" width="64" height="64" class="mw-file-element" data-file-width="64" data-file-height="64"></a></span>
</p><p><br>
<b>Macro_Start_MCP_Bridge.FCMacro</b>
</p><p>- <a rel="nofollow" class="external free" href="https://github.com/spkane/freecad-robust-mcp-and-more/blob/main/macros/Start_MCP_Bridge/StartMCPBridge.FCMacro">https://github.com/spkane/freecad-robust-mcp-and-more/blob/main/macros/Start_MCP_Bridge/StartMCPBridge.FCMacro</a>
</p>
<h2><span class="mw-headline" id="Links">Links</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://modelcontextprotocol.io/">Model Context Protocol Specification</a></li>
<li><a rel="nofollow" class="external text" href="https://claude.com/claude-code">Claude Code</a> - AI assistant that works with MCP</li>
<li><a href="Python_scripting_tutorial.html" title="Python scripting tutorial">Python Scripting Tutorial</a> - FreeCAD Python documentation</li></ul>
<!-- 
NewPP limit report
Cached time: 20260106053938
Cache expiry: 86400
Reduced expiry: false
Complications: [show&#8208;toc]
CPU time usage: 0.027 seconds
Real time usage: 0.032 seconds
Preprocessor visited node count: 233/1000000
Post&#8208;expand include size: 3237/2097152 bytes
Template argument size: 1396/2097152 bytes
Highest expansion depth: 5/100
Expensive parser function count: 5/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 2919/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    7.252      1 -total
 30.61%    2.220      5 Template:Code
 28.86%    2.093      1 Template:Macro
 16.59%    1.203      3 Template:FileName
 14.26%    1.034      3 Template:Incode
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:409402-0!canonical and timestamp 20260106053944 and revision id 1728149. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="site.js"></script>