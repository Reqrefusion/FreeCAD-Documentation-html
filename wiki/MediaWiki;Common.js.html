<link href="site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">MediaWiki:Common.js</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><div class="mw-highlight mw-highlight-lang-javascript mw-content-ltr mw-highlight-lines" dir="ltr"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos" data-line="1"></span></a><span class="c1">// show a hand cursor on expand links</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos" data-line="2"></span></a><span class="nx">$</span><span class="p">(</span><span class="s2">".expand-link"</span><span class="p">).</span><span class="nx">hover</span><span class="p">(</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"cursor"</span><span class="p">,</span><span class="w"> </span><span class="s2">"pointer"</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos" data-line="3"></span></a><span class="c1">// make sublist visible on expand links click</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos" data-line="4"></span></a><span class="nx">$</span><span class="p">(</span><span class="s2">".expand-link"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">parent</span><span class="p">(</span><span class="s1">'li'</span><span class="p">).</span><span class="nx">parent</span><span class="p">(</span><span class="s1">'ul'</span><span class="p">).</span><span class="nx">parent</span><span class="p">(</span><span class="s1">'div'</span><span class="p">).</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s2">"collapsible-list"</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos" data-line="5"></span></a><span class="c1">// restrict width of images on manual and command pages to fit besides TOC</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos" data-line="6"></span></a><span class="nx">$</span><span class="p">(</span><span class="s2">".manualtoc"</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">find</span><span class="p">(</span><span class="s2">"img"</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span><span class="s2">"max-width"</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">".manualtoc"</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">width</span><span class="p">()</span><span class="o">-</span><span class="mf">300</span><span class="p">,</span><span class="s2">"height"</span><span class="o">:</span><span class="s2">"auto"</span><span class="p">});</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos" data-line="7"></span></a><span class="nx">$</span><span class="p">(</span><span class="s2">".fcinfobox"</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">find</span><span class="p">(</span><span class="s2">"img"</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span><span class="s2">"max-width"</span><span class="o">:</span><span class="nx">$</span><span class="p">(</span><span class="s2">".fcinfobox"</span><span class="p">).</span><span class="nx">parent</span><span class="p">().</span><span class="nx">width</span><span class="p">()</span><span class="o">-</span><span class="mf">300</span><span class="p">,</span><span class="s2">"height"</span><span class="o">:</span><span class="s2">"auto"</span><span class="p">});</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos" data-line="8"></span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos" data-line="9"></span></a><span class="nx">mw</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">using</span><span class="p">(</span><span class="s1">'mediawiki.util'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos" data-line="10"></span></a><span class="w">    </span><span class="nx">mw</span><span class="p">.</span><span class="nx">hook</span><span class="p">(</span><span class="s1">'wikipage.content'</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos" data-line="11"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wgNamespaceNumber'</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos" data-line="12"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'ca-editgithub'</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos" data-line="13"></span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos" data-line="14"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">pageName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wgPageName'</span><span class="p">);</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos" data-line="15"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="sr">/\/[a-z\-]{2,3}$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">pageName</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos" data-line="16"></span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos" data-line="17"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">fileName</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">pageName</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/:/g</span><span class="p">,</span><span class="w"> </span><span class="s1">';'</span><span class="p">);</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos" data-line="18"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">githubUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://github.com/Reqrefusion/FreeCAD-Documentation-Project/blob/main/wiki/'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">fileName</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'.wikitext'</span><span class="p">;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos" data-line="19"></span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos" data-line="20"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'ca-edit'</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'ca-viewsource'</span><span class="p">);</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos" data-line="21"></span></a>
</span><span id="L-22"><a href="#L-22"><span class="linenos" data-line="22"></span></a><span class="w">        </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">addPortletLink</span><span class="p">(</span><span class="s1">'p-views'</span><span class="p">,</span><span class="w"> </span><span class="nx">githubUrl</span><span class="p">,</span><span class="w"> </span><span class="s1">'Edit on GitHub'</span><span class="p">,</span><span class="w"> </span><span class="s1">'ca-editgithub'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Edit this page on GitHub'</span><span class="p">);</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos" data-line="23"></span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos" data-line="24"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">newLink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'ca-editgithub'</span><span class="p">);</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos" data-line="25"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">after</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">newLink</span><span class="p">)</span><span class="w"> </span><span class="nx">after</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">newLink</span><span class="p">,</span><span class="w"> </span><span class="nx">after</span><span class="p">.</span><span class="nx">nextSibling</span><span class="p">);</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos" data-line="26"></span></a><span class="w">    </span><span class="p">});</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos" data-line="27"></span></a><span class="p">});</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos" data-line="28"></span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos" data-line="29"></span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos" data-line="30"></span></a><span class="nx">mw</span><span class="p">.</span><span class="nx">loader</span><span class="p">.</span><span class="nx">using</span><span class="p">(</span><span class="s1">'mediawiki.util'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos" data-line="31"></span></a><span class="w">    </span><span class="nx">mw</span><span class="p">.</span><span class="nx">hook</span><span class="p">(</span><span class="s1">'wikipage.content'</span><span class="p">).</span><span class="nx">add</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos" data-line="32"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wgNamespaceNumber'</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos" data-line="33"></span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos" data-line="34"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'mw-content-subtitle'</span><span class="p">);</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos" data-line="35"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">sub</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">sub</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'.mw-pt-translate-header'</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos" data-line="36"></span></a><span class="w">        </span><span class="cm">/*Group Filter*/</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos" data-line="37"></span></a><span class="w">        </span><span class="cm">/*</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos" data-line="38"></span></a><span class="cm">        var groups = mw.config.get('wgUserGroups') || [];</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos" data-line="39"></span></a><span class="cm">        if (!groups.some(function (g) { return ['translator', 'translationadmin', 'sysop'].indexOf(g) !== -1; })) return;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos" data-line="40"></span></a><span class="cm">        */</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos" data-line="41"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">pageRoot</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wgPageName'</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos" data-line="42"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">titlePlus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">pageRoot</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/_/g</span><span class="p">,</span><span class="w"> </span><span class="s1">'+'</span><span class="p">);</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos" data-line="43"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">userLang</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'wgUserLanguage'</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">language</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">'en'</span><span class="p">;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos" data-line="44"></span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos" data-line="45"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">util</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">(</span><span class="s1">'Special:Translate'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos" data-line="46"></span></a><span class="w">            </span><span class="s1">'?group=page-'</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">titlePlus</span><span class="w"> </span><span class="o">+</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos" data-line="47"></span></a><span class="w">            </span><span class="s1">'&amp;action=page&amp;filter=&amp;language='</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">userLang</span><span class="p">;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos" data-line="48"></span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos" data-line="49"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mw</span><span class="p">.</span><span class="nx">msg</span><span class="p">(</span><span class="s1">'pt-translate'</span><span class="p">);</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos" data-line="50"></span></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">label</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="sr">/^&#10748;.+&#10749;$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">label</span><span class="p">))</span><span class="w"> </span><span class="nx">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Translate this page'</span><span class="p">;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos" data-line="51"></span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos" data-line="52"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">span</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'span'</span><span class="p">);</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos" data-line="53"></span></a><span class="w">        </span><span class="nx">span</span><span class="p">.</span><span class="nx">className</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'mw-pt-translate-header'</span><span class="p">;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos" data-line="54"></span></a><span class="w">        </span><span class="nx">span</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'block'</span><span class="p">;</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos" data-line="55"></span></a><span class="w">        </span><span class="nx">span</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'center'</span><span class="p">;</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos" data-line="56"></span></a><span class="w">        </span><span class="nx">span</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">borderBottom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'0'</span><span class="p">;</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos" data-line="57"></span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos" data-line="58"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'a'</span><span class="p">);</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos" data-line="59"></span></a><span class="w">        </span><span class="nx">link</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">href</span><span class="p">;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos" data-line="60"></span></a><span class="w">        </span><span class="nx">link</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">label</span><span class="p">;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos" data-line="61"></span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos" data-line="62"></span></a><span class="w">        </span><span class="nx">span</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">link</span><span class="p">);</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos" data-line="63"></span></a><span class="w">        </span><span class="nx">sub</span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="nx">span</span><span class="p">);</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos" data-line="64"></span></a><span class="w">    </span><span class="p">});</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos" data-line="65"></span></a><span class="p">});</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos" data-line="66"></span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos" data-line="67"></span></a><span class="c1">//Pop-up header cleaner</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos" data-line="68"></span></a><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos" data-line="69"></span></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">BLOCKED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">'introduction'</span><span class="p">,</span><span class="s1">'introduced in 1.0'</span><span class="p">,</span><span class="s1">'description'</span><span class="p">,</span><span class="s1">'overview'</span><span class="p">,</span><span class="s1">'contents'</span><span class="p">,</span><span class="s1">'summary'</span><span class="p">,</span><span class="s1">'background'</span><span class="p">];</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos" data-line="70"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">uniq</span><span class="p">(</span><span class="nx">a</span><span class="p">){</span><span class="kd">var</span><span class="w"> </span><span class="nx">s</span><span class="o">=</span><span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="kc">null</span><span class="p">),</span><span class="nx">r</span><span class="o">=</span><span class="p">[];</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span><span class="w"> </span><span class="nx">k</span><span class="o">=</span><span class="nx">a</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">trim</span><span class="p">();</span><span class="k">if</span><span class="p">(</span><span class="nx">k</span><span class="o">&amp;&amp;!</span><span class="nx">s</span><span class="p">[</span><span class="nx">k</span><span class="p">]){</span><span class="nx">s</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">=</span><span class="mf">1</span><span class="p">;</span><span class="nx">r</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">k</span><span class="p">);}}</span><span class="k">return</span><span class="w"> </span><span class="nx">r</span><span class="p">;}</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos" data-line="71"></span></a><span class="w">  </span><span class="nx">BLOCKED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">uniq</span><span class="p">(</span><span class="nx">BLOCKED</span><span class="p">);</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos" data-line="72"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">escRe</span><span class="p">(</span><span class="nx">s</span><span class="p">){</span><span class="k">return</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[.*+?^${}()|[\]\\]/g</span><span class="p">,</span><span class="s1">'\\$&amp;'</span><span class="p">);}</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos" data-line="73"></span></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">inlineOpen</span><span class="o">=</span><span class="s1">'(?:&lt;(?:b|strong|i|em|span|small|mark|u)[^&gt;]*&gt;\\s*)*'</span><span class="p">;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos" data-line="74"></span></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">reBlocked</span><span class="o">=</span><span class="ow">new</span><span class="w"> </span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">'^\\s*'</span><span class="o">+</span><span class="nx">inlineOpen</span><span class="o">+</span><span class="s1">'(?:'</span><span class="o">+</span><span class="nx">BLOCKED</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">escRe</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">'|'</span><span class="p">)</span><span class="o">+</span><span class="s1">')\\s*[:&#65306;\\-&ndash;&mdash;]?\\s*'</span><span class="p">,</span><span class="s1">'i'</span><span class="p">);</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos" data-line="75"></span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos" data-line="76"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">stripEqLines</span><span class="p">(</span><span class="nx">root</span><span class="p">){</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos" data-line="77"></span></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">w</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createTreeWalker</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span><span class="nx">NodeFilter</span><span class="p">.</span><span class="nx">SHOW_TEXT</span><span class="p">,</span><span class="kc">null</span><span class="p">);</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos" data-line="78"></span></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">del</span><span class="o">=</span><span class="p">[];</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos" data-line="79"></span></a><span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="nx">w</span><span class="p">.</span><span class="nx">nextNode</span><span class="p">()){</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos" data-line="80"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">t</span><span class="o">=</span><span class="nx">w</span><span class="p">.</span><span class="nx">currentNode</span><span class="p">;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos" data-line="81"></span></a><span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="sr">/^\s*=+.*=+\s*$/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">)){</span><span class="nx">t</span><span class="p">.</span><span class="nx">nodeValue</span><span class="o">=</span><span class="s1">''</span><span class="p">;</span><span class="kd">var</span><span class="w"> </span><span class="nx">p</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="nx">p</span><span class="o">&amp;&amp;!</span><span class="nx">p</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">trim</span><span class="p">())</span><span class="nx">del</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">p</span><span class="p">);}</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos" data-line="82"></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos" data-line="83"></span></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">del</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span><span class="w"> </span><span class="nx">n</span><span class="o">=</span><span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span><span class="k">if</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">)</span><span class="nx">n</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">n</span><span class="p">);}</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos" data-line="84"></span></a><span class="w">  </span><span class="p">}</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos" data-line="85"></span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos" data-line="86"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">stripBlockedPrefixes</span><span class="p">(</span><span class="nx">root</span><span class="p">){</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos" data-line="87"></span></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">nodes</span><span class="o">=</span><span class="p">[</span><span class="nx">root</span><span class="p">].</span><span class="nx">concat</span><span class="p">([].</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'p,li,div'</span><span class="p">)));</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos" data-line="88"></span></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">nodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos" data-line="89"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">el</span><span class="o">=</span><span class="nx">nodes</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span><span class="w"> </span><span class="nx">html</span><span class="o">=</span><span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos" data-line="90"></span></a><span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">html</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos" data-line="91"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">replaced</span><span class="o">=</span><span class="nx">html</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">reBlocked</span><span class="p">,</span><span class="s1">''</span><span class="p">);</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos" data-line="92"></span></a><span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="nx">replaced</span><span class="o">!==</span><span class="nx">html</span><span class="p">)</span><span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">replaced</span><span class="p">;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos" data-line="93"></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos" data-line="94"></span></a><span class="w">  </span><span class="p">}</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos" data-line="95"></span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos" data-line="96"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">scrub</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">el</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="nx">stripEqLines</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span><span class="nx">stripBlockedPrefixes</span><span class="p">(</span><span class="nx">el</span><span class="p">);}</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos" data-line="97"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">scrubSoon</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span><span class="nx">scrub</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">scrub</span><span class="p">(</span><span class="nx">el</span><span class="p">);},</span><span class="mf">0</span><span class="p">);</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">scrub</span><span class="p">(</span><span class="nx">el</span><span class="p">);},</span><span class="mf">80</span><span class="p">);}</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos" data-line="98"></span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos" data-line="99"></span></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">seen</span><span class="o">=</span><span class="ow">new</span><span class="w"> </span><span class="nb">WeakSet</span><span class="p">();</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos" data-line="100"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">watchExtract</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos" data-line="101"></span></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">el</span><span class="o">||</span><span class="nx">seen</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">el</span><span class="p">))</span><span class="k">return</span><span class="p">;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos" data-line="102"></span></a><span class="w">    </span><span class="nx">seen</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos" data-line="103"></span></a><span class="w">    </span><span class="nx">scrubSoon</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos" data-line="104"></span></a><span class="w">    </span><span class="ow">new</span><span class="w"> </span><span class="nx">MutationObserver</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span><span class="nx">scrubSoon</span><span class="p">(</span><span class="nx">el</span><span class="p">);}).</span><span class="nx">observe</span><span class="p">(</span><span class="nx">el</span><span class="p">,{</span><span class="nx">childList</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">subtree</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">characterData</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos" data-line="105"></span></a><span class="w">  </span><span class="p">}</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos" data-line="106"></span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos" data-line="107"></span></a><span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">findAndWatch</span><span class="p">(</span><span class="nx">node</span><span class="p">){</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos" data-line="108"></span></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span><span class="o">!==</span><span class="mf">1</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos" data-line="109"></span></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">matches</span><span class="o">&amp;&amp;</span><span class="nx">node</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="s1">'.mwe-popups-extract'</span><span class="p">))</span><span class="nx">watchExtract</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos" data-line="110"></span></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">q</span><span class="o">=</span><span class="nx">node</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="o">?</span><span class="nx">node</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">'.mwe-popups-extract'</span><span class="p">)</span><span class="o">:</span><span class="p">[];</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos" data-line="111"></span></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span><span class="nx">watchExtract</span><span class="p">(</span><span class="nx">q</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos" data-line="112"></span></a><span class="w">  </span><span class="p">}</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos" data-line="113"></span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos" data-line="114"></span></a><span class="w">  </span><span class="kd">var</span><span class="w"> </span><span class="nx">docObs</span><span class="o">=</span><span class="ow">new</span><span class="w"> </span><span class="nx">MutationObserver</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">muts</span><span class="p">){</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos" data-line="115"></span></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;</span><span class="nx">muts</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos" data-line="116"></span></a><span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">m</span><span class="o">=</span><span class="nx">muts</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos" data-line="117"></span></a><span class="w">      </span><span class="k">if</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s1">'childList'</span><span class="p">){</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos" data-line="118"></span></a><span class="w">        </span><span class="k">for</span><span class="p">(</span><span class="kd">var</span><span class="w"> </span><span class="nx">j</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">j</span><span class="o">&lt;</span><span class="nx">m</span><span class="p">.</span><span class="nx">addedNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">j</span><span class="o">++</span><span class="p">)</span><span class="nx">findAndWatch</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">addedNodes</span><span class="p">[</span><span class="nx">j</span><span class="p">]);</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos" data-line="119"></span></a><span class="w">      </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">m</span><span class="p">.</span><span class="nx">type</span><span class="o">===</span><span class="s1">'characterData'</span><span class="p">){</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos" data-line="120"></span></a><span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">el</span><span class="o">=</span><span class="nx">m</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentElement</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">closest</span><span class="o">&amp;&amp;</span><span class="nx">m</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">closest</span><span class="p">(</span><span class="s1">'.mwe-popups-extract'</span><span class="p">);</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos" data-line="121"></span></a><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span><span class="nx">scrubSoon</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos" data-line="122"></span></a><span class="w">      </span><span class="p">}</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos" data-line="123"></span></a><span class="w">    </span><span class="p">}</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos" data-line="124"></span></a><span class="w">  </span><span class="p">});</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos" data-line="125"></span></a><span class="w">  </span><span class="nx">docObs</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,{</span><span class="nx">childList</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">subtree</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span><span class="nx">characterData</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos" data-line="126"></span></a><span class="w">  </span><span class="nx">findAndWatch</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos" data-line="127"></span></a><span class="p">})();</span>
</span></pre></div>
<!-- 
NewPP limit report
Cached time: 20250818210004
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.005 seconds
Real time usage: 0.005 seconds
Preprocessor visited node count: 1/1000000
Post&#8208;expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 1/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->
</div>
</div><script src="site.js"></script>