<link href="site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macros</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><p>import FreeCAD as App
import Part
from FreeCAD import Base
</p><p>doc = App.newDocument("Channel_Block")
</p>
<ol><li>&#21019;&#24314;&#22522;&#30784;&#38271;&#26041;&#20307;</li></ol>
<p>length = 300
width = 110
height = 60
block = Part.makeBox(length, width, height)
block_obj = doc.addObject("Part::Feature", "Block")
block_obj.Shape = block
</p>
<ol><li>&#20989;&#25968;&#65306;&#21019;&#24314;&#21322;&#22278;&#26609;&#65288;&#21521;&#19979;&#20985;&#65292;&#27839;&#25351;&#23450;&#36724;&#65289;</li></ol>
<p>def create_half_cylinder(radius, length, pos, direction):
</p>
<pre>   # &#21019;&#24314;&#21322;&#22278;&#26059;&#36716;&#20307;
   sketch = doc.addObject('Part::Part2DObject', 'Sketch')
   sketch.Support = None
   sketch.MapMode = 'FlatFace'
   
   # &#22312;&#33609;&#22270;&#20013;&#30011;&#19968;&#20010;&#30697;&#24418;&#65288;3x3&#65289;
   sketch.addGeometry(Part.LineSegment(App.Vector(0,0,0), App.Vector(radius,0,0)), False)
   sketch.addGeometry(Part.LineSegment(App.Vector(radius,0,0), App.Vector(radius,radius,0)), False)
   sketch.addGeometry(Part.LineSegment(App.Vector(radius,radius,0), App.Vector(0,radius,0)), False)
   sketch.addGeometry(Part.LineSegment(App.Vector(0,radius,0), App.Vector(0,0,0)), False)
   
   # &#25289;&#20280;&#24182;&#26059;&#36716;&#25104;&#21322;&#22278;&#26609;
   # &#26356;&#31616;&#21333;&#65306;&#30452;&#25509;&#29992;&#26059;&#36716;
   wire = Part.Wire([
       Part.makeLine((0,0,0), (radius,0,0)),
       Part.makeLine((radius,0,0), (radius,radius,0)),
       Part.makeLine((radius,radius,0), (0,radius,0)),
       Part.makeLine((0,radius,0), (0,0,0))
   ])
   face = Part.Face(wire)
   solid = face.revolve(Base.Vector(0,0,0), Base.Vector(*direction), 180)
   solid.translate(pos)
   return solid
</pre>
<ol><li>&#21019;&#24314;X&#26041;&#21521;&#27133;&#65288;&#27839;X&#65292;Y&#38453;&#21015;&#65289;</li></ol>
<p>x_slots = []
for i in range(14):  # Y&#26041;&#21521;&#27599;&#38548;8mm
</p>
<pre>   y_pos = i * 8
   pos = Base.Vector(0, y_pos, height - 3)  # Z=57
   cyl = Part.makeCylinder(3, 300, pos, Base.Vector(1,0,0))
   # &#29992;&#38271;&#26041;&#20307;&#20999;&#25481;&#19978;&#21322;&#37096;&#20998;&#65292;&#20445;&#30041;&#19979;&#21322;&#65288;Z &le; 57+3&#65289;
   box = Part.makeBox(302, 6, 3, Base.Vector(-1, y_pos-3, height-3))
   half_cyl = cyl.common(box)  # &#20132;&#38598; &rarr; &#19979;&#21322;&#22278;&#26609;
   x_slots.append(half_cyl)
</pre>
<p>x_slot_union = x_slots[0]
for s in x_slots[1:]:
</p>
<pre>   x_slot_union = x_slot_union.fuse(s)
</pre>
<p>x_slot_obj = doc.addObject("Part::Feature", "X_Slots")
x_slot_obj.Shape = x_slot_union
</p>
<ol><li>&#21019;&#24314;Y&#26041;&#21521;&#27133;&#65288;&#27839;Y&#65292;X&#38453;&#21015;&#65289;</li></ol>
<p>y_slots = []
for i in range(16):  # X&#26041;&#21521;&#27599;&#38548;20mm
</p>
<pre>   x_pos = i * 20
   pos = Base.Vector(x_pos, 0, height - 3)
   cyl = Part.makeCylinder(3, 110, pos, Base.Vector(0,1,0))
   box = Part.makeBox(6, 112, 3, Base.Vector(x_pos-3, -1, height-3))
   half_cyl = cyl.common(box)
   y_slots.append(half_cyl)
</pre>
<p>y_slot_union = y_slots[0]
for s in y_slots[1:]:
</p>
<pre>   y_slot_union = y_slot_union.fuse(s)
</pre>
<p>y_slot_obj = doc.addObject("Part::Feature", "Y_Slots")
y_slot_obj.Shape = y_slot_union
</p>
<ol><li>&#21512;&#24182;&#25152;&#26377;&#20985;&#27133;</li></ol>
<p>slots_union = x_slot_union.fuse(y_slot_union)
slots_obj = doc.addObject("Part::Feature", "All_Slots")
slots_obj.Shape = slots_union
</p>
<ol><li>&#20174;&#22359;&#20307;&#20013;&#20999;&#21106;</li></ol>
<p>cut = doc.addObject("Part::Cut", "Final_Block")
cut.Base = block_obj
cut.Tool = slots_obj
</p><p>doc.recompute()
App.ActiveDocument.recompute()
</p>
<!-- 
NewPP limit report
Cached time: 20250807170012
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.003 seconds
Real time usage: 0.003 seconds
Preprocessor visited node count: 1/1000000
Post&#8208;expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 1/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:446-0!canonical and timestamp 20250807170012 and revision id 1624741. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="site.js"></script>