<link href="site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Macros</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><ol><li>-*- coding: utf-8 -*-</li></ol>
<p>"""
Genera una manguera flexible enrollada (tubo hueco sobre h&eacute;lice) y la exporta en STEP.
Probado en FreeCAD 0.20+ (GUI o modo consola).
</p><p>Par&aacute;metros editables:
- hose_inner_diameter_mm, hose_outer_diameter_mm
- helix_center_radius_mm (radio del enrollado al centro del tubo)
- turns (vueltas), pitch_mm_per_turn (paso por vuelta)
- lefthand (True = h&eacute;lice izquierda), is_frenet (True = mant&eacute;n secci&oacute;n perpendicular al camino)
"""
</p><p>import FreeCAD as App
import Part
import os
</p>
<ol><li>========= PAR&Aacute;METROS =========</li></ol>
<p>hose_inner_diameter_mm = 20.0
hose_outer_diameter_mm = 24.0
helix_center_radius_mm = 140.0
turns = 10
pitch_mm_per_turn = 50.0
lefthand = False
is_frenet = True
</p>
<ol><li>Ruta de exportaci&oacute;n (c&aacute;mbiala si quieres)</li></ol>
<p>out_dir = App.getUserAppDataDir() if hasattr(App, "getUserAppDataDir") else os.getcwd()
out_path = os.path.join(out_dir, "manguera_enrollada.step")
</p>
<ol><li>==============================</li></ol>
<p>Ri = hose_inner_diameter_mm / 2.0
Ro = hose_outer_diameter_mm / 2.0
height = turns * pitch_mm_per_turn
</p><p>doc = App.newDocument("HoseHelixSTEP")
</p>
<ol><li>1) Crear la h&eacute;lice (trayectoria)</li>
<li>Part.makeHelix(pitch, height, radius, angle=0, lefthand=False)</li></ol>
<p>helix = Part.makeHelix(pitch_mm_per_turn, height, helix_center_radius_mm, 0.0, lefthand)
</p>
<ol><li>2) Crear las secciones circular exterior e interior (como caras para obtener s&oacute;lidos)</li>
<li>Ubicamos los c&iacute;rculos en el origen; el barrido con Frenet ajusta orientaci&oacute;n autom&aacute;ticamente</li></ol>
<p>circle_outer = Part.Circle(App.Vector(0,0,0), App.Vector(0,0,1), Ro)
wire_outer = Part.Wire([circle_outer.toShape()])
face_outer = Part.Face(wire_outer)  # disco
</p><p>circle_inner = Part.Circle(App.Vector(0,0,0), App.Vector(0,0,1), Ri)
wire_inner = Part.Wire([circle_inner.toShape()])
face_inner = Part.Face(wire_inner)  # disco
</p>
<ol><li>3) Barrer (sweep) las secciones sobre la h&eacute;lice</li>
<li>Face.makePipe(path) crea un s&oacute;lido "varilla" a lo largo de la trayectoria</li></ol>
<p>outer_solid = face_outer.makePipe(helix, isFrenet=is_frenet)
inner_solid = face_inner.makePipe(helix, isFrenet=is_frenet)
</p>
<ol><li>4) Hacer el tubo hueco: outer - inner</li></ol>
<p>tube_solid = outer_solid.cut(inner_solid)
</p>
<ol><li>5) Agregar al documento y recomputar</li></ol>
<p>obj = doc.addObject("Part::Feature", "CoiledHose")
obj.Shape = tube_solid
doc.recompute()
</p>
<ol><li>6) Exportar a STEP</li></ol>
<p>Part.export([obj], out_path)
</p><p>print("Exportado STEP a:", out_path)
</p>
<!-- 
NewPP limit report
Cached time: 20250905221503
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.003 seconds
Real time usage: 0.003 seconds
Preprocessor visited node count: 1/1000000
Post&#8208;expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 1/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:446-0!canonical and timestamp 20250905221503 and revision id 1638016. Rendering was triggered because: api-parse
 -->
</div>
</div><script src="site.js"></script>