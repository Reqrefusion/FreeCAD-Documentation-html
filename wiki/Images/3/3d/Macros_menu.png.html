<link href="../../../site.css" rel="stylesheet" type="text/css"/><div class="mw-page-container"><h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Images/3/3d/Macros menu.png</span></h1><?xml encoding="UTF-8"><div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr"><p># Macro: MascherinaHDMI_Femmina_Precisa
</p><p># Descrizione: Crea una mascherina con foro ESATTO per HDMI femmina Type A
</p><p># Dimensioni basate su specifiche HDMI Licensing Administrator
</p><p>import FreeCAD
</p><p>import Part
</p><p>import Draft
</p><p>from FreeCAD import Base, Vector
</p><p>import math
</p><p>def crea_mascherina_hdmi_precisa():
</p><p>&nbsp; &nbsp; """
</p><p>&nbsp; &nbsp; Crea una mascherina con foro PRECISO per connettore HDMI femmina Type A.
</p><p>&nbsp; &nbsp; Dimensioni basate sullo standard HDMI.
</p><p>&nbsp; &nbsp; """
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Dimensioni massime della mascherina
</p><p>&nbsp; &nbsp; larghezza_totale = 20.0&nbsp; # mm
</p><p>&nbsp; &nbsp; altezza_totale = 20.0&nbsp; &nbsp; # mm
</p><p>&nbsp; &nbsp; spessore = 2.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# mm
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # ============================================
</p><p>&nbsp; &nbsp; # DIMENSIONI ESATTE CONNETTORE HDMI FEMMINA TYPE A
</p><p>&nbsp; &nbsp; # Fonte: Specifiche HDMI 1.4b, IEC 62680-1-3
</p><p>&nbsp; &nbsp; # ============================================
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Dimensioni esteriori del connettore femmina (casa metallica)
</p><p>&nbsp; &nbsp; larghezza_esterna = 13.9&nbsp; &nbsp; # mm &plusmn;0.1 (A in datasheet)
</p><p>&nbsp; &nbsp; altezza_esterna = 4.45&nbsp; &nbsp; &nbsp; # mm &plusmn;0.1 (B in datasheet)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Dimensioni apertura interna (dove entra il maschio)
</p><p>&nbsp; &nbsp; # Queste sono le misure CRITICHE per il foro nella mascherina
</p><p>&nbsp; &nbsp; larghezza_apertura = 13.5&nbsp; &nbsp;# mm (C in datasheet, massima)
</p><p>&nbsp; &nbsp; altezza_apertura = 4.35&nbsp; &nbsp; &nbsp;# mm (D in datasheet, massima)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Forma trapezoidale caratteristica dell'HDMI
</p><p>&nbsp; &nbsp; # L'apertura &egrave; leggermente trapezoidale
</p><p>&nbsp; &nbsp; larghezza_superiore = 13.5&nbsp; &nbsp;# mm
</p><p>&nbsp; &nbsp; larghezza_inferiore = 12.7&nbsp; &nbsp;# mm
</p><p>&nbsp; &nbsp; altezza_trapezio = 4.35&nbsp; &nbsp; &nbsp; # mm
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Raggio angoli caratteristico
</p><p>&nbsp; &nbsp; raggio_angoli = 0.5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # mm
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Posizione pin (per riferimento)
</p><p>&nbsp; &nbsp; altezza_pin_centro = 2.1&nbsp; &nbsp; &nbsp;# mm dal bordo inferiore
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # ============================================
</p><p>&nbsp; &nbsp; # CREAZIONE MASCHERINA
</p><p>&nbsp; &nbsp; # ============================================
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Crea il documento
</p><p>&nbsp; &nbsp; doc = FreeCAD.ActiveDocument
</p><p>&nbsp; &nbsp; if not doc:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; doc = FreeCAD.newDocument("Mascherina_HDMI_Precisa")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 1. CREA BASE PRINCIPALE 20x20x2mm
</p><p>&nbsp; &nbsp; base = Part.makeBox(larghezza_totale, altezza_totale, spessore)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Centro della mascherina
</p><p>&nbsp; &nbsp; centro_x = larghezza_totale / 2
</p><p>&nbsp; &nbsp; centro_y = altezza_totale / 2
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 2. CREA FORO HDMI PRECISO (forma a trapezio)
</p><p>&nbsp; &nbsp; print("Creando foro HDMI con dimensioni esatte...")
</p><p>&nbsp; &nbsp; print(f"Larghezza superiore: {larghezza_superiore}mm")
</p><p>&nbsp; &nbsp; print(f"Larghezza inferiore: {larghezza_inferiore}mm")
</p><p>&nbsp; &nbsp; print(f"Altezza: {altezza_trapezio}mm")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Crea il profilo trapezoidale dell'HDMI
</p><p>&nbsp; &nbsp; # Coordinate rispetto al centro del trapezio
</p><p>&nbsp; &nbsp; met&agrave;_sup = larghezza_superiore / 2
</p><p>&nbsp; &nbsp; met&agrave;_inf = larghezza_inferiore / 2
</p><p>&nbsp; &nbsp; h = altezza_trapezio / 2
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Punti del trapezio (in senso orario)
</p><p>&nbsp; &nbsp; # Forma esatta dell'HDMI: trapezio isoscele
</p><p>&nbsp; &nbsp; punti = [
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(-met&agrave;_inf, -h, 0),&nbsp; &nbsp; &nbsp; # Angolo inferiore sinistro
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(met&agrave;_inf, -h, 0),&nbsp; &nbsp; &nbsp; &nbsp;# Angolo inferiore destro
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(met&agrave;_sup, h, 0),&nbsp; &nbsp; &nbsp; &nbsp; # Angolo superiore destro
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(-met&agrave;_sup, h, 0),&nbsp; &nbsp; &nbsp; &nbsp;# Angolo superiore sinistro
</p><p>&nbsp; &nbsp; ]
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Crea il wire (contorno)
</p><p>&nbsp; &nbsp; wire = Part.makePolygon(punti + [punti[0]])&nbsp; # Chiudi il contorno
</p><p>&nbsp; &nbsp; faccia = Part.Face(wire)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Estrudi per creare il solido di taglio
</p><p>&nbsp; &nbsp; foro_hdmi = faccia.extrude(Vector(0, 0, spessore * 3))&nbsp; # Extra lungo per sicurezza
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Posiziona al centro della mascherina
</p><p>&nbsp; &nbsp; foro_hdmi.translate(Vector(centro_x, centro_y, -spessore - 1))
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 3. APPLICA RAGGI AGLI ANGOLI (caratteristici dell'HDMI)
</p><p>&nbsp; &nbsp; try:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Raggio sui 4 angoli del trapezio
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Nota: In FreeCAD &egrave; pi&ugrave; facile applicare il raggio prima dell'estrusione
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Creiamo direttamente un profilo con raggi
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Alternativa: crea un rettangolo con raggi e poi ritaglia il trapezio
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; rettangolo_base = Part.makeRoundedRectangle(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; larghezza_superiore, 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; altezza_trapezio, 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; raggio_angoli, 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; raggio_angoli, 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; raggio_angoli, 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; raggio_angoli,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vector(0,0,0), 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vector(0,0,1)
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; )
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Crea il solido dal rettangolo arrotondato
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; foro_hdmi_arrot = rettangolo_base.extrude(Vector(0, 0, spessore * 3))
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; foro_hdmi_arrot.translate(Vector(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; centro_x - larghezza_superiore/2,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; centro_y - altezza_trapezio/2,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -spessore - 1
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; ))
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Usa questa versione arrotondata
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; foro_hdmi = foro_hdmi_arrot
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; except:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("Usando forma trapezoidale senza raggi (fallback)")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 4. CREA FORI PER VITI DI FISSAGGIO (M2.5 standard)
</p><p>&nbsp; &nbsp; diametro_vite = 2.5&nbsp; # mm per vite M2.5
</p><p>&nbsp; &nbsp; distanza_bordo = 2.5 # mm dal bordo
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Posizioni dei 4 fori (angoli della mascherina)
</p><p>&nbsp; &nbsp; posizioni_fori = [
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; (distanza_bordo, distanza_bordo),&nbsp; # Basso-sinistra
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; (larghezza_totale - distanza_bordo, distanza_bordo),&nbsp; # Basso-destra
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; (distanza_bordo, altezza_totale - distanza_bordo),&nbsp; # Alto-sinistra
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; (larghezza_totale - distanza_bordo, altezza_totale - distanza_bordo)&nbsp; # Alto-destra
</p><p>&nbsp; &nbsp; ]
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 5. CREA GUIDA ORIENTATIVA (tacca per montaggio corretto)
</p><p>&nbsp; &nbsp; # L'HDMI ha una tacca sul lato inferiore per orientamento
</p><p>&nbsp; &nbsp; larghezza_tacca = 7.0&nbsp; # mm
</p><p>&nbsp; &nbsp; altezza_tacca = 0.8&nbsp; &nbsp; # mm
</p><p>&nbsp; &nbsp; profondita_tacca = 0.5&nbsp; # mm
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Crea la tacca di orientamento
</p><p>&nbsp; &nbsp; tacca = Part.makeBox(larghezza_tacca, profondita_tacca, altezza_tacca)
</p><p>&nbsp; &nbsp; tacca.translate(Vector(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; centro_x - larghezza_tacca/2,&nbsp; # Centrata in orizzontale
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 0,&nbsp; # Sul bordo inferiore
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; spessore - altezza_tacca&nbsp; # Sulla faccia superiore
</p><p>&nbsp; &nbsp; ))
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 6. UNISCI TUTTI I SOLIDI DI TAGLIO
</p><p>&nbsp; &nbsp; taglio_totale = foro_hdmi
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Aggiungi fori per viti
</p><p>&nbsp; &nbsp; for pos in posizioni_fori:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; foro = Part.makeCylinder(diametro_vite/2, spessore * 3)
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; foro.translate(Vector(pos[0], pos[1], -spessore - 1))
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; taglio_totale = taglio_totale.fuse(foro)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Aggiungi la tacca (&egrave; un'aggiunta, non un taglio)
</p><p>&nbsp; &nbsp; # Per la tacca usiamo un'operazione di taglio dalla faccia superiore
</p><p>&nbsp; &nbsp; tacca_taglio = tacca.copy()
</p><p>&nbsp; &nbsp; tacca_taglio.translate(Vector(0, 0, -0.1))&nbsp; # Assicura penetrazione
</p><p>&nbsp; &nbsp; taglio_totale = taglio_totale.fuse(tacca_taglio)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 7. APPLICA TUTTI I TAGLI ALLA BASE
</p><p>&nbsp; &nbsp; mascherina = base.cut(taglio_totale)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 8. AGGIUNGI RACCOLTI PER MIGLIORARE LA STAMPABILIT&Agrave;
</p><p>&nbsp; &nbsp; try:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Raccordo spigoli esterni verticali
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; raccordo = 0.3&nbsp; # mm
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; bordi_da_raccordare = []
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; for edge in mascherina.Edges:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Trova bordi verticali (paralleli all'asse Z)
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if abs(edge.Length - spessore) &lt; 0.01:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Verifica se &egrave; un bordo esterno
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for vertex in edge.Vertexes:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x, y, z = vertex.X, vertex.Y, vertex.Z
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (x &lt; 0.1 or x &gt; larghezza_totale - 0.1 or 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; y &lt; 0.1 or y &gt; altezza_totale - 0.1):
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bordi_da_raccordare.append(edge)
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; # Applica raccordo se ci sono bordi validi
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if bordi_da_raccordare:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mascherina = mascherina.makeFillet(raccordo, bordi_da_raccordare[:4])
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; except Exception as e:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print(f"Raccordo non applicabile: {e}")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 9. AGGIUNGI AL DOCUMENTO
</p><p>&nbsp; &nbsp; obj_mascherina = doc.addObject("Part::Feature", "Mascherina_HDMI_Precisa")
</p><p>&nbsp; &nbsp; obj_mascherina.Shape = mascherina
</p><p>&nbsp; &nbsp; obj_mascherina.ViewObject.ShapeColor = (0.2, 0.2, 0.2)&nbsp; # Grigio scuro
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 10. CREA UN RIFERIMENTO VISIVO DEL CONNETTORE
</p><p>&nbsp; &nbsp; # Crea un modello semplificato del connettore HDMI per verifica
</p><p>&nbsp; &nbsp; connettore_ref = Part.makeBox(larghezza_esterna, 5.0, altezza_esterna)
</p><p>&nbsp; &nbsp; connettore_ref.translate(Vector(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; centro_x - larghezza_esterna/2,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; centro_y - 2.5,&nbsp; # Centrato in verticale
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; spessore + 0.1&nbsp; # Appena sopra la mascherina
</p><p>&nbsp; &nbsp; ))
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; obj_connettore = doc.addObject("Part::Feature", "Connettore_HDMI_Riferimento")
</p><p>&nbsp; &nbsp; obj_connettore.Shape = connettore_ref
</p><p>&nbsp; &nbsp; obj_connettore.ViewObject.ShapeColor = (0.8, 0.3, 0.0)&nbsp; # Arancione metallico
</p><p>&nbsp; &nbsp; obj_connettore.ViewObject.Transparency = 60
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 11. CREA UNA VISTA IN SEZIONE PER VERIFICA
</p><p>&nbsp; &nbsp; # Crea un piano di taglio per vedere la sezione
</p><p>&nbsp; &nbsp; piano_sezione = Part.makeBox(larghezza_totale, altezza_totale/2, spessore * 2)
</p><p>&nbsp; &nbsp; piano_sezione.translate(Vector(0, altezza_totale/2, -spessore))
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; sezione = mascherina.common(piano_sezione)
</p><p>&nbsp; &nbsp; obj_sezione = doc.addObject("Part::Feature", "Sezione_Verifica")
</p><p>&nbsp; &nbsp; obj_sezione.Shape = sezione
</p><p>&nbsp; &nbsp; obj_sezione.ViewObject.ShapeColor = (0.0, 0.6, 0.8)&nbsp; # Blu chiaro
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 12. AGGIUNGI QUOTE PER MISURE
</p><p>&nbsp; &nbsp; # Crea linee di quota visive
</p><p>&nbsp; &nbsp; # Quota larghezza foro HDMI
</p><p>&nbsp; &nbsp; linea_quota_larg = Part.makeLine(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(centro_x - larghezza_superiore/2, centro_y + altezza_trapezio/2 + 3, spessore),
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; Vector(centro_x + larghezza_superiore/2, centro_y + altezza_trapezio/2 + 3, spessore)
</p><p>&nbsp; &nbsp; )
</p><p>&nbsp; &nbsp; obj_quota_larg = doc.addObject("Part::Feature", "Quota_Larghezza_HDMI")
</p><p>&nbsp; &nbsp; obj_quota_larg.Shape = linea_quota_larg
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 13. AGGIORNA TUTTO
</p><p>&nbsp; &nbsp; doc.recompute()
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 14. IMPOSTA VISTA 3D OTTIMALE
</p><p>&nbsp; &nbsp; FreeCADGui.ActiveDocument.activeView().viewIsometric()
</p><p>&nbsp; &nbsp; FreeCADGui.ActiveDocument.activeView().fitAll()
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # 15. STAMPA RIEPILOGO DETTAGLIATO
</p><p>&nbsp; &nbsp; print("\n" + "="*70)
</p><p>&nbsp; &nbsp; print("MASCHERINA HDMI FEMMINA - DIMENSIONI ESATTE")
</p><p>&nbsp; &nbsp; print("="*70)
</p><p>&nbsp; &nbsp; print(f"DIMENSIONI MASCHERINA:")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Larghezza totale: {larghezza_totale} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Altezza totale: {altezza_totale} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Spessore: {spessore} mm")
</p><p>&nbsp; &nbsp; print()
</p><p>&nbsp; &nbsp; print(f"FORO HDMI TYPE A (dimensioni reali):")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Larghezza superiore: {larghezza_superiore} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Larghezza inferiore: {larghezza_inferiore} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Altezza: {altezza_trapezio} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Forma: Trapezio isoscele con raggi R{raggio_angoli}mm")
</p><p>&nbsp; &nbsp; print()
</p><p>&nbsp; &nbsp; print(f"FORI DI FISSAGGIO:")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Diametro: {diametro_vite} mm (vite M{diametro_vite})")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Posizione: {distanza_bordo} mm dal bordo")
</p><p>&nbsp; &nbsp; print()
</p><p>&nbsp; &nbsp; print(f"CARATTERISTICHE AGGIUNTIVE:")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Tacca di orientamento: {larghezza_tacca}x{altezza_tacca} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; &bull; Raccordo spigoli: 0.3 mm")
</p><p>&nbsp; &nbsp; print("="*70)
</p><p>&nbsp; &nbsp; print("\n&#10003; Verificare SEMPRE le dimensioni con un calibro sul connettore reale!")
</p><p>&nbsp; &nbsp; print("&#10003; Consigliato: stampa 3D di prova in PLA/PETG prima di produzione definitiva")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; return obj_mascherina
</p><p># FUNZIONE ALTERNATIVA: Versione con foro rettangolare semplificato
</p><p># (per compatibilit&agrave; o se si hanno problemi con la forma trapezoidale)
</p><p>def crea_mascherina_hdmi_rettangolare():
</p><p>&nbsp; &nbsp; """Versione con foro rettangolare, adatta a processi di taglio laser"""
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Dimensioni
</p><p>&nbsp; &nbsp; larghezza_totale = 20.0
</p><p>&nbsp; &nbsp; altezza_totale = 20.0
</p><p>&nbsp; &nbsp; spessore = 2.0
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Foro HDMI semplificato (rettangolare)
</p><p>&nbsp; &nbsp; # Dimensioni massime: 13.9 x 4.45 mm
</p><p>&nbsp; &nbsp; larghezza_foro = 13.5&nbsp; # mm (leggermente pi&ugrave; grande per tolleranza)
</p><p>&nbsp; &nbsp; altezza_foro = 4.35&nbsp; &nbsp; # mm
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; doc = FreeCAD.ActiveDocument
</p><p>&nbsp; &nbsp; if not doc:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; doc = FreeCAD.newDocument("Mascherina_HDMI_Rettangolare")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Base
</p><p>&nbsp; &nbsp; base = Part.makeBox(larghezza_totale, altezza_totale, spessore)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Centro
</p><p>&nbsp; &nbsp; centro_x = larghezza_totale / 2
</p><p>&nbsp; &nbsp; centro_y = altezza_totale / 2
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Foro HDMI rettangolare
</p><p>&nbsp; &nbsp; foro = Part.makeBox(larghezza_foro, altezza_foro, spessore * 3)
</p><p>&nbsp; &nbsp; foro.translate(Vector(
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; centro_x - larghezza_foro/2,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; centro_y - altezza_foro/2,
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; -spessore - 1
</p><p>&nbsp; &nbsp; ))
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Fori viti M2.5
</p><p>&nbsp; &nbsp; diametro_vite = 2.5
</p><p>&nbsp; &nbsp; pos_fori = [(3,3), (17,3), (3,17), (17,17)]
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; taglio_totale = foro
</p><p>&nbsp; &nbsp; for pos in pos_fori:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; vite = Part.makeCylinder(diametro_vite/2, spessore * 3)
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; vite.translate(Vector(pos[0], pos[1], -spessore - 1))
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; taglio_totale = taglio_totale.fuse(vite)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Applica tagli
</p><p>&nbsp; &nbsp; mascherina = base.cut(taglio_totale)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Aggiungi al documento
</p><p>&nbsp; &nbsp; obj = doc.addObject("Part::Feature", "Mascherina_HDMI_Rettangolare")
</p><p>&nbsp; &nbsp; obj.Shape = mascherina
</p><p>&nbsp; &nbsp; obj.ViewObject.ShapeColor = (0.3, 0.3, 0.3)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; doc.recompute()
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; print("\n&#10003; Mascherina HDMI con foro rettangolare creata")
</p><p>&nbsp; &nbsp; print(f"&nbsp; Foro: {larghezza_foro} x {altezza_foro} mm")
</p><p>&nbsp; &nbsp; print(f"&nbsp; Viti: M{diametro_vite} (4 fori)")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; return obj
</p><p># ============================================
</p><p># ESEGUZIONE PRINCIPALE
</p><p># ============================================
</p><p>try:
</p><p>&nbsp; &nbsp; print("Creazione mascherina HDMI femmina con dimensioni ESATTE...")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Scegli quale versione creare:
</p><p>&nbsp; &nbsp; # 1. Versione precisa con forma trapezoidale (RACCOMANDATA)
</p><p>&nbsp; &nbsp; # 2. Versione con foro rettangolare (semplice)
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; risposta = input("Premi 1 per forma precisa trapezoidale, 2 per rettangolare: ")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; if risposta == "2":
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("Creazione versione rettangolare semplificata...")
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; risultato = crea_mascherina_hdmi_rettangolare()
</p><p>&nbsp; &nbsp; else:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("Creazione versione precisa con forma HDMI esatta...")
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; risultato = crea_mascherina_hdmi_precisa()
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; print("\n&#9989; MASCHERINA CREATA CON SUCCESSO!")
</p><p>&nbsp; &nbsp; print("\nIstruzioni post-creazione:")
</p><p>&nbsp; &nbsp; print("1. Verifica le misure con lo strumento 'Misura' di FreeCAD")
</p><p>&nbsp; &nbsp; print("2. Esporta come STL per stampa 3D")
</p><p>&nbsp; &nbsp; print("3. Per produzione laser/CNC, esporta come DXF della faccia superiore")
</p><p>&nbsp; &nbsp; 
</p><p>except Exception as e:
</p><p>&nbsp; &nbsp; print(f"\n&#10060; ERRORE durante la creazione: {e}")
</p><p>&nbsp; &nbsp; print("\nSoluzioni possibili:")
</p><p>&nbsp; &nbsp; print("1. Assicurati di avere un documento FreeCAD aperto")
</p><p>&nbsp; &nbsp; print("2. Prova a riavviare FreeCAD")
</p><p>&nbsp; &nbsp; print("3. Usa la versione semplificata")
</p><p>&nbsp; &nbsp; 
</p><p>&nbsp; &nbsp; # Fallback automatico
</p><p>&nbsp; &nbsp; try:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("\nTentativo con versione semplificata...")
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; risultato = crea_mascherina_hdmi_rettangolare()
</p><p>&nbsp; &nbsp; except:
</p><p>&nbsp; &nbsp; &nbsp; &nbsp; print("\nImpossibile creare la mascherina. Controlla l'installazione di FreeCAD.")
</p>
<!-- 
NewPP limit report
Cached time: 20260127152955
Cache expiry: 86400
Reduced expiry: false
Complications: []
CPU time usage: 0.011 seconds
Real time usage: 0.011 seconds
Preprocessor visited node count: 25/1000000
Post&#8208;expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/100
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post&#8208;expand size: 8/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%    0.000      1 -total
-->

<!-- Saved in parser cache with key freecadweb_db01-wiki_:pcache:idhash:412821-0!canonical and timestamp 20260127153003 and revision id 1744839. Rendering was triggered because: edit-page
 -->
</div>
</div><script src="../../../site.js"></script>